user config:
seed 666
device 0
scaler StandardScaler()
day_slot 288
n_route 10
n_his 96
n_pred 96
n_train 34
n_val 5
n_test 5
mode 1
n_c 10
model STAGNN_stamp
TPG TPGNN
name lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6
log_path log/TPGNN_r05p02kt3outer_256
crash 256
new_name TPGNN_r05p02kt3outer_256
batch_size 256
lr 0.0001
a 0.1
r 0.5
n_mask 1
adam {'use': True, 'weight_decay': 0.0001}
slr {'use': True, 'step_size': 400, 'gamma': 0.3}
resume False
start_epoch 0
epochs 100
n_layer 1
n_attr 64
n_hid 64
reg_A 0.001
circle 288
drop_prob 0.2
CE {'use': True, 'kernel_size': 1, 'bias': False}
LE {'use': False, 'bias': False}
SE {'use': True, 'separate': True, 'no': False}
TE {'use': True, 'no': True}
attn {'head': 1, 'd_k': 32, 'd_v': 32, 'drop_prob': 0.2}
STstamp {'use': True, 'kt': 3, 'temperature': 1.0}
T4N {'use': True, 'step': 2, 'end_epoch': 10000, 'change_head': True, 'change_enc': True}
stamp_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/time_stamp.npy
data_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/V_France_processed_0.csv
adj_matrix_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/W_France_processed_0.csv
dis_mat tensor([[0.0000, 0.3661, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.6136, 0.0000,
         0.0000],
        [0.3661, 0.0000, 0.0000, 0.0000, 0.1098, 0.0000, 0.0000, 0.8975, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.3410, 0.8975, 0.0000, 0.0000, 0.0000, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.3410, 0.0000, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000,
         0.1494],
        [0.0000, 0.1098, 0.8975, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000, 0.6996,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000,
         0.2289],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000, 0.0000,
         0.5594],
        [0.6136, 0.8975, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.2117,
         0.0000],
        [0.0000, 0.4288, 0.4288, 0.0000, 0.6996, 0.0000, 0.0000, 0.2117, 0.0000,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.1494, 0.0000, 0.2289, 0.5594, 0.0000, 0.0000,
         0.0000]], device='cuda:0')
prefix log/lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6/
checkpoint_temp_path log/lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6//temp.pth
checkpoint_best_path log/lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6//best.pth
tensorboard_path log/lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6/
record_path log/lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6/record.txt
eps 0.1
parse <bound method DefaultConfig.parse of <config.DefaultConfig object at 0x7fce8ce95550>>
output <bound method DefaultConfig.output of <config.DefaultConfig object at 0x7fce8ce95550>>
train: True, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 9792
len(data): 9792, day_slot: 288, n_day: 34
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
10 10
epoch 0   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 4.03751435646644 , validation loss: 1.1844175457954407
epoch 1   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 3.8629551300635705 , validation loss: 1.1126021146774292
epoch 2   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 3.6700420563037577 , validation loss: 1.0093430280685425
epoch 3   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 3.50979155760545 , validation loss: 0.955541729927063
epoch 4   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 3.409261079934927 , validation loss: 0.9281019866466522
epoch 5   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 3.329726274196918 , validation loss: 0.9316791892051697
epoch 6   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 3.2572163618527927 , validation loss: 0.9154495298862457
epoch 7   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 3.190845324442937 , validation loss: 0.9475274384021759
epoch 8   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 3.1278772904322696 , validation loss: 0.9471671879291534
epoch 9   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 3.0650931138258715 , validation loss: 0.9460846483707428
epoch 10   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 3.004750655247615 , validation loss: 0.9806264340877533
epoch 11   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.9502559991983266 , validation loss: 0.9689925611019135
epoch 12   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.9009139904609094 , validation loss: 0.9890470504760742
epoch 13   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.8588433265686035 , validation loss: 0.9864609241485596
epoch 14   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.8235111236572266 , validation loss: 0.9934549331665039
epoch 15   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.793533600293673 , validation loss: 0.9933046400547028
epoch 16   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.77090466939486 , validation loss: 1.003685712814331
epoch 17   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.7508493936978855 , validation loss: 1.0270293951034546
epoch 18   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.7335111728081336 , validation loss: 1.0294922590255737
epoch 19   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.716402457310603 , validation loss: 1.0336194038391113
epoch 20   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.7019229852236233 , validation loss: 1.0310630202293396
epoch 21   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.6865128370431752 , validation loss: 1.0426398515701294
epoch 22   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.67220585162823 , validation loss: 1.039562165737152
epoch 23   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.657777529496413 , validation loss: 1.0227247476577759
epoch 24   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.6438875748560977 , validation loss: 1.021426498889923
epoch 25   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.6312086398784933 , validation loss: 1.0275567173957825
epoch 26   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.6177842433636007 , validation loss: 1.0068398714065552
epoch 27   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.6045953310452976 , validation loss: 1.0203943848609924
epoch 28   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.592284000836886 , validation loss: 1.0293445587158203
epoch 29   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.579879412284264 , validation loss: 1.0190642476081848
epoch 30   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.567884775308462 , validation loss: 1.0213738977909088
epoch 31   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.5559906592735877 , validation loss: 1.022543579339981
epoch 32   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.5446687661684475 , validation loss: 0.9836335778236389
epoch 33   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.5330425775968113 , validation loss: 0.9958325922489166
epoch 34   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.5218061117025523 , validation loss: 1.0104709565639496
epoch 35   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.5106503046475925 , validation loss: 0.9941519498825073
epoch 36   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.499524318254911 , validation loss: 1.000355213880539
epoch 37   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.4887159237494836 , validation loss: 1.000779241323471
epoch 38   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.4774709848257213 , validation loss: 1.0033721327781677
epoch 39   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.4668569014622617 , validation loss: 0.9917145073413849
epoch 40   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.455878551189716 , validation loss: 0.9997122883796692
epoch 41   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.4458945164313683 , validation loss: 0.9766727685928345
epoch 42   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.4358288508195143 , validation loss: 0.975593090057373
epoch 43   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.425099152785081 , validation loss: 0.974043607711792
epoch 44   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.4150558434999905 , validation loss: 0.9758444428443909
epoch 45   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.4047855780674863 , validation loss: 0.9678860306739807
epoch 46   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.3952215084662805 , validation loss: 0.9609756171703339
epoch 47   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.3848571410545936 , validation loss: 0.9508229792118073
epoch 48   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.3751159264491153 , validation loss: 0.9573646783828735
epoch 49   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.365511857546293 , validation loss: 0.9484831988811493
epoch 50   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.355477204689613 , validation loss: 0.9616168439388275
epoch 51   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.3459316216982327 , validation loss: 0.9644551277160645
epoch 52   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.3360611292032094 , validation loss: 0.9535242915153503
epoch 53   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.3268280762892504 , validation loss: 0.9520591199398041
epoch 54   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.3175195914048414 , validation loss: 0.9471860229969025
epoch 55   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.3078700579129734 , validation loss: 0.9346373975276947
epoch 56   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.2987097960252028 , validation loss: 0.9312130212783813
epoch 57   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.289302257391123 , validation loss: 0.9238225817680359
epoch 58   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.280697767551129 , validation loss: 0.9281275272369385
epoch 59   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.271194549707266 , validation loss: 0.9285464286804199
epoch 60   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.2622960347395678 , validation loss: 0.9363756775856018
epoch 61   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.253837145291842 , validation loss: 0.9297721982002258
epoch 62   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.24473892725431 , validation loss: 0.9216375052928925
epoch 63   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.235901740881113 , validation loss: 0.911345362663269
epoch 64   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.2274413659022403 , validation loss: 0.9274396896362305
epoch 65   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.2187859278458815 , validation loss: 0.9431256651878357
epoch 66   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.209890365600586 , validation loss: 0.918696254491806
epoch 67   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.2012095267956076 , validation loss: 0.9219835102558136
epoch 68   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.1929248846494236 , validation loss: 0.9152764081954956
epoch 69   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.184517108477079 , validation loss: 0.9202221035957336
epoch 70   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.1758705652677097 , validation loss: 0.8971328139305115
epoch 71   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.1677922102121205 , validation loss: 0.9017581641674042
epoch 72   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.1602534514207106 , validation loss: 0.9159446656703949
epoch 73   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.151184320449829 , validation loss: 0.9126253426074982
epoch 74   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.143659389936007 , validation loss: 0.916288286447525
epoch 75   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.135538944831261 , validation loss: 0.9199426472187042
epoch 76   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.1273101476522593 , validation loss: 0.9136121571063995
epoch 77   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.1191434126633863 , validation loss: 0.921948254108429
epoch 78   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.11167887540964 , validation loss: 0.9030073285102844
epoch 79   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.1029827227959266 , validation loss: 0.8935201168060303
epoch 80   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.095617074232835 , validation loss: 0.9155027270317078
epoch 81   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.087688849522517 , validation loss: 0.9072943925857544
epoch 82   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.079608513758733 , validation loss: 0.9109239876270294
epoch 83   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.071500851557805 , validation loss: 0.9080077111721039
epoch 84   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.0641983839181752 , validation loss: 0.9059033989906311
epoch 85   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.057175874710083 , validation loss: 0.8840529024600983
epoch 86   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.0489905980917125 , validation loss: 0.882800281047821
epoch 87   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.0413128779484677 , validation loss: 0.9063486158847809
epoch 88   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.0339738772465634 , validation loss: 0.8916311860084534
epoch 89   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.026750381176288 , validation loss: 0.8903684616088867
epoch 90   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.0189194129063535 , validation loss: 0.896758109331131
epoch 91   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.011166114073533 , validation loss: 0.8923341929912567
epoch 92   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 2.0032211267031155 , validation loss: 0.8885009288787842
epoch 93   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 1.9963507652282715 , validation loss: 0.8926928639411926
epoch 94   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 1.9892252408541167 , validation loss: 0.8607955873012543
epoch 95   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 1.982315100156344 , validation loss: 0.8787679672241211
epoch 96   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 1.9742520864193256 , validation loss: 0.897729218006134
tensor(75.4154, device='cuda:0')
MAE: [0.4032995952159819, 0.5499210115105452, 0.6132682570798764, 0.6621100993227866, 0.7084274207259116, 0.7128511579878167, 0.685287680326164, 0.6566153786342936, 0.6872019014584342, 0.7380088992485988, 0.8050253588729298, 0.8540276750510308, 0.8830061544600836, 0.8700610143710504, 0.8320263481028762, 0.8199571296180954, 0.855875581613521, 0.8739033889814674, 0.9196436832015662, 0.9474688644645755, 0.9971955276119341, 0.9944483330849674, 0.9416535279389049, 0.9094538574450717, 0.905259124460755, 0.9226064914186514, 0.9579017890045016, 1.0099638045016561, 1.0221319411564427, 1.0131647747336436, 0.9460505174630869, 0.968266903499967] , MAPE: [0.14086842526148252, 0.14187757983049148, 0.279818841852613, 0.16316071838182195, 0.10195363663190066, 0.09801233565276393, 0.0234417260697978, 0.02103375376317381, -0.01224529424860633, 0.0860733802524424, 0.02611677788636427, -0.021953438052987998, -0.1431952682240883, -0.16184520556239318, -0.21692133807173788, -0.12949864761304292, -0.09534179640207775, -0.08912181013110855, -0.101403961328864, -0.04839696063288036, -0.17394020363132195, -0.16452060627977283, -0.1814078680682146, -0.03587416974303028, -0.03282654808303425, -0.09886522889293288, -0.09773794586411089, -0.3357721984857116, -0.2893914065578024, -0.09089766143881488, -0.24412062494148973, -0.5801269267223531] %, RMSE: [0.6860311212242473, 0.8696209046327694, 0.9496718130017178, 0.9883991889740625, 1.0227320665996054, 1.0094722787337498, 0.9550320252720075, 0.911157194670499, 0.9320955620831581, 0.9810475148949519, 1.0614584427798555, 1.113745046073951, 1.142491026544888, 1.113970278871218, 1.0724893614769904, 1.0442097714395757, 1.087984653455224, 1.09711855436496, 1.152352389722109, 1.191663551654283, 1.2507624538436337, 1.2461692965816749, 1.19742589246639, 1.1530382495933278, 1.1358346187364248, 1.1568689945988824, 1.2059590406316534, 1.2691566969353019, 1.29100575783114, 1.2744190988385822, 1.209223790948824, 1.2303807226683683]
epoch 97   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 1.9670611344850981 , validation loss: 0.8873258233070374
tensor(75.3343, device='cuda:0')
MAE: [0.3928516525875047, 0.5449383695008828, 0.6052551790052718, 0.6526548343539699, 0.6980206462111055, 0.704962527770549, 0.6876399451328115, 0.648327193465852, 0.6798470946516573, 0.7258663861009955, 0.7816243408578112, 0.8284721523208409, 0.8615101859768488, 0.8394654947584591, 0.7982054393629053, 0.7717632111442304, 0.8034835116853265, 0.8182809841467701, 0.8593338876730311, 0.8784207446800218, 0.9218441430475448, 0.9216321380148382, 0.8681441383705157, 0.8241823608113318, 0.8221304868852969, 0.8403475734241999, 0.8704124009670671, 0.9216706943972823, 0.9392821856991378, 0.9291972582641336, 0.8574485888078656, 0.8712254728461356] , MAPE: [0.11538873695036156, 0.11246360925814816, 0.20230893291480487, 0.14678663860618546, 0.150581737444232, 0.10633646948289453, 0.0397581931661194, 0.027025016306749243, 0.013074030074308634, 0.09988476850792104, 0.0365376184998589, -0.01593086262169947, -0.10459012686520378, -0.08627495628495979, -0.15230671176686883, -0.08174408843397575, -0.031671314703336, -0.004487137123061384, -0.00024088671564462968, 0.03546556478321381, -0.08370113205174272, -0.11011807190729593, -0.06231469161003185, 0.08511636164859081, -0.01510592767734743, -0.00500019848261499, -0.03452712245242305, -0.2460198888591444, -0.1774628374480208, -0.23652263185042366, -0.1551840242067203, -0.5913410858392881] %, RMSE: [0.6699229130939905, 0.8610246791460473, 0.9382011102789166, 0.981730032395039, 1.0143062454203253, 1.009641109696668, 0.9662672079274898, 0.9131097246057795, 0.9371226143267373, 0.9787954818197354, 1.0477520235060143, 1.1018145125850183, 1.1382869769155666, 1.092551008224476, 1.0451601981087795, 1.011612661081162, 1.0508194861629323, 1.049067836292527, 1.1051332464229804, 1.1404088299067985, 1.1896992681643956, 1.181176352970196, 1.1288278858694234, 1.0772174629568283, 1.0603329204188514, 1.0801742906632477, 1.1309096097852276, 1.197761410245595, 1.2177816237597499, 1.1905028358122782, 1.1143894424608016, 1.1393070619358796]
epoch 98   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 1.961409302858206 , validation loss: 0.862626850605011
tensor(75.2533, device='cuda:0')
MAE: [0.39596669984741384, 0.5393356975162469, 0.5919747081085003, 0.6384380635263917, 0.6824883736512557, 0.6913577613405663, 0.6685647061517097, 0.6276665995815366, 0.6697561508906794, 0.7082766931907264, 0.7571119405555817, 0.796112044477048, 0.827723608094354, 0.8163823573083915, 0.7822515122619332, 0.7554052612554166, 0.7901322879903403, 0.8028790373270659, 0.8366574231588964, 0.8520102337782377, 0.8925885770938445, 0.8979582956349765, 0.8438548379184044, 0.8069265191456706, 0.8143496353641038, 0.8260673742042375, 0.841067949324539, 0.8859483349891667, 0.9144689076847022, 0.9119300394078966, 0.845472591163725, 0.8623656483348843] , MAPE: [0.12312200284139274, 0.10912709225793057, 0.20197766354924712, 0.1477412566768255, 0.14091080694081404, 0.07586671964921292, 0.03232339411714719, 0.026054528578336515, 0.00337996879388511, 0.08324476198265066, 0.025748256634465977, -0.04507607291777229, -0.14175677202431936, -0.1255864342818302, -0.22352462585380692, -0.1426805063179027, -0.07371194869964702, -0.05417078160854703, -0.061052165108669273, -0.01826772504193905, -0.12198951156410273, -0.18428729113195416, -0.17709459147564574, -0.013496701671430912, -0.12168938693540356, -0.08424160296353031, -0.11876155545713048, -0.2889137865534051, -0.30380862427554356, -0.2992660631443711, -0.20331536867796232, -0.6660791035613751] %, RMSE: [0.6743061313746939, 0.8606072305971653, 0.9298057254469565, 0.9725724361499293, 1.0035327391265993, 1.0023175510499904, 0.9541817199366363, 0.8954491206173214, 0.9260311815410085, 0.9627737642326148, 1.0272899172112397, 1.0707605228139618, 1.1065629578222114, 1.0789300249822482, 1.0397557887327833, 0.9994634551682213, 1.0408570433540336, 1.0394734453730339, 1.0874062868852956, 1.1159964999055028, 1.1679060729755828, 1.1691165593787491, 1.1187341970681646, 1.0701324511981005, 1.0626294545507438, 1.0762510545689625, 1.112486940806627, 1.1694311760464997, 1.2018433259429668, 1.188292379713775, 1.1222331392474516, 1.1459400573619458]
epoch 99   lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6 , train loss: 1.9538449690892146 , validation loss: 0.872943103313446
tensor(75.1723, device='cuda:0')
MAE: [0.3849937317854504, 0.5280966373792244, 0.5789693700155416, 0.6253283703617137, 0.6728381127929411, 0.6876073444000993, 0.6609818555535892, 0.6177449040997236, 0.6404273774386527, 0.688640862495936, 0.7484395394163187, 0.7915895937847877, 0.8211155450401694, 0.7975109890280003, 0.7598757706786093, 0.7376197235701011, 0.763252941496747, 0.7718218558327746, 0.8191633748263121, 0.8365759941897134, 0.8745951544470394, 0.868822806023599, 0.8140940249835131, 0.7690027026674643, 0.7543104297283691, 0.7699106776871786, 0.8063442694326651, 0.851314173754996, 0.8641661964779355, 0.8556585147769488, 0.7788684339133888, 0.7907919126810486] , MAPE: [0.14940522089948308, 0.18709066370895466, 0.2929244620625322, 0.1801702234108834, 0.1177819253593448, 0.15827370403629737, 0.07658103218126908, 0.08330018241188883, 0.056178933563432176, 0.1577564156082124, 0.10442222884429209, 0.04867566616809462, -0.06500775163608438, -0.0490305327114518, -0.14801767815599642, -0.05663957982164443, 0.005104724286104908, 0.01281495219906048, 0.004021219207474151, 0.06434235572931357, -0.04503569597251606, -0.026737571056589717, -0.08877379423899687, 0.08840105410385186, 0.10171173031107024, 0.05924436035804582, -0.047055926375040184, -0.14659820190315212, -0.08176627416328104, 0.031728272097947055, -0.155352565102281, -0.3986688414613054] %, RMSE: [0.6644512425270742, 0.8464906942423706, 0.9193817802037968, 0.9627607375690574, 1.0008386408533643, 1.0003897997925821, 0.9483717790011457, 0.8886687451752683, 0.9014227277201811, 0.9414090978540497, 1.017739582600916, 1.069318099993767, 1.1040054332805302, 1.0590378823209268, 1.0169630398519476, 0.9757198529095265, 1.0062349504278107, 0.9977684958505316, 1.0580076495373087, 1.089547903658888, 1.1430348111842794, 1.1311343276637293, 1.076344925738132, 1.0103009678931185, 0.981230240245909, 1.0019097554107463, 1.0593146083188385, 1.1220528478047285, 1.1478183627465404, 1.1272342039662087, 1.0425569573281763, 1.0581631422856823]
test loss: NIL 
MAE: [0.3849937317854504, 0.5280966373792244, 0.5789693700155416, 0.6253283703617137, 0.6728381127929411, 0.6876073444000993, 0.6609818555535892, 0.6177449040997236, 0.6404273774386527, 0.688640862495936, 0.7484395394163187, 0.7915895937847877, 0.8211155450401694, 0.7975109890280003, 0.7598757706786093, 0.7376197235701011, 0.763252941496747, 0.7718218558327746, 0.8191633748263121, 0.8365759941897134, 0.8745951544470394, 0.868822806023599, 0.8140940249835131, 0.7690027026674643, 0.7543104297283691, 0.7699106776871786, 0.8063442694326651, 0.851314173754996, 0.8641661964779355, 0.8556585147769488, 0.7788684339133888, 0.7907919126810486] , MAPE: [0.14940522089948308, 0.18709066370895466, 0.2929244620625322, 0.1801702234108834, 0.1177819253593448, 0.15827370403629737, 0.07658103218126908, 0.08330018241188883, 0.056178933563432176, 0.1577564156082124, 0.10442222884429209, 0.04867566616809462, -0.06500775163608438, -0.0490305327114518, -0.14801767815599642, -0.05663957982164443, 0.005104724286104908, 0.01281495219906048, 0.004021219207474151, 0.06434235572931357, -0.04503569597251606, -0.026737571056589717, -0.08877379423899687, 0.08840105410385186, 0.10171173031107024, 0.05924436035804582, -0.047055926375040184, -0.14659820190315212, -0.08176627416328104, 0.031728272097947055, -0.155352565102281, -0.3986688414613054] %, RMSE: [0.6644512425270742, 0.8464906942423706, 0.9193817802037968, 0.9627607375690574, 1.0008386408533643, 1.0003897997925821, 0.9483717790011457, 0.8886687451752683, 0.9014227277201811, 0.9414090978540497, 1.017739582600916, 1.069318099993767, 1.1040054332805302, 1.0590378823209268, 1.0169630398519476, 0.9757198529095265, 1.0062349504278107, 0.9977684958505316, 1.0580076495373087, 1.089547903658888, 1.1430348111842794, 1.1311343276637293, 1.076344925738132, 1.0103009678931185, 0.981230240245909, 1.0019097554107463, 1.0593146083188385, 1.1220528478047285, 1.1478183627465404, 1.1272342039662087, 1.0425569573281763, 1.0581631422856823]
====================
training elapsedd with 260.74 seconds for 100 iterations, the sec/iter = 2.61

MAE_mean: [0.38499373 0.52809664 0.57896937 0.62532837 0.67283811 0.68760734
 0.66098186 0.6177449  0.64042738 0.68864086 0.74843954 0.79158959
 0.82111555 0.79751099 0.75987577 0.73761972 0.76325294 0.77182186
 0.81916337 0.83657599 0.87459515 0.86882281 0.81409402 0.7690027
 0.75431043 0.76991068 0.80634427 0.85131417 0.8641662  0.85565851
 0.77886843 0.79079191] , MAPE_mean: [ 0.14940522  0.18709066  0.29292446  0.18017022  0.11778193  0.1582737
  0.07658103  0.08330018  0.05617893  0.15775642  0.10442223  0.04867567
 -0.06500775 -0.04903053 -0.14801768 -0.05663958  0.00510472  0.01281495
  0.00402122  0.06434236 -0.0450357  -0.02673757 -0.08877379  0.08840105
  0.10171173  0.05924436 -0.04705593 -0.1465982  -0.08176627  0.03172827
 -0.15535257 -0.39866884] , RMSE_mean: [0.66445124 0.84649069 0.91938178 0.96276074 1.00083864 1.0003898
 0.94837178 0.88866875 0.90142273 0.9414091  1.01773958 1.0693181
 1.10400543 1.05903788 1.01696304 0.97571985 1.00623495 0.9977685
 1.05800765 1.0895479  1.14303481 1.13113433 1.07634493 1.01030097
 0.98123024 1.00190976 1.05931461 1.12205285 1.14781836 1.1272342
 1.04255696 1.05816314]

MAE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , MAPE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , RMSE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
Finished training with: lr1e-4_bs256_nh64_ra1e-3_dp0.2_wd1e-4_ah1_ck1_kt6
user config:
seed 666
device 0
scaler StandardScaler()
day_slot 288
n_route 10
n_his 96
n_pred 96
n_train 34
n_val 5
n_test 5
mode 1
n_c 10
model STAGNN_stamp
TPG TPGNN
name lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6
log_path log/TPGNN_r05p02kt3outer_258
crash 258
new_name TPGNN_r05p02kt3outer_258
batch_size 64
lr 0.001
a 0.1
r 0.5
n_mask 1
adam {'use': True, 'weight_decay': 0.0001}
slr {'use': True, 'step_size': 400, 'gamma': 0.3}
resume False
start_epoch 0
epochs 100
n_layer 1
n_attr 64
n_hid 256
reg_A 0.001
circle 288
drop_prob 0.3
CE {'use': True, 'kernel_size': 1, 'bias': False}
LE {'use': False, 'bias': False}
SE {'use': True, 'separate': True, 'no': False}
TE {'use': True, 'no': True}
attn {'head': 1, 'd_k': 32, 'd_v': 32, 'drop_prob': 0.2}
STstamp {'use': True, 'kt': 3, 'temperature': 1.0}
T4N {'use': True, 'step': 2, 'end_epoch': 10000, 'change_head': True, 'change_enc': True}
stamp_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/time_stamp.npy
data_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/V_France_processed_0.csv
adj_matrix_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/W_France_processed_0.csv
dis_mat tensor([[0.0000, 0.3661, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.6136, 0.0000,
         0.0000],
        [0.3661, 0.0000, 0.0000, 0.0000, 0.1098, 0.0000, 0.0000, 0.8975, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.3410, 0.8975, 0.0000, 0.0000, 0.0000, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.3410, 0.0000, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000,
         0.1494],
        [0.0000, 0.1098, 0.8975, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000, 0.6996,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000,
         0.2289],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000, 0.0000,
         0.5594],
        [0.6136, 0.8975, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.2117,
         0.0000],
        [0.0000, 0.4288, 0.4288, 0.0000, 0.6996, 0.0000, 0.0000, 0.2117, 0.0000,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.1494, 0.0000, 0.2289, 0.5594, 0.0000, 0.0000,
         0.0000]], device='cuda:0')
prefix log/lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6/
checkpoint_temp_path log/lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6//temp.pth
checkpoint_best_path log/lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6//best.pth
tensorboard_path log/lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6/
record_path log/lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6/record.txt
eps 0.1
parse <bound method DefaultConfig.parse of <config.DefaultConfig object at 0x7efdd9525550>>
output <bound method DefaultConfig.output of <config.DefaultConfig object at 0x7efdd9525550>>
train: True, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 9792
len(data): 9792, day_slot: 288, n_day: 34
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
10 10
epoch 0   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 2.883078603183522 , validation loss: 1.0928974375128746
epoch 1   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 2.304542438656676 , validation loss: 1.0097372606396675
epoch 2   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 1.9946157862158382 , validation loss: 0.9431851208209991
epoch 3   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 1.7537324685676425 , validation loss: 0.8882866352796555
epoch 4   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 1.554755638627445 , validation loss: 0.8887401968240738
epoch 5   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 1.3882109183891147 , validation loss: 0.7807023376226425
epoch 6   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 1.244672695795695 , validation loss: 0.7369098514318466
epoch 7   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 1.124690334002177 , validation loss: 0.8131953701376915
epoch 8   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 1.0260654454137765 , validation loss: 0.7939803898334503
epoch 9   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.9394858374315149 , validation loss: 0.6857124119997025
epoch 10   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.8659852743148804 , validation loss: 0.6772839799523354
epoch 11   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.801310377962449 , validation loss: 0.6834846660494804
epoch 12   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.7440257878864512 , validation loss: 0.6953799352049828
epoch 13   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.6969675199658263 , validation loss: 0.6700008362531662
epoch 14   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.6517232843473846 , validation loss: 0.6845366433262825
epoch 15   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.6142745029692557 , validation loss: 0.6751845106482506
epoch 16   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.5783105878268971 , validation loss: 0.6570000052452087
epoch 17   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.5479549344848184 , validation loss: 0.6982621997594833
epoch 18   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.5230480526007858 , validation loss: 0.6715245023369789
epoch 19   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.4946445951274797 , validation loss: 0.7148694470524788
epoch 20   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.4728282058940214 , validation loss: 0.6418172493577003
epoch 21   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.45280073846087737 , validation loss: 0.7676473557949066
epoch 22   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.4360507007907419 , validation loss: 0.6543639674782753
epoch 23   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.4173700727668463 , validation loss: 0.6651522517204285
epoch 24   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.4031463253731821 , validation loss: 0.6711046174168587
epoch 25   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.39179700379278143 , validation loss: 0.7419894188642502
epoch 26   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.37675194588362004 , validation loss: 0.6525291949510574
epoch 27   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.3640211914099899 , validation loss: 0.7296496033668518
epoch 28   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.3546174793851142 , validation loss: 0.6748087778687477
epoch 29   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.3443229660099628 , validation loss: 0.6992392092943192
epoch 30   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.3354295731759539 , validation loss: 0.7911013141274452
epoch 31   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.3273293422717674 , validation loss: 0.6360023021697998
epoch 32   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.32046093835550193 , validation loss: 0.7058175876736641
epoch 33   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.31571395256940055 , validation loss: 0.639423206448555
epoch 34   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.3058421605942296 , validation loss: 0.7047639414668083
epoch 35   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.29960092551567974 , validation loss: 0.6852291077375412
epoch 36   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.2946138078091191 , validation loss: 0.7003267705440521
epoch 37   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.28907013231632755 , validation loss: 0.7286946028470993
epoch 38   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.28542939237519804 , validation loss: 0.6526017114520073
epoch 39   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.2803683789337383 , validation loss: 0.7331557348370552
epoch 40   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.2762923147164139 , validation loss: 0.6674033924937248
epoch 41   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.2732037294144724 , validation loss: 0.6509869918227196
epoch 42   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.26945501449061376 , validation loss: 0.7081759944558144
epoch 43   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.26706085076519087 , validation loss: 0.6566149070858955
epoch 44   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.26287196196761786 , validation loss: 0.7800479903817177
epoch 45   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.259674105574103 , validation loss: 0.6447244361042976
epoch 46   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.25758112791706533 , validation loss: 0.6671624258160591
epoch 47   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.2549494177687402 , validation loss: 0.6721756234765053
epoch 48   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.25235236889007046 , validation loss: 0.7164180427789688
epoch 49   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.25015716576108743 , validation loss: 0.7172173261642456
epoch 50   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.24769285029056026 , validation loss: 0.7216795831918716
epoch 51   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.24698871637091918 , validation loss: 0.6409585252404213
epoch 52   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.2531938354174296 , validation loss: 0.8862107768654823
epoch 53   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.2462862683277504 , validation loss: 0.6273610666394234
epoch 54   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.23966303584622403 , validation loss: 0.6414794698357582
epoch 55   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.23829056877715915 , validation loss: 0.6114090159535408
epoch 56   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.23679311427415586 , validation loss: 0.6503388956189156
epoch 57   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.2355237901210785 , validation loss: 0.7410725653171539
epoch 58   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.23465125847096538 , validation loss: 0.6565526202321053
epoch 59   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.23368409480534347 , validation loss: 0.6947350800037384
epoch 60   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.2324092762143004 , validation loss: 0.650844544172287
epoch 61   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.23102210316003538 , validation loss: 0.6400779038667679
epoch 62   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.23083518387055865 , validation loss: 0.6481291353702545
epoch 63   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.2297448957083272 , validation loss: 0.6639542430639267
epoch 64   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.22812728379286973 , validation loss: 0.6778810024261475
epoch 65   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.22908184779625312 , validation loss: 0.6423647925257683
epoch 66   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.22649700209206225 , validation loss: 0.6640027314424515
epoch 67   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.22536583127928714 , validation loss: 0.7223867550492287
epoch 68   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.22455025420469396 , validation loss: 0.6899060308933258
epoch 69   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.22547593274537256 , validation loss: 0.6329756155610085
epoch 70   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.2236734020943735 , validation loss: 0.6373270824551582
epoch 71   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.22310652715318344 , validation loss: 0.6758036017417908
epoch 72   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.22331824957155713 , validation loss: 0.6364311650395393
epoch 73   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.22145130938174679 , validation loss: 0.6599648967385292
epoch 74   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.22328830232807234 , validation loss: 0.6234681978821754
epoch 75   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.22033540320162678 , validation loss: 0.6471735686063766
epoch 76   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.2201309154431025 , validation loss: 0.6143321394920349
epoch 77   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.21979027665128895 , validation loss: 0.6371467113494873
epoch 78   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.22036155795349793 , validation loss: 0.628863550722599
epoch 79   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.21877871278454275 , validation loss: 0.6561683565378189
epoch 80   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.2183413943823646 , validation loss: 0.7662020325660706
epoch 81   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.2178377608458201 , validation loss: 0.6323010921478271
epoch 82   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.21724019009692996 , validation loss: 0.6193947196006775
epoch 83   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.21802275525588616 , validation loss: 0.6901368573307991
epoch 84   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.2181161744337456 , validation loss: 0.7104071825742722
epoch 85   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.21615661680698395 , validation loss: 0.7501009926199913
epoch 86   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.21593766586453306 , validation loss: 0.6140192225575447
epoch 87   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.2159951907746932 , validation loss: 0.6391665413975716
epoch 88   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.21511222071507397 , validation loss: 0.6197629421949387
epoch 89   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.21489392396281748 , validation loss: 0.6728899031877518
epoch 90   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.2144587548340068 , validation loss: 0.6318017244338989
epoch 91   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.21438340842723846 , validation loss: 0.6771792396903038
epoch 92   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.21419700132865532 , validation loss: 0.6273544877767563
epoch 93   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.2152287314335505 , validation loss: 0.6879437565803528
epoch 94   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.21307356042020462 , validation loss: 0.6467678844928741
epoch 95   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.2141705579033085 , validation loss: 0.6461499333381653
epoch 96   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.21305091357698627 , validation loss: 0.647694431245327
tensor(17.8319, device='cuda:0')
MAE: [0.28143176836129663, 0.3515234627017809, 0.3902678671073212, 0.4264594165695658, 0.4580043818249569, 0.4728145196089118, 0.4972359385631364, 0.5154717284003176, 0.5414370838315562, 0.5487735156085073, 0.5654422264946528, 0.5776949965043627, 0.5918905879975748, 0.5876132980995264, 0.5873069243544002, 0.5928457667346391, 0.6015129578453441, 0.5999908308995907, 0.5938710077129996, 0.5988389227326153, 0.6065742301942838, 0.594943495214984, 0.5952481123428677, 0.6064433388715399, 0.6148149847796129, 0.6117353687919292, 0.6049441067471178, 0.6040398416566404, 0.6047046111650842, 0.5948066392798246, 0.5889427546899497, 0.5931928905832207] , MAPE: [0.07631331244648462, 0.11308321038046941, 0.20687790719488006, 0.2010757775845649, 0.19840367469009113, 0.12211002613031353, 0.11794127812232677, 0.15275577745675356, 0.09123973041596269, 0.1584460951552034, 0.1727046999784868, 0.11063850494269226, 0.1576084017183646, 0.20996226119428402, 0.15820362662153317, 0.12866445989266928, 0.12117319432522, 0.15302756763696604, 0.14569306590321615, 0.16333569203376813, 0.1668084884963428, 0.1438185150969336, 0.15498129928663607, 0.13462451539519626, 0.020759021246634164, 0.09672848647950606, 0.09498632238435675, 0.003233351117868898, -0.1015862378263402, 0.007073848419333688, 0.00048127191625811525, -0.09135153558120082] %, RMSE: [0.4941324135808273, 0.5817189534725268, 0.6376773589268835, 0.6801381173682782, 0.7101713868411637, 0.7288788981623304, 0.7632766665202703, 0.7859575833458042, 0.8204692720145728, 0.8222978897170291, 0.8408523342344822, 0.8540650585624471, 0.8678485797177833, 0.864152349837912, 0.8589353078382871, 0.8637471658160958, 0.8802146107073857, 0.8734576649799992, 0.8606139587600448, 0.8646613651997628, 0.8724302636910602, 0.8615977992378883, 0.8569936664900147, 0.8742771364772487, 0.8876073824926659, 0.8842235381893513, 0.8737929505292832, 0.8726207699443986, 0.8719275221321401, 0.8639928671576581, 0.8562134255388402, 0.8669877208077543]
epoch 97   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.21320603261975682 , validation loss: 0.685762032866478
tensor(17.7103, device='cuda:0')
MAE: [0.2779125749909309, 0.35035914150162684, 0.4001420574309784, 0.4406503654413463, 0.47158875167158615, 0.49212447178559665, 0.5082644789323172, 0.5266808576348055, 0.5454962636660976, 0.548332005966954, 0.567463235000206, 0.581434597139314, 0.5941700389998552, 0.5996352775156805, 0.6098559369062333, 0.6214918386095117, 0.6285586744504644, 0.6211551832376989, 0.6288027180055368, 0.6390477967892111, 0.6458884859391363, 0.6487530250787812, 0.6447847071304418, 0.6443678109251808, 0.6431182893026697, 0.6352968056929135, 0.6285013838072029, 0.6320848267894124, 0.6368878687535096, 0.6395826163607141, 0.6358905640394263, 0.637019873803491] , MAPE: [0.11562865828003176, 0.14440254762256802, 0.2518328788024721, 0.23124059727119753, 0.2482026484686368, 0.1823780639411671, 0.16500798903977842, 0.21765708217120094, 0.18598523078699802, 0.2446684328012034, 0.26391875706698875, 0.22092501878798412, 0.2705048587852993, 0.2509423945225777, 0.21762750961821853, 0.2069750666442464, 0.23429965912535747, 0.2397575807062964, 0.2065716808307502, 0.19104306936340248, 0.28659150262656996, 0.21100313436209953, 0.2363215299743669, 0.19951395535613856, 0.13602362499871476, 0.1094431305671328, 0.09006874905793254, -0.056435509553093934, -0.10594731626119666, -0.08085065747706638, -0.016576892373736555, -0.17226125047294022] %, RMSE: [0.4894961180392521, 0.5880044493514592, 0.6571117437530911, 0.6999006643985421, 0.7285234939527968, 0.7535214572912724, 0.78070723391893, 0.8063944088301901, 0.8293921841296769, 0.8294329456780154, 0.8567199287244676, 0.866776768867654, 0.87748577900743, 0.8848206931361862, 0.8992108331992039, 0.916019622765084, 0.9282396915176733, 0.9137092993414563, 0.9233107600792615, 0.9308443276273549, 0.940094050485172, 0.9465698169915008, 0.9391300771391459, 0.941108009699857, 0.9389108623567145, 0.9277873297139404, 0.9184187708798235, 0.9212530412397922, 0.9269933441316514, 0.9342217616685122, 0.9330169597201604, 0.9407828841790139]
epoch 98   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.21313712059282788 , validation loss: 0.6418560519814491
tensor(17.5837, device='cuda:0')
MAE: [0.2697747077710312, 0.32951769932048375, 0.3626152546612603, 0.4003642977296, 0.4316418335450448, 0.4402716200535675, 0.4440080820006731, 0.46906957804004557, 0.5015619314239197, 0.5029075953786828, 0.5073684167888822, 0.522853444176774, 0.5457674921849339, 0.5360189536837957, 0.5314101664986961, 0.5499206459184283, 0.5730470825990989, 0.5678495710425694, 0.5581074725650251, 0.5766452060420949, 0.5876495903880172, 0.5788195554489635, 0.5652691175285535, 0.5822923618251669, 0.5916891526055436, 0.5826816439536429, 0.566084218621254, 0.5741354312728515, 0.5866541555616045, 0.5843720492146448, 0.5682620108127594, 0.5739026768924188] , MAPE: [0.07146775901450514, 0.07353246907611326, 0.21043822863976397, 0.17385346145581354, 0.20430704376043218, 0.10266634025259487, 0.07458801682159058, 0.10659880050678093, 0.006573206546867762, 0.06139450334362655, 0.06425787272343797, 0.024239346163663755, 0.06392706935050416, 0.11731696673330513, 0.034588247009654426, 0.041411618766417156, 0.027490016908125924, 0.021109828535013128, 0.0717329867127976, 0.04786401508462395, 0.045938205340062266, 0.13048060024525615, 0.10631168951070688, 0.06908910981639808, 0.1452847343229493, 0.17866681431550815, 0.24541466628483194, 0.05665422759584113, 0.035470201937756594, 0.1088197019531829, 0.20034020019859583, 0.04492956112407312] %, RMSE: [0.47460865626968646, 0.5472246908116277, 0.5956016048429157, 0.6348745740883398, 0.6631400541187443, 0.670730885621261, 0.6764214420152537, 0.700550630132969, 0.7333681423513666, 0.7297298873439958, 0.7299481992274293, 0.7391106943229162, 0.761653956715455, 0.7461973514479193, 0.7307188131267035, 0.7486561978235161, 0.7772915912403952, 0.7683452402069583, 0.7543780899640097, 0.7728263943638229, 0.7818465858280008, 0.773001381781425, 0.7565953068451726, 0.7783971130740088, 0.7857383722549939, 0.774865051472775, 0.7574402344277368, 0.7645606180300832, 0.7761935700975421, 0.777054317951051, 0.7626992457795044, 0.7726521491388614]
epoch 99   lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6 , train loss: 0.21408360436850904 , validation loss: 0.629164345562458
tensor(17.4774, device='cuda:0')
MAE: [0.26328192938608835, 0.3434832139848972, 0.3750972394593367, 0.410820991207183, 0.4527967294199949, 0.48401030441602094, 0.49775655436281535, 0.5112550458219862, 0.5289993664749043, 0.5401123027033029, 0.5529609380897672, 0.5593585515437053, 0.5745571457665682, 0.5872315092204311, 0.5809490894921815, 0.5838269735665358, 0.5919444430354484, 0.5943813319650201, 0.5954017865753819, 0.5923821210407066, 0.5940280151145398, 0.5910475000013242, 0.587573796157754, 0.5870164260905735, 0.5894331242597287, 0.583239320043436, 0.5750438552891317, 0.5640298007751249, 0.5620521213133464, 0.5608986075199449, 0.5573696808762771, 0.5499398789577877] , MAPE: [0.11243681532400795, 0.06637480238303096, 0.1981006535898302, 0.1961278283519425, 0.2614292237128993, 0.17556928566244753, 0.13535487208876054, 0.18728417187008858, 0.13941548025930575, 0.18442816691224018, 0.19903805768243324, 0.20291130376206656, 0.24862552581445813, 0.25665470234348925, 0.20280560799963027, 0.16445747962288712, 0.19818062447750617, 0.18027014159637061, 0.1917778405135848, 0.19700874000955157, 0.2634429950587144, 0.22422863102687318, 0.20713026622590142, 0.17365831459446968, 0.10135328046377141, 0.06131263506943141, 0.0939662521428725, -0.009319399401297092, -0.07431863516410717, -0.05883187644150931, -0.033516700763156944, -0.15532257042540035] %, RMSE: [0.4677266288943208, 0.5712349628841817, 0.6184441462628598, 0.6577111341984447, 0.7006458275594203, 0.740714063653446, 0.7574710553304659, 0.7665785512141581, 0.7842418255943154, 0.7927190808041733, 0.8035873945651928, 0.8047063819441292, 0.8213544476163267, 0.8404918894075324, 0.824567633909111, 0.8189916791832307, 0.8315722962160931, 0.8317606783119659, 0.8288721959476296, 0.8266251679514494, 0.8259628599354252, 0.8249024748315824, 0.8137593596939157, 0.8127209821545631, 0.8160622163605765, 0.8039217341184852, 0.7939593631529381, 0.7803945552946828, 0.7771572410136827, 0.7795172727552533, 0.7740471905572031, 0.7648023010929654]
test loss: NIL 
MAE: [0.26328192938608835, 0.3434832139848972, 0.3750972394593367, 0.410820991207183, 0.4527967294199949, 0.48401030441602094, 0.49775655436281535, 0.5112550458219862, 0.5289993664749043, 0.5401123027033029, 0.5529609380897672, 0.5593585515437053, 0.5745571457665682, 0.5872315092204311, 0.5809490894921815, 0.5838269735665358, 0.5919444430354484, 0.5943813319650201, 0.5954017865753819, 0.5923821210407066, 0.5940280151145398, 0.5910475000013242, 0.587573796157754, 0.5870164260905735, 0.5894331242597287, 0.583239320043436, 0.5750438552891317, 0.5640298007751249, 0.5620521213133464, 0.5608986075199449, 0.5573696808762771, 0.5499398789577877] , MAPE: [0.11243681532400795, 0.06637480238303096, 0.1981006535898302, 0.1961278283519425, 0.2614292237128993, 0.17556928566244753, 0.13535487208876054, 0.18728417187008858, 0.13941548025930575, 0.18442816691224018, 0.19903805768243324, 0.20291130376206656, 0.24862552581445813, 0.25665470234348925, 0.20280560799963027, 0.16445747962288712, 0.19818062447750617, 0.18027014159637061, 0.1917778405135848, 0.19700874000955157, 0.2634429950587144, 0.22422863102687318, 0.20713026622590142, 0.17365831459446968, 0.10135328046377141, 0.06131263506943141, 0.0939662521428725, -0.009319399401297092, -0.07431863516410717, -0.05883187644150931, -0.033516700763156944, -0.15532257042540035] %, RMSE: [0.4677266288943208, 0.5712349628841817, 0.6184441462628598, 0.6577111341984447, 0.7006458275594203, 0.740714063653446, 0.7574710553304659, 0.7665785512141581, 0.7842418255943154, 0.7927190808041733, 0.8035873945651928, 0.8047063819441292, 0.8213544476163267, 0.8404918894075324, 0.824567633909111, 0.8189916791832307, 0.8315722962160931, 0.8317606783119659, 0.8288721959476296, 0.8266251679514494, 0.8259628599354252, 0.8249024748315824, 0.8137593596939157, 0.8127209821545631, 0.8160622163605765, 0.8039217341184852, 0.7939593631529381, 0.7803945552946828, 0.7771572410136827, 0.7795172727552533, 0.7740471905572031, 0.7648023010929654]
====================
training elapsedd with 348.61 seconds for 100 iterations, the sec/iter = 3.49

MAE_mean: [0.26328193 0.34348321 0.37509724 0.41082099 0.45279673 0.4840103
 0.49775655 0.51125505 0.52899937 0.5401123  0.55296094 0.55935855
 0.57455715 0.58723151 0.58094909 0.58382697 0.59194444 0.59438133
 0.59540179 0.59238212 0.59402802 0.5910475  0.5875738  0.58701643
 0.58943312 0.58323932 0.57504386 0.5640298  0.56205212 0.56089861
 0.55736968 0.54993988] , MAPE_mean: [ 0.11243682  0.0663748   0.19810065  0.19612783  0.26142922  0.17556929
  0.13535487  0.18728417  0.13941548  0.18442817  0.19903806  0.2029113
  0.24862553  0.2566547   0.20280561  0.16445748  0.19818062  0.18027014
  0.19177784  0.19700874  0.263443    0.22422863  0.20713027  0.17365831
  0.10135328  0.06131264  0.09396625 -0.0093194  -0.07431864 -0.05883188
 -0.0335167  -0.15532257] , RMSE_mean: [0.46772663 0.57123496 0.61844415 0.65771113 0.70064583 0.74071406
 0.75747106 0.76657855 0.78424183 0.79271908 0.80358739 0.80470638
 0.82135445 0.84049189 0.82456763 0.81899168 0.8315723  0.83176068
 0.8288722  0.82662517 0.82596286 0.82490247 0.81375936 0.81272098
 0.81606222 0.80392173 0.79395936 0.78039456 0.77715724 0.77951727
 0.77404719 0.7648023 ]

MAE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , MAPE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , RMSE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
Finished training with: lr1e-3_bs64_nh256_ra1e-3_dp0.3_wd1e-6_ah1_ck3_kt6
user config:
seed 666
device 0
scaler StandardScaler()
day_slot 288
n_route 10
n_his 96
n_pred 96
n_train 34
n_val 5
n_test 5
mode 1
n_c 10
model STAGNN_stamp
TPG TPGNN
name lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2
log_path log/TPGNN_r05p02kt3outer_260
crash 260
new_name TPGNN_r05p02kt3outer_260
batch_size 64
lr 0.0001
a 0.1
r 0.5
n_mask 1
adam {'use': True, 'weight_decay': 0.0001}
slr {'use': True, 'step_size': 400, 'gamma': 0.3}
resume False
start_epoch 0
epochs 100
n_layer 1
n_attr 64
n_hid 64
reg_A 1e-05
circle 288
drop_prob 0.3
CE {'use': True, 'kernel_size': 1, 'bias': False}
LE {'use': False, 'bias': False}
SE {'use': True, 'separate': True, 'no': False}
TE {'use': True, 'no': True}
attn {'head': 1, 'd_k': 32, 'd_v': 32, 'drop_prob': 0.2}
STstamp {'use': True, 'kt': 3, 'temperature': 1.0}
T4N {'use': True, 'step': 2, 'end_epoch': 10000, 'change_head': True, 'change_enc': True}
stamp_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/time_stamp.npy
data_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/V_France_processed_0.csv
adj_matrix_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/W_France_processed_0.csv
dis_mat tensor([[0.0000, 0.3661, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.6136, 0.0000,
         0.0000],
        [0.3661, 0.0000, 0.0000, 0.0000, 0.1098, 0.0000, 0.0000, 0.8975, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.3410, 0.8975, 0.0000, 0.0000, 0.0000, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.3410, 0.0000, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000,
         0.1494],
        [0.0000, 0.1098, 0.8975, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000, 0.6996,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000,
         0.2289],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000, 0.0000,
         0.5594],
        [0.6136, 0.8975, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.2117,
         0.0000],
        [0.0000, 0.4288, 0.4288, 0.0000, 0.6996, 0.0000, 0.0000, 0.2117, 0.0000,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.1494, 0.0000, 0.2289, 0.5594, 0.0000, 0.0000,
         0.0000]], device='cuda:0')
prefix log/lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2/
checkpoint_temp_path log/lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2//temp.pth
checkpoint_best_path log/lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2//best.pth
tensorboard_path log/lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2/
record_path log/lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2/record.txt
eps 0.1
parse <bound method DefaultConfig.parse of <config.DefaultConfig object at 0x7f8b45ed5550>>
output <bound method DefaultConfig.output of <config.DefaultConfig object at 0x7f8b45ed5550>>
train: True, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 9792
len(data): 9792, day_slot: 288, n_day: 34
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
10 10
epoch 0   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 1.4392276160857256 , validation loss: 0.960175558924675
epoch 1   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 1.010279842451507 , validation loss: 0.9295838624238968
epoch 2   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.8008496621075798 , validation loss: 0.9806268513202667
epoch 3   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.6452741821606954 , validation loss: 0.9827150106430054
epoch 4   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.5697238527092279 , validation loss: 1.006063126027584
epoch 5   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.5388020989941615 , validation loss: 1.0188713744282722
epoch 6   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.5180754912834541 , validation loss: 1.0245135053992271
epoch 7   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.5016263606501561 , validation loss: 1.0352956876158714
epoch 8   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.4880393632486755 , validation loss: 1.0357419922947884
epoch 9   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.47637207075661303 , validation loss: 0.9925085380673409
epoch 10   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.46605121680334505 , validation loss: 0.9907056018710136
epoch 11   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.45676541854353514 , validation loss: 0.9855534881353378
epoch 12   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.44802213708559674 , validation loss: 0.967545323073864
epoch 13   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.44015862836557273 , validation loss: 0.9633756801486015
epoch 14   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.4328698252930361 , validation loss: 0.9559657499194145
epoch 15   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.4258490719047247 , validation loss: 0.9506970122456551
epoch 16   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.419235453301785 , validation loss: 0.959446556866169
epoch 17   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.41357863592166527 , validation loss: 0.9362749457359314
epoch 18   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.40811937930537207 , validation loss: 0.9405161514878273
epoch 19   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.40314430933372647 , validation loss: 0.9350870177149773
epoch 20   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.398511575717552 , validation loss: 0.9263668730854988
epoch 21   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.39402231398750753 , validation loss: 0.9401497542858124
epoch 22   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.38987033682710986 , validation loss: 0.9280989021062851
epoch 23   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.386011282602946 , validation loss: 0.9221777468919754
epoch 24   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.38224110124157923 , validation loss: 0.9327173158526421
epoch 25   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.3786604118113424 , validation loss: 0.9293728023767471
epoch 26   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.3753109831436008 , validation loss: 0.9003280028700829
epoch 27   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.3716307714873669 , validation loss: 0.8895402923226357
epoch 28   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.36858225511569603 , validation loss: 0.8994124978780746
epoch 29   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.3655429640237023 , validation loss: 0.9091161489486694
epoch 30   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.36205629332392825 , validation loss: 0.9065101966261864
epoch 31   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.3593380211615095 , validation loss: 0.8851844221353531
epoch 32   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.3564342055834976 , validation loss: 0.8658398762345314
epoch 33   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.3533340067255731 , validation loss: 0.8706671297550201
epoch 34   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.3499201816671035 , validation loss: 0.8445570841431618
epoch 35   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.3471539645802741 , validation loss: 0.8387355506420135
epoch 36   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.3443547592443578 , validation loss: 0.824447751045227
epoch 37   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.33973102943570005 , validation loss: 0.8001808673143387
epoch 38   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.3376050649904737 , validation loss: 0.7990827336907387
epoch 39   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.3348902405477038 , validation loss: 0.7819777578115463
epoch 40   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.3330448930170022 , validation loss: 0.7792849093675613
epoch 41   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.33152735408614664 , validation loss: 0.7854543253779411
epoch 42   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.32644090816086413 , validation loss: 0.7656285241246223
epoch 43   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.32394930545021505 , validation loss: 0.7550543695688248
epoch 44   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.3225401353602316 , validation loss: 0.7499340698122978
epoch 45   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.3180937901431439 , validation loss: 0.7369404584169388
epoch 46   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.31472412160798613 , validation loss: 0.7246449217200279
epoch 47   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.3134090012195064 , validation loss: 0.7414586693048477
epoch 48   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.3107621015286913 , validation loss: 0.7223041728138924
epoch 49   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.30802522979530633 , validation loss: 0.7031118497252464
epoch 50   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.3058017018963309 , validation loss: 0.710780531167984
epoch 51   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.3030650750094769 , validation loss: 0.7042169123888016
epoch 52   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.30287986292558555 , validation loss: 0.7183433547616005
epoch 53   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.2998034223621967 , validation loss: 0.6940517723560333
epoch 54   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.298460360251221 , validation loss: 0.700819306075573
epoch 55   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.29671762386957806 , validation loss: 0.6904211938381195
epoch 56   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.2948620897882125 , validation loss: 0.689061626791954
epoch 57   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.2935036818186442 , validation loss: 0.6818369179964066
epoch 58   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.2919860517277437 , validation loss: 0.6836838200688362
epoch 59   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.29061469435691833 , validation loss: 0.6835019960999489
epoch 60   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.289199676583795 , validation loss: 0.681135855615139
epoch 61   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.28795810482081247 , validation loss: 0.6773369088768959
epoch 62   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.2872149716405308 , validation loss: 0.6847623959183693
epoch 63   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.2853131995481603 , validation loss: 0.6682082712650299
epoch 64   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.2841755356274399 , validation loss: 0.670323371887207
epoch 65   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.2830636150696698 , validation loss: 0.6756186261773109
epoch 66   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.2818787752413282 , validation loss: 0.6723629534244537
epoch 67   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.2803388045114629 , validation loss: 0.673701673746109
epoch 68   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.2801144631469951 , validation loss: 0.6728630736470222
epoch 69   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.2786131168113035 , validation loss: 0.6704412400722504
epoch 70   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.27766994985879634 , validation loss: 0.674902968108654
epoch 71   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.2760976365968293 , validation loss: 0.6668365821242332
epoch 72   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.27592555039069233 , validation loss: 0.6582387983798981
epoch 73   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.2745133948092367 , validation loss: 0.664142407476902
epoch 74   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.27350328570487453 , validation loss: 0.6659350246191025
epoch 75   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.27247464189342424 , validation loss: 0.6616136431694031
epoch 76   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.27132325371106464 , validation loss: 0.660635344684124
epoch 77   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.27113448930721656 , validation loss: 0.6558801010251045
epoch 78   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.2702036207797481 , validation loss: 0.6665035262703896
epoch 79   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.2685098683132845 , validation loss: 0.6533737257122993
epoch 80   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.26783763368924457 , validation loss: 0.6520516350865364
epoch 81   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.26700320898317825 , validation loss: 0.655597411096096
epoch 82   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.26624274604460774 , validation loss: 0.6486112177371979
epoch 83   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.26532716201800927 , validation loss: 0.6598663330078125
epoch 84   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.2646581048474592 , validation loss: 0.656536303460598
epoch 85   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.2639596549903645 , validation loss: 0.6466939225792885
epoch 86   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.26296210610399057 , validation loss: 0.6529544219374657
epoch 87   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.2624381365729313 , validation loss: 0.654097393155098
epoch 88   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.2616773487306109 , validation loss: 0.6555264815688133
epoch 89   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.26112306790024625 , validation loss: 0.6420930474996567
epoch 90   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.2600780430377698 , validation loss: 0.6491342559456825
epoch 91   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.2593619762098088 , validation loss: 0.645094707608223
epoch 92   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.2588330895877352 , validation loss: 0.6465064957737923
epoch 93   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.2580900469831392 , validation loss: 0.6439006626605988
epoch 94   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.2574116555499096 , validation loss: 0.640504851937294
epoch 95   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.2568642234101015 , validation loss: 0.6420350223779678
epoch 96   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.25625091265229616 , validation loss: 0.6352861449122429
tensor(57.0431, device='cuda:0')
MAE: [0.300575453635862, 0.3953195627997677, 0.4306052702945686, 0.4460946145331122, 0.48266088406468943, 0.5085150316780068, 0.5000982833609523, 0.513233304778018, 0.5420082111337904, 0.5548232535013603, 0.5609557227732748, 0.5705813846033374, 0.5858863732933076, 0.5977351134763934, 0.5926985418689005, 0.5867246010989796, 0.6006532427756903, 0.6015755304308685, 0.6000968042050594, 0.594187887282178, 0.6074659437236866, 0.6040021259334784, 0.5843175931217284, 0.5635085613762518, 0.558264138607942, 0.559834099485318, 0.5650505509288962, 0.5641288969533268, 0.5704296020917671, 0.5786845851985296, 0.5613771193566703, 0.5528671065343487] , MAPE: [0.06685913040552327, 0.03893304069298314, 0.14201110609693782, 0.11836885710703221, 0.10733793625058115, 0.08351984077700988, 0.056572065685277735, 0.05913919035202497, 0.012636886607573821, 0.06970842774035547, 0.06263035965889281, 0.05967425072502704, 0.08134361164850713, 0.10279787886756371, 0.018162550502849026, 0.03350388609163028, 0.026922457390800885, 0.0664244932604602, 0.06407797137758252, 0.0635878885552658, 0.07327840440521033, 0.060273496868033634, 0.0539957942981897, 0.03830622877521181, 0.01844776035710742, 0.029305826573942522, -0.017969101281182093, -0.034410184407702736, -0.0794964103653318, -0.05111493044650676, -0.01897502185694694, -0.08783302574069239] %, RMSE: [0.5575029990249403, 0.6773525452322585, 0.7051157120295626, 0.7109853713840026, 0.7646310880961611, 0.8011708314982436, 0.779809295555793, 0.7830938516357645, 0.794369994060567, 0.7928856995716237, 0.7939985179899034, 0.8005574529461252, 0.8244307051092334, 0.8420771463083543, 0.8282874410205711, 0.8105600497899825, 0.8277037091559358, 0.8180540817308448, 0.8054360418316762, 0.8031062989646427, 0.8266979140646575, 0.8276627562828198, 0.7980058990264237, 0.7623570116074204, 0.7514361086740619, 0.7650505353005198, 0.7723711760646876, 0.7709139100870346, 0.7818315729720412, 0.8094436680672755, 0.7807993224524482, 0.7659754358407416]
epoch 97   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.25574998177734076 , validation loss: 0.6339788809418678
tensor(56.8127, device='cuda:0')
MAE: [0.3033691173635385, 0.3951354423566654, 0.42880399276444825, 0.462335268840213, 0.4815623292843475, 0.5002028594769959, 0.5104610381292698, 0.5139869018538481, 0.5468312078379287, 0.5630941909217496, 0.5609479361208943, 0.5808139800818003, 0.5765189367584577, 0.5844427313989738, 0.5877359225301398, 0.5839922674829813, 0.5949570799880114, 0.5832559499447955, 0.5915286029176307, 0.5923341150420536, 0.5878954481494796, 0.5788898610926627, 0.5704021193716944, 0.5538106103982661, 0.5427082122881541, 0.5425390018015793, 0.5537325104725422, 0.553591750409723, 0.5501168416509616, 0.5526770984640671, 0.5368973540921801, 0.5234161036740028] , MAPE: [0.04710740196224186, 0.037660798834738524, 0.15336661287452594, 0.12185456670526525, 0.12434192745248156, 0.08737601541971053, 0.052934562552391165, 0.06055073292954383, 0.024695250445031035, 0.08062971170587806, 0.09753033974491887, 0.097585205945832, 0.0997202706655827, 0.11417167880778956, 0.04490814092317095, 0.05145443768222809, 0.030870455710079937, 0.07077120434053569, 0.10919012900519895, 0.10020216436551393, 0.09510772716254295, 0.09746605653820149, 0.08886554783017533, 0.08028927931052598, 0.04682262943186269, 0.03471982737982882, 0.006616596666821182, 0.022781244900006173, -0.020458905152586762, -0.01895146464877678, -0.006886441218432702, -0.07604803554155652] %, RMSE: [0.5533763546111704, 0.6680089687756038, 0.6961708015121771, 0.7338869935015585, 0.7588642253475401, 0.7854172461826469, 0.7969762688937883, 0.7835018971314053, 0.8016488891576643, 0.8065367424017608, 0.7953213382994766, 0.8183034633584019, 0.81375189891203, 0.8288607891530493, 0.8299347713285472, 0.8160596409543647, 0.8266671566602131, 0.7948926586883756, 0.8020633365903408, 0.8129248161443764, 0.8077404625909106, 0.800788368673747, 0.7932739582844226, 0.7638909496481212, 0.7408503959461943, 0.7511557111702621, 0.7701155579431564, 0.7717448104212262, 0.769276794023104, 0.7885261596307412, 0.7668110247676216, 0.7475875817562428]
epoch 98   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.2553706665833791 , validation loss: 0.6444439068436623
tensor(56.5817, device='cuda:0')
MAE: [0.30257257257857045, 0.39313146381648545, 0.4364189124088158, 0.45937799429463355, 0.4892313079003091, 0.5047859073920924, 0.5132205256981026, 0.5178279560735238, 0.5506943603870987, 0.5705201335209086, 0.584340971041586, 0.5972379918740198, 0.5911735549914775, 0.5944780088944802, 0.5968689277094127, 0.5887301588997476, 0.6007873348073708, 0.6027760096551064, 0.6057499893063429, 0.6066812074929476, 0.6063886446976247, 0.5966796621789714, 0.586804735729298, 0.5732152936061288, 0.5676316984128399, 0.5789054702041844, 0.5907010442039632, 0.5903894985444152, 0.5850376529127513, 0.5825915265002662, 0.5612826527114574, 0.5429991039671196] , MAPE: [0.05948045073497288, 0.07970072631159354, 0.17781546417131694, 0.15238613482979643, 0.1299031560378638, 0.11211360676188445, 0.0865204525415872, 0.08919839691412731, 0.05116793973457798, 0.11521051554911199, 0.12427531107716183, 0.11456126551535939, 0.12423586990873746, 0.13488775360780844, 0.05574292501580803, 0.06914344903249678, 0.06673712141781844, 0.08530380093462564, 0.09368413149944169, 0.08848139332751108, 0.11095359151249214, 0.08944368977714738, 0.10154260731731558, 0.06057593782327401, 0.04328397877790999, 0.055835487412165166, 0.0020580570664576053, -0.008351838231847632, -0.06782553400773976, -0.05979440452939034, -0.02700396453140522, -0.1262296766513659] %, RMSE: [0.5617247972643798, 0.6715803966742377, 0.7113088263289479, 0.7265540295111378, 0.7720242797338364, 0.7928165192761799, 0.7993150255267983, 0.7884640832522214, 0.8067712464088221, 0.8179922141998086, 0.8297952948220555, 0.8417875183991691, 0.8347775075113854, 0.8406987537787872, 0.8356274789776594, 0.8183861939430906, 0.8304346624139772, 0.8211551578646278, 0.8182989002269795, 0.827880207358397, 0.832181914263444, 0.8232263378874717, 0.8088517318886409, 0.7852593786916717, 0.769984668486334, 0.7951190728595997, 0.8077294822571944, 0.8071544421751563, 0.8028796678476562, 0.8132428729662716, 0.7818729684845679, 0.7560015534005087]
epoch 99   lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2 , train loss: 0.2543784011812771 , validation loss: 0.6367676705121994
tensor(56.3626, device='cuda:0')
MAE: [0.3004120286979674, 0.39403044794182074, 0.4323891335573604, 0.4633379340233262, 0.4826604002901382, 0.4906536204757687, 0.4935062801333855, 0.4961017556166872, 0.5252634667228793, 0.534696942823603, 0.5575233605300489, 0.5710818654796128, 0.5754493754793957, 0.5906195126543993, 0.5833149037131867, 0.5897550966360212, 0.5950158674360166, 0.600435094628099, 0.6098098768489724, 0.6034969740432025, 0.6030626204360238, 0.5976746112665103, 0.5768521153871162, 0.5611085348918112, 0.5668703175141697, 0.5736841330316264, 0.5835027855444584, 0.5801326550647002, 0.5693950751558253, 0.5692280035569649, 0.5557960858169136, 0.5501993287729157] , MAPE: [0.06093651102511656, 0.02999905439699001, 0.1538246017700114, 0.14228380660169632, 0.09432141551407973, 0.08280407850720593, 0.06508493017845729, 0.08388216888081983, 0.036028908956546896, 0.08722358419949544, 0.08496246714612407, 0.07138197060194366, 0.06193982842658855, 0.08846368795041608, 0.02601022017891663, 0.04353327392746896, 0.04926513385153063, 0.09300534023247424, 0.08659403585681222, 0.06339066587210591, 0.06577745418235019, 0.04899873292146817, 0.06819765733356933, 0.05202953268814884, 0.03292541108216572, 0.0342997963901226, 0.01665345984954986, -0.005640607728912692, -0.09285835680604634, -0.06399418058024314, 0.0001695536490326949, -0.10790491843556195] %, RMSE: [0.5568700958133189, 0.6777090288583218, 0.7071357170511151, 0.7373218197060031, 0.7589633917210662, 0.7688330599452363, 0.7685199680403629, 0.7562357840436249, 0.7709048203080474, 0.7691930045091102, 0.7970971021019486, 0.8082118751545679, 0.8136039642309807, 0.8393238362955392, 0.8216017566767023, 0.8251438380883618, 0.8255069972567188, 0.8244269549591, 0.8283416744738236, 0.8208924654861443, 0.822310450787169, 0.8207410008313355, 0.7898113621625208, 0.761972357544419, 0.7694683265546516, 0.7891256961404733, 0.7988638551955305, 0.7903826887666622, 0.7760657320071197, 0.7915645512919091, 0.7747202615463119, 0.7640663077632234]
test loss: NIL 
MAE: [0.3004120286979674, 0.39403044794182074, 0.4323891335573604, 0.4633379340233262, 0.4826604002901382, 0.4906536204757687, 0.4935062801333855, 0.4961017556166872, 0.5252634667228793, 0.534696942823603, 0.5575233605300489, 0.5710818654796128, 0.5754493754793957, 0.5906195126543993, 0.5833149037131867, 0.5897550966360212, 0.5950158674360166, 0.600435094628099, 0.6098098768489724, 0.6034969740432025, 0.6030626204360238, 0.5976746112665103, 0.5768521153871162, 0.5611085348918112, 0.5668703175141697, 0.5736841330316264, 0.5835027855444584, 0.5801326550647002, 0.5693950751558253, 0.5692280035569649, 0.5557960858169136, 0.5501993287729157] , MAPE: [0.06093651102511656, 0.02999905439699001, 0.1538246017700114, 0.14228380660169632, 0.09432141551407973, 0.08280407850720593, 0.06508493017845729, 0.08388216888081983, 0.036028908956546896, 0.08722358419949544, 0.08496246714612407, 0.07138197060194366, 0.06193982842658855, 0.08846368795041608, 0.02601022017891663, 0.04353327392746896, 0.04926513385153063, 0.09300534023247424, 0.08659403585681222, 0.06339066587210591, 0.06577745418235019, 0.04899873292146817, 0.06819765733356933, 0.05202953268814884, 0.03292541108216572, 0.0342997963901226, 0.01665345984954986, -0.005640607728912692, -0.09285835680604634, -0.06399418058024314, 0.0001695536490326949, -0.10790491843556195] %, RMSE: [0.5568700958133189, 0.6777090288583218, 0.7071357170511151, 0.7373218197060031, 0.7589633917210662, 0.7688330599452363, 0.7685199680403629, 0.7562357840436249, 0.7709048203080474, 0.7691930045091102, 0.7970971021019486, 0.8082118751545679, 0.8136039642309807, 0.8393238362955392, 0.8216017566767023, 0.8251438380883618, 0.8255069972567188, 0.8244269549591, 0.8283416744738236, 0.8208924654861443, 0.822310450787169, 0.8207410008313355, 0.7898113621625208, 0.761972357544419, 0.7694683265546516, 0.7891256961404733, 0.7988638551955305, 0.7903826887666622, 0.7760657320071197, 0.7915645512919091, 0.7747202615463119, 0.7640663077632234]
====================
training elapsedd with 310.26 seconds for 100 iterations, the sec/iter = 3.10

MAE_mean: [0.30041203 0.39403045 0.43238913 0.46333793 0.4826604  0.49065362
 0.49350628 0.49610176 0.52526347 0.53469694 0.55752336 0.57108187
 0.57544938 0.59061951 0.5833149  0.5897551  0.59501587 0.60043509
 0.60980988 0.60349697 0.60306262 0.59767461 0.57685212 0.56110853
 0.56687032 0.57368413 0.58350279 0.58013266 0.56939508 0.569228
 0.55579609 0.55019933] , MAPE_mean: [ 0.06093651  0.02999905  0.1538246   0.14228381  0.09432142  0.08280408
  0.06508493  0.08388217  0.03602891  0.08722358  0.08496247  0.07138197
  0.06193983  0.08846369  0.02601022  0.04353327  0.04926513  0.09300534
  0.08659404  0.06339067  0.06577745  0.04899873  0.06819766  0.05202953
  0.03292541  0.0342998   0.01665346 -0.00564061 -0.09285836 -0.06399418
  0.00016955 -0.10790492] , RMSE_mean: [0.5568701  0.67770903 0.70713572 0.73732182 0.75896339 0.76883306
 0.76851997 0.75623578 0.77090482 0.769193   0.7970971  0.80821188
 0.81360396 0.83932384 0.82160176 0.82514384 0.825507   0.82442695
 0.82834167 0.82089247 0.82231045 0.820741   0.78981136 0.76197236
 0.76946833 0.7891257  0.79886386 0.79038269 0.77606573 0.79156455
 0.77472026 0.76406631]

MAE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , MAPE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , RMSE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
Finished training with: lr1e-4_bs64_nh64_ra1e-5_dp0.3_wd1e-6_ah4_ck1_kt2
user config:
seed 666
device 0
scaler StandardScaler()
day_slot 288
n_route 10
n_his 96
n_pred 96
n_train 34
n_val 5
n_test 5
mode 1
n_c 10
model STAGNN_stamp
TPG TPGNN
name lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6
log_path log/TPGNN_r05p02kt3outer_262
crash 262
new_name TPGNN_r05p02kt3outer_262
batch_size 128
lr 0.0001
a 0.1
r 0.5
n_mask 1
adam {'use': True, 'weight_decay': 0.0001}
slr {'use': True, 'step_size': 400, 'gamma': 0.3}
resume False
start_epoch 0
epochs 100
n_layer 1
n_attr 64
n_hid 64
reg_A 0.001
circle 288
drop_prob 0.2
CE {'use': True, 'kernel_size': 1, 'bias': False}
LE {'use': False, 'bias': False}
SE {'use': True, 'separate': True, 'no': False}
TE {'use': True, 'no': True}
attn {'head': 1, 'd_k': 32, 'd_v': 32, 'drop_prob': 0.2}
STstamp {'use': True, 'kt': 3, 'temperature': 1.0}
T4N {'use': True, 'step': 2, 'end_epoch': 10000, 'change_head': True, 'change_enc': True}
stamp_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/time_stamp.npy
data_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/V_France_processed_0.csv
adj_matrix_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/W_France_processed_0.csv
dis_mat tensor([[0.0000, 0.3661, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.6136, 0.0000,
         0.0000],
        [0.3661, 0.0000, 0.0000, 0.0000, 0.1098, 0.0000, 0.0000, 0.8975, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.3410, 0.8975, 0.0000, 0.0000, 0.0000, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.3410, 0.0000, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000,
         0.1494],
        [0.0000, 0.1098, 0.8975, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000, 0.6996,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000,
         0.2289],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000, 0.0000,
         0.5594],
        [0.6136, 0.8975, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.2117,
         0.0000],
        [0.0000, 0.4288, 0.4288, 0.0000, 0.6996, 0.0000, 0.0000, 0.2117, 0.0000,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.1494, 0.0000, 0.2289, 0.5594, 0.0000, 0.0000,
         0.0000]], device='cuda:0')
prefix log/lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6/
checkpoint_temp_path log/lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6//temp.pth
checkpoint_best_path log/lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6//best.pth
tensorboard_path log/lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6/
record_path log/lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6/record.txt
eps 0.1
parse <bound method DefaultConfig.parse of <config.DefaultConfig object at 0x7eff60334550>>
output <bound method DefaultConfig.output of <config.DefaultConfig object at 0x7eff60334550>>
train: True, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 9792
len(data): 9792, day_slot: 288, n_day: 34
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
10 10
epoch 0   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 3.9518928711230936 , validation loss: 1.1123305261135101
epoch 1   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 3.593272456756005 , validation loss: 0.9469910562038422
epoch 2   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 3.3693959896381083 , validation loss: 0.9183046519756317
epoch 3   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 3.226816406616798 , validation loss: 0.9428549557924271
epoch 4   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 3.0981537928948035 , validation loss: 0.9495413899421692
epoch 5   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 2.980062108773452 , validation loss: 0.9795249849557877
epoch 6   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 2.8820193730867825 , validation loss: 0.9885030090808868
epoch 7   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 2.81052198776832 , validation loss: 0.9963932484388351
epoch 8   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 2.7620407067812405 , validation loss: 1.016690507531166
epoch 9   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 2.726518099124615 , validation loss: 1.0230176746845245
epoch 10   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 2.694865529353802 , validation loss: 1.0402017831802368
epoch 11   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 2.6655050424429088 , validation loss: 1.0452186167240143
epoch 12   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 2.6382438586308408 , validation loss: 1.0283341109752655
epoch 13   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 2.612849849921006 , validation loss: 1.017738938331604
epoch 14   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 2.587022139475896 , validation loss: 1.0129120647907257
epoch 15   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 2.5633852115044227 , validation loss: 0.9990861862897873
epoch 16   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 2.5397769946318407 , validation loss: 0.9967899322509766
epoch 17   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 2.5169531473746667 , validation loss: 0.9968340843915939
epoch 18   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 2.4948196594531717 , validation loss: 0.9839595854282379
epoch 19   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 2.4727396873327403 , validation loss: 0.9839162230491638
epoch 20   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 2.4521846771240234 , validation loss: 0.9688054919242859
epoch 21   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 2.430826810690073 , validation loss: 0.9927898496389389
epoch 22   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 2.4106106666418223 , validation loss: 0.9674098789691925
epoch 23   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 2.3907432097655077 , validation loss: 0.9751605838537216
epoch 24   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 2.3709862599006066 , validation loss: 0.9585968255996704
epoch 25   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 2.351727788264935 , validation loss: 0.9438654333353043
epoch 26   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 2.332006949644822 , validation loss: 0.9498042613267899
epoch 27   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 2.3136751651763916 , validation loss: 0.9380957037210464
epoch 28   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 2.294926019815298 , validation loss: 0.9300305098295212
epoch 29   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 2.276854689304645 , validation loss: 0.9260644018650055
epoch 30   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 2.258940650866582 , validation loss: 0.9539351612329483
epoch 31   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 2.2413520446190467 , validation loss: 0.926244392991066
epoch 32   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 2.2239793814145603 , validation loss: 0.9281388968229294
epoch 33   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 2.2074113075549784 , validation loss: 0.9412700533866882
epoch 34   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 2.1905016532311072 , validation loss: 0.929410919547081
epoch 35   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 2.1738691880152774 , validation loss: 0.9261690229177475
epoch 36   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 2.1578991504815908 , validation loss: 0.9158379435539246
epoch 37   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 2.14129991714771 , validation loss: 0.9113297015428543
epoch 38   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 2.1252034260676456 , validation loss: 0.911258801817894
epoch 39   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 2.1091203689575195 , validation loss: 0.9158574193716049
epoch 40   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 2.0930984570429874 , validation loss: 0.9082305580377579
epoch 41   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 2.078417319517869 , validation loss: 0.9098502695560455
epoch 42   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 2.063140786611117 , validation loss: 0.8907223045825958
epoch 43   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 2.0478056394136868 , validation loss: 0.8864969611167908
epoch 44   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 2.032936169550969 , validation loss: 0.8887150138616562
epoch 45   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 2.018330509846027 , validation loss: 0.8889463096857071
epoch 46   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 2.00383913058501 , validation loss: 0.8916382193565369
epoch 47   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.9890530430353606 , validation loss: 0.8838758915662766
epoch 48   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.9746914643507738 , validation loss: 0.8654334247112274
epoch 49   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.9603430720476003 , validation loss: 0.8728092759847641
epoch 50   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.9456143287511973 , validation loss: 0.8659217357635498
epoch 51   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.9329137664574843 , validation loss: 0.8583072125911713
epoch 52   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.918191217459165 , validation loss: 0.8613493591547012
epoch 53   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.9044230488630443 , validation loss: 0.8564377725124359
epoch 54   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.891497483620277 , validation loss: 0.8403223752975464
epoch 55   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.876961167042072 , validation loss: 0.8393528163433075
epoch 56   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.862628189417032 , validation loss: 0.8370257616043091
epoch 57   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.8495333057183485 , validation loss: 0.8366067558526993
epoch 58   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.835332677914546 , validation loss: 0.8211523741483688
epoch 59   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.8231706023216248 , validation loss: 0.8170045018196106
epoch 60   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.8110754673297589 , validation loss: 0.7986460477113724
epoch 61   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.797209735100086 , validation loss: 0.8004636764526367
epoch 62   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.7854240307441125 , validation loss: 0.7968612611293793
epoch 63   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.7717128762832055 , validation loss: 0.8074112385511398
epoch 64   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.7583700235073383 , validation loss: 0.7786890268325806
epoch 65   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.7453269820946913 , validation loss: 0.7688998281955719
epoch 66   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.7339513897895813 , validation loss: 0.7718809247016907
epoch 67   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.7223769701444185 , validation loss: 0.7686665207147598
epoch 68   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.7098028338872469 , validation loss: 0.7684684246778488
epoch 69   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.6991571967418377 , validation loss: 0.7581931203603745
epoch 70   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.686264849626101 , validation loss: 0.7508244812488556
epoch 71   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.6734265501682575 , validation loss: 0.7461932152509689
epoch 72   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.6602314160420344 , validation loss: 0.7321684956550598
epoch 73   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.651835166490995 , validation loss: 0.7299534827470779
epoch 74   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.6406324368256788 , validation loss: 0.7345292270183563
epoch 75   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.6282890347334056 , validation loss: 0.7230405062437057
epoch 76   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.6161426305770874 , validation loss: 0.7271212339401245
epoch 77   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.6048146715530982 , validation loss: 0.7149283140897751
epoch 78   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.5951887919352605 , validation loss: 0.713795930147171
epoch 79   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.583257230428549 , validation loss: 0.7119937837123871
epoch 80   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.573291118328388 , validation loss: 0.7132976055145264
epoch 81   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.5637975931167603 , validation loss: 0.7094672620296478
epoch 82   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.5518974019930913 , validation loss: 0.6987020820379257
epoch 83   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.5423161524992723 , validation loss: 0.7004788368940353
epoch 84   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.5333475791490996 , validation loss: 0.7020151764154434
epoch 85   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.5222724080085754 , validation loss: 0.7080128043889999
epoch 86   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.5123385282663198 , validation loss: 0.7047394961118698
epoch 87   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.5021075835594764 , validation loss: 0.7037286162376404
epoch 88   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.4946115062786982 , validation loss: 0.6992941200733185
epoch 89   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.4832906860571642 , validation loss: 0.6942533701658249
epoch 90   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.4738986767255342 , validation loss: 0.6954660266637802
epoch 91   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.4644766587477465 , validation loss: 0.6996787190437317
epoch 92   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.454768689779135 , validation loss: 0.6955755352973938
epoch 93   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.4464703798294067 , validation loss: 0.6916201412677765
epoch 94   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.4363672549907978 , validation loss: 0.690409928560257
epoch 95   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.4277242880601149 , validation loss: 0.6866871565580368
epoch 96   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.4193730170910175 , validation loss: 0.6883681565523148
tensor(68.5421, device='cuda:0')
MAE: [0.3474973255242269, 0.43282713346670565, 0.4651605743597041, 0.47789600167106644, 0.5189944785794953, 0.552591065435872, 0.5831630712562269, 0.5887230310103251, 0.6214878976377707, 0.6258419546410058, 0.6365273086308051, 0.6471163133677748, 0.6700898171075111, 0.6813792488833448, 0.6868098626929076, 0.6818783317155868, 0.7020340937241605, 0.6993553709857089, 0.7075142855834715, 0.7129435201423223, 0.7189312179778348, 0.7320766133703676, 0.7199937857971671, 0.6938452444114175, 0.6896799330993257, 0.6826340443445081, 0.6960042107934804, 0.699397704815492, 0.7072089278843907, 0.7134613205223661, 0.6883696444474698, 0.6753214668586236] , MAPE: [0.09382000526867282, 0.09501741840820202, 0.19230505961945193, 0.0929231064615388, 0.10162484525790655, 0.059836052311620355, 0.07809699747578203, 0.05105632556133697, -0.011813372160213756, 0.02825884022700829, 0.052756672729708055, 0.03778472561288695, 0.02942684604828342, -0.022607183539879883, -0.05733641793287705, -0.03466988180122235, -0.05163117084489864, -0.02176063911553074, 0.02900971122238468, 0.007503099163367711, 0.009313552191334874, -0.03150076695163398, -0.03771126420844404, -0.02300228051362996, -0.040709987654410404, -0.027139918244813262, -0.08347511847125734, -0.12026830752089754, -0.237611074882065, -0.18450240610111465, -0.10666852960758633, -0.5174563725830013] %, RMSE: [0.6442561564825251, 0.7330832147795939, 0.7710130913572125, 0.7699702976613074, 0.8170753180762895, 0.847277285601474, 0.8976962591582046, 0.885230954617045, 0.9016273788965105, 0.8751819655578569, 0.8783658243979995, 0.8884169738144871, 0.9185252343554154, 0.9274255349259154, 0.9287215978236775, 0.9213030605783773, 0.9407646028244441, 0.9172419000546103, 0.9146886441387223, 0.9250579643686145, 0.9337593861863532, 0.9490524910474943, 0.9248848885956417, 0.8819026512058825, 0.8747018875840438, 0.8711445265206779, 0.8909318733871089, 0.8994860162991873, 0.9098524039586694, 0.9268677575462648, 0.8909863795627418, 0.8747848516688846]
epoch 97   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.409376662511092 , validation loss: 0.6931949704885483
tensor(68.4114, device='cuda:0')
MAE: [0.35255981612110454, 0.4284963387926829, 0.45747788422827407, 0.47894027502458425, 0.5280050113169266, 0.5498689868541184, 0.5835712894096433, 0.5955661347632287, 0.6290092561449664, 0.6295918492475505, 0.6492019396534516, 0.663316342679342, 0.6818200928752416, 0.6775797513067799, 0.6790558077792455, 0.6805216617378186, 0.7002040688582148, 0.6959672971346329, 0.7063731776588817, 0.7172674140766186, 0.7215950268541569, 0.7268123295676616, 0.7159791502707935, 0.6953734580492696, 0.6828933176443404, 0.6755966229329231, 0.6992152654068525, 0.7082223430663808, 0.713559058123201, 0.7167174994365609, 0.6886320994178928, 0.6824149242744387] , MAPE: [0.09820513257274084, 0.08918038290078613, 0.1876404919911972, 0.12873773942543248, 0.09285921064128058, 0.06339017318111614, 0.08955067217386387, 0.06556390990594307, 0.004682379361693916, 0.038694930311401025, 0.08509631705472784, 0.08529982263525977, 0.05225020199197557, -0.0031514781521520454, -0.04443667823951043, -0.028786711090197106, -0.023566595411327784, -0.005934805262116139, 0.04954466123641565, 0.04244164259778756, 0.04073796480409525, -0.008414705573249916, -0.005212183889184932, 0.0032949029353999933, -0.02764444066604633, -0.01777113532272441, -0.08918164697319111, -0.10114683194341749, -0.20314533678195487, -0.16235776216571804, -0.11160709052094614, -0.5572639362832061] %, RMSE: [0.6456511034831056, 0.724537783120859, 0.7659368744316808, 0.7811361244689765, 0.8286032561372131, 0.8450081235807814, 0.9056574727537288, 0.8961698026715383, 0.9074697440758717, 0.881123567324106, 0.9019271564772486, 0.916276412500496, 0.9337799504429322, 0.9214974585844127, 0.9217940140839559, 0.9191786939386251, 0.9354378915615833, 0.9152491565014587, 0.918825503363634, 0.9366184716420676, 0.9389743810376401, 0.9433708378074745, 0.9277137511088074, 0.8920049232821843, 0.8694710899441128, 0.866239528004291, 0.9026835681221987, 0.9193674516608741, 0.9206858602902123, 0.9329442511910055, 0.8941051362893346, 0.8882619302934399]
epoch 98   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.4009567224062407 , validation loss: 0.6803875267505646
tensor(68.2810, device='cuda:0')
MAE: [0.3405481408033328, 0.42536950318173977, 0.4542333546252057, 0.4739710428682396, 0.521367458095774, 0.5413110662379408, 0.5710218100854647, 0.577531474477794, 0.6079134659441284, 0.6079916706347127, 0.6351918043136674, 0.6426321600559983, 0.6594490930416919, 0.6584997254831851, 0.6624917754395528, 0.6635230066296021, 0.6712992321388777, 0.6680922618834781, 0.6797390497368089, 0.6809645891577466, 0.6840625054608147, 0.6918938488070373, 0.6817096082030882, 0.6641558584469112, 0.6501422593604351, 0.6444832626317349, 0.6659415503262935, 0.667540272026102, 0.6747525630057933, 0.680681643767436, 0.6550334560097263, 0.6436294850079132] , MAPE: [0.0784940470489946, 0.08148444280504806, 0.16809946055820676, 0.07305327300503543, 0.10838293944804127, 0.05516743403117439, 0.08003815787551821, 0.04439278678723717, -0.014279392920725513, 0.04620653111375412, 0.09858272112068268, 0.07680148300988276, 0.06091735622383229, 0.02205109013451537, -0.02183570046799639, 0.0032612669912764573, -0.014906353096079536, 0.0041405907348482434, 0.06080892331490759, 0.03315913837001831, 0.05667944321524083, 0.031236825702458705, -0.009013433356027686, 0.01478324986040741, -0.017488790384464364, -0.017696410712123533, -0.07799520695896474, -0.08150408665567083, -0.20584655152385653, -0.15691791286849244, -0.06831974813304169, -0.5097255836679905] %, RMSE: [0.629116888474686, 0.7256746320236431, 0.7658795242036243, 0.7769439017771647, 0.8245291736370801, 0.8399183570753838, 0.8979636818189357, 0.8761616575002116, 0.8856957364665002, 0.858355286610862, 0.8891875196463256, 0.8946308619155378, 0.9130341558906878, 0.9081540231978756, 0.9130666818673266, 0.9060743033827512, 0.9035222274541881, 0.8830335906538095, 0.8895264184241062, 0.8949171476965595, 0.8980546337163419, 0.9098723854681716, 0.893112245721709, 0.8617558387284593, 0.8372088246446476, 0.8357977746950276, 0.8696941235957815, 0.877349251796733, 0.8835934418177261, 0.9033919503249978, 0.8686498830645735, 0.8522362377616897]
epoch 99   lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6 , train loss: 1.3916088526065533 , validation loss: 0.6801298558712006
tensor(68.1508, device='cuda:0')
MAE: [0.34175929719596604, 0.4207176808931279, 0.4637662854759003, 0.4760766237454738, 0.5139101269979452, 0.5363680650958235, 0.5632146717918096, 0.5660116714626051, 0.5941250730896388, 0.5987250213546813, 0.6231389127045717, 0.6356823981777986, 0.6503157055980919, 0.6562984491944236, 0.6632417065751998, 0.6641731203700771, 0.6794794031758745, 0.677808014798487, 0.6851776004213955, 0.6889292805860798, 0.6986870039218902, 0.7095460844786895, 0.694758006001717, 0.6750036379764067, 0.6683767982458062, 0.6647424309312836, 0.6821552941291449, 0.6850433337730691, 0.6876502918433782, 0.6909103228297737, 0.6612944327241059, 0.6526414474760441] , MAPE: [0.09991715550026128, 0.07384010691773855, 0.14998275569928737, 0.05286271212082452, 0.08363473951608706, 0.03495294103965094, 0.04797786827901929, 0.03278998793730559, -0.027669252466468005, 0.026828550138053502, 0.05427545402608884, 0.032460857002396426, 0.03466271863213666, 0.001975887196904202, -0.06578927347120905, -0.03904254828046254, -0.04126155746087853, -0.011764078294530094, 0.04152633681515299, -0.012920625918066565, 0.040420149860425955, 0.014087704820093368, -0.039582199646473845, -0.012229647026673325, -0.0298815495846463, -0.01084543958711966, -0.07932934147815704, -0.12052038759799805, -0.1863573363837732, -0.1482551926251288, -0.11963358253210582, -0.533894112566981] %, RMSE: [0.6354547407086933, 0.7185503104234937, 0.7775016448793575, 0.7717778565865712, 0.8107609367406586, 0.8310315229579572, 0.8808100429536792, 0.8579362387602013, 0.8674472087909983, 0.8447585421326687, 0.86936861888661, 0.880962319889428, 0.897291692369693, 0.9030325939277395, 0.9054690193330744, 0.898139922843989, 0.9117672865214074, 0.8957643227678871, 0.8935795033537671, 0.8998795074198611, 0.9129789656106642, 0.9280657231956501, 0.9013859722742341, 0.8655979134347472, 0.8557076001082013, 0.857510714442152, 0.8848333743702218, 0.8908154217237853, 0.8903691889478941, 0.9023455947957284, 0.8636525831644788, 0.8513557209770641]
test loss: NIL 
MAE: [0.34175929719596604, 0.4207176808931279, 0.4637662854759003, 0.4760766237454738, 0.5139101269979452, 0.5363680650958235, 0.5632146717918096, 0.5660116714626051, 0.5941250730896388, 0.5987250213546813, 0.6231389127045717, 0.6356823981777986, 0.6503157055980919, 0.6562984491944236, 0.6632417065751998, 0.6641731203700771, 0.6794794031758745, 0.677808014798487, 0.6851776004213955, 0.6889292805860798, 0.6986870039218902, 0.7095460844786895, 0.694758006001717, 0.6750036379764067, 0.6683767982458062, 0.6647424309312836, 0.6821552941291449, 0.6850433337730691, 0.6876502918433782, 0.6909103228297737, 0.6612944327241059, 0.6526414474760441] , MAPE: [0.09991715550026128, 0.07384010691773855, 0.14998275569928737, 0.05286271212082452, 0.08363473951608706, 0.03495294103965094, 0.04797786827901929, 0.03278998793730559, -0.027669252466468005, 0.026828550138053502, 0.05427545402608884, 0.032460857002396426, 0.03466271863213666, 0.001975887196904202, -0.06578927347120905, -0.03904254828046254, -0.04126155746087853, -0.011764078294530094, 0.04152633681515299, -0.012920625918066565, 0.040420149860425955, 0.014087704820093368, -0.039582199646473845, -0.012229647026673325, -0.0298815495846463, -0.01084543958711966, -0.07932934147815704, -0.12052038759799805, -0.1863573363837732, -0.1482551926251288, -0.11963358253210582, -0.533894112566981] %, RMSE: [0.6354547407086933, 0.7185503104234937, 0.7775016448793575, 0.7717778565865712, 0.8107609367406586, 0.8310315229579572, 0.8808100429536792, 0.8579362387602013, 0.8674472087909983, 0.8447585421326687, 0.86936861888661, 0.880962319889428, 0.897291692369693, 0.9030325939277395, 0.9054690193330744, 0.898139922843989, 0.9117672865214074, 0.8957643227678871, 0.8935795033537671, 0.8998795074198611, 0.9129789656106642, 0.9280657231956501, 0.9013859722742341, 0.8655979134347472, 0.8557076001082013, 0.857510714442152, 0.8848333743702218, 0.8908154217237853, 0.8903691889478941, 0.9023455947957284, 0.8636525831644788, 0.8513557209770641]
====================
training elapsedd with 252.69 seconds for 100 iterations, the sec/iter = 2.53

MAE_mean: [0.3417593  0.42071768 0.46376629 0.47607662 0.51391013 0.53636807
 0.56321467 0.56601167 0.59412507 0.59872502 0.62313891 0.6356824
 0.65031571 0.65629845 0.66324171 0.66417312 0.6794794  0.67780801
 0.6851776  0.68892928 0.698687   0.70954608 0.69475801 0.67500364
 0.6683768  0.66474243 0.68215529 0.68504333 0.68765029 0.69091032
 0.66129443 0.65264145] , MAPE_mean: [ 0.09991716  0.07384011  0.14998276  0.05286271  0.08363474  0.03495294
  0.04797787  0.03278999 -0.02766925  0.02682855  0.05427545  0.03246086
  0.03466272  0.00197589 -0.06578927 -0.03904255 -0.04126156 -0.01176408
  0.04152634 -0.01292063  0.04042015  0.0140877  -0.0395822  -0.01222965
 -0.02988155 -0.01084544 -0.07932934 -0.12052039 -0.18635734 -0.14825519
 -0.11963358 -0.53389411] , RMSE_mean: [0.63545474 0.71855031 0.77750164 0.77177786 0.81076094 0.83103152
 0.88081004 0.85793624 0.86744721 0.84475854 0.86936862 0.88096232
 0.89729169 0.90303259 0.90546902 0.89813992 0.91176729 0.89576432
 0.8935795  0.89987951 0.91297897 0.92806572 0.90138597 0.86559791
 0.8557076  0.85751071 0.88483337 0.89081542 0.89036919 0.90234559
 0.86365258 0.85135572]

MAE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , MAPE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , RMSE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
Finished training with: lr1e-4_bs128_nh64_ra1e-3_dp0.2_wd1e-5_ah2_ck3_kt6
user config:
seed 666
device 0
scaler StandardScaler()
day_slot 288
n_route 10
n_his 96
n_pred 96
n_train 34
n_val 5
n_test 5
mode 1
n_c 10
model STAGNN_stamp
TPG TPGNN
name lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2
log_path log/TPGNN_r05p02kt3outer_264
crash 264
new_name TPGNN_r05p02kt3outer_264
batch_size 64
lr 0.0001
a 0.1
r 0.5
n_mask 1
adam {'use': True, 'weight_decay': 0.0001}
slr {'use': True, 'step_size': 400, 'gamma': 0.3}
resume False
start_epoch 0
epochs 100
n_layer 1
n_attr 64
n_hid 64
reg_A 0.001
circle 288
drop_prob 0.2
CE {'use': True, 'kernel_size': 1, 'bias': False}
LE {'use': False, 'bias': False}
SE {'use': True, 'separate': True, 'no': False}
TE {'use': True, 'no': True}
attn {'head': 1, 'd_k': 32, 'd_v': 32, 'drop_prob': 0.2}
STstamp {'use': True, 'kt': 3, 'temperature': 1.0}
T4N {'use': True, 'step': 2, 'end_epoch': 10000, 'change_head': True, 'change_enc': True}
stamp_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/time_stamp.npy
data_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/V_France_processed_0.csv
adj_matrix_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/W_France_processed_0.csv
dis_mat tensor([[0.0000, 0.3661, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.6136, 0.0000,
         0.0000],
        [0.3661, 0.0000, 0.0000, 0.0000, 0.1098, 0.0000, 0.0000, 0.8975, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.3410, 0.8975, 0.0000, 0.0000, 0.0000, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.3410, 0.0000, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000,
         0.1494],
        [0.0000, 0.1098, 0.8975, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000, 0.6996,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000,
         0.2289],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000, 0.0000,
         0.5594],
        [0.6136, 0.8975, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.2117,
         0.0000],
        [0.0000, 0.4288, 0.4288, 0.0000, 0.6996, 0.0000, 0.0000, 0.2117, 0.0000,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.1494, 0.0000, 0.2289, 0.5594, 0.0000, 0.0000,
         0.0000]], device='cuda:0')
prefix log/lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2/
checkpoint_temp_path log/lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2//temp.pth
checkpoint_best_path log/lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2//best.pth
tensorboard_path log/lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2/
record_path log/lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2/record.txt
eps 0.1
parse <bound method DefaultConfig.parse of <config.DefaultConfig object at 0x7fdc7be55550>>
output <bound method DefaultConfig.output of <config.DefaultConfig object at 0x7fdc7be55550>>
train: True, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 9792
len(data): 9792, day_slot: 288, n_day: 34
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
10 10
epoch 0   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 3.7790507615781297 , validation loss: 0.9647117331624031
epoch 1   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 3.309194616242951 , validation loss: 0.9305716380476952
epoch 2   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 3.056300915923773 , validation loss: 0.9852955043315887
epoch 3   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 2.8617776749180814 , validation loss: 0.9879560619592667
epoch 4   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 2.752826176437677 , validation loss: 1.0154815539717674
epoch 5   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 2.688292662302653 , validation loss: 1.0347561687231064
epoch 6   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 2.634077506906846 , validation loss: 1.02484592795372
epoch 7   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 2.584487938413433 , validation loss: 1.0235678851604462
epoch 8   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 2.5384796133228376 , validation loss: 1.0334099531173706
epoch 9   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 2.4949627530341054 , validation loss: 0.9960484728217125
epoch 10   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 2.453429792441574 , validation loss: 0.9935751557350159
epoch 11   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 2.4136124218211457 , validation loss: 0.974711537361145
epoch 12   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 2.374973867453781 , validation loss: 0.9591660052537918
epoch 13   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 2.3375260409186867 , validation loss: 0.9593385234475136
epoch 14   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 2.301110225565293 , validation loss: 0.9483761489391327
epoch 15   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 2.2656011254179713 , validation loss: 0.9407312199473381
epoch 16   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 2.231027406804702 , validation loss: 0.9406887218356133
epoch 17   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 2.1979553232006 , validation loss: 0.9261303842067719
epoch 18   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 2.1653722968755984 , validation loss: 0.9239534810185432
epoch 19   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 2.133886454152126 , validation loss: 0.9197415709495544
epoch 20   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 2.10326241979412 , validation loss: 0.9144544452428818
epoch 21   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 2.073002020517985 , validation loss: 0.9214160367846489
epoch 22   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 2.043553006415274 , validation loss: 0.901158519089222
epoch 23   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 2.014819453744327 , validation loss: 0.9006321057677269
epoch 24   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.9867521197188134 , validation loss: 0.9069837257266045
epoch 25   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.9589760280122943 , validation loss: 0.915626734495163
epoch 26   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.9317987385918112 , validation loss: 0.8710596486926079
epoch 27   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.90479468831829 , validation loss: 0.8602123335003853
epoch 28   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.8793956789315915 , validation loss: 0.8498186022043228
epoch 29   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.853606901916803 , validation loss: 0.8737110495567322
epoch 30   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.8274996818280687 , validation loss: 0.8665338754653931
epoch 31   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.8030705755832148 , validation loss: 0.8389454111456871
epoch 32   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.778483278611127 , validation loss: 0.8266736939549446
epoch 33   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.7543686908834122 , validation loss: 0.826596274971962
epoch 34   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.729608979879641 , validation loss: 0.7954293265938759
epoch 35   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.7070150936351103 , validation loss: 0.7932983189821243
epoch 36   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.6844686760621912 , validation loss: 0.774379126727581
epoch 37   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.6604094294940723 , validation loss: 0.7604693695902824
epoch 38   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.6389583302479165 , validation loss: 0.7527376189827919
epoch 39   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.6175146570392684 , validation loss: 0.7387052401900291
epoch 40   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.5959667598499971 , validation loss: 0.739112876355648
epoch 41   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.5757254829593734 , validation loss: 0.7443734630942345
epoch 42   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.552910893571143 , validation loss: 0.7249793335795403
epoch 43   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.5335277061836392 , validation loss: 0.7212456241250038
epoch 44   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.5154240668988694 , validation loss: 0.7092617228627205
epoch 45   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.494307139340569 , validation loss: 0.7047340795397758
epoch 46   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.475380259401658 , validation loss: 0.7004304379224777
epoch 47   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.4574733738805734 , validation loss: 0.7095695957541466
epoch 48   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.4392989102531881 , validation loss: 0.6994572877883911
epoch 49   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.4209062211653765 , validation loss: 0.6819809228181839
epoch 50   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.4029572430778952 , validation loss: 0.6870654672384262
epoch 51   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.3855566884957107 , validation loss: 0.6841800138354301
epoch 52   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.3696500670676137 , validation loss: 0.6955191716551781
epoch 53   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.3518323874941058 , validation loss: 0.6782793700695038
epoch 54   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.3358979739394843 , validation loss: 0.6870483905076981
epoch 55   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.319504363864076 , validation loss: 0.6781834810972214
epoch 56   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.304383448525971 , validation loss: 0.677096389234066
epoch 57   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.2888571655049044 , validation loss: 0.6717696785926819
epoch 58   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.2730321860780902 , validation loss: 0.6707916483283043
epoch 59   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.2580744238460766 , validation loss: 0.6699091866612434
epoch 60   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.2435778332691567 , validation loss: 0.6701851189136505
epoch 61   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.2286609785229552 , validation loss: 0.6713178902864456
epoch 62   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.2147349890540629 , validation loss: 0.6727785095572472
epoch 63   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.199550747871399 , validation loss: 0.6641466915607452
epoch 64   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.1863399954403149 , validation loss: 0.6644490361213684
epoch 65   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.1729284735286938 , validation loss: 0.6705463826656342
epoch 66   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.1593343837588441 , validation loss: 0.6616267785429955
epoch 67   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.1455481543260462 , validation loss: 0.6666967943310738
epoch 68   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.1330946590386184 , validation loss: 0.6677493155002594
epoch 69   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.1197124509250416 , validation loss: 0.6617425978183746
epoch 70   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.1071585416793823 , validation loss: 0.6721242442727089
epoch 71   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.0942283424676633 , validation loss: 0.6675858274102211
epoch 72   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.0825524096395456 , validation loss: 0.6516045555472374
epoch 73   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.0698124170303345 , validation loss: 0.6593444719910622
epoch 74   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.0576584432639329 , validation loss: 0.6537838280200958
epoch 75   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.045778611127068 , validation loss: 0.6586507931351662
epoch 76   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.0344860997854495 , validation loss: 0.6581682935357094
epoch 77   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.023514193647048 , validation loss: 0.6506559327244759
epoch 78   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 1.0120309509483039 , validation loss: 0.6640980243682861
epoch 79   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 0.999837014020658 , validation loss: 0.651633232831955
epoch 80   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 0.9889387944165398 , validation loss: 0.6506458446383476
epoch 81   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 0.9781683215907976 , validation loss: 0.6504930183291435
epoch 82   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 0.9677070239010979 , validation loss: 0.6467099338769913
epoch 83   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 0.9571678837140402 , validation loss: 0.6577488258481026
epoch 84   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 0.9463414175837648 , validation loss: 0.6508799642324448
epoch 85   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 0.936592181523641 , validation loss: 0.6466500833630562
epoch 86   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 0.9260925498663211 , validation loss: 0.6507490426301956
epoch 87   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 0.9164955861428205 , validation loss: 0.6469582840800285
epoch 88   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 0.9064009470098159 , validation loss: 0.6569291576743126
epoch 89   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 0.8967555995080986 , validation loss: 0.6369983181357384
epoch 90   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 0.8869668186879626 , validation loss: 0.643622875213623
epoch 91   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 0.8776446627635582 , validation loss: 0.6421931684017181
epoch 92   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 0.8685466834143096 , validation loss: 0.644025132060051
epoch 93   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 0.859169108026168 , validation loss: 0.6409033760428429
epoch 94   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 0.8500007659781212 , validation loss: 0.6430539935827255
epoch 95   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 0.8410855005769169 , validation loss: 0.6395608186721802
epoch 96   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 0.8324459627562878 , validation loss: 0.6392110362648964
tensor(58.5444, device='cuda:0')
MAE: [0.3000437595432663, 0.3911877861251987, 0.43375908933810353, 0.4493224533717388, 0.48773059254627404, 0.5191001305820363, 0.5113159404675831, 0.5287245094536122, 0.5479588632579394, 0.5607749782525694, 0.5724407952893333, 0.5776307107819263, 0.6055148684049083, 0.6123757693501785, 0.6047503171951424, 0.6013236555635698, 0.611017344026183, 0.6129189288370388, 0.6158968818895326, 0.6115782788933553, 0.6256260806936579, 0.6229726357147405, 0.6038026808709214, 0.5938675570848984, 0.5847868887442597, 0.5817945221957472, 0.5924109292385581, 0.5902328112491013, 0.5939293284036373, 0.6035063572900043, 0.5889287204571914, 0.582479221446574] , MAPE: [0.07454135932438438, 0.06632880259578125, 0.12828599322967363, 0.08763434654073375, 0.07959823458247275, 0.050552664332734885, 0.07069970062365738, 0.04946681634481194, -0.0017409541163612733, 0.06167581479395839, 0.07765622448854535, 0.06921835734245121, 0.08020893327265344, 0.07175158323500806, 0.01941961644474806, 0.016924572832385538, 0.01528930923679244, 0.04814031418330713, 0.0541856744280325, 0.01395865028104793, 0.05591566750507912, 0.05594321146882235, 0.04768962462800531, 0.008718587752593952, -0.004157290051772535, -0.0007543513945726313, -0.022140863223305, -0.06631497595332306, -0.11503638905406145, -0.03890913162779622, -0.03641528158214006, -0.16333886016985957] %, RMSE: [0.5542671108672838, 0.6550918605279558, 0.7057737095743929, 0.719583966225773, 0.7726412315219456, 0.80930617289556, 0.7937089941537464, 0.8030185092251071, 0.7954770427397632, 0.78918457712227, 0.7997932785960489, 0.7992411049248392, 0.8449333558386235, 0.8538216644399805, 0.8319422041177424, 0.8217938636770189, 0.8277868247381578, 0.8159845224385598, 0.8099992106799628, 0.8070750254706116, 0.8308109497853281, 0.8336406344490994, 0.8012968525801891, 0.783784337671986, 0.7635152790918923, 0.7631564892119198, 0.7841107740877082, 0.7815080381354836, 0.7917516630969895, 0.8158154283826163, 0.7917790979961733, 0.7800286771236719]
epoch 97   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 0.8236642573394027 , validation loss: 0.6340077593922615
tensor(58.3578, device='cuda:0')
MAE: [0.29906444498892276, 0.3834729136171818, 0.42533763481592085, 0.45748316324459987, 0.4795365359313959, 0.4970702644965621, 0.5063368165434444, 0.5163729754533888, 0.539323577657726, 0.549154938023115, 0.5553663177156495, 0.5752905036399583, 0.5861240949082314, 0.5844905915864043, 0.5849500868510762, 0.5921918562903385, 0.5960835101735807, 0.5852646332610514, 0.5970219233808751, 0.5952707763699834, 0.5890226734477604, 0.5790493004323588, 0.5691041521441921, 0.5668796816439435, 0.5535994409623834, 0.5483132651356077, 0.5630005544013122, 0.5598985683514747, 0.5512249097857893, 0.5517531406687399, 0.5418164815607759, 0.5400234142596324] , MAPE: [0.06053821453410922, 0.06312926221877749, 0.15248497371102165, 0.13928673803671288, 0.12717889667843404, 0.08058037758215206, 0.0755504106146826, 0.0812561286482558, 0.03354657355664459, 0.09471802646317452, 0.11865143177582889, 0.126592592032824, 0.13663191975526434, 0.12812099542440283, 0.08214911364411369, 0.08567132134438785, 0.05430615215767511, 0.08756236678378103, 0.1392030041615122, 0.11759768723426195, 0.1350003597572309, 0.13168590373837283, 0.10063640460364096, 0.08543896782217435, 0.04254530204148284, 0.00919015892490279, -0.009549726928865115, -0.000206592171395932, -0.04183559093484835, 0.002779257629509564, -0.014921742977015495, -0.11332262218165326] %, RMSE: [0.5468311951079872, 0.6407269737360616, 0.6931971970544885, 0.7385317971469191, 0.764670369321698, 0.7849989390915401, 0.7989859498108084, 0.7975132101064776, 0.7971388974856167, 0.788719182683332, 0.7916634394116663, 0.8147583203741134, 0.835014565747202, 0.8349434366897464, 0.8297614181196908, 0.8325752553824722, 0.8262062217758623, 0.7948086590617695, 0.8072950292501596, 0.8102439277568317, 0.8013568888363892, 0.7929706994301452, 0.7799810940733395, 0.7729993510994263, 0.7438341040586893, 0.7403483819140209, 0.7682941337732154, 0.7657553244099736, 0.7613018641727048, 0.7733086645609935, 0.7578797005357001, 0.7560238929015811]
epoch 98   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 0.8156158211184483 , validation loss: 0.6469801068305969
tensor(58.1706, device='cuda:0')
MAE: [0.29992410251957163, 0.386560758590391, 0.4315974584655337, 0.45727271965983296, 0.4870147998937281, 0.5047400232759717, 0.5160921824722522, 0.5277222419537835, 0.5510690568007298, 0.570372928827905, 0.5910973087355456, 0.6014844013426031, 0.6067628367986415, 0.6057264191404792, 0.6109684918671078, 0.6083470650141117, 0.6079425567449983, 0.6089106002403903, 0.6171914524131829, 0.6158255276398867, 0.6133786407338705, 0.6042400177777505, 0.5950267608458003, 0.5887856111456592, 0.5746035205646293, 0.5822088627215743, 0.5966089026199788, 0.5951962748841028, 0.5885313238168961, 0.5922789409891078, 0.5762556990783316, 0.5639396525731253] , MAPE: [0.08637393505890528, 0.11110076650622339, 0.18168090328661193, 0.15615993612874346, 0.1335856809146215, 0.09484748940781501, 0.1009658098584353, 0.0888520484509579, 0.0633685246615319, 0.12394161719681525, 0.14054871347471207, 0.13599553217290075, 0.13582376616921485, 0.13393166810835572, 0.09327927115097277, 0.09491242541567922, 0.08985025949498336, 0.08514962685258219, 0.1192734897157451, 0.09276323745583757, 0.11793545536861333, 0.09585336416163233, 0.09766097609892238, 0.06579680663955964, 0.026172823119779105, 0.015686318920155658, -0.008576071354100783, -0.009867820923622294, -0.07729948058436965, -0.04749911542106048, -0.025264621691432655, -0.10481854758884268] %, RMSE: [0.5553077222070323, 0.6485159400902163, 0.7029121762839058, 0.7365175879371211, 0.7779595252150899, 0.7961877011120199, 0.8109383351154194, 0.811722264917089, 0.8106716477965454, 0.8150092926450642, 0.8368251806237788, 0.8447954638583318, 0.8578474673010849, 0.8570348070438838, 0.8550654255060446, 0.8471852603703532, 0.8341340000259903, 0.8210875015791409, 0.8246623873614961, 0.8288869595457079, 0.8301016315881921, 0.8216495786631227, 0.8053237262386933, 0.7958292854171881, 0.7654033847570739, 0.779936982861149, 0.8034027328856365, 0.8018327007866725, 0.8003937852797914, 0.8154457060723036, 0.7894900054367548, 0.7754388981353249]
epoch 99   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2 , train loss: 0.8065972842422187 , validation loss: 0.6362518817186356
tensor(57.9835, device='cuda:0')
MAE: [0.29953375707879737, 0.3821388892323432, 0.4269127035148672, 0.4565564317839969, 0.48084943980314604, 0.49198151679344704, 0.49181755097102875, 0.5031113484213801, 0.5218527352882876, 0.5216570701325293, 0.5545712944566628, 0.5658363459578034, 0.5791125518223751, 0.5876066746309246, 0.579844409818425, 0.5950503747495487, 0.5934918967843748, 0.5934126012876015, 0.611372439218781, 0.6054978632821327, 0.6062191084526556, 0.5955209938786232, 0.5745835168818108, 0.5724723699811808, 0.5694575311343387, 0.5685839010652673, 0.5863079069616254, 0.5831934642580521, 0.5700629998251949, 0.5695841712627522, 0.559031032966978, 0.5575075936327045] , MAPE: [0.07947827930478937, 0.07078057242282546, 0.16138384202725273, 0.12904831979152526, 0.09869427866898309, 0.07905524693022241, 0.07470146377162873, 0.08372693127395042, 0.03562922049160164, 0.08925679198591208, 0.11492989631237692, 0.11162238133602569, 0.10207899153877059, 0.12089920860903035, 0.08290768070562897, 0.08971251276412547, 0.07715435127367302, 0.09635210707773348, 0.11765183509037333, 0.07799270968772615, 0.11260347960412397, 0.0933142757821738, 0.08072960251822262, 0.06751365022055718, 0.018642313776366153, 0.013445640706070747, -0.002602704059711859, -0.006645598958355024, -0.07992946432517858, -0.03833072118773173, -0.019603916161047646, -0.105533125222223] %, RMSE: [0.5516358435477553, 0.6459816087348966, 0.700220562008759, 0.7423042795252377, 0.7664739339832576, 0.7750811152441262, 0.7730750004331547, 0.7761809512986445, 0.7704255429368304, 0.7524504948453475, 0.7997845908943357, 0.8068750550572094, 0.8276936146749616, 0.8422031531033274, 0.8219538957325986, 0.8403250421784221, 0.8240955344866358, 0.811360416011296, 0.8295171743259385, 0.8220946281700344, 0.8232882132271901, 0.8131411629869647, 0.7807771283888908, 0.7751624565824681, 0.7643505409516782, 0.7676497899318178, 0.7970128053549371, 0.7928786443207549, 0.7790366150015827, 0.7870974053484432, 0.7734274168020535, 0.7702692263154249]
test loss: NIL 
MAE: [0.29953375707879737, 0.3821388892323432, 0.4269127035148672, 0.4565564317839969, 0.48084943980314604, 0.49198151679344704, 0.49181755097102875, 0.5031113484213801, 0.5218527352882876, 0.5216570701325293, 0.5545712944566628, 0.5658363459578034, 0.5791125518223751, 0.5876066746309246, 0.579844409818425, 0.5950503747495487, 0.5934918967843748, 0.5934126012876015, 0.611372439218781, 0.6054978632821327, 0.6062191084526556, 0.5955209938786232, 0.5745835168818108, 0.5724723699811808, 0.5694575311343387, 0.5685839010652673, 0.5863079069616254, 0.5831934642580521, 0.5700629998251949, 0.5695841712627522, 0.559031032966978, 0.5575075936327045] , MAPE: [0.07947827930478937, 0.07078057242282546, 0.16138384202725273, 0.12904831979152526, 0.09869427866898309, 0.07905524693022241, 0.07470146377162873, 0.08372693127395042, 0.03562922049160164, 0.08925679198591208, 0.11492989631237692, 0.11162238133602569, 0.10207899153877059, 0.12089920860903035, 0.08290768070562897, 0.08971251276412547, 0.07715435127367302, 0.09635210707773348, 0.11765183509037333, 0.07799270968772615, 0.11260347960412397, 0.0933142757821738, 0.08072960251822262, 0.06751365022055718, 0.018642313776366153, 0.013445640706070747, -0.002602704059711859, -0.006645598958355024, -0.07992946432517858, -0.03833072118773173, -0.019603916161047646, -0.105533125222223] %, RMSE: [0.5516358435477553, 0.6459816087348966, 0.700220562008759, 0.7423042795252377, 0.7664739339832576, 0.7750811152441262, 0.7730750004331547, 0.7761809512986445, 0.7704255429368304, 0.7524504948453475, 0.7997845908943357, 0.8068750550572094, 0.8276936146749616, 0.8422031531033274, 0.8219538957325986, 0.8403250421784221, 0.8240955344866358, 0.811360416011296, 0.8295171743259385, 0.8220946281700344, 0.8232882132271901, 0.8131411629869647, 0.7807771283888908, 0.7751624565824681, 0.7643505409516782, 0.7676497899318178, 0.7970128053549371, 0.7928786443207549, 0.7790366150015827, 0.7870974053484432, 0.7734274168020535, 0.7702692263154249]
====================
training elapsedd with 313.11 seconds for 100 iterations, the sec/iter = 3.13

MAE_mean: [0.29953376 0.38213889 0.4269127  0.45655643 0.48084944 0.49198152
 0.49181755 0.50311135 0.52185274 0.52165707 0.55457129 0.56583635
 0.57911255 0.58760667 0.57984441 0.59505037 0.5934919  0.5934126
 0.61137244 0.60549786 0.60621911 0.59552099 0.57458352 0.57247237
 0.56945753 0.5685839  0.58630791 0.58319346 0.570063   0.56958417
 0.55903103 0.55750759] , MAPE_mean: [ 0.07947828  0.07078057  0.16138384  0.12904832  0.09869428  0.07905525
  0.07470146  0.08372693  0.03562922  0.08925679  0.1149299   0.11162238
  0.10207899  0.12089921  0.08290768  0.08971251  0.07715435  0.09635211
  0.11765184  0.07799271  0.11260348  0.09331428  0.0807296   0.06751365
  0.01864231  0.01344564 -0.0026027  -0.0066456  -0.07992946 -0.03833072
 -0.01960392 -0.10553313] , RMSE_mean: [0.55163584 0.64598161 0.70022056 0.74230428 0.76647393 0.77508112
 0.773075   0.77618095 0.77042554 0.75245049 0.79978459 0.80687506
 0.82769361 0.84220315 0.8219539  0.84032504 0.82409553 0.81136042
 0.82951717 0.82209463 0.82328821 0.81314116 0.78077713 0.77516246
 0.76435054 0.76764979 0.79701281 0.79287864 0.77903662 0.78709741
 0.77342742 0.77026923]

MAE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , MAPE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , RMSE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
Finished training with: lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-4_ah4_ck1_kt2
user config:
seed 666
device 0
scaler StandardScaler()
day_slot 288
n_route 10
n_his 96
n_pred 96
n_train 34
n_val 5
n_test 5
mode 1
n_c 10
model STAGNN_stamp
TPG TPGNN
name lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6
log_path log/TPGNN_r05p02kt3outer_266
crash 266
new_name TPGNN_r05p02kt3outer_266
batch_size 256
lr 0.001
a 0.1
r 0.5
n_mask 1
adam {'use': True, 'weight_decay': 0.0001}
slr {'use': True, 'step_size': 400, 'gamma': 0.3}
resume False
start_epoch 0
epochs 100
n_layer 1
n_attr 64
n_hid 128
reg_A 0.001
circle 288
drop_prob 0.2
CE {'use': True, 'kernel_size': 1, 'bias': False}
LE {'use': False, 'bias': False}
SE {'use': True, 'separate': True, 'no': False}
TE {'use': True, 'no': True}
attn {'head': 1, 'd_k': 32, 'd_v': 32, 'drop_prob': 0.2}
STstamp {'use': True, 'kt': 3, 'temperature': 1.0}
T4N {'use': True, 'step': 2, 'end_epoch': 10000, 'change_head': True, 'change_enc': True}
stamp_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/time_stamp.npy
data_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/V_France_processed_0.csv
adj_matrix_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/W_France_processed_0.csv
dis_mat tensor([[0.0000, 0.3661, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.6136, 0.0000,
         0.0000],
        [0.3661, 0.0000, 0.0000, 0.0000, 0.1098, 0.0000, 0.0000, 0.8975, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.3410, 0.8975, 0.0000, 0.0000, 0.0000, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.3410, 0.0000, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000,
         0.1494],
        [0.0000, 0.1098, 0.8975, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000, 0.6996,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000,
         0.2289],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000, 0.0000,
         0.5594],
        [0.6136, 0.8975, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.2117,
         0.0000],
        [0.0000, 0.4288, 0.4288, 0.0000, 0.6996, 0.0000, 0.0000, 0.2117, 0.0000,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.1494, 0.0000, 0.2289, 0.5594, 0.0000, 0.0000,
         0.0000]], device='cuda:0')
prefix log/lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6/
checkpoint_temp_path log/lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6//temp.pth
checkpoint_best_path log/lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6//best.pth
tensorboard_path log/lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6/
record_path log/lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6/record.txt
eps 0.1
parse <bound method DefaultConfig.parse of <config.DefaultConfig object at 0x7f3a878d5550>>
output <bound method DefaultConfig.output of <config.DefaultConfig object at 0x7f3a878d5550>>
train: True, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 9792
len(data): 9792, day_slot: 288, n_day: 34
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
10 10
epoch 0   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 3.540118327507606 , validation loss: 1.3061009049415588
epoch 1   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 2.9155045472658596 , validation loss: 1.1221630573272705
epoch 2   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 2.6940521276914158 , validation loss: 1.115014135837555
epoch 3   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 2.5458465356093187 , validation loss: 1.0133000910282135
epoch 4   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 2.431601506013137 , validation loss: 0.9964486360549927
epoch 5   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 2.331961448375995 , validation loss: 0.972064346075058
epoch 6   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 2.2428018679985633 , validation loss: 0.9455913007259369
epoch 7   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 2.1603512947375956 , validation loss: 0.9219788908958435
epoch 8   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 2.0843262672424316 , validation loss: 0.9263511300086975
epoch 9   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 2.012257511799152 , validation loss: 0.9423871040344238
epoch 10   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 1.9448089599609375 , validation loss: 0.8946908712387085
epoch 11   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 1.8801982219402606 , validation loss: 0.8821909725666046
epoch 12   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 1.818776772572444 , validation loss: 0.8682670593261719
epoch 13   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 1.7605832723470836 , validation loss: 0.8638841509819031
epoch 14   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 1.7044685437129095 , validation loss: 0.8877768814563751
epoch 15   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 1.6509237747925978 , validation loss: 0.851800799369812
epoch 16   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 1.599683669897226 , validation loss: 0.8706492483615875
epoch 17   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 1.5475618564165556 , validation loss: 0.7869176268577576
epoch 18   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 1.5017112401815562 , validation loss: 0.7963429987430573
epoch 19   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 1.4563001302572398 , validation loss: 0.7801268398761749
epoch 20   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 1.4131782329999483 , validation loss: 0.7311691641807556
epoch 21   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 1.3746188145417433 , validation loss: 0.7749212682247162
epoch 22   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 1.3355351227980394 , validation loss: 0.7580622732639313
epoch 23   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 1.298711428275475 , validation loss: 0.7210533320903778
epoch 24   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 1.2638879464222834 , validation loss: 0.7154090404510498
epoch 25   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 1.2328739074560313 , validation loss: 0.7032743692398071
epoch 26   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 1.199776530265808 , validation loss: 0.7170557081699371
epoch 27   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 1.1699132094016442 , validation loss: 0.7063164710998535
epoch 28   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 1.14035492676955 , validation loss: 0.7093771696090698
epoch 29   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 1.1133138491557195 , validation loss: 0.6977922916412354
epoch 30   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 1.0872168632654042 , validation loss: 0.7646363079547882
epoch 31   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 1.0607118698266835 , validation loss: 0.6967507302761078
epoch 32   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 1.0366164537576528 , validation loss: 0.6974912881851196
epoch 33   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 1.0146498680114746 , validation loss: 0.7229187488555908
epoch 34   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.99298279102032 , validation loss: 0.6886868476867676
epoch 35   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.9706032780500559 , validation loss: 0.6991415023803711
epoch 36   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.9502132764229407 , validation loss: 0.6968839466571808
epoch 37   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.9302162390488845 , validation loss: 0.69346684217453
epoch 38   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.9090719360571641 , validation loss: 0.6898130476474762
epoch 39   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.8905915709642264 , validation loss: 0.8010067343711853
epoch 40   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.8721030079401456 , validation loss: 0.6950564384460449
epoch 41   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.8547650896585904 , validation loss: 0.7564577460289001
epoch 42   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.8384980513499334 , validation loss: 0.6905991733074188
epoch 43   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.8212452897658715 , validation loss: 0.696619063615799
epoch 44   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.8054284269993122 , validation loss: 0.7030064463615417
epoch 45   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.789250754393064 , validation loss: 0.6745974719524384
epoch 46   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.7749152550330529 , validation loss: 0.6779979467391968
epoch 47   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.7627155505693876 , validation loss: 0.6821416914463043
epoch 48   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.7480604281792274 , validation loss: 0.6783774197101593
epoch 49   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.7324938774108887 , validation loss: 0.6917014122009277
epoch 50   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.7203828875835125 , validation loss: 0.6942430138587952
epoch 51   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.7070116446568415 , validation loss: 0.6673838496208191
epoch 52   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.6955017447471619 , validation loss: 0.7396570444107056
epoch 53   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.6841927033204299 , validation loss: 0.6832976043224335
epoch 54   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.672984989789816 , validation loss: 0.6878732442855835
epoch 55   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.6606668784068181 , validation loss: 0.6731973886489868
epoch 56   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.6511299976935754 , validation loss: 0.7175256609916687
epoch 57   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.6394434525416448 , validation loss: 0.6737081110477448
epoch 58   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.6290692732884333 , validation loss: 0.7150630056858063
epoch 59   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.6192554373007554 , validation loss: 0.6687295734882355
epoch 60   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.6097933512467605 , validation loss: 0.7116407752037048
epoch 61   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.6015430826407212 , validation loss: 0.6758899092674255
epoch 62   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.5919701548723074 , validation loss: 0.7341614663600922
epoch 63   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.5834110470918509 , validation loss: 0.6673352420330048
epoch 64   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.5746349463096032 , validation loss: 0.7740252614021301
epoch 65   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.5674089651841384 , validation loss: 0.6729432940483093
epoch 66   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.5583933866941012 , validation loss: 0.7228983342647552
epoch 67   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.5499303340911865 , validation loss: 0.6919398605823517
epoch 68   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.5428463587394128 , validation loss: 0.6679191291332245
epoch 69   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.535546600818634 , validation loss: 0.7094963490962982
epoch 70   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.5280020053570087 , validation loss: 0.6679733991622925
epoch 71   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.5213064826451815 , validation loss: 0.7028341889381409
epoch 72   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.51522735448984 , validation loss: 0.7201924920082092
epoch 73   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.5084982560231135 , validation loss: 0.6747284531593323
epoch 74   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.5020656379369589 , validation loss: 0.6689044535160065
epoch 75   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.4952514675947336 , validation loss: 0.6765885651111603
epoch 76   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.4898609725328592 , validation loss: 0.7371176779270172
epoch 77   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.48352593871263355 , validation loss: 0.6597106754779816
epoch 78   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.4784089212234204 , validation loss: 0.6560417711734772
epoch 79   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.4714382290840149 , validation loss: 0.7075749039649963
epoch 80   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.4676411747932434 , validation loss: 0.6943509876728058
epoch 81   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.4621745554300455 , validation loss: 0.7522110641002655
epoch 82   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.4561753800282112 , validation loss: 0.6836914718151093
epoch 83   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.4509128194588881 , validation loss: 0.6765825748443604
epoch 84   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.4461018718205966 , validation loss: 0.7549762427806854
epoch 85   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.4416540333857903 , validation loss: 0.6583601832389832
epoch 86   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.4362866167838757 , validation loss: 0.6761301159858704
epoch 87   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.4320875177016625 , validation loss: 0.7260346412658691
epoch 88   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.4283592700958252 , validation loss: 0.6858586072921753
epoch 89   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.4231995504636031 , validation loss: 0.7198353707790375
epoch 90   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.4195113250842461 , validation loss: 0.6444456577301025
epoch 91   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.4141840705504784 , validation loss: 0.7372025549411774
epoch 92   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.41029823514131397 , validation loss: 0.6552148163318634
epoch 93   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.40724621369288516 , validation loss: 0.653232216835022
epoch 94   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.40324392227026135 , validation loss: 0.651416540145874
epoch 95   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.39900102523656994 , validation loss: 0.6490031778812408
epoch 96   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.3952504052565648 , validation loss: 0.699348658323288
tensor(43.6288, device='cuda:0')
MAE: [0.29946097939716865, 0.40418300319174977, 0.445012338446338, 0.46570797320935375, 0.5183695239331765, 0.5387743596436898, 0.5381475838056295, 0.5520587776548508, 0.569509091048511, 0.6105464475039277, 0.6252669871055051, 0.6286598497458263, 0.6464005474331452, 0.654334613554871, 0.6518997148168993, 0.6670220303166773, 0.675572389321805, 0.679054231068177, 0.6748165063558089, 0.6694124827166232, 0.6757204101071453, 0.6736210597250802, 0.6614666829961016, 0.6567485344537639, 0.6409893080924359, 0.6515519011516085, 0.6560772618681154, 0.6369109999216593, 0.6315223982679591, 0.621349768678168, 0.6057601285724392, 0.6113775119596382] , MAPE: [0.11304162529640868, 0.12231978350964129, 0.2161211206082833, 0.2648249740515189, 0.25500992664564376, 0.21169149299621456, 0.12959436048291498, 0.11679569311084144, 0.11419109952906324, 0.2418325221730209, 0.22683195312389534, 0.25602607848201026, 0.2560484532611901, 0.25542316378456703, 0.16866906513232552, 0.12656212638730702, 0.15830907784064527, 0.17379070546742068, 0.16230658343991028, 0.2057798200191835, 0.2542404387811482, 0.2516709995433657, 0.16217802962252256, 0.07320446835615829, 0.07126362032780889, 0.014992643748872107, -0.03723252129123232, -0.037636219465969484, -0.13434989597310726, -0.09579129672069199, -0.11120035492698821, -0.3287318186566579] %, RMSE: [0.5339962386545731, 0.6627160468900015, 0.7155444526373356, 0.7306852154129994, 0.7807525137790243, 0.8147745392698541, 0.8113116062532647, 0.8141463079292812, 0.8084809598688669, 0.8519257539675329, 0.8774369522194851, 0.8659765785629011, 0.8834077116650577, 0.9071314608062134, 0.902633793294783, 0.9182822170325147, 0.9137935330728804, 0.9091378107490525, 0.9062380303372256, 0.8960549339368407, 0.9036118238447852, 0.9178385003648178, 0.9026101041081479, 0.8951098687447991, 0.8681288927401849, 0.8723625131081024, 0.8816919190488295, 0.8502535177579402, 0.8465779310284394, 0.8472418198316043, 0.8274117545040925, 0.8345188417976456]
epoch 97   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.3921422247703259 , validation loss: 0.6499471068382263
tensor(43.4145, device='cuda:0')
MAE: [0.30000800705049185, 0.39682485369302944, 0.4542862402579805, 0.47279521896667087, 0.5172462191786041, 0.524708419823347, 0.5364009452411501, 0.5500981371308264, 0.5644012578259961, 0.5883045870954766, 0.609920330705318, 0.6035292002170817, 0.6167044455104882, 0.6292047894843998, 0.6449956609001479, 0.6431087072155217, 0.6513373395145784, 0.6550276585558871, 0.6633327366889828, 0.6600683522395329, 0.6545008504210212, 0.6587944206618463, 0.654264442694479, 0.6509094562300856, 0.6399303612535454, 0.6422089757256633, 0.6401794395006272, 0.6271771129604775, 0.6227292334764581, 0.6179211446994282, 0.6135374184106429, 0.6079135011827823] , MAPE: [0.0833139005189366, 0.09213424141585792, 0.14873387510114777, 0.21368113395278698, 0.179660082060227, 0.16283512176926904, 0.12190446582520213, 0.08835191647124599, 0.020232266365349732, 0.12260589898240479, 0.09596068393542868, 0.13806854210823377, 0.12249914967203837, 0.157811879280945, 0.11567184369660345, 0.05151587576284637, 0.027955568292790743, 0.04949299143535474, 0.05032016882419672, 0.04804830072471661, 0.04792585264186893, 0.07326749009366094, 0.07950320250184285, -0.03702689923811104, -0.0061117478116198215, -0.048085459427459204, -0.03944703680440932, -0.0354913236349059, -0.0633922200302066, -0.04504597184908356, -0.03576674304100548, -0.13495741338737924] %, RMSE: [0.5450596368153934, 0.6500101356797816, 0.720557674235649, 0.7427378684590775, 0.7886754594857635, 0.7886836574010853, 0.8001945158613676, 0.807566618917678, 0.812232346657697, 0.8256155124145019, 0.849472753491179, 0.8360486034985051, 0.8559916727879259, 0.876705037992132, 0.8890298898117469, 0.8828851140852957, 0.8924858863929874, 0.8824649002642275, 0.8836450862286219, 0.8822174070579945, 0.8779655520166711, 0.8817404309756747, 0.873471678302086, 0.8608031994654081, 0.8392084052337924, 0.8352328866684227, 0.8290981980294122, 0.8115136570877195, 0.8133510326694734, 0.8129912962164779, 0.8018546759372865, 0.7926117853600679]
epoch 98   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.388392122892233 , validation loss: 0.6848067343235016
tensor(43.2041, device='cuda:0')
MAE: [0.31422841345132857, 0.4206203998382366, 0.4703837901490174, 0.5079129330501844, 0.5623317082411341, 0.5874465548131884, 0.603271173343024, 0.6282198477117825, 0.6464616598113987, 0.6723170358034753, 0.6946505056256332, 0.7144838606294475, 0.7321655185837491, 0.7298875431313189, 0.7383006561756825, 0.7478927107700675, 0.7570170605238336, 0.7450585524924099, 0.7481139070004916, 0.7602223677161275, 0.7674121751112037, 0.77801763804303, 0.7679737894884167, 0.7807310841697239, 0.7822201794324461, 0.7741424920235175, 0.7803019715305034, 0.7966448617118804, 0.8040478056974555, 0.7909831057792318, 0.7692184659984616, 0.7585517029387435] , MAPE: [0.058545815514412285, 0.09507083249128948, 0.11282021370812856, 0.16240098924845484, 0.10226984796763851, 0.0840449649457983, 0.00204300954612392, -0.018889370493113167, -0.05931005821752628, 0.027040283327781807, -0.012432946690151794, -0.01924515438551736, -0.02685864849598672, 0.022096897328360073, -0.04847600118304361, -0.07510510230375263, -0.08568809857564984, -0.0828802592677308, -0.07971348289297725, -0.10864379685649125, -0.13585166987787198, -0.10948928563569951, -0.13423662534938913, -0.21502026217028972, -0.16142882263005395, -0.17507766220599508, -0.18117810273605933, -0.23103256542810188, -0.27132395012605803, -0.23435380702078001, -0.2362545503726622, -0.29514068094359414] %, RMSE: [0.5445010893484822, 0.662425486361377, 0.7234239855457205, 0.7673972753826163, 0.8317065179549787, 0.8543815578692465, 0.8758421154937559, 0.8870209429226344, 0.8892680055047183, 0.9009747652906683, 0.9221095984226806, 0.9480012333822199, 0.9758751951752832, 0.9758551872524107, 0.9850618593686394, 0.9916848027722857, 0.9915446970802638, 0.9552557051864203, 0.9547176740850492, 0.974921921193701, 0.9903846160627102, 1.0080378203840714, 0.9925329575282263, 0.9984079201898216, 0.9912535941657783, 0.9694071717133569, 0.9709345710708004, 0.990683547109878, 1.003211534208638, 0.9914411803917346, 0.9600070775029482, 0.9418892134865021]
epoch 99   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6 , train loss: 0.3857671503837292 , validation loss: 0.6803291738033295
tensor(42.9937, device='cuda:0')
MAE: [0.3186632190912616, 0.4105809453650637, 0.447045398823072, 0.47613779616129304, 0.5318170766385522, 0.562861061009396, 0.587649712243031, 0.6099143247346672, 0.6351819514579226, 0.6436941236363167, 0.6466326268040336, 0.6601513615300514, 0.6805427528431965, 0.6985902444417252, 0.7268772856253631, 0.731454622510091, 0.7439752192478435, 0.7363509931303944, 0.7253615607820528, 0.7248116876849348, 0.725199437670064, 0.735330550656798, 0.7394177218755111, 0.7547094392192732, 0.7672392170353955, 0.7554895685851267, 0.7304690351847982, 0.7219566336738849, 0.7233315253751257, 0.7292501092366106, 0.7429933626884498, 0.7374836054682424] , MAPE: [0.08504665103278329, 0.07416782710664323, 0.09502880000457414, 0.1732392397828584, 0.13372058957160785, 0.1016350275358682, 0.03688164913041227, 0.03592191289374803, -0.013943613207775717, 0.0639191570849105, 0.014021794892872742, 0.05424029018592507, 0.039386440274316446, 0.05956973365557527, -0.05076434226003181, -0.025498711074139566, -0.052797666411779666, -0.05431815496630566, -0.05444138803562514, -0.036633902683629975, -0.043563919634877504, -0.03414034116320125, -0.05043490633871958, -0.09249018660015018, -0.09797675337740244, -0.1236296370033638, -0.11918490472627737, -0.11779482984007306, -0.17076562519493385, -0.15292819553999992, -0.16208388432103074, -0.2074169253393454] %, RMSE: [0.5585834243790267, 0.6611027371069141, 0.7014203667983909, 0.7403269909322348, 0.8052638798152362, 0.8357604808118798, 0.8682906813733113, 0.8863291910855725, 0.8982950368241321, 0.886335218073838, 0.881368138947816, 0.8972826909928582, 0.9218502480528932, 0.9536992943868517, 0.989817218663538, 0.9942689500938942, 0.9993766495195249, 0.974126306517015, 0.9538555952452273, 0.9537102543024868, 0.9551600668801891, 0.9736335935073629, 0.9812052726261403, 0.9956946926150645, 1.0029710635320142, 0.976557448906512, 0.9395916854402668, 0.9272655810299287, 0.9278283541479305, 0.9397755579206443, 0.9513478752510193, 0.9444997869599855]
test loss: NIL 
MAE: [0.3186632190912616, 0.4105809453650637, 0.447045398823072, 0.47613779616129304, 0.5318170766385522, 0.562861061009396, 0.587649712243031, 0.6099143247346672, 0.6351819514579226, 0.6436941236363167, 0.6466326268040336, 0.6601513615300514, 0.6805427528431965, 0.6985902444417252, 0.7268772856253631, 0.731454622510091, 0.7439752192478435, 0.7363509931303944, 0.7253615607820528, 0.7248116876849348, 0.725199437670064, 0.735330550656798, 0.7394177218755111, 0.7547094392192732, 0.7672392170353955, 0.7554895685851267, 0.7304690351847982, 0.7219566336738849, 0.7233315253751257, 0.7292501092366106, 0.7429933626884498, 0.7374836054682424] , MAPE: [0.08504665103278329, 0.07416782710664323, 0.09502880000457414, 0.1732392397828584, 0.13372058957160785, 0.1016350275358682, 0.03688164913041227, 0.03592191289374803, -0.013943613207775717, 0.0639191570849105, 0.014021794892872742, 0.05424029018592507, 0.039386440274316446, 0.05956973365557527, -0.05076434226003181, -0.025498711074139566, -0.052797666411779666, -0.05431815496630566, -0.05444138803562514, -0.036633902683629975, -0.043563919634877504, -0.03414034116320125, -0.05043490633871958, -0.09249018660015018, -0.09797675337740244, -0.1236296370033638, -0.11918490472627737, -0.11779482984007306, -0.17076562519493385, -0.15292819553999992, -0.16208388432103074, -0.2074169253393454] %, RMSE: [0.5585834243790267, 0.6611027371069141, 0.7014203667983909, 0.7403269909322348, 0.8052638798152362, 0.8357604808118798, 0.8682906813733113, 0.8863291910855725, 0.8982950368241321, 0.886335218073838, 0.881368138947816, 0.8972826909928582, 0.9218502480528932, 0.9536992943868517, 0.989817218663538, 0.9942689500938942, 0.9993766495195249, 0.974126306517015, 0.9538555952452273, 0.9537102543024868, 0.9551600668801891, 0.9736335935073629, 0.9812052726261403, 0.9956946926150645, 1.0029710635320142, 0.976557448906512, 0.9395916854402668, 0.9272655810299287, 0.9278283541479305, 0.9397755579206443, 0.9513478752510193, 0.9444997869599855]
====================
training elapsedd with 275.01 seconds for 100 iterations, the sec/iter = 2.75

MAE_mean: [0.31866322 0.41058095 0.4470454  0.4761378  0.53181708 0.56286106
 0.58764971 0.60991432 0.63518195 0.64369412 0.64663263 0.66015136
 0.68054275 0.69859024 0.72687729 0.73145462 0.74397522 0.73635099
 0.72536156 0.72481169 0.72519944 0.73533055 0.73941772 0.75470944
 0.76723922 0.75548957 0.73046904 0.72195663 0.72333153 0.72925011
 0.74299336 0.73748361] , MAPE_mean: [ 0.08504665  0.07416783  0.0950288   0.17323924  0.13372059  0.10163503
  0.03688165  0.03592191 -0.01394361  0.06391916  0.01402179  0.05424029
  0.03938644  0.05956973 -0.05076434 -0.02549871 -0.05279767 -0.05431815
 -0.05444139 -0.0366339  -0.04356392 -0.03414034 -0.05043491 -0.09249019
 -0.09797675 -0.12362964 -0.1191849  -0.11779483 -0.17076563 -0.1529282
 -0.16208388 -0.20741693] , RMSE_mean: [0.55858342 0.66110274 0.70142037 0.74032699 0.80526388 0.83576048
 0.86829068 0.88632919 0.89829504 0.88633522 0.88136814 0.89728269
 0.92185025 0.95369929 0.98981722 0.99426895 0.99937665 0.97412631
 0.9538556  0.95371025 0.95516007 0.97363359 0.98120527 0.99569469
 1.00297106 0.97655745 0.93959169 0.92726558 0.92782835 0.93977556
 0.95134788 0.94449979]

MAE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , MAPE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , RMSE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
Finished training with: lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-5_ah1_ck3_kt6
user config:
seed 666
device 0
scaler StandardScaler()
day_slot 288
n_route 10
n_his 96
n_pred 96
n_train 34
n_val 5
n_test 5
mode 1
n_c 10
model STAGNN_stamp
TPG TPGNN
name lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6
log_path log/TPGNN_r05p02kt3outer_268
crash 268
new_name TPGNN_r05p02kt3outer_268
batch_size 256
lr 0.0001
a 0.1
r 0.5
n_mask 1
adam {'use': True, 'weight_decay': 0.0001}
slr {'use': True, 'step_size': 400, 'gamma': 0.3}
resume False
start_epoch 0
epochs 100
n_layer 1
n_attr 64
n_hid 64
reg_A 1e-05
circle 288
drop_prob 0.2
CE {'use': True, 'kernel_size': 1, 'bias': False}
LE {'use': False, 'bias': False}
SE {'use': True, 'separate': True, 'no': False}
TE {'use': True, 'no': True}
attn {'head': 1, 'd_k': 32, 'd_v': 32, 'drop_prob': 0.2}
STstamp {'use': True, 'kt': 3, 'temperature': 1.0}
T4N {'use': True, 'step': 2, 'end_epoch': 10000, 'change_head': True, 'change_enc': True}
stamp_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/time_stamp.npy
data_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/V_France_processed_0.csv
adj_matrix_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/W_France_processed_0.csv
dis_mat tensor([[0.0000, 0.3661, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.6136, 0.0000,
         0.0000],
        [0.3661, 0.0000, 0.0000, 0.0000, 0.1098, 0.0000, 0.0000, 0.8975, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.3410, 0.8975, 0.0000, 0.0000, 0.0000, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.3410, 0.0000, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000,
         0.1494],
        [0.0000, 0.1098, 0.8975, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000, 0.6996,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000,
         0.2289],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000, 0.0000,
         0.5594],
        [0.6136, 0.8975, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.2117,
         0.0000],
        [0.0000, 0.4288, 0.4288, 0.0000, 0.6996, 0.0000, 0.0000, 0.2117, 0.0000,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.1494, 0.0000, 0.2289, 0.5594, 0.0000, 0.0000,
         0.0000]], device='cuda:0')
prefix log/lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6/
checkpoint_temp_path log/lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6//temp.pth
checkpoint_best_path log/lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6//best.pth
tensorboard_path log/lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6/
record_path log/lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6/record.txt
eps 0.1
parse <bound method DefaultConfig.parse of <config.DefaultConfig object at 0x7faf10e55550>>
output <bound method DefaultConfig.output of <config.DefaultConfig object at 0x7faf10e55550>>
train: True, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 9792
len(data): 9792, day_slot: 288, n_day: 34
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
10 10
epoch 0   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 1.666616705747751 , validation loss: 1.184414803981781
epoch 1   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 1.5022028042719915 , validation loss: 1.1125891208648682
epoch 2   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 1.3193593758803148 , validation loss: 1.0092045068740845
epoch 3   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 1.1691182209895208 , validation loss: 0.9553645253181458
epoch 4   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 1.078573694595924 , validation loss: 0.927891343832016
epoch 5   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 1.0089847032840435 , validation loss: 0.9313212633132935
epoch 6   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.9463485341805679 , validation loss: 0.9152565896511078
epoch 7   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.8898385854867789 , validation loss: 0.9471994042396545
epoch 8   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.8366340123690091 , validation loss: 0.9466649293899536
epoch 9   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.7835293687306918 , validation loss: 0.9459177553653717
epoch 10   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.7328032897068903 , validation loss: 0.9802138805389404
epoch 11   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.6878720109279339 , validation loss: 0.9684251248836517
epoch 12   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.6480498772401077 , validation loss: 0.9886943399906158
epoch 13   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.6154330464509817 , validation loss: 0.9861981570720673
epoch 14   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.5895336820529058 , validation loss: 0.9928868114948273
epoch 15   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.5689288790409381 , validation loss: 0.9929001033306122
epoch 16   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.5556435676721426 , validation loss: 1.003534197807312
epoch 17   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.5448539715546828 , validation loss: 1.0266798734664917
epoch 18   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.5367185748540438 , validation loss: 1.0292351841926575
epoch 19   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.5287627577781677 , validation loss: 1.0333556532859802
epoch 20   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.5233876980268038 , validation loss: 1.030900478363037
epoch 21   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.5170190288470342 , validation loss: 1.0421873927116394
epoch 22   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.5117160448661218 , validation loss: 1.0395763516426086
epoch 23   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.5062358448138604 , validation loss: 1.022594153881073
epoch 24   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.5012358060249915 , validation loss: 1.0212029814720154
epoch 25   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.4974049788254958 , validation loss: 1.0269713401794434
epoch 26   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.49277441318218523 , validation loss: 1.0067290663719177
epoch 27   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.48832974296349746 , validation loss: 1.020062506198883
epoch 28   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.48473377181933475 , validation loss: 1.0292011499404907
epoch 29   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.4809732207885155 , validation loss: 1.0190252661705017
epoch 30   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.4775862808410938 , validation loss: 1.0210951566696167
epoch 31   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.47425749668708217 , validation loss: 1.02230703830719
epoch 32   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.4714455489928906 , validation loss: 0.983546257019043
epoch 33   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.4682893271629627 , validation loss: 0.9955675899982452
epoch 34   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.46546828288298386 , validation loss: 1.0103670060634613
epoch 35   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.46268956936322725 , validation loss: 0.9938743710517883
epoch 36   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.4598900836247664 , validation loss: 1.0003288090229034
epoch 37   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.45736910517399126 , validation loss: 1.0007592737674713
epoch 38   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.4543625781169304 , validation loss: 1.0032737255096436
epoch 39   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.4519463754617251 , validation loss: 0.9918572306632996
epoch 40   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.44911256203284633 , validation loss: 0.9997115135192871
epoch 41   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.44724117334072405 , validation loss: 0.976504921913147
epoch 42   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.44524160486001235 , validation loss: 0.9755030572414398
epoch 43   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.44253534307846654 , validation loss: 0.9740236401557922
epoch 44   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.44047148869587827 , validation loss: 0.9763122498989105
epoch 45   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.43814197411903966 , validation loss: 0.9678751528263092
epoch 46   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.436477745954807 , validation loss: 0.9609051048755646
epoch 47   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.43396981633626497 , validation loss: 0.9508878588676453
epoch 48   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.4320435569836543 , validation loss: 0.9574879109859467
epoch 49   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.430209939296429 , validation loss: 0.9484407901763916
epoch 50   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.4279102866466229 , validation loss: 0.9618574976921082
epoch 51   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.4260576504927415 , validation loss: 0.9647350013256073
epoch 52   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.4238397295658405 , validation loss: 0.9537545144557953
epoch 53   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.4222237444840945 , validation loss: 0.9523271918296814
epoch 54   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.4204913561160748 , validation loss: 0.9472051858901978
epoch 55   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.4183831742176643 , validation loss: 0.9348132312297821
epoch 56   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.41672635536927444 , validation loss: 0.9312771558761597
epoch 57   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.41477436973498416 , validation loss: 0.9240390062332153
epoch 58   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.41360486012238723 , validation loss: 0.9280003011226654
epoch 59   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.4114797550898332 , validation loss: 0.9286893010139465
epoch 60   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.4099317193031311 , validation loss: 0.9373212158679962
epoch 61   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.4088003704181084 , validation loss: 0.9300999343395233
epoch 62   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.4069726627606612 , validation loss: 0.9220651090145111
epoch 63   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.4053799326603229 , validation loss: 0.9117124676704407
epoch 64   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.4041333290246817 , validation loss: 0.9278723299503326
epoch 65   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.40264581487729 , validation loss: 0.9441171884536743
epoch 66   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.4008844311420734 , validation loss: 0.9195367097854614
epoch 67   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.39929262491372913 , validation loss: 0.9232601225376129
epoch 68   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.39807514273203337 , validation loss: 0.915881872177124
epoch 69   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.3966923883328071 , validation loss: 0.9212697148323059
epoch 70   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.3950467132605039 , validation loss: 0.8975665867328644
epoch 71   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.3939303090939155 , validation loss: 0.9022879004478455
epoch 72   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.39332183049275327 , validation loss: 0.916996031999588
epoch 73   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.39115591920339143 , validation loss: 0.9133346378803253
epoch 74   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.3904824944642874 , validation loss: 0.9168662428855896
epoch 75   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.38918762711378246 , validation loss: 0.920642763376236
epoch 76   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.38774539874150205 , validation loss: 0.9142120480537415
epoch 77   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.38633832106223476 , validation loss: 0.922618180513382
epoch 78   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.38563032104418826 , validation loss: 0.9034040570259094
epoch 79   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.383593893968142 , validation loss: 0.8939181268215179
epoch 80   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.38289013504981995 , validation loss: 0.9158753454685211
epoch 81   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.3816019411270435 , validation loss: 0.9078242182731628
epoch 82   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.3801129093536964 , validation loss: 0.9110585451126099
epoch 83   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.37856587309103745 , validation loss: 0.908679336309433
epoch 84   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.3778002835237063 , validation loss: 0.9059838950634003
epoch 85   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.3773031532764435 , validation loss: 0.884429395198822
epoch 86   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.37555768398138195 , validation loss: 0.8832888305187225
epoch 87   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.37433271453930783 , validation loss: 0.9063437283039093
epoch 88   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.3734197501952832 , validation loss: 0.8917775452136993
epoch 89   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.3725835107840024 , validation loss: 0.8914427757263184
epoch 90   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.3710804765041058 , validation loss: 0.896745353937149
epoch 91   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.3696442154737619 , validation loss: 0.8922162353992462
epoch 92   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.36794861921897304 , validation loss: 0.8885140717029572
epoch 93   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.3673317638727335 , validation loss: 0.8929606378078461
epoch 94   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.3664697683774508 , validation loss: 0.8609019815921783
epoch 95   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.36579336799108064 , validation loss: 0.878663957118988
epoch 96   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.3638761043548584 , validation loss: 0.8978999853134155
tensor(75.8203, device='cuda:0')
MAE: [0.4035032929944777, 0.5497270446455048, 0.6134440804311295, 0.6618064036469945, 0.7078979628705948, 0.7130085441540476, 0.6866331221718226, 0.6578547426366929, 0.6883080015654109, 0.7387920385384068, 0.8061624238425001, 0.8548515919922399, 0.8839786318797119, 0.8710273781357353, 0.83402016630089, 0.8231625619065976, 0.8595493080374813, 0.8768946053549532, 0.9225227314479573, 0.9502454571514246, 1.0008306790074122, 0.9989880612653863, 0.9464630912236639, 0.9144965354921585, 0.9102769765611162, 0.927007950055941, 0.9614835432425295, 1.013208088662629, 1.025186861923214, 1.0174126097698186, 0.9517297775441416, 0.9752359175939381] , MAPE: [0.14128051025721358, 0.14099780435980983, 0.27711594496398534, 0.16182529519248476, 0.09758704118602238, 0.09260328761588472, 0.01881906718526038, 0.0178707658451668, -0.017196799156966515, 0.08412847545968258, 0.021986847433778243, -0.025938607396020257, -0.1444277034928187, -0.1694529048584265, -0.22434897265130577, -0.133506689639426, -0.10336713950859608, -0.09321242039267108, -0.10811690083594175, -0.05323866752316556, -0.1712873735985738, -0.16641328595857108, -0.1883540099632648, -0.041507990631542216, -0.0422533373941653, -0.1034514361055155, -0.10108131684812348, -0.34032382533373073, -0.29488634593544477, -0.09980520999174897, -0.2361118493608821, -0.5950945592797244] %, RMSE: [0.6863971664964381, 0.868609835679093, 0.9484257225824642, 0.9866463483281739, 1.02145762817788, 1.0089725701572292, 0.9553591946362945, 0.9113208305463718, 0.9319037493399379, 0.9803902768689503, 1.0609800290296567, 1.1132869080626024, 1.142484647653721, 1.1145385829057333, 1.07433967955981, 1.0469558351272887, 1.0909310023854353, 1.099615135546651, 1.1540701707326537, 1.1933798808259901, 1.2538853380908968, 1.2506670116686973, 1.2024348792704798, 1.1581946617981982, 1.1409458195715976, 1.1613206186022387, 1.2089770870283525, 1.2719290124153875, 1.294226521849012, 1.2794950251742419, 1.2162075909683916, 1.2381299848269731]
epoch 97   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.3628341188797584 , validation loss: 0.8873798847198486
tensor(75.7404, device='cuda:0')
MAE: [0.39252688977694544, 0.5443721772754354, 0.604293201706017, 0.6513631466618672, 0.6973754466280879, 0.7059467906552875, 0.6885504496805178, 0.6489264959480959, 0.6804490832807785, 0.7257175919649758, 0.7808805213524893, 0.8274324126122999, 0.8616262680514879, 0.8403699171642974, 0.7992615948726913, 0.7734890221170697, 0.805329826742065, 0.818356290383975, 0.8588736377710227, 0.8783550547297622, 0.9234266682625892, 0.9239492192096317, 0.8699720886715486, 0.8259112048901848, 0.8236898328563602, 0.8408111821637325, 0.8701621547195407, 0.9216657401102873, 0.9401145268124096, 0.9309017880767891, 0.8592559643719614, 0.8737498356440325] , MAPE: [0.11570353993041695, 0.11559411129374153, 0.2019586115287192, 0.147608240370197, 0.1481067469752557, 0.10474178999122329, 0.03862480743062837, 0.02530537940048254, 0.009967926441404979, 0.09852888639364031, 0.03391044762175165, -0.017583833614891735, -0.10378124047682823, -0.09040855709126114, -0.15560412811372817, -0.08083681506664041, -0.03506514795550962, -0.0035081275732819946, -0.0016056571485409898, 0.03513803045787745, -0.08033626537587608, -0.10900559685082288, -0.06308473264127333, 0.08729697934887132, -0.01566771522529343, -0.002253954331255542, -0.03244981020593598, -0.2429288537306837, -0.17124691386620267, -0.22944731743157765, -0.15284000968080513, -0.5951144224553688] %, RMSE: [0.6690539055205915, 0.8598116623054844, 0.9363304318243852, 0.9797627029031059, 1.0131113546373356, 1.01016536634127, 0.9667418394301424, 0.913391441084601, 0.9367386520330458, 0.9778891439162327, 1.0462098494676717, 1.1005871482316074, 1.1382959355735711, 1.0934288203764888, 1.0468170240775785, 1.013789490192783, 1.052413831642155, 1.0491733335872773, 1.1041678091212543, 1.1402019276145743, 1.1912313169704467, 1.1833642870002778, 1.1311839526184135, 1.079496093521166, 1.062176208647504, 1.0808698309509381, 1.130579702015004, 1.1975658096895743, 1.218468288667048, 1.1923663187821696, 1.116770025499056, 1.142292405384921]
epoch 98   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.36335291312291074 , validation loss: 0.8624844551086426
tensor(75.6629, device='cuda:0')
MAE: [0.39620471523162554, 0.5388482533257752, 0.591234248757324, 0.6372082634412289, 0.6819721668221287, 0.6915846974673422, 0.6692394274073777, 0.6275785072190092, 0.6696398502630517, 0.7073019307655926, 0.7562869966702209, 0.7952827682622622, 0.8276056465016889, 0.8163029632602156, 0.7816926998015225, 0.7561104382482386, 0.7909940795961422, 0.8017181606252783, 0.8353332873545203, 0.8509824247857959, 0.8923830424333663, 0.898733713698487, 0.8443607148462811, 0.8077019434671887, 0.8152793970723281, 0.8256608232327727, 0.8396303035737467, 0.884821025346857, 0.9134855640049755, 0.9116016373495313, 0.8453142541931155, 0.862444198524445] , MAPE: [0.12268684050582376, 0.11052152966852087, 0.2002734371496499, 0.14937664698662967, 0.14094800887253742, 0.07636626578567621, 0.031643847636470435, 0.024875150195064297, 0.0019010966239027805, 0.0829113804793331, 0.023458411860022156, -0.044552219098124214, -0.13763621766847492, -0.12926842791570792, -0.22606642848058944, -0.14024439357449156, -0.07530713875468228, -0.054645006107742485, -0.06380622496561551, -0.01733507834347901, -0.11188200313250322, -0.18090550589075757, -0.1779643365579895, -0.012256877122353283, -0.12437028880670341, -0.08578839423200331, -0.12165066578788064, -0.2849719102635557, -0.30253432687037124, -0.311854562484498, -0.2056533003387314, -0.6695289282492792] %, RMSE: [0.6741645410744658, 0.8593317795296158, 0.9275520554608436, 0.9706965134580948, 1.0024061817010699, 1.0024739292308327, 0.9546256494171679, 0.8949686547193252, 0.9251790910726343, 0.9609008697901167, 1.0255560430823414, 1.0695647193363729, 1.1062704668255046, 1.0788649763632112, 1.0395689143474454, 1.0006235686045877, 1.0418830020907366, 1.0385035238243285, 1.0857649308711999, 1.114687878091881, 1.1677827619920207, 1.1700590511868192, 1.1200449514894948, 1.071672558546113, 1.06425789221168, 1.0765313920950261, 1.1114411564895146, 1.1689162317983453, 1.2014731628521684, 1.1889598971978985, 1.123438195439842, 1.1474607927956813]
epoch 99   lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.361866302215136 , validation loss: 0.8725633323192596
tensor(75.5865, device='cuda:0')
MAE: [0.38448058972749666, 0.5272964297634425, 0.5777839527624784, 0.6239325123543361, 0.67162949940785, 0.6864251050218633, 0.6606226010791737, 0.6172187958586692, 0.6396225594487234, 0.6870380288592933, 0.7468917888548878, 0.7899779197943311, 0.8195302251903053, 0.795780033164264, 0.758433889694435, 0.7367541856176614, 0.7624288589088726, 0.7700252849195806, 0.817450887086158, 0.8349910662369322, 0.8737901373660749, 0.8684334798134172, 0.8136441641175141, 0.7685828797476961, 0.7538295663827934, 0.7684975573193935, 0.8046750455219106, 0.8499283545172399, 0.8627793196849909, 0.854422284658883, 0.7777692733874506, 0.7905614642829625] , MAPE: [0.15023540857911172, 0.1888477379324385, 0.2901186307586838, 0.17969691988097541, 0.11623546575434318, 0.15741158368284383, 0.07500485472107929, 0.0824710990730481, 0.05576000640867278, 0.15995767837119743, 0.10500264597906055, 0.04798770617072506, -0.06252347466367769, -0.0516508720293218, -0.15141923829731316, -0.05645988511826516, 0.005343488339855595, 0.01552849702097202, 0.004014105484481858, 0.06465076979012985, -0.039782967692158264, -0.026552040947699612, -0.09136938584260354, 0.08979206622998104, 0.10354776573257152, 0.06016196424885624, -0.04560536084714053, -0.14139029132410494, -0.07636679164952173, 0.03660644477352106, -0.15836868800669332, -0.3884030259133151] %, RMSE: [0.6640515951693219, 0.8452102044719014, 0.9166451373407936, 0.9602084873446747, 0.9994481934959512, 0.9996028558166982, 0.947824333223581, 0.8880021977588242, 0.9004091083985257, 0.9391758422790065, 1.0151690957468975, 1.0670525124544181, 1.1026600763744958, 1.0581027241154628, 1.0163549264657108, 0.975007554887419, 1.0053211352028146, 0.9956633741058573, 1.0552293009376117, 1.0873362594296867, 1.1425594003119772, 1.1315332045546747, 1.076633789219905, 1.0100933232997338, 0.9806836884291691, 1.0001516015929823, 1.0567833408668221, 1.120137975487968, 1.146682944762372, 1.1268956822652636, 1.0426102872557592, 1.0586579986058455]
test loss: NIL 
MAE: [0.38448058972749666, 0.5272964297634425, 0.5777839527624784, 0.6239325123543361, 0.67162949940785, 0.6864251050218633, 0.6606226010791737, 0.6172187958586692, 0.6396225594487234, 0.6870380288592933, 0.7468917888548878, 0.7899779197943311, 0.8195302251903053, 0.795780033164264, 0.758433889694435, 0.7367541856176614, 0.7624288589088726, 0.7700252849195806, 0.817450887086158, 0.8349910662369322, 0.8737901373660749, 0.8684334798134172, 0.8136441641175141, 0.7685828797476961, 0.7538295663827934, 0.7684975573193935, 0.8046750455219106, 0.8499283545172399, 0.8627793196849909, 0.854422284658883, 0.7777692733874506, 0.7905614642829625] , MAPE: [0.15023540857911172, 0.1888477379324385, 0.2901186307586838, 0.17969691988097541, 0.11623546575434318, 0.15741158368284383, 0.07500485472107929, 0.0824710990730481, 0.05576000640867278, 0.15995767837119743, 0.10500264597906055, 0.04798770617072506, -0.06252347466367769, -0.0516508720293218, -0.15141923829731316, -0.05645988511826516, 0.005343488339855595, 0.01552849702097202, 0.004014105484481858, 0.06465076979012985, -0.039782967692158264, -0.026552040947699612, -0.09136938584260354, 0.08979206622998104, 0.10354776573257152, 0.06016196424885624, -0.04560536084714053, -0.14139029132410494, -0.07636679164952173, 0.03660644477352106, -0.15836868800669332, -0.3884030259133151] %, RMSE: [0.6640515951693219, 0.8452102044719014, 0.9166451373407936, 0.9602084873446747, 0.9994481934959512, 0.9996028558166982, 0.947824333223581, 0.8880021977588242, 0.9004091083985257, 0.9391758422790065, 1.0151690957468975, 1.0670525124544181, 1.1026600763744958, 1.0581027241154628, 1.0163549264657108, 0.975007554887419, 1.0053211352028146, 0.9956633741058573, 1.0552293009376117, 1.0873362594296867, 1.1425594003119772, 1.1315332045546747, 1.076633789219905, 1.0100933232997338, 0.9806836884291691, 1.0001516015929823, 1.0567833408668221, 1.120137975487968, 1.146682944762372, 1.1268956822652636, 1.0426102872557592, 1.0586579986058455]
====================
training elapsedd with 256.86 seconds for 100 iterations, the sec/iter = 2.57

MAE_mean: [0.38448059 0.52729643 0.57778395 0.62393251 0.6716295  0.68642511
 0.6606226  0.6172188  0.63962256 0.68703803 0.74689179 0.78997792
 0.81953023 0.79578003 0.75843389 0.73675419 0.76242886 0.77002528
 0.81745089 0.83499107 0.87379014 0.86843348 0.81364416 0.76858288
 0.75382957 0.76849756 0.80467505 0.84992835 0.86277932 0.85442228
 0.77776927 0.79056146] , MAPE_mean: [ 0.15023541  0.18884774  0.29011863  0.17969692  0.11623547  0.15741158
  0.07500485  0.0824711   0.05576001  0.15995768  0.10500265  0.04798771
 -0.06252347 -0.05165087 -0.15141924 -0.05645989  0.00534349  0.0155285
  0.00401411  0.06465077 -0.03978297 -0.02655204 -0.09136939  0.08979207
  0.10354777  0.06016196 -0.04560536 -0.14139029 -0.07636679  0.03660644
 -0.15836869 -0.38840303] , RMSE_mean: [0.6640516  0.8452102  0.91664514 0.96020849 0.99944819 0.99960286
 0.94782433 0.8880022  0.90040911 0.93917584 1.0151691  1.06705251
 1.10266008 1.05810272 1.01635493 0.97500755 1.00532114 0.99566337
 1.0552293  1.08733626 1.1425594  1.1315332  1.07663379 1.01009332
 0.98068369 1.0001516  1.05678334 1.12013798 1.14668294 1.12689568
 1.04261029 1.058658  ]

MAE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , MAPE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , RMSE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
Finished training with: lr1e-4_bs256_nh64_ra1e-5_dp0.2_wd1e-6_ah1_ck5_kt6
user config:
seed 666
device 0
scaler StandardScaler()
day_slot 288
n_route 10
n_his 96
n_pred 96
n_train 34
n_val 5
n_test 5
mode 1
n_c 10
model STAGNN_stamp
TPG TPGNN
name lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6
log_path log/TPGNN_r05p02kt3outer_270
crash 270
new_name TPGNN_r05p02kt3outer_270
batch_size 256
lr 0.0001
a 0.1
r 0.5
n_mask 1
adam {'use': True, 'weight_decay': 0.0001}
slr {'use': True, 'step_size': 400, 'gamma': 0.3}
resume False
start_epoch 0
epochs 100
n_layer 1
n_attr 64
n_hid 64
reg_A 1e-05
circle 288
drop_prob 0.3
CE {'use': True, 'kernel_size': 1, 'bias': False}
LE {'use': False, 'bias': False}
SE {'use': True, 'separate': True, 'no': False}
TE {'use': True, 'no': True}
attn {'head': 1, 'd_k': 32, 'd_v': 32, 'drop_prob': 0.2}
STstamp {'use': True, 'kt': 3, 'temperature': 1.0}
T4N {'use': True, 'step': 2, 'end_epoch': 10000, 'change_head': True, 'change_enc': True}
stamp_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/time_stamp.npy
data_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/V_France_processed_0.csv
adj_matrix_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/W_France_processed_0.csv
dis_mat tensor([[0.0000, 0.3661, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.6136, 0.0000,
         0.0000],
        [0.3661, 0.0000, 0.0000, 0.0000, 0.1098, 0.0000, 0.0000, 0.8975, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.3410, 0.8975, 0.0000, 0.0000, 0.0000, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.3410, 0.0000, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000,
         0.1494],
        [0.0000, 0.1098, 0.8975, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000, 0.6996,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000,
         0.2289],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000, 0.0000,
         0.5594],
        [0.6136, 0.8975, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.2117,
         0.0000],
        [0.0000, 0.4288, 0.4288, 0.0000, 0.6996, 0.0000, 0.0000, 0.2117, 0.0000,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.1494, 0.0000, 0.2289, 0.5594, 0.0000, 0.0000,
         0.0000]], device='cuda:0')
prefix log/lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6/
checkpoint_temp_path log/lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6//temp.pth
checkpoint_best_path log/lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6//best.pth
tensorboard_path log/lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6/
record_path log/lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6/record.txt
eps 0.1
parse <bound method DefaultConfig.parse of <config.DefaultConfig object at 0x7fe3e0f24550>>
output <bound method DefaultConfig.output of <config.DefaultConfig object at 0x7fe3e0f24550>>
train: True, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 9792
len(data): 9792, day_slot: 288, n_day: 34
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
10 10
epoch 0   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 1.6792211899390588 , validation loss: 1.1851544976234436
epoch 1   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 1.5185035650546734 , validation loss: 1.1140466928482056
epoch 2   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 1.3374800406969511 , validation loss: 1.01089745759964
epoch 3   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 1.1865646105546217 , validation loss: 0.9538418352603912
epoch 4   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 1.0958230220354521 , validation loss: 0.9325990974903107
epoch 5   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 1.025645755804502 , validation loss: 0.9298098683357239
epoch 6   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.9650655022034278 , validation loss: 0.9129803776741028
epoch 7   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.9099899071913499 , validation loss: 0.9393837749958038
epoch 8   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.8587861932241 , validation loss: 0.9371263086795807
epoch 9   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.8078801081730769 , validation loss: 0.9485608339309692
epoch 10   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.7588169116240281 , validation loss: 0.9796642959117889
epoch 11   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.7145007436092083 , validation loss: 0.9675249457359314
epoch 12   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.6745715003747207 , validation loss: 0.9824877679347992
epoch 13   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.6413380182706393 , validation loss: 0.9911732971668243
epoch 14   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.6144589781761169 , validation loss: 0.997817188501358
epoch 15   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.5928339178745563 , validation loss: 0.9840466678142548
epoch 16   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.577493415429042 , validation loss: 0.9976689517498016
epoch 17   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.5664343192027166 , validation loss: 1.0063573718070984
epoch 18   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.5574749937424293 , validation loss: 1.0166581869125366
epoch 19   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.5487374296555152 , validation loss: 1.0117241144180298
epoch 20   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.5427149671774644 , validation loss: 1.0200295448303223
epoch 21   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.536139387350816 , validation loss: 1.030063509941101
epoch 22   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.5302627911934485 , validation loss: 1.0344258546829224
epoch 23   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.5246193133867704 , validation loss: 1.01760333776474
epoch 24   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.5193030513249911 , validation loss: 1.0215543508529663
epoch 25   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.515136902148907 , validation loss: 1.018211305141449
epoch 26   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.5103568984911993 , validation loss: 1.004889726638794
epoch 27   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.5059858285463773 , validation loss: 1.0176399946212769
epoch 28   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.5015703875284928 , validation loss: 1.0212367177009583
epoch 29   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.49785664448371303 , validation loss: 1.0203514099121094
epoch 30   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.4942878805674039 , validation loss: 1.0221988558769226
epoch 31   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.49049521868045515 , validation loss: 1.0260136723518372
epoch 32   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.4873685378294725 , validation loss: 0.9893361926078796
epoch 33   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.48371192583670986 , validation loss: 1.0051794946193695
epoch 34   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.48091440017406756 , validation loss: 1.0238738656044006
epoch 35   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.47798293141218334 , validation loss: 1.0029348134994507
epoch 36   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.4748690655598274 , validation loss: 1.001945286989212
epoch 37   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.4721490924174969 , validation loss: 0.9990359246730804
epoch 38   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.46894986354387724 , validation loss: 1.0009089708328247
epoch 39   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.46624599741055417 , validation loss: 0.9967332184314728
epoch 40   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.4634007192575015 , validation loss: 1.0013297200202942
epoch 41   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.46102971067795384 , validation loss: 0.984850138425827
epoch 42   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.45892988718472993 , validation loss: 0.9820191264152527
epoch 43   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.45582296068851763 , validation loss: 0.9859442114830017
epoch 44   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.4538008960393759 , validation loss: 0.9836781322956085
epoch 45   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.4511450735422281 , validation loss: 0.9781379103660583
epoch 46   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.44899370349370515 , validation loss: 0.9739846587181091
epoch 47   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.4464184091641353 , validation loss: 0.9683598279953003
epoch 48   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.44420373898286086 , validation loss: 0.9717565178871155
epoch 49   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.4424694570211264 , validation loss: 0.9580793380737305
epoch 50   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.43980977168449986 , validation loss: 0.9683144986629486
epoch 51   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.4377143910297981 , validation loss: 0.976385623216629
epoch 52   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.4353230412189777 , validation loss: 0.9663864970207214
epoch 53   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.4334443394954388 , validation loss: 0.9608288705348969
epoch 54   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.4317493186547206 , validation loss: 0.9480835795402527
epoch 55   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.4293069037107321 , validation loss: 0.9496511220932007
epoch 56   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.4275528903190906 , validation loss: 0.9460538625717163
epoch 57   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.42537588568834156 , validation loss: 0.9440797865390778
epoch 58   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.42411992183098424 , validation loss: 0.9413095116615295
epoch 59   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.4223138208572681 , validation loss: 0.9446426033973694
epoch 60   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.4203570897762592 , validation loss: 0.9410657584667206
epoch 61   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.41890565248636097 , validation loss: 0.940102607011795
epoch 62   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.41689116679705107 , validation loss: 0.9524968862533569
epoch 63   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.4156015698726361 , validation loss: 0.9381861686706543
epoch 64   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.41367780245267427 , validation loss: 0.9379186630249023
epoch 65   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.412611722946167 , validation loss: 0.9625105857849121
epoch 66   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.4106412186072423 , validation loss: 0.9322631359100342
epoch 67   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.40912973193021923 , validation loss: 0.9336230754852295
epoch 68   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.40734765850580656 , validation loss: 0.9227905571460724
epoch 69   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.40626276914889997 , validation loss: 0.9341985881328583
epoch 70   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.4044951773606814 , validation loss: 0.9141129553318024
epoch 71   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.40345966128202587 , validation loss: 0.9205454587936401
epoch 72   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.4021845047290509 , validation loss: 0.9281725585460663
epoch 73   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.4004323482513428 , validation loss: 0.9374578297138214
epoch 74   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.39944902062416077 , validation loss: 0.9359241724014282
epoch 75   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.398085186114678 , validation loss: 0.9375205338001251
epoch 76   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.3965711845801427 , validation loss: 0.9299660325050354
epoch 77   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.39563795694938075 , validation loss: 0.937797337770462
epoch 78   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.39446264734634984 , validation loss: 0.9248093664646149
epoch 79   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.3927150322840764 , validation loss: 0.9179964959621429
epoch 80   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.39208219143060535 , validation loss: 0.9412212371826172
epoch 81   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.39053834401644194 , validation loss: 0.9214814603328705
epoch 82   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.3893005664532001 , validation loss: 0.9310272634029388
epoch 83   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.38827876632030195 , validation loss: 0.9338566660881042
epoch 84   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.386801533974134 , validation loss: 0.930581271648407
epoch 85   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.3862676758032579 , validation loss: 0.9270501434803009
epoch 86   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.3847603156016423 , validation loss: 0.9135719835758209
epoch 87   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.38366835621687084 , validation loss: 0.9330655932426453
epoch 88   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.3828635926430042 , validation loss: 0.91178297996521
epoch 89   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.3817293047904968 , validation loss: 0.9129255414009094
epoch 90   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.3801967020218189 , validation loss: 0.9245183765888214
epoch 91   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.37887946917460513 , validation loss: 0.9314940869808197
epoch 92   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.3774855618293469 , validation loss: 0.9092182815074921
epoch 93   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.37684571284514207 , validation loss: 0.9166521430015564
epoch 94   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.37602195831445545 , validation loss: 0.8979144096374512
epoch 95   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.37521217190302336 , validation loss: 0.9258950650691986
epoch 96   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.37371575832366943 , validation loss: 0.9327746331691742
tensor(75.7661, device='cuda:0')
MAE: [0.4140966330092765, 0.5646448633560585, 0.6260082674202192, 0.6811264253413477, 0.7264159240754149, 0.7181502590547364, 0.6935039991499453, 0.6699244005703512, 0.7016705332846217, 0.7607364047674904, 0.8361555723619369, 0.8946580673823344, 0.9172741231575762, 0.8926260214763665, 0.8517767453570034, 0.8334480934025547, 0.8702524584827503, 0.8948354283731776, 0.9507120435558183, 0.9891533048066896, 1.0288104452887914, 1.0152458688789576, 0.9599306302003024, 0.9226751227139197, 0.9114232335539688, 0.9461066711284988, 0.9897736779344748, 1.0445903641799676, 1.0541190470132937, 1.0370719429070956, 0.9702989542806886, 0.981185044158903] , MAPE: [0.1442580921976293, 0.10592009699112524, 0.3069941258354796, 0.2535934313114603, 0.17691847392259022, 0.1416456736526818, 0.02927237083418919, 0.042363770954783754, 0.0077633039692426384, 0.07284958655929605, 0.011086533728887366, 0.024043456033222797, -0.17658899676972836, -0.11315045326927763, -0.18864365845107348, -0.07471625512963971, -0.1439168041271065, -0.068365509834539, -0.08266195596992662, -0.04721430824276542, -0.26940407709235287, -0.21110656561127827, -0.1547915679192892, -0.013261461552777376, -0.1100940501766721, -0.10394894170875596, -0.1019985374835165, -0.34085399782707604, -0.30720267789427563, -0.13209058549527194, -0.27512292561818874, -0.4940435885390736] %, RMSE: [0.7125768278541188, 0.893254943648436, 0.9678404658267336, 1.0186303484177546, 1.0468494277184126, 1.018796242417994, 0.9662856359012515, 0.924727612145683, 0.9522751955085531, 1.0092559884226708, 1.1002565297807256, 1.1651067655703315, 1.189253100087934, 1.1495989917304243, 1.0993303687429976, 1.0648345404984223, 1.1124968154877848, 1.1297422545079208, 1.1928816610541793, 1.2482021539283763, 1.2974568046405832, 1.28406424802118, 1.2283595557451537, 1.1855967162231247, 1.157859531579085, 1.1959596854650973, 1.2556174535367264, 1.3212173492738493, 1.3385556180143678, 1.3087874984604706, 1.2445336825816662, 1.2564862095133535]
epoch 97   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.37271658732340884 , validation loss: 0.9286281168460846
tensor(75.6821, device='cuda:0')
MAE: [0.40701036668752233, 0.5617273545405376, 0.6307130557420596, 0.6714247908325117, 0.7164648126726298, 0.7167408610383029, 0.6990086743743494, 0.6606518829191469, 0.6990881984256515, 0.7509359500369, 0.8123926558539502, 0.8652611617841902, 0.8989418730569869, 0.87552768702782, 0.8339608904106792, 0.8073506400254123, 0.8490696299959397, 0.8665900862647086, 0.905459821189264, 0.9339417321918552, 0.977887846948867, 0.974029302133881, 0.9283513699763829, 0.8914645048772398, 0.8877750185400862, 0.9143459920596677, 0.9386848061297511, 0.9833350830167993, 0.9973915694472044, 0.9949775889704061, 0.9462522934000824, 0.9640938381720142] , MAPE: [0.1321177681465802, 0.09308020629690836, 0.24248613926291, 0.20870973512964183, 0.22191950091171037, 0.1351756172098181, 0.035027951657239195, 0.003692892127605539, 0.03692355231136821, 0.0801907132595094, -0.0010283851892400543, -0.012069653194822543, -0.1216671123146387, -0.05332158668722823, -0.15545206641737544, -0.1533302953610672, -0.12042908628229364, -0.12827174294924787, -0.1277485743833564, -0.14666418963319114, -0.13645549634016677, -0.0989384733614381, -0.11527421096012179, -0.032210355590064, -0.11766002003000281, -0.058314175417007084, -0.12698802383968213, -0.28008440473869284, -0.33337227457157065, -0.21935103343597784, -0.26927647055382137, -0.6502093372459687] %, RMSE: [0.7036526309584984, 0.8855537968292686, 0.9681460611045604, 1.008082985154974, 1.031051531270625, 1.0116633758408802, 0.96947588495726, 0.9155030903469473, 0.9521624141495391, 1.0016986183843113, 1.0809543658927618, 1.141258246085452, 1.1698502248965525, 1.1241998672767728, 1.074831637812304, 1.0340429764600207, 1.0876436243171053, 1.0947231086282183, 1.1437324440822716, 1.1866297872869014, 1.2345948430790716, 1.2296829833725065, 1.1892877765472543, 1.1471090198017662, 1.1244665093995478, 1.1558573267065013, 1.1993467397353725, 1.252754452667228, 1.2695188246127882, 1.2541730794211257, 1.2090906045007126, 1.2342812036948732]
epoch 98   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.37232945286310637 , validation loss: 0.8911190927028656
tensor(75.5996, device='cuda:0')
MAE: [0.40669139987174613, 0.5529962307473011, 0.603311469948457, 0.6530902482598021, 0.703926886850488, 0.7049786630927671, 0.6711089130857787, 0.6373292205225407, 0.6732724000425222, 0.7135349244224963, 0.7713107445121733, 0.8288135229661754, 0.8580105326269014, 0.8405252686016185, 0.802570948190219, 0.772850742348153, 0.8086551498383591, 0.8216327907452263, 0.8581291237043351, 0.8890082787322937, 0.9281449889499195, 0.9274229316144568, 0.872199659581037, 0.8295876742035304, 0.8268483561471335, 0.8477943314008952, 0.8660173925342634, 0.9129151148733097, 0.9367461459119756, 0.9335880000297864, 0.8739316868363428, 0.8868790176096036] , MAPE: [0.14157841324305223, 0.09107870167984955, 0.27222160803124107, 0.22501643249500328, 0.20716166758814408, 0.09709517312783403, 0.027944170734461052, 0.03293111387674892, 0.030877968581074118, 0.07451553028045683, 0.029696144550053413, 0.006516977650720684, -0.18596525835043742, -0.08673465462015359, -0.1813736476394175, -0.1156254186872429, -0.14642855222761503, -0.06486226187768385, -0.08295404305658784, -0.05066650167650607, -0.2309409894438482, -0.07413825015448479, -0.10986412512062951, 0.04204507672345759, -0.0986346992753511, -0.030226375427725365, -0.02132045173718109, -0.31583254500522073, -0.36818088121259746, -0.26898988917791244, -0.20730056011791734, -0.592806473299897] %, RMSE: [0.7001487600098626, 0.8808546138002596, 0.9437333835670848, 0.9954977045508028, 1.0288588382324186, 1.0105720495398776, 0.9525869561688658, 0.9025241227535249, 0.9337664015662887, 0.9750457510394763, 1.0549682149605104, 1.1182720334666343, 1.1477671285779214, 1.1093430060355967, 1.0634761588361767, 1.0158385788435593, 1.063676771611562, 1.0672786826863572, 1.1154694897754127, 1.1622403750464847, 1.207998068632481, 1.2046608749072485, 1.14999040309244, 1.1009454777963947, 1.0813078908856968, 1.1067632043762903, 1.147266635406648, 1.206235071959244, 1.2334602500174965, 1.21691446407673, 1.1609399753124172, 1.1800576153569102]
epoch 99   lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6 , train loss: 0.37142908114653367 , validation loss: 0.9050579965114594
tensor(75.5174, device='cuda:0')
MAE: [0.40179632587415964, 0.5456849794623625, 0.6033643843542746, 0.6544759078700211, 0.6964324360185293, 0.7001728509454844, 0.6730781984548132, 0.6334808584905623, 0.6604148184269973, 0.7070256839782845, 0.7718515615695223, 0.8250442223385284, 0.8466928422320442, 0.8126983356698579, 0.7672569869771677, 0.7321627167568149, 0.7611610761968438, 0.7819114914620967, 0.8388130509765032, 0.8701541616014906, 0.8999592700385556, 0.8738062465686313, 0.8126786764718823, 0.7550332936060797, 0.7415279809946251, 0.7783638615683489, 0.8257218531400119, 0.8801258737962577, 0.8840366039494264, 0.8567153033982847, 0.7711526633875886, 0.7702832750207984] , MAPE: [0.15376705785781822, 0.17640829061333224, 0.34420017283305343, 0.2812221045355605, 0.21590122257647515, 0.23532519639004623, 0.12454988182488752, 0.10782508908733174, 0.09213054828844366, 0.18373723503106187, 0.14076283096326228, 0.12008371268146127, 0.005047025758468248, 0.07015921010596637, 0.009339869451431854, 0.008355187559413325, 0.1355196694346013, 0.02971971987352254, 0.10572397692886315, 0.08524255261996999, 0.04444560719637612, 0.07153755593819894, 0.046304348464731186, 0.16677004889700292, 0.16736116530959258, 0.1520434923490018, 0.09423651257983627, 0.014090932849013398, -0.04870663175414575, 0.17588533328297926, 0.11092573627378892, -0.08359560597640328] %, RMSE: [0.6994758683620392, 0.8794136786729172, 0.9519596581685466, 1.003255168233632, 1.0293728481176183, 1.0125836777638273, 0.9610780855064848, 0.90356188031513, 0.927581522845076, 0.968643328960344, 1.0562776387534267, 1.1193672595010817, 1.1446341960263062, 1.0884446223163076, 1.0304774096886684, 0.9771152946148746, 1.0154972329579863, 1.0220184584275427, 1.092588966030973, 1.1469858451010964, 1.1858792827176619, 1.1544956688405128, 1.0846814976123393, 1.0127157460026137, 0.9836156944976853, 1.0240697300434147, 1.1007895999332205, 1.1768208583506325, 1.1909056193109424, 1.1456155458429473, 1.0501555349665286, 1.0526992663280468]
test loss: NIL 
MAE: [0.40179632587415964, 0.5456849794623625, 0.6033643843542746, 0.6544759078700211, 0.6964324360185293, 0.7001728509454844, 0.6730781984548132, 0.6334808584905623, 0.6604148184269973, 0.7070256839782845, 0.7718515615695223, 0.8250442223385284, 0.8466928422320442, 0.8126983356698579, 0.7672569869771677, 0.7321627167568149, 0.7611610761968438, 0.7819114914620967, 0.8388130509765032, 0.8701541616014906, 0.8999592700385556, 0.8738062465686313, 0.8126786764718823, 0.7550332936060797, 0.7415279809946251, 0.7783638615683489, 0.8257218531400119, 0.8801258737962577, 0.8840366039494264, 0.8567153033982847, 0.7711526633875886, 0.7702832750207984] , MAPE: [0.15376705785781822, 0.17640829061333224, 0.34420017283305343, 0.2812221045355605, 0.21590122257647515, 0.23532519639004623, 0.12454988182488752, 0.10782508908733174, 0.09213054828844366, 0.18373723503106187, 0.14076283096326228, 0.12008371268146127, 0.005047025758468248, 0.07015921010596637, 0.009339869451431854, 0.008355187559413325, 0.1355196694346013, 0.02971971987352254, 0.10572397692886315, 0.08524255261996999, 0.04444560719637612, 0.07153755593819894, 0.046304348464731186, 0.16677004889700292, 0.16736116530959258, 0.1520434923490018, 0.09423651257983627, 0.014090932849013398, -0.04870663175414575, 0.17588533328297926, 0.11092573627378892, -0.08359560597640328] %, RMSE: [0.6994758683620392, 0.8794136786729172, 0.9519596581685466, 1.003255168233632, 1.0293728481176183, 1.0125836777638273, 0.9610780855064848, 0.90356188031513, 0.927581522845076, 0.968643328960344, 1.0562776387534267, 1.1193672595010817, 1.1446341960263062, 1.0884446223163076, 1.0304774096886684, 0.9771152946148746, 1.0154972329579863, 1.0220184584275427, 1.092588966030973, 1.1469858451010964, 1.1858792827176619, 1.1544956688405128, 1.0846814976123393, 1.0127157460026137, 0.9836156944976853, 1.0240697300434147, 1.1007895999332205, 1.1768208583506325, 1.1909056193109424, 1.1456155458429473, 1.0501555349665286, 1.0526992663280468]
====================
training elapsedd with 256.99 seconds for 100 iterations, the sec/iter = 2.57

MAE_mean: [0.40179633 0.54568498 0.60336438 0.65447591 0.69643244 0.70017285
 0.6730782  0.63348086 0.66041482 0.70702568 0.77185156 0.82504422
 0.84669284 0.81269834 0.76725699 0.73216272 0.76116108 0.78191149
 0.83881305 0.87015416 0.89995927 0.87380625 0.81267868 0.75503329
 0.74152798 0.77836386 0.82572185 0.88012587 0.8840366  0.8567153
 0.77115266 0.77028328] , MAPE_mean: [ 0.15376706  0.17640829  0.34420017  0.2812221   0.21590122  0.2353252
  0.12454988  0.10782509  0.09213055  0.18373724  0.14076283  0.12008371
  0.00504703  0.07015921  0.00933987  0.00835519  0.13551967  0.02971972
  0.10572398  0.08524255  0.04444561  0.07153756  0.04630435  0.16677005
  0.16736117  0.15204349  0.09423651  0.01409093 -0.04870663  0.17588533
  0.11092574 -0.08359561] , RMSE_mean: [0.69947587 0.87941368 0.95195966 1.00325517 1.02937285 1.01258368
 0.96107809 0.90356188 0.92758152 0.96864333 1.05627764 1.11936726
 1.1446342  1.08844462 1.03047741 0.97711529 1.01549723 1.02201846
 1.09258897 1.14698585 1.18587928 1.15449567 1.0846815  1.01271575
 0.98361569 1.02406973 1.1007896  1.17682086 1.19090562 1.14561555
 1.05015553 1.05269927]

MAE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , MAPE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , RMSE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
Finished training with: lr1e-4_bs256_nh64_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt6
user config:
seed 666
device 0
scaler StandardScaler()
day_slot 288
n_route 10
n_his 96
n_pred 96
n_train 34
n_val 5
n_test 5
mode 1
n_c 10
model STAGNN_stamp
TPG TPGNN
name lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6
log_path log/TPGNN_r05p02kt3outer_272
crash 272
new_name TPGNN_r05p02kt3outer_272
batch_size 256
lr 0.001
a 0.1
r 0.5
n_mask 1
adam {'use': True, 'weight_decay': 0.0001}
slr {'use': True, 'step_size': 400, 'gamma': 0.3}
resume False
start_epoch 0
epochs 100
n_layer 1
n_attr 64
n_hid 128
reg_A 0.001
circle 288
drop_prob 0.2
CE {'use': True, 'kernel_size': 1, 'bias': False}
LE {'use': False, 'bias': False}
SE {'use': True, 'separate': True, 'no': False}
TE {'use': True, 'no': True}
attn {'head': 1, 'd_k': 32, 'd_v': 32, 'drop_prob': 0.2}
STstamp {'use': True, 'kt': 3, 'temperature': 1.0}
T4N {'use': True, 'step': 2, 'end_epoch': 10000, 'change_head': True, 'change_enc': True}
stamp_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/time_stamp.npy
data_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/V_France_processed_0.csv
adj_matrix_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/W_France_processed_0.csv
dis_mat tensor([[0.0000, 0.3661, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.6136, 0.0000,
         0.0000],
        [0.3661, 0.0000, 0.0000, 0.0000, 0.1098, 0.0000, 0.0000, 0.8975, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.3410, 0.8975, 0.0000, 0.0000, 0.0000, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.3410, 0.0000, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000,
         0.1494],
        [0.0000, 0.1098, 0.8975, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000, 0.6996,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000,
         0.2289],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000, 0.0000,
         0.5594],
        [0.6136, 0.8975, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.2117,
         0.0000],
        [0.0000, 0.4288, 0.4288, 0.0000, 0.6996, 0.0000, 0.0000, 0.2117, 0.0000,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.1494, 0.0000, 0.2289, 0.5594, 0.0000, 0.0000,
         0.0000]], device='cuda:0')
prefix log/lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6/
checkpoint_temp_path log/lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6//temp.pth
checkpoint_best_path log/lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6//best.pth
tensorboard_path log/lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6/
record_path log/lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6/record.txt
eps 0.1
parse <bound method DefaultConfig.parse of <config.DefaultConfig object at 0x7f1a44792550>>
output <bound method DefaultConfig.output of <config.DefaultConfig object at 0x7f1a44792550>>
train: True, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 9792
len(data): 9792, day_slot: 288, n_day: 34
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
10 10
epoch 0   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 3.540118327507606 , validation loss: 1.3061009049415588
epoch 1   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 2.9155045472658596 , validation loss: 1.1221630573272705
epoch 2   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 2.6940521276914158 , validation loss: 1.115014135837555
epoch 3   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 2.5458465356093187 , validation loss: 1.0133000910282135
epoch 4   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 2.431601506013137 , validation loss: 0.9964486360549927
epoch 5   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 2.331961448375995 , validation loss: 0.972064346075058
epoch 6   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 2.2428018679985633 , validation loss: 0.9455913007259369
epoch 7   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 2.1603512947375956 , validation loss: 0.9219788908958435
epoch 8   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 2.0843262672424316 , validation loss: 0.9263511300086975
epoch 9   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 2.012257511799152 , validation loss: 0.9423871040344238
epoch 10   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 1.9448089599609375 , validation loss: 0.8946908712387085
epoch 11   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 1.8801982219402606 , validation loss: 0.8821909725666046
epoch 12   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 1.818776772572444 , validation loss: 0.8682670593261719
epoch 13   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 1.7605832723470836 , validation loss: 0.8638841509819031
epoch 14   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 1.7044685437129095 , validation loss: 0.8877768814563751
epoch 15   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 1.6509237747925978 , validation loss: 0.851800799369812
epoch 16   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 1.599683669897226 , validation loss: 0.8706492483615875
epoch 17   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 1.5475618564165556 , validation loss: 0.7869176268577576
epoch 18   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 1.5017112401815562 , validation loss: 0.7963429987430573
epoch 19   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 1.4563001302572398 , validation loss: 0.7801268398761749
epoch 20   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 1.4131782329999483 , validation loss: 0.7311691641807556
epoch 21   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 1.3746188145417433 , validation loss: 0.7749212682247162
epoch 22   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 1.3355351227980394 , validation loss: 0.7580622732639313
epoch 23   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 1.298711428275475 , validation loss: 0.7210533320903778
epoch 24   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 1.2638879464222834 , validation loss: 0.7154090404510498
epoch 25   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 1.2328739074560313 , validation loss: 0.7032743692398071
epoch 26   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 1.199776530265808 , validation loss: 0.7170557081699371
epoch 27   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 1.1699132094016442 , validation loss: 0.7063164710998535
epoch 28   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 1.14035492676955 , validation loss: 0.7093771696090698
epoch 29   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 1.1133138491557195 , validation loss: 0.6977922916412354
epoch 30   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 1.0872168632654042 , validation loss: 0.7646363079547882
epoch 31   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 1.0607118698266835 , validation loss: 0.6967507302761078
epoch 32   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 1.0366164537576528 , validation loss: 0.6974912881851196
epoch 33   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 1.0146498680114746 , validation loss: 0.7229187488555908
epoch 34   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.99298279102032 , validation loss: 0.6886868476867676
epoch 35   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.9706032780500559 , validation loss: 0.6991415023803711
epoch 36   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.9502132764229407 , validation loss: 0.6968839466571808
epoch 37   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.9302162390488845 , validation loss: 0.69346684217453
epoch 38   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.9090719360571641 , validation loss: 0.6898130476474762
epoch 39   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.8905915709642264 , validation loss: 0.8010067343711853
epoch 40   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.8721030079401456 , validation loss: 0.6950564384460449
epoch 41   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.8547650896585904 , validation loss: 0.7564577460289001
epoch 42   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.8384980513499334 , validation loss: 0.6905991733074188
epoch 43   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.8212452897658715 , validation loss: 0.696619063615799
epoch 44   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.8054284269993122 , validation loss: 0.7030064463615417
epoch 45   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.789250754393064 , validation loss: 0.6745974719524384
epoch 46   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.7749152550330529 , validation loss: 0.6779979467391968
epoch 47   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.7627155505693876 , validation loss: 0.6821416914463043
epoch 48   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.7480604281792274 , validation loss: 0.6783774197101593
epoch 49   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.7324938774108887 , validation loss: 0.6917014122009277
epoch 50   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.7203828875835125 , validation loss: 0.6942430138587952
epoch 51   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.7070116446568415 , validation loss: 0.6673838496208191
epoch 52   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.6955017447471619 , validation loss: 0.7396570444107056
epoch 53   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.6841927033204299 , validation loss: 0.6832976043224335
epoch 54   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.672984989789816 , validation loss: 0.6878732442855835
epoch 55   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.6606668784068181 , validation loss: 0.6731973886489868
epoch 56   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.6511299976935754 , validation loss: 0.7175256609916687
epoch 57   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.6394434525416448 , validation loss: 0.6737081110477448
epoch 58   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.6290692732884333 , validation loss: 0.7150630056858063
epoch 59   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.6192554373007554 , validation loss: 0.6687295734882355
epoch 60   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.6097933512467605 , validation loss: 0.7116407752037048
epoch 61   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.6015430826407212 , validation loss: 0.6758899092674255
epoch 62   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.5919701548723074 , validation loss: 0.7341614663600922
epoch 63   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.5834110470918509 , validation loss: 0.6673352420330048
epoch 64   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.5746349463096032 , validation loss: 0.7740252614021301
epoch 65   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.5674089651841384 , validation loss: 0.6729432940483093
epoch 66   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.5583933866941012 , validation loss: 0.7228983342647552
epoch 67   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.5499303340911865 , validation loss: 0.6919398605823517
epoch 68   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.5428463587394128 , validation loss: 0.6679191291332245
epoch 69   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.535546600818634 , validation loss: 0.7094963490962982
epoch 70   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.5280020053570087 , validation loss: 0.6679733991622925
epoch 71   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.5213064826451815 , validation loss: 0.7028341889381409
epoch 72   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.51522735448984 , validation loss: 0.7201924920082092
epoch 73   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.5084982560231135 , validation loss: 0.6747284531593323
epoch 74   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.5020656379369589 , validation loss: 0.6689044535160065
epoch 75   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.4952514675947336 , validation loss: 0.6765885651111603
epoch 76   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.4898609725328592 , validation loss: 0.7371176779270172
epoch 77   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.48352593871263355 , validation loss: 0.6597106754779816
epoch 78   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.4784089212234204 , validation loss: 0.6560417711734772
epoch 79   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.4714382290840149 , validation loss: 0.7075749039649963
epoch 80   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.4676411747932434 , validation loss: 0.6943509876728058
epoch 81   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.4621745554300455 , validation loss: 0.7522110641002655
epoch 82   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.4561753800282112 , validation loss: 0.6836914718151093
epoch 83   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.4509128194588881 , validation loss: 0.6765825748443604
epoch 84   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.4461018718205966 , validation loss: 0.7549762427806854
epoch 85   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.4416540333857903 , validation loss: 0.6583601832389832
epoch 86   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.4362866167838757 , validation loss: 0.6761301159858704
epoch 87   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.4320875177016625 , validation loss: 0.7260346412658691
epoch 88   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.4283592700958252 , validation loss: 0.6858586072921753
epoch 89   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.4231995504636031 , validation loss: 0.7198353707790375
epoch 90   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.4195113250842461 , validation loss: 0.6444456577301025
epoch 91   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.4141840705504784 , validation loss: 0.7372025549411774
epoch 92   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.41029823514131397 , validation loss: 0.6552148163318634
epoch 93   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.40724621369288516 , validation loss: 0.653232216835022
epoch 94   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.40324392227026135 , validation loss: 0.651416540145874
epoch 95   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.39900102523656994 , validation loss: 0.6490031778812408
epoch 96   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.3952504052565648 , validation loss: 0.699348658323288
tensor(43.6288, device='cuda:0')
MAE: [0.29946097939716865, 0.40418300319174977, 0.445012338446338, 0.46570797320935375, 0.5183695239331765, 0.5387743596436898, 0.5381475838056295, 0.5520587776548508, 0.569509091048511, 0.6105464475039277, 0.6252669871055051, 0.6286598497458263, 0.6464005474331452, 0.654334613554871, 0.6518997148168993, 0.6670220303166773, 0.675572389321805, 0.679054231068177, 0.6748165063558089, 0.6694124827166232, 0.6757204101071453, 0.6736210597250802, 0.6614666829961016, 0.6567485344537639, 0.6409893080924359, 0.6515519011516085, 0.6560772618681154, 0.6369109999216593, 0.6315223982679591, 0.621349768678168, 0.6057601285724392, 0.6113775119596382] , MAPE: [0.11304162529640868, 0.12231978350964129, 0.2161211206082833, 0.2648249740515189, 0.25500992664564376, 0.21169149299621456, 0.12959436048291498, 0.11679569311084144, 0.11419109952906324, 0.2418325221730209, 0.22683195312389534, 0.25602607848201026, 0.2560484532611901, 0.25542316378456703, 0.16866906513232552, 0.12656212638730702, 0.15830907784064527, 0.17379070546742068, 0.16230658343991028, 0.2057798200191835, 0.2542404387811482, 0.2516709995433657, 0.16217802962252256, 0.07320446835615829, 0.07126362032780889, 0.014992643748872107, -0.03723252129123232, -0.037636219465969484, -0.13434989597310726, -0.09579129672069199, -0.11120035492698821, -0.3287318186566579] %, RMSE: [0.5339962386545731, 0.6627160468900015, 0.7155444526373356, 0.7306852154129994, 0.7807525137790243, 0.8147745392698541, 0.8113116062532647, 0.8141463079292812, 0.8084809598688669, 0.8519257539675329, 0.8774369522194851, 0.8659765785629011, 0.8834077116650577, 0.9071314608062134, 0.902633793294783, 0.9182822170325147, 0.9137935330728804, 0.9091378107490525, 0.9062380303372256, 0.8960549339368407, 0.9036118238447852, 0.9178385003648178, 0.9026101041081479, 0.8951098687447991, 0.8681288927401849, 0.8723625131081024, 0.8816919190488295, 0.8502535177579402, 0.8465779310284394, 0.8472418198316043, 0.8274117545040925, 0.8345188417976456]
epoch 97   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.3921422247703259 , validation loss: 0.6499471068382263
tensor(43.4145, device='cuda:0')
MAE: [0.30000800705049185, 0.39682485369302944, 0.4542862402579805, 0.47279521896667087, 0.5172462191786041, 0.524708419823347, 0.5364009452411501, 0.5500981371308264, 0.5644012578259961, 0.5883045870954766, 0.609920330705318, 0.6035292002170817, 0.6167044455104882, 0.6292047894843998, 0.6449956609001479, 0.6431087072155217, 0.6513373395145784, 0.6550276585558871, 0.6633327366889828, 0.6600683522395329, 0.6545008504210212, 0.6587944206618463, 0.654264442694479, 0.6509094562300856, 0.6399303612535454, 0.6422089757256633, 0.6401794395006272, 0.6271771129604775, 0.6227292334764581, 0.6179211446994282, 0.6135374184106429, 0.6079135011827823] , MAPE: [0.0833139005189366, 0.09213424141585792, 0.14873387510114777, 0.21368113395278698, 0.179660082060227, 0.16283512176926904, 0.12190446582520213, 0.08835191647124599, 0.020232266365349732, 0.12260589898240479, 0.09596068393542868, 0.13806854210823377, 0.12249914967203837, 0.157811879280945, 0.11567184369660345, 0.05151587576284637, 0.027955568292790743, 0.04949299143535474, 0.05032016882419672, 0.04804830072471661, 0.04792585264186893, 0.07326749009366094, 0.07950320250184285, -0.03702689923811104, -0.0061117478116198215, -0.048085459427459204, -0.03944703680440932, -0.0354913236349059, -0.0633922200302066, -0.04504597184908356, -0.03576674304100548, -0.13495741338737924] %, RMSE: [0.5450596368153934, 0.6500101356797816, 0.720557674235649, 0.7427378684590775, 0.7886754594857635, 0.7886836574010853, 0.8001945158613676, 0.807566618917678, 0.812232346657697, 0.8256155124145019, 0.849472753491179, 0.8360486034985051, 0.8559916727879259, 0.876705037992132, 0.8890298898117469, 0.8828851140852957, 0.8924858863929874, 0.8824649002642275, 0.8836450862286219, 0.8822174070579945, 0.8779655520166711, 0.8817404309756747, 0.873471678302086, 0.8608031994654081, 0.8392084052337924, 0.8352328866684227, 0.8290981980294122, 0.8115136570877195, 0.8133510326694734, 0.8129912962164779, 0.8018546759372865, 0.7926117853600679]
epoch 98   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.388392122892233 , validation loss: 0.6848067343235016
tensor(43.2041, device='cuda:0')
MAE: [0.31422841345132857, 0.4206203998382366, 0.4703837901490174, 0.5079129330501844, 0.5623317082411341, 0.5874465548131884, 0.603271173343024, 0.6282198477117825, 0.6464616598113987, 0.6723170358034753, 0.6946505056256332, 0.7144838606294475, 0.7321655185837491, 0.7298875431313189, 0.7383006561756825, 0.7478927107700675, 0.7570170605238336, 0.7450585524924099, 0.7481139070004916, 0.7602223677161275, 0.7674121751112037, 0.77801763804303, 0.7679737894884167, 0.7807310841697239, 0.7822201794324461, 0.7741424920235175, 0.7803019715305034, 0.7966448617118804, 0.8040478056974555, 0.7909831057792318, 0.7692184659984616, 0.7585517029387435] , MAPE: [0.058545815514412285, 0.09507083249128948, 0.11282021370812856, 0.16240098924845484, 0.10226984796763851, 0.0840449649457983, 0.00204300954612392, -0.018889370493113167, -0.05931005821752628, 0.027040283327781807, -0.012432946690151794, -0.01924515438551736, -0.02685864849598672, 0.022096897328360073, -0.04847600118304361, -0.07510510230375263, -0.08568809857564984, -0.0828802592677308, -0.07971348289297725, -0.10864379685649125, -0.13585166987787198, -0.10948928563569951, -0.13423662534938913, -0.21502026217028972, -0.16142882263005395, -0.17507766220599508, -0.18117810273605933, -0.23103256542810188, -0.27132395012605803, -0.23435380702078001, -0.2362545503726622, -0.29514068094359414] %, RMSE: [0.5445010893484822, 0.662425486361377, 0.7234239855457205, 0.7673972753826163, 0.8317065179549787, 0.8543815578692465, 0.8758421154937559, 0.8870209429226344, 0.8892680055047183, 0.9009747652906683, 0.9221095984226806, 0.9480012333822199, 0.9758751951752832, 0.9758551872524107, 0.9850618593686394, 0.9916848027722857, 0.9915446970802638, 0.9552557051864203, 0.9547176740850492, 0.974921921193701, 0.9903846160627102, 1.0080378203840714, 0.9925329575282263, 0.9984079201898216, 0.9912535941657783, 0.9694071717133569, 0.9709345710708004, 0.990683547109878, 1.003211534208638, 0.9914411803917346, 0.9600070775029482, 0.9418892134865021]
epoch 99   lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6 , train loss: 0.3857671503837292 , validation loss: 0.6803291738033295
tensor(42.9937, device='cuda:0')
MAE: [0.3186632190912616, 0.4105809453650637, 0.447045398823072, 0.47613779616129304, 0.5318170766385522, 0.562861061009396, 0.587649712243031, 0.6099143247346672, 0.6351819514579226, 0.6436941236363167, 0.6466326268040336, 0.6601513615300514, 0.6805427528431965, 0.6985902444417252, 0.7268772856253631, 0.731454622510091, 0.7439752192478435, 0.7363509931303944, 0.7253615607820528, 0.7248116876849348, 0.725199437670064, 0.735330550656798, 0.7394177218755111, 0.7547094392192732, 0.7672392170353955, 0.7554895685851267, 0.7304690351847982, 0.7219566336738849, 0.7233315253751257, 0.7292501092366106, 0.7429933626884498, 0.7374836054682424] , MAPE: [0.08504665103278329, 0.07416782710664323, 0.09502880000457414, 0.1732392397828584, 0.13372058957160785, 0.1016350275358682, 0.03688164913041227, 0.03592191289374803, -0.013943613207775717, 0.0639191570849105, 0.014021794892872742, 0.05424029018592507, 0.039386440274316446, 0.05956973365557527, -0.05076434226003181, -0.025498711074139566, -0.052797666411779666, -0.05431815496630566, -0.05444138803562514, -0.036633902683629975, -0.043563919634877504, -0.03414034116320125, -0.05043490633871958, -0.09249018660015018, -0.09797675337740244, -0.1236296370033638, -0.11918490472627737, -0.11779482984007306, -0.17076562519493385, -0.15292819553999992, -0.16208388432103074, -0.2074169253393454] %, RMSE: [0.5585834243790267, 0.6611027371069141, 0.7014203667983909, 0.7403269909322348, 0.8052638798152362, 0.8357604808118798, 0.8682906813733113, 0.8863291910855725, 0.8982950368241321, 0.886335218073838, 0.881368138947816, 0.8972826909928582, 0.9218502480528932, 0.9536992943868517, 0.989817218663538, 0.9942689500938942, 0.9993766495195249, 0.974126306517015, 0.9538555952452273, 0.9537102543024868, 0.9551600668801891, 0.9736335935073629, 0.9812052726261403, 0.9956946926150645, 1.0029710635320142, 0.976557448906512, 0.9395916854402668, 0.9272655810299287, 0.9278283541479305, 0.9397755579206443, 0.9513478752510193, 0.9444997869599855]
test loss: NIL 
MAE: [0.3186632190912616, 0.4105809453650637, 0.447045398823072, 0.47613779616129304, 0.5318170766385522, 0.562861061009396, 0.587649712243031, 0.6099143247346672, 0.6351819514579226, 0.6436941236363167, 0.6466326268040336, 0.6601513615300514, 0.6805427528431965, 0.6985902444417252, 0.7268772856253631, 0.731454622510091, 0.7439752192478435, 0.7363509931303944, 0.7253615607820528, 0.7248116876849348, 0.725199437670064, 0.735330550656798, 0.7394177218755111, 0.7547094392192732, 0.7672392170353955, 0.7554895685851267, 0.7304690351847982, 0.7219566336738849, 0.7233315253751257, 0.7292501092366106, 0.7429933626884498, 0.7374836054682424] , MAPE: [0.08504665103278329, 0.07416782710664323, 0.09502880000457414, 0.1732392397828584, 0.13372058957160785, 0.1016350275358682, 0.03688164913041227, 0.03592191289374803, -0.013943613207775717, 0.0639191570849105, 0.014021794892872742, 0.05424029018592507, 0.039386440274316446, 0.05956973365557527, -0.05076434226003181, -0.025498711074139566, -0.052797666411779666, -0.05431815496630566, -0.05444138803562514, -0.036633902683629975, -0.043563919634877504, -0.03414034116320125, -0.05043490633871958, -0.09249018660015018, -0.09797675337740244, -0.1236296370033638, -0.11918490472627737, -0.11779482984007306, -0.17076562519493385, -0.15292819553999992, -0.16208388432103074, -0.2074169253393454] %, RMSE: [0.5585834243790267, 0.6611027371069141, 0.7014203667983909, 0.7403269909322348, 0.8052638798152362, 0.8357604808118798, 0.8682906813733113, 0.8863291910855725, 0.8982950368241321, 0.886335218073838, 0.881368138947816, 0.8972826909928582, 0.9218502480528932, 0.9536992943868517, 0.989817218663538, 0.9942689500938942, 0.9993766495195249, 0.974126306517015, 0.9538555952452273, 0.9537102543024868, 0.9551600668801891, 0.9736335935073629, 0.9812052726261403, 0.9956946926150645, 1.0029710635320142, 0.976557448906512, 0.9395916854402668, 0.9272655810299287, 0.9278283541479305, 0.9397755579206443, 0.9513478752510193, 0.9444997869599855]
====================
training elapsedd with 275.03 seconds for 100 iterations, the sec/iter = 2.75

MAE_mean: [0.31866322 0.41058095 0.4470454  0.4761378  0.53181708 0.56286106
 0.58764971 0.60991432 0.63518195 0.64369412 0.64663263 0.66015136
 0.68054275 0.69859024 0.72687729 0.73145462 0.74397522 0.73635099
 0.72536156 0.72481169 0.72519944 0.73533055 0.73941772 0.75470944
 0.76723922 0.75548957 0.73046904 0.72195663 0.72333153 0.72925011
 0.74299336 0.73748361] , MAPE_mean: [ 0.08504665  0.07416783  0.0950288   0.17323924  0.13372059  0.10163503
  0.03688165  0.03592191 -0.01394361  0.06391916  0.01402179  0.05424029
  0.03938644  0.05956973 -0.05076434 -0.02549871 -0.05279767 -0.05431815
 -0.05444139 -0.0366339  -0.04356392 -0.03414034 -0.05043491 -0.09249019
 -0.09797675 -0.12362964 -0.1191849  -0.11779483 -0.17076563 -0.1529282
 -0.16208388 -0.20741693] , RMSE_mean: [0.55858342 0.66110274 0.70142037 0.74032699 0.80526388 0.83576048
 0.86829068 0.88632919 0.89829504 0.88633522 0.88136814 0.89728269
 0.92185025 0.95369929 0.98981722 0.99426895 0.99937665 0.97412631
 0.9538556  0.95371025 0.95516007 0.97363359 0.98120527 0.99569469
 1.00297106 0.97655745 0.93959169 0.92726558 0.92782835 0.93977556
 0.95134788 0.94449979]

MAE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , MAPE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , RMSE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
Finished training with: lr1e-3_bs256_nh128_ra1e-3_dp0.2_wd1e-6_ah1_ck5_kt6
user config:
seed 666
device 0
scaler StandardScaler()
day_slot 288
n_route 10
n_his 96
n_pred 96
n_train 34
n_val 5
n_test 5
mode 1
n_c 10
model STAGNN_stamp
TPG TPGNN
name lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2
log_path log/TPGNN_r05p02kt3outer_273
crash 273
new_name TPGNN_r05p02kt3outer_273
batch_size 128
lr 0.001
a 0.1
r 0.5
n_mask 1
adam {'use': True, 'weight_decay': 0.0001}
slr {'use': True, 'step_size': 400, 'gamma': 0.3}
resume False
start_epoch 0
epochs 100
n_layer 1
n_attr 64
n_hid 64
reg_A 0.001
circle 288
drop_prob 0.1
CE {'use': True, 'kernel_size': 1, 'bias': False}
LE {'use': False, 'bias': False}
SE {'use': True, 'separate': True, 'no': False}
TE {'use': True, 'no': True}
attn {'head': 1, 'd_k': 32, 'd_v': 32, 'drop_prob': 0.2}
STstamp {'use': True, 'kt': 3, 'temperature': 1.0}
T4N {'use': True, 'step': 2, 'end_epoch': 10000, 'change_head': True, 'change_enc': True}
stamp_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/time_stamp.npy
data_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/V_France_processed_0.csv
adj_matrix_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/W_France_processed_0.csv
dis_mat tensor([[0.0000, 0.3661, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.6136, 0.0000,
         0.0000],
        [0.3661, 0.0000, 0.0000, 0.0000, 0.1098, 0.0000, 0.0000, 0.8975, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.3410, 0.8975, 0.0000, 0.0000, 0.0000, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.3410, 0.0000, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000,
         0.1494],
        [0.0000, 0.1098, 0.8975, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000, 0.6996,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000,
         0.2289],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000, 0.0000,
         0.5594],
        [0.6136, 0.8975, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.2117,
         0.0000],
        [0.0000, 0.4288, 0.4288, 0.0000, 0.6996, 0.0000, 0.0000, 0.2117, 0.0000,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.1494, 0.0000, 0.2289, 0.5594, 0.0000, 0.0000,
         0.0000]], device='cuda:0')
prefix log/lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2/
checkpoint_temp_path log/lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2//temp.pth
checkpoint_best_path log/lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2//best.pth
tensorboard_path log/lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2/
record_path log/lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2/record.txt
eps 0.1
parse <bound method DefaultConfig.parse of <config.DefaultConfig object at 0x7f8ba0e95550>>
output <bound method DefaultConfig.output of <config.DefaultConfig object at 0x7f8ba0e95550>>
train: True, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 9792
len(data): 9792, day_slot: 288, n_day: 34
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
10 10
epoch 0   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 3.2709308862686157 , validation loss: 1.0923549234867096
epoch 1   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 2.629853762113131 , validation loss: 1.0304517298936844
epoch 2   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 2.3793632433964658 , validation loss: 1.0201792269945145
epoch 3   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 2.1957782231844387 , validation loss: 0.9540790617465973
epoch 4   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 2.041347013070033 , validation loss: 0.9558233916759491
epoch 5   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 1.9056544808241038 , validation loss: 0.9023198485374451
epoch 6   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 1.784467270741096 , validation loss: 0.9180575609207153
epoch 7   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 1.6754433650236864 , validation loss: 0.8693353831768036
epoch 8   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 1.5741310944923987 , validation loss: 0.8076654374599457
epoch 9   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 1.4801407548097463 , validation loss: 0.7912008166313171
epoch 10   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 1.3934537860063405 , validation loss: 0.7230679839849472
epoch 11   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 1.316423122699444 , validation loss: 0.7337015867233276
epoch 12   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 1.2448051984493549 , validation loss: 0.7144296765327454
epoch 13   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 1.1831045242456288 , validation loss: 0.7102310359477997
epoch 14   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 1.1255208666508014 , validation loss: 0.68327197432518
epoch 15   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 1.0716044719402606 , validation loss: 0.685982346534729
epoch 16   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 1.021581246302678 , validation loss: 0.6788922846317291
epoch 17   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.9760208886403304 , validation loss: 0.6755807846784592
epoch 18   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.9346153415166415 , validation loss: 0.6805973201990128
epoch 19   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.8957706689834595 , validation loss: 0.6734061241149902
epoch 20   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.8597734410029191 , validation loss: 0.658977746963501
epoch 21   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.8259942875458643 , validation loss: 0.6738672107458115
epoch 22   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.7963780554441305 , validation loss: 0.6655392348766327
epoch 23   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.7654174589193784 , validation loss: 0.688628152012825
epoch 24   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.7386073630589706 , validation loss: 0.6604731231927872
epoch 25   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.7125502687234145 , validation loss: 0.6710432767868042
epoch 26   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.6877134029681866 , validation loss: 0.6749809682369232
epoch 27   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.6661544740200043 , validation loss: 0.6533439457416534
epoch 28   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.6444512949540064 , validation loss: 0.6610862165689468
epoch 29   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.6235180932741898 , validation loss: 0.6579265892505646
epoch 30   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.6044848607136653 , validation loss: 0.6556098312139511
epoch 31   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.5868165836884425 , validation loss: 0.6586011946201324
epoch 32   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.5702615540761214 , validation loss: 0.6799430996179581
epoch 33   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.5555653251134433 , validation loss: 0.6597301810979843
epoch 34   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.5393339762320886 , validation loss: 0.6553232967853546
epoch 35   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.5251727402210236 , validation loss: 0.6704467087984085
epoch 36   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.5128933260074029 , validation loss: 0.6719959080219269
epoch 37   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.4982564735871095 , validation loss: 0.6835101097822189
epoch 38   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.48628058571081895 , validation loss: 0.6918316930532455
epoch 39   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.47423624992370605 , validation loss: 0.648873507976532
epoch 40   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.4638425845366258 , validation loss: 0.669654980301857
epoch 41   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.4539624292116899 , validation loss: 0.6913469582796097
epoch 42   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.4439136924651953 , validation loss: 0.6556563079357147
epoch 43   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.4342065350367473 , validation loss: 0.6519746482372284
epoch 44   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.42538548088990724 , validation loss: 0.6481745392084122
epoch 45   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.41726107322252715 , validation loss: 0.650183916091919
epoch 46   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.410128381389838 , validation loss: 0.6793515086174011
epoch 47   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.4020011837665851 , validation loss: 0.6309775710105896
epoch 48   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.39448709785938263 , validation loss: 0.6462821066379547
epoch 49   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.3876874710504825 , validation loss: 0.6412701457738876
epoch 50   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.37958963444599736 , validation loss: 0.6643278449773788
epoch 51   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.3741655189257402 , validation loss: 0.626181423664093
epoch 52   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.36788756113785964 , validation loss: 0.6408916711807251
epoch 53   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.36277689039707184 , validation loss: 0.6322608292102814
epoch 54   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.3574677144105618 , validation loss: 0.6501591354608536
epoch 55   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.3515198861177151 , validation loss: 0.6402146369218826
epoch 56   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.3454371587588237 , validation loss: 0.6274555176496506
epoch 57   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.3412078939951383 , validation loss: 0.6247144639492035
epoch 58   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.3362779445373095 , validation loss: 0.6529260575771332
epoch 59   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.3318978204176976 , validation loss: 0.6983542442321777
epoch 60   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.3286319994009458 , validation loss: 0.6668387055397034
epoch 61   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.32428149305857146 , validation loss: 0.654006227850914
epoch 62   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.320252381838285 , validation loss: 0.6348090022802353
epoch 63   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.31589281673614794 , validation loss: 0.6539113819599152
epoch 64   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.31198472472337574 , validation loss: 0.6438632309436798
epoch 65   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.30827434131732356 , validation loss: 0.6096712350845337
epoch 66   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.3049040803542504 , validation loss: 0.651893749833107
epoch 67   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.3019767323365578 , validation loss: 0.6848984360694885
epoch 68   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.29990158058129823 , validation loss: 0.6322753578424454
epoch 69   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.29634272364469677 , validation loss: 0.6271687000989914
epoch 70   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.2938882513688161 , validation loss: 0.6566714644432068
epoch 71   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.2905745334350146 , validation loss: 0.6552098095417023
epoch 72   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.2872091806851901 , validation loss: 0.6691948026418686
epoch 73   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.28592427648030794 , validation loss: 0.6691620200872421
epoch 74   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.28399089781137615 , validation loss: 0.627835676074028
epoch 75   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.2809545351908757 , validation loss: 0.6260565519332886
epoch 76   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.27825859647530776 , validation loss: 0.6505994945764542
epoch 77   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.27557504864839405 , validation loss: 0.6514866948127747
epoch 78   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.27376882617290205 , validation loss: 0.619667574763298
epoch 79   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.2718864301076302 , validation loss: 0.6237907260656357
epoch 80   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.2703338964627339 , validation loss: 0.6161777377128601
epoch 81   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.26787600265099454 , validation loss: 0.6606611609458923
epoch 82   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.2660246296570851 , validation loss: 0.6302255839109421
epoch 83   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.26422635637796843 , validation loss: 0.6151864230632782
epoch 84   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.2631677549618941 , validation loss: 0.6184432655572891
epoch 85   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.26119283070931065 , validation loss: 0.6458187401294708
epoch 86   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.2600427499184242 , validation loss: 0.6338817626237869
epoch 87   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.2581370094647774 , validation loss: 0.635737419128418
epoch 88   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.2569977371738507 , validation loss: 0.6199839860200882
epoch 89   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.2546612207706158 , validation loss: 0.6522990167140961
epoch 90   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.2543139520746011 , validation loss: 0.6521971225738525
epoch 91   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.2525940388441086 , validation loss: 0.7068020701408386
epoch 92   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.25153351804384816 , validation loss: 0.6896263360977173
epoch 93   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.2500135950171031 , validation loss: 0.6476403325796127
epoch 94   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.2486565663264348 , validation loss: 0.6996274292469025
epoch 95   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.2479928439626327 , validation loss: 0.6271521300077438
epoch 96   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.24691009979981643 , validation loss: 0.6169422417879105
tensor(28.9536, device='cuda:0')
MAE: [0.3050449481768745, 0.3751686521082608, 0.4003918342823259, 0.41633347867111936, 0.4805113132820302, 0.4945184814976048, 0.4939326636189806, 0.5071561537711814, 0.5225741565760379, 0.5217251426557598, 0.5255506684879782, 0.5391054776572075, 0.5797429467267213, 0.5839249395986194, 0.589777821370775, 0.585127929589836, 0.5896404393965897, 0.5841119164973497, 0.5736353547571553, 0.5746377474902985, 0.611602990286252, 0.6198759495776108, 0.6152473770811693, 0.6069186047094001, 0.6112939168854626, 0.5912885681021306, 0.5734844852872577, 0.5758588922861003, 0.5948248531052017, 0.6003842812953228, 0.6086264692876757, 0.6226490419223597] , MAPE: [0.060925190297674604, 0.07975871260758215, 0.17419918898892403, 0.16423366564545766, 0.1862188593701375, 0.11720352471756303, 0.0729324385523316, 0.0683213221738967, 0.004322267603304671, 0.10670081639152543, 0.08305377713705235, 0.10644178556633295, 0.10440816026322601, 0.13725645094567468, 0.05339352482473916, 0.02059542997194737, 0.03288000028272587, 0.09332894488504571, 0.06600308377587971, 0.0758900199617384, 0.051329749793890794, 0.09290309964486557, 0.08919914614242386, -0.0009677491310305844, -0.0007359390058421191, 0.008576577204260399, 0.04032087009527646, 8.285712864797217e-05, -0.030906389515820563, 0.007396031676504096, 0.0390224209195438, -0.07925943097873764] %, RMSE: [0.5486971104800258, 0.6130985065012525, 0.6439476297585904, 0.6551089440096927, 0.7329691987127582, 0.7411828656968029, 0.7337850250599373, 0.7443759714720585, 0.7467652047647984, 0.7293881193049919, 0.7398130080734886, 0.7505683596004477, 0.8022293080918961, 0.7958449487643674, 0.7934554295453358, 0.7874473149163801, 0.7939013201008387, 0.7782692726883087, 0.7620081648697247, 0.761538670734664, 0.8111658101361124, 0.8160887094615251, 0.8036740524629302, 0.7888779719917692, 0.7964297912868663, 0.773048428533719, 0.7563655648738855, 0.7540904063811574, 0.7826079860826402, 0.7826043348519812, 0.7872280981708943, 0.8069057051940605]
epoch 97   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.24568985345271918 , validation loss: 0.6496085226535797
tensor(28.7469, device='cuda:0')
MAE: [0.29415873126868525, 0.3727775072605954, 0.40961478207692426, 0.44343492371346993, 0.4756295003628685, 0.4916121063552336, 0.5201557955659504, 0.523737933699368, 0.5431865320178036, 0.5621872127321117, 0.595448193961044, 0.6138381320583759, 0.6275585175814472, 0.6244511956519918, 0.6339823533648375, 0.6388783912648706, 0.6408526857990349, 0.6318384630724634, 0.6360024928186357, 0.6411686123450546, 0.6422371790899905, 0.6266457150653773, 0.6321809896570391, 0.6270291089931906, 0.599241028042779, 0.6041403306552122, 0.6081596165908904, 0.607621936975143, 0.6038237147797956, 0.5943776861064558, 0.6027030515033253, 0.5885254253816704] , MAPE: [0.04674795456258844, 0.11228093623000193, 0.2256915881462184, 0.24289746963782669, 0.23630190238383594, 0.1729959989876316, 0.13363655601020694, 0.1733261586064725, 0.12264004337736381, 0.21574922516135517, 0.24731282963159137, 0.25129923353928313, 0.239273560064942, 0.2540301341192944, 0.17656922742320902, 0.13973906101481617, 0.1676875542984575, 0.20274035124908402, 0.22361163017765648, 0.19894414444652941, 0.2115284674603259, 0.19420153933603043, 0.17517696592003557, 0.1307404263879859, 0.0736913381095168, 0.04785171754404089, 0.01578774183841852, -0.04128238053952185, -0.1660496303936771, -0.0746761597523853, -0.020108723473742953, -0.25778335338203384] %, RMSE: [0.5331495847228613, 0.6166864382691675, 0.6655873938018607, 0.6888046798717059, 0.7195070205507985, 0.7442842552271348, 0.7855842297285115, 0.7776546803184272, 0.7877286664502214, 0.7965719923303252, 0.8402182216513918, 0.8541598730178228, 0.8672148930792801, 0.865629256817627, 0.8766549934261554, 0.8809612195216863, 0.8776254423142749, 0.8624095420369892, 0.8699196876449887, 0.8716281353821721, 0.8698261342151635, 0.8465989318741995, 0.8532991941463736, 0.8454064959831872, 0.8106192057978672, 0.822884468215257, 0.8318689421009938, 0.8245284079920199, 0.8176594133873127, 0.8070804639017101, 0.8155962175585046, 0.8063029292822624]
epoch 98   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.24510199060806862 , validation loss: 0.6271438002586365
tensor(28.5423, device='cuda:0')
MAE: [0.3023777315210186, 0.38675670993725586, 0.42169441976594096, 0.46233739978662625, 0.5073730083137328, 0.5018301498494351, 0.4822510658482032, 0.49793891667513196, 0.518985791814696, 0.5389049437630576, 0.5509618714405704, 0.5697215212500875, 0.6078367121402443, 0.5945893259521228, 0.5814798522193331, 0.5963943399730878, 0.6004387290230424, 0.611135594547467, 0.5994440365964835, 0.6134214743758677, 0.6284347446087133, 0.6082155904988038, 0.5772527965898482, 0.5739755354693985, 0.5646770451630744, 0.5701945860378598, 0.5627359559689409, 0.5743996041907554, 0.5947814407662402, 0.5797656977761383, 0.5496021195688314, 0.5392254313607652] , MAPE: [0.05722157909948551, 0.11651222770186784, 0.2224930368170107, 0.22206902443464396, 0.25866833000221245, 0.1762139632938293, 0.13012909533804032, 0.154974234537289, 0.12277587530216516, 0.20667854138514757, 0.20762593353685568, 0.21232608086032884, 0.23672832928078857, 0.24527581685249314, 0.16646798089355816, 0.13234719223189215, 0.1568366480334878, 0.20463666589123247, 0.17939304363156985, 0.19827326456055744, 0.23508550095939576, 0.20747861625712308, 0.17855283487022555, 0.10719963050066954, 0.019163555173391175, 0.0137729280590579, -0.017718037492223563, -0.036410221379345103, -0.11804456562562618, -0.05892610729207254, -0.019999910596899595, -0.2748864073641346] %, RMSE: [0.5530120422198407, 0.6415151113404456, 0.6784182769579111, 0.721697787731261, 0.7786723642718357, 0.7617346917658361, 0.7354124235161192, 0.7517599784030148, 0.7653747966051835, 0.7779270338364512, 0.7928444842486505, 0.8141604042992892, 0.865591974601565, 0.8393447570769497, 0.817083427715634, 0.8359000128542264, 0.8330163343726307, 0.843455125833596, 0.8234710915903649, 0.840611377304735, 0.8591484634844088, 0.8270913409168597, 0.7896657263418915, 0.784807491374268, 0.7708614738293806, 0.7788183307968789, 0.7680193947041697, 0.7826530339296411, 0.8104421934830984, 0.7913811808698193, 0.7537521781615524, 0.7502917402721255]
epoch 99   lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2 , train loss: 0.24325168075469825 , validation loss: 0.6274068206548691
tensor(28.3517, device='cuda:0')
MAE: [0.313600094608228, 0.4094964159808131, 0.4460065783453702, 0.4620193032141218, 0.5026037189617907, 0.5110836731677049, 0.5110089342307645, 0.5155823818213767, 0.5489257721864071, 0.5764005092036018, 0.5948303558028389, 0.5942945502802115, 0.6183093948646919, 0.6144029040281306, 0.6136570074704005, 0.6115428302583006, 0.6334118571155465, 0.6608306876009272, 0.6582237591452359, 0.6437571512158845, 0.6586755941109251, 0.6453263174197108, 0.6368400409986678, 0.6266292664339554, 0.6423711531528646, 0.6441993550870798, 0.635774669459032, 0.6250583179730961, 0.6272421654797706, 0.6113514886389381, 0.6023691638413163, 0.6113929660683594] , MAPE: [0.056804136846399206, 0.09914417615968202, 0.17770190728475316, 0.15080038792081582, 0.16562725425312613, 0.10490307979175903, 0.083677854584533, 0.06615705449533914, 0.02553519848138562, 0.10331295917274104, 0.0824103611892372, 0.07050745275808311, 0.0579210084391345, 0.10818883482768853, 0.04958706275221742, 0.018224123728079914, 0.030490256717891226, 0.07446319460284359, 0.07369374088650466, 0.030137943218194532, 0.018880195806873556, 0.03544471188625393, 0.07514622661928387, -0.042439334813439256, -0.051484736370529735, 0.001873278208572019, 0.03225913987402293, -0.07170929527032677, -0.08697451999791606, -0.04646774308104308, -0.021650835802951424, -0.07849612571759937] %, RMSE: [0.5602235784524908, 0.6665575585556444, 0.7088630860798361, 0.7177299681632773, 0.7599224199324794, 0.7628347016495564, 0.7604420949504037, 0.748980244787658, 0.7811593402692294, 0.809795426549907, 0.8356731005590584, 0.8274609782217804, 0.8548570755328074, 0.8435990780698602, 0.8342452691732821, 0.8244979183318795, 0.852558857765414, 0.8916946679952567, 0.8866273006800884, 0.864473260803081, 0.882498790810909, 0.8616469213913932, 0.8440560647314757, 0.821169275745751, 0.8411196159493113, 0.8503115736164375, 0.8342397680189803, 0.8115285763880138, 0.8137194266627964, 0.7942068011168326, 0.7778347186274956, 0.7845147574875816]
test loss: NIL 
MAE: [0.313600094608228, 0.4094964159808131, 0.4460065783453702, 0.4620193032141218, 0.5026037189617907, 0.5110836731677049, 0.5110089342307645, 0.5155823818213767, 0.5489257721864071, 0.5764005092036018, 0.5948303558028389, 0.5942945502802115, 0.6183093948646919, 0.6144029040281306, 0.6136570074704005, 0.6115428302583006, 0.6334118571155465, 0.6608306876009272, 0.6582237591452359, 0.6437571512158845, 0.6586755941109251, 0.6453263174197108, 0.6368400409986678, 0.6266292664339554, 0.6423711531528646, 0.6441993550870798, 0.635774669459032, 0.6250583179730961, 0.6272421654797706, 0.6113514886389381, 0.6023691638413163, 0.6113929660683594] , MAPE: [0.056804136846399206, 0.09914417615968202, 0.17770190728475316, 0.15080038792081582, 0.16562725425312613, 0.10490307979175903, 0.083677854584533, 0.06615705449533914, 0.02553519848138562, 0.10331295917274104, 0.0824103611892372, 0.07050745275808311, 0.0579210084391345, 0.10818883482768853, 0.04958706275221742, 0.018224123728079914, 0.030490256717891226, 0.07446319460284359, 0.07369374088650466, 0.030137943218194532, 0.018880195806873556, 0.03544471188625393, 0.07514622661928387, -0.042439334813439256, -0.051484736370529735, 0.001873278208572019, 0.03225913987402293, -0.07170929527032677, -0.08697451999791606, -0.04646774308104308, -0.021650835802951424, -0.07849612571759937] %, RMSE: [0.5602235784524908, 0.6665575585556444, 0.7088630860798361, 0.7177299681632773, 0.7599224199324794, 0.7628347016495564, 0.7604420949504037, 0.748980244787658, 0.7811593402692294, 0.809795426549907, 0.8356731005590584, 0.8274609782217804, 0.8548570755328074, 0.8435990780698602, 0.8342452691732821, 0.8244979183318795, 0.852558857765414, 0.8916946679952567, 0.8866273006800884, 0.864473260803081, 0.882498790810909, 0.8616469213913932, 0.8440560647314757, 0.821169275745751, 0.8411196159493113, 0.8503115736164375, 0.8342397680189803, 0.8115285763880138, 0.8137194266627964, 0.7942068011168326, 0.7778347186274956, 0.7845147574875816]
====================
training elapsedd with 252.78 seconds for 100 iterations, the sec/iter = 2.53

MAE_mean: [0.31360009 0.40949642 0.44600658 0.4620193  0.50260372 0.51108367
 0.51100893 0.51558238 0.54892577 0.57640051 0.59483036 0.59429455
 0.61830939 0.6144029  0.61365701 0.61154283 0.63341186 0.66083069
 0.65822376 0.64375715 0.65867559 0.64532632 0.63684004 0.62662927
 0.64237115 0.64419936 0.63577467 0.62505832 0.62724217 0.61135149
 0.60236916 0.61139297] , MAPE_mean: [ 0.05680414  0.09914418  0.17770191  0.15080039  0.16562725  0.10490308
  0.08367785  0.06615705  0.0255352   0.10331296  0.08241036  0.07050745
  0.05792101  0.10818883  0.04958706  0.01822412  0.03049026  0.07446319
  0.07369374  0.03013794  0.0188802   0.03544471  0.07514623 -0.04243933
 -0.05148474  0.00187328  0.03225914 -0.0717093  -0.08697452 -0.04646774
 -0.02165084 -0.07849613] , RMSE_mean: [0.56022358 0.66655756 0.70886309 0.71772997 0.75992242 0.7628347
 0.76044209 0.74898024 0.78115934 0.80979543 0.8356731  0.82746098
 0.85485708 0.84359908 0.83424527 0.82449792 0.85255886 0.89169467
 0.8866273  0.86447326 0.88249879 0.86164692 0.84405606 0.82116928
 0.84111962 0.85031157 0.83423977 0.81152858 0.81371943 0.7942068
 0.77783472 0.78451476]

MAE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , MAPE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , RMSE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
Finished training with: lr1e-3_bs128_nh64_ra1e-3_dp0.1_wd1e-5_ah1_ck5_kt2
Random search tuning completed. Results saved to tuning_results_G_96_R_0512.csv.
