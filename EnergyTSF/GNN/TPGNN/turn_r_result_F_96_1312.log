user config:
seed 666
device 0
scaler StandardScaler()
day_slot 288
n_route 10
n_his 96
n_pred 96
n_train 34
n_val 5
n_test 5
mode 1
n_c 10
model STAGNN_stamp
TPG TPGNN
name lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4
log_path log/TPGNN_r05p02kt3outer_334
crash 334
new_name TPGNN_r05p02kt3outer_334
batch_size 64
lr 0.001
a 0.1
r 0.5
n_mask 1
adam {'use': True, 'weight_decay': 0.0001}
slr {'use': True, 'step_size': 400, 'gamma': 0.3}
resume False
start_epoch 0
epochs 100
n_layer 1
n_attr 64
n_hid 128
reg_A 1e-05
circle 288
drop_prob 0.2
CE {'use': True, 'kernel_size': 1, 'bias': False}
LE {'use': False, 'bias': False}
SE {'use': True, 'separate': True, 'no': False}
TE {'use': True, 'no': True}
attn {'head': 1, 'd_k': 32, 'd_v': 32, 'drop_prob': 0.2}
STstamp {'use': True, 'kt': 3, 'temperature': 1.0}
T4N {'use': True, 'step': 2, 'end_epoch': 10000, 'change_head': True, 'change_enc': True}
stamp_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/time_stamp_F_96.npy
data_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/V_France_processed_0.csv
adj_matrix_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/W_France_processed_0.csv
dis_mat tensor([[0.0000, 0.3661, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.6136, 0.0000,
         0.0000],
        [0.3661, 0.0000, 0.0000, 0.0000, 0.1098, 0.0000, 0.0000, 0.8975, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.3410, 0.8975, 0.0000, 0.0000, 0.0000, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.3410, 0.0000, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000,
         0.1494],
        [0.0000, 0.1098, 0.8975, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000, 0.6996,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000,
         0.2289],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000, 0.0000,
         0.5594],
        [0.6136, 0.8975, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.2117,
         0.0000],
        [0.0000, 0.4288, 0.4288, 0.0000, 0.6996, 0.0000, 0.0000, 0.2117, 0.0000,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.1494, 0.0000, 0.2289, 0.5594, 0.0000, 0.0000,
         0.0000]], device='cuda:0')
prefix log/lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4/
checkpoint_temp_path log/lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4//temp.pth
checkpoint_best_path log/lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4//best.pth
tensorboard_path log/lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4/
record_path log/lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4/record.txt
eps 0.1
parse <bound method DefaultConfig.parse of <config.DefaultConfig object at 0x7fdfa959a550>>
output <bound method DefaultConfig.output of <config.DefaultConfig object at 0x7fdfa959a550>>
train: True, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 9792
len(data): 9792, day_slot: 288, n_day: 34
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
10 10
epoch 0   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.7432025098333171 , validation loss: 1.022171638906002
epoch 1   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.4384662286908019 , validation loss: 0.9178669527173042
epoch 2   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.39524613350045446 , validation loss: 0.9211586490273476
epoch 3   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.37107156947547315 , validation loss: 0.86090437322855
epoch 4   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.35356887649087343 , validation loss: 0.8019558116793633
epoch 5   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.3383151111649532 , validation loss: 0.8027881756424904
epoch 6   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.32180852749768424 , validation loss: 0.7423539906740189
epoch 7   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.30553199672231485 , validation loss: 0.7100451439619064
epoch 8   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.2946612040201823 , validation loss: 0.6926991790533066
epoch 9   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.28610391067523583 , validation loss: 0.6931155696511269
epoch 10   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.2810104658790663 , validation loss: 0.6803595423698425
epoch 11   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.27573232089771943 , validation loss: 0.716014489531517
epoch 12   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.271919343401404 , validation loss: 0.6782524138689041
epoch 13   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.2680784744374892 , validation loss: 0.6758157461881638
epoch 14   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.2647068477144428 , validation loss: 0.706605926156044
epoch 15   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.26200202487263025 , validation loss: 0.7569927424192429
epoch 16   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.25966281546097175 , validation loss: 0.6830442696809769
epoch 17   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.2565878626762652 , validation loss: 0.6470574885606766
epoch 18   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.25523894937599406 , validation loss: 0.6437415331602097
epoch 19   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.251918251023573 , validation loss: 0.6706730872392654
epoch 20   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.25072972418046463 , validation loss: 0.6651918217539787
epoch 21   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.247825108906802 , validation loss: 0.6392491459846497
epoch 22   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.24699129339526682 , validation loss: 0.6415489986538887
epoch 23   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.24556950114521325 , validation loss: 0.6626931875944138
epoch 24   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.24362493350225337 , validation loss: 0.6386787369847298
epoch 25   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.241968338396035 , validation loss: 0.6224027425050735
epoch 26   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.2417522855833465 , validation loss: 0.6314772963523865
epoch 27   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.24022947836155986 , validation loss: 0.6285386234521866
epoch 28   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.23809196230243235 , validation loss: 0.628767803311348
epoch 29   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.23698214602236653 , validation loss: 0.6318250671029091
epoch 30   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.2353891248212141 , validation loss: 0.6319097653031349
epoch 31   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.2355040755926394 , validation loss: 0.7517718970775604
epoch 32   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.23689046472895378 , validation loss: 0.6408759206533432
epoch 33   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.23325576005028745 , validation loss: 0.6097534075379372
epoch 34   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.2325856156793295 , validation loss: 0.6230143457651138
epoch 35   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.23190060024167977 , validation loss: 0.6222105547785759
epoch 36   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.23076668264819125 , validation loss: 0.6184515431523323
epoch 37   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.23054498346412883 , validation loss: 0.6176237985491753
epoch 38   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.22911418623784008 , validation loss: 0.6385332494974136
epoch 39   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.22895274179823258 , validation loss: 0.6245652362704277
epoch 40   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.228733733588574 , validation loss: 0.6910577490925789
epoch 41   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.2320027354301191 , validation loss: 0.6824308782815933
epoch 42   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.22809543241472804 , validation loss: 0.6490927785634995
epoch 43   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.2262458146787157 , validation loss: 0.6486779227852821
epoch 44   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.22671432647050596 , validation loss: 0.6321990638971329
epoch 45   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.22738969501327067 , validation loss: 0.6449838951230049
epoch 46   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.22511651995135287 , validation loss: 0.60481196641922
epoch 47   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.22391541974217283 , validation loss: 0.6179802492260933
epoch 48   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.22422544219914606 , validation loss: 0.6465174108743668
epoch 49   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.22460909392319472 , validation loss: 0.6384951770305634
epoch 50   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.22362917427923165 , validation loss: 0.6353804096579552
epoch 51   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.22288777723031886 , validation loss: 0.655386783182621
epoch 52   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.22415094574292502 , validation loss: 0.7409602627158165
epoch 53   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.2225771587268979 , validation loss: 0.6172651723027229
epoch 54   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.22205439472899718 , validation loss: 0.6135259121656418
epoch 55   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.2213303966849458 , validation loss: 0.6772242784500122
epoch 56   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.22111768290108325 , validation loss: 0.6257493793964386
epoch 57   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.22143374500321408 , validation loss: 0.7723754942417145
epoch 58   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.22115433712800345 , validation loss: 0.6635723486542702
epoch 59   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.22018859199449128 , validation loss: 0.6539577692747116
epoch 60   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.2200754708519169 , validation loss: 0.6358722448348999
epoch 61   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.22032836430213032 , validation loss: 0.6331966370344162
epoch 62   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.219557903268758 , validation loss: 0.7535744085907936
epoch 63   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.21969539686745287 , validation loss: 0.6389319375157356
epoch 64   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.2180258193436791 , validation loss: 0.639054499566555
epoch 65   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.21834450521889856 , validation loss: 0.611721508204937
epoch 66   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.21837652781430414 , validation loss: 0.7292380705475807
epoch 67   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.21767355413997874 , validation loss: 0.6524351537227631
epoch 68   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.21760125984163844 , validation loss: 0.6604018062353134
epoch 69   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.2170539632731793 , validation loss: 0.6363553181290627
epoch 70   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.2170734817490858 , validation loss: 0.6920228078961372
epoch 71   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.21749231920522802 , validation loss: 0.6046558246016502
epoch 72   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.2161900593953974 , validation loss: 0.6063977479934692
epoch 73   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.2174305781429889 , validation loss: 0.616931289434433
epoch 74   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.21636332220890941 , validation loss: 0.6600606814026833
epoch 75   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.21536636381757027 , validation loss: 0.6628247648477554
epoch 76   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.21630247784595863 , validation loss: 0.6078931093215942
epoch 77   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.21541603230962567 , validation loss: 0.6155361384153366
epoch 78   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.21530536810557047 , validation loss: 0.6091401353478432
epoch 79   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.21426078355779835 , validation loss: 0.6297386884689331
epoch 80   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.21435929367355272 , validation loss: 0.6098975613713264
epoch 81   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.21496260925835253 , validation loss: 0.5992449447512627
epoch 82   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.21394719913894056 , validation loss: 0.5926970019936562
epoch 83   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.21360871692498526 , validation loss: 0.6126628667116165
epoch 84   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.21342229638613908 , validation loss: 0.6211055889725685
epoch 85   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.21331998472120248 , validation loss: 0.7353354766964912
epoch 86   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.21407784580015668 , validation loss: 0.637106865644455
epoch 87   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.2123909648142609 , validation loss: 0.708252526819706
epoch 88   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.21267838834547528 , validation loss: 0.6075756624341011
epoch 89   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.21224322009320354 , validation loss: 0.6008663028478622
epoch 90   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.2125820985027388 , validation loss: 0.6517276018857956
epoch 91   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.21371651835301342 , validation loss: 0.7996577173471451
epoch 92   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.21190801321291455 , validation loss: 0.6941431164741516
epoch 93   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.21162436172073962 , validation loss: 0.5997069329023361
epoch 94   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.21198712055589639 , validation loss: 0.6290350183844566
epoch 95   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.2114394564254611 , validation loss: 0.6238187998533249
epoch 96   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.21162620362113505 , validation loss: 0.6052915975451469
tensor(8.2407, device='cuda:0')
MAE: [0.27600698766185777, 0.36722029071397233, 0.38985274800713915, 0.4174098173445619, 0.44238737780053516, 0.4619862031779185, 0.4707063204013579, 0.4838273059987684, 0.5084614521439773, 0.540077866235191, 0.5356140599778095, 0.5439444009406665, 0.5507293582650036, 0.5531599668782089, 0.5555014579552082, 0.5646542885507813, 0.5742253001898133, 0.5913057979240476, 0.5811410708155137, 0.5712670419645525, 0.5646559819675137, 0.5547099158359864, 0.5503457545680138, 0.5534037427147178, 0.5593140279455591, 0.5778525605127599, 0.5642839269219062, 0.5533387759838676, 0.5526631140922071, 0.5461154141615039, 0.5427877530718664, 0.5514478796636013] , MAPE: [0.07810904673486407, 0.08235970478505496, 0.19136623577582776, 0.148643516289348, 0.12201436008597195, 0.09569295306663278, 0.029478637968800896, 0.05377821013951445, 0.0064638761750155154, 0.08467259045734103, 0.05584150890333665, 0.07328553900383077, 0.05692461822363164, 0.10733193523376987, 0.03596412677214719, 0.05033286110195871, 0.00812463939243468, 0.02968764153959052, 0.013908783006574839, 0.06364129004186889, 0.050733758309242774, 0.042118510372011704, 0.023630368613719595, 0.015388558462565793, -0.016530640187814888, -0.060543755440499884, -0.06870826183601952, -0.12177378065185922, -0.10284019446681847, -0.09022407221598412, -0.0800999423819288, -0.23976695042452925] %, RMSE: [0.49222160730638265, 0.5946464556121253, 0.6246349046174485, 0.6526856309975461, 0.6730233627821995, 0.6977713133537936, 0.713831116269239, 0.7245975208770317, 0.7450657537309602, 0.7744157572335065, 0.7672108882954878, 0.7683152311975147, 0.7719960338755312, 0.7706672456545289, 0.7730770388443853, 0.7828571382617048, 0.7907993945302645, 0.8045351460190221, 0.787668606117588, 0.7755592623222775, 0.7635970059620423, 0.749617588014223, 0.7448080154132224, 0.7433239085795418, 0.7434257428221993, 0.7616440508178819, 0.745821515372364, 0.7321556162834723, 0.7257684137740118, 0.7149552654681963, 0.7113378512300944, 0.7236589415189532]
epoch 97   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.21063953521204928 , validation loss: 0.5906532257795334
tensor(8.1261, device='cuda:0')
MAE: [0.261899239650169, 0.3447880701190725, 0.38081467764173665, 0.40245292556943785, 0.439000867754797, 0.45939379738547753, 0.4707914103323728, 0.4882335623100246, 0.49681557105950164, 0.518000412020021, 0.528200570208395, 0.5266081161228652, 0.5431493407222875, 0.5547227057705144, 0.5581810052335723, 0.5619784984441916, 0.552409817155873, 0.5588413423718405, 0.5600082156185022, 0.547985085886423, 0.5510289391944396, 0.5553985456730595, 0.5521657505032328, 0.5518251861962153, 0.5372383230162266, 0.543444640225318, 0.5376399165860464, 0.5263271061235021, 0.5285775645107953, 0.5347245157682865, 0.5353356887148597, 0.538887542397091] , MAPE: [0.10108376543302679, 0.08672341329006251, 0.18498808569366654, 0.15212840289824112, 0.1379303436958262, 0.06861012909789276, 0.016509762901448843, 0.06135780356048496, 0.037708236859223795, 0.1254215568002612, 0.08228967593883203, 0.07640852847597943, 0.04721046231905272, 0.12023072100252263, 0.022836148069966547, 0.06904879136191854, 0.053523556964067485, 0.05515805510988957, 0.028322094069308246, 0.05017006120260909, 0.04356087215126705, 0.049543774856846134, 0.00842735873805011, 0.008366104185427587, 0.011967927233301602, -0.033860915806120474, -0.03851579974513482, -0.08969524405683636, -0.0751812142477078, -0.09348203484351823, -0.09882857196381947, -0.14297232939618681] %, RMSE: [0.4583835588839383, 0.5630126500320388, 0.6038593270097748, 0.6277840818116998, 0.6637568016242578, 0.689706759674021, 0.7076971106743268, 0.7282217004388458, 0.7294175931760197, 0.7498819116158656, 0.7609949057759158, 0.7518575080013582, 0.7660680583533286, 0.7767681467056406, 0.7761066469801917, 0.7854034573773093, 0.7702757293670306, 0.7690691521865481, 0.7631734678147996, 0.749214446010718, 0.750850922673987, 0.7490459420088732, 0.7425271835480914, 0.7405947288479471, 0.7196923363729189, 0.7233843254585401, 0.7158857670125227, 0.7015024979670377, 0.7010407628161569, 0.7034209554030835, 0.7010136836688599, 0.7077344830788551]
epoch 98   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.21132727317950306 , validation loss: 0.6513056457042694
tensor(8.0813, device='cuda:0')
MAE: [0.2700616369091128, 0.34711611820192834, 0.3868688530747577, 0.42213778661612, 0.4542927638643911, 0.48120708988710625, 0.5006895183088239, 0.5286482997004365, 0.5622886859971223, 0.5783893662520214, 0.5871956424296055, 0.5999820599347814, 0.6044035511636703, 0.6113101607382528, 0.6270689511925136, 0.6377248919104255, 0.6518352955633525, 0.652317529595313, 0.6471873053432126, 0.638794148201939, 0.6302675186727464, 0.6347770941223873, 0.6438492421291231, 0.6550604895978551, 0.6665892511502522, 0.6656269793700158, 0.6612877197386985, 0.6517110658302596, 0.6424541099515465, 0.6497583617159578, 0.6611939176732732, 0.6725723187302806] , MAPE: [0.0881298663691093, 0.08472523435948029, 0.16271130071554374, 0.1594631380190624, 0.12989121578646387, 0.09927083009774298, 0.012515454643283557, 0.05129648627162, -0.003763895596007903, 0.09943690090605835, 0.06987742211353892, 0.09652540636031358, 0.09231510230567794, 0.13111250503241778, 0.03142063811101252, 0.055474139634287586, -0.026888385513917718, 0.06006688271439154, 0.04778574598221932, 0.07037913249224544, 0.056725113844515604, 0.0372919202131158, -0.03958160779282292, -0.02429454730840063, -0.08743708889678208, -0.07362551840848158, -0.039321143077062345, -0.12650952400885723, -0.08501098324166077, -0.10876787783951887, -0.11231774146307666, -0.19097313930974197] %, RMSE: [0.4781862109472345, 0.5693533321656341, 0.6176075024959037, 0.6590101132214774, 0.6896982007536365, 0.7220993439893508, 0.7494500501388588, 0.7768294992589776, 0.809767372445451, 0.828744003109784, 0.8399309102533551, 0.8505848339087004, 0.8585411213547416, 0.8629005462905841, 0.8816005772607614, 0.891416449497883, 0.9072738987885417, 0.9003274156991075, 0.8897855897265534, 0.8796590166021784, 0.8685772186027613, 0.8742445326227827, 0.8881577727414296, 0.8993567761691268, 0.9091153021645185, 0.9064287252986851, 0.9051002378610536, 0.8924923954260653, 0.8790837610800706, 0.8885704006342341, 0.8979493227914535, 0.9148743718996586]
epoch 99   lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4 , train loss: 0.21102220141420178 , validation loss: 0.7162570953369141
tensor(7.9557, device='cuda:0')
MAE: [0.29522545627644764, 0.37992570964043443, 0.42202327940987483, 0.4688769718628262, 0.5217045670929941, 0.5426845076411349, 0.5538048851818383, 0.5811986847496448, 0.6159826179332647, 0.6378622903148692, 0.6474608744246905, 0.6660749024402388, 0.6943209492756994, 0.6977651547241149, 0.7002832658258603, 0.7154181067922066, 0.7373549573991409, 0.750711250641604, 0.754492501852285, 0.7629681304223912, 0.7807026841399288, 0.7788269284452053, 0.7734357156151349, 0.7827496094755905, 0.7949684554207878, 0.8081169861053914, 0.8021541250251311, 0.7945605303153165, 0.8114433390491632, 0.8174497340608042, 0.8176872073945388, 0.8275326886509075] , MAPE: [0.10379622179700346, 0.07715147808843145, 0.13743798193949203, 0.1540900786804454, 0.14632551071548489, 0.05594421730711174, 0.02521389292491559, 0.038715567292642424, 0.019268352545529815, 0.09940174679923412, 0.043133655472558964, 0.071686666617314, 0.04701369572768844, 0.036430317203758396, 0.003459681795249014, 0.040452270288729664, -0.006878348442024645, 0.019648327806627872, -0.015236711112946106, -0.002873523487126186, -0.017115876612531923, -0.018365345075078424, -0.05138483310771204, -0.04074121302687719, -0.04531532501800648, -0.09791642636337951, -0.10548292796171228, -0.1712677520031281, -0.2075490930332135, -0.22774211215543455, -0.18824011166105958, -0.20374175898856772] %, RMSE: [0.49937683578753367, 0.5987976759551042, 0.6504691149155064, 0.7076950396245154, 0.7671302659505217, 0.7939794339539107, 0.8166884983803262, 0.8533141686642491, 0.8875681572702411, 0.9086485397768715, 0.9187057590997214, 0.9391411616946123, 0.9730195736609731, 0.9734706568397248, 0.9806969889176512, 1.001193230980704, 1.0266640325478316, 1.0441403254372104, 1.0531402464243043, 1.062838945872651, 1.0861579557390006, 1.085542351984584, 1.0836372983512312, 1.0880722652691668, 1.094596834591372, 1.1086865440696592, 1.1063905732218755, 1.094309718218614, 1.1062639835471997, 1.1121799773369236, 1.112853374878145, 1.1240859150768467]
test loss: NIL 
MAE: [0.29522545627644764, 0.37992570964043443, 0.42202327940987483, 0.4688769718628262, 0.5217045670929941, 0.5426845076411349, 0.5538048851818383, 0.5811986847496448, 0.6159826179332647, 0.6378622903148692, 0.6474608744246905, 0.6660749024402388, 0.6943209492756994, 0.6977651547241149, 0.7002832658258603, 0.7154181067922066, 0.7373549573991409, 0.750711250641604, 0.754492501852285, 0.7629681304223912, 0.7807026841399288, 0.7788269284452053, 0.7734357156151349, 0.7827496094755905, 0.7949684554207878, 0.8081169861053914, 0.8021541250251311, 0.7945605303153165, 0.8114433390491632, 0.8174497340608042, 0.8176872073945388, 0.8275326886509075] , MAPE: [0.10379622179700346, 0.07715147808843145, 0.13743798193949203, 0.1540900786804454, 0.14632551071548489, 0.05594421730711174, 0.02521389292491559, 0.038715567292642424, 0.019268352545529815, 0.09940174679923412, 0.043133655472558964, 0.071686666617314, 0.04701369572768844, 0.036430317203758396, 0.003459681795249014, 0.040452270288729664, -0.006878348442024645, 0.019648327806627872, -0.015236711112946106, -0.002873523487126186, -0.017115876612531923, -0.018365345075078424, -0.05138483310771204, -0.04074121302687719, -0.04531532501800648, -0.09791642636337951, -0.10548292796171228, -0.1712677520031281, -0.2075490930332135, -0.22774211215543455, -0.18824011166105958, -0.20374175898856772] %, RMSE: [0.49937683578753367, 0.5987976759551042, 0.6504691149155064, 0.7076950396245154, 0.7671302659505217, 0.7939794339539107, 0.8166884983803262, 0.8533141686642491, 0.8875681572702411, 0.9086485397768715, 0.9187057590997214, 0.9391411616946123, 0.9730195736609731, 0.9734706568397248, 0.9806969889176512, 1.001193230980704, 1.0266640325478316, 1.0441403254372104, 1.0531402464243043, 1.062838945872651, 1.0861579557390006, 1.085542351984584, 1.0836372983512312, 1.0880722652691668, 1.094596834591372, 1.1086865440696592, 1.1063905732218755, 1.094309718218614, 1.1062639835471997, 1.1121799773369236, 1.112853374878145, 1.1240859150768467]
====================
training elapsedd with 320.49 seconds for 100 iterations, the sec/iter = 3.20

MAE_mean: [0.29522546 0.37992571 0.42202328 0.46887697 0.52170457 0.54268451
 0.55380489 0.58119868 0.61598262 0.63786229 0.64746087 0.6660749
 0.69432095 0.69776515 0.70028327 0.71541811 0.73735496 0.75071125
 0.7544925  0.76296813 0.78070268 0.77882693 0.77343572 0.78274961
 0.79496846 0.80811699 0.80215413 0.79456053 0.81144334 0.81744973
 0.81768721 0.82753269] , MAPE_mean: [ 0.10379622  0.07715148  0.13743798  0.15409008  0.14632551  0.05594422
  0.02521389  0.03871557  0.01926835  0.09940175  0.04313366  0.07168667
  0.0470137   0.03643032  0.00345968  0.04045227 -0.00687835  0.01964833
 -0.01523671 -0.00287352 -0.01711588 -0.01836535 -0.05138483 -0.04074121
 -0.04531533 -0.09791643 -0.10548293 -0.17126775 -0.20754909 -0.22774211
 -0.18824011 -0.20374176] , RMSE_mean: [0.49937684 0.59879768 0.65046911 0.70769504 0.76713027 0.79397943
 0.8166885  0.85331417 0.88756816 0.90864854 0.91870576 0.93914116
 0.97301957 0.97347066 0.98069699 1.00119323 1.02666403 1.04414033
 1.05314025 1.06283895 1.08615796 1.08554235 1.0836373  1.08807227
 1.09459683 1.10868654 1.10639057 1.09430972 1.10626398 1.11217998
 1.11285337 1.12408592]

MAE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , MAPE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , RMSE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
Finished training with: lr1e-3_bs64_nh128_ra1e-5_dp0.2_wd1e-6_ah2_ck5_kt4
user config:
seed 666
device 0
scaler StandardScaler()
day_slot 288
n_route 10
n_his 96
n_pred 96
n_train 34
n_val 5
n_test 5
mode 1
n_c 10
model STAGNN_stamp
TPG TPGNN
name lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2
log_path log/TPGNN_r05p02kt3outer_336
crash 336
new_name TPGNN_r05p02kt3outer_336
batch_size 64
lr 0.001
a 0.1
r 0.5
n_mask 1
adam {'use': True, 'weight_decay': 0.0001}
slr {'use': True, 'step_size': 400, 'gamma': 0.3}
resume False
start_epoch 0
epochs 100
n_layer 1
n_attr 64
n_hid 128
reg_A 1e-05
circle 288
drop_prob 0.3
CE {'use': True, 'kernel_size': 1, 'bias': False}
LE {'use': False, 'bias': False}
SE {'use': True, 'separate': True, 'no': False}
TE {'use': True, 'no': True}
attn {'head': 1, 'd_k': 32, 'd_v': 32, 'drop_prob': 0.2}
STstamp {'use': True, 'kt': 3, 'temperature': 1.0}
T4N {'use': True, 'step': 2, 'end_epoch': 10000, 'change_head': True, 'change_enc': True}
stamp_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/time_stamp_F_96.npy
data_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/V_France_processed_0.csv
adj_matrix_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/W_France_processed_0.csv
dis_mat tensor([[0.0000, 0.3661, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.6136, 0.0000,
         0.0000],
        [0.3661, 0.0000, 0.0000, 0.0000, 0.1098, 0.0000, 0.0000, 0.8975, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.3410, 0.8975, 0.0000, 0.0000, 0.0000, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.3410, 0.0000, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000,
         0.1494],
        [0.0000, 0.1098, 0.8975, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000, 0.6996,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000,
         0.2289],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000, 0.0000,
         0.5594],
        [0.6136, 0.8975, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.2117,
         0.0000],
        [0.0000, 0.4288, 0.4288, 0.0000, 0.6996, 0.0000, 0.0000, 0.2117, 0.0000,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.1494, 0.0000, 0.2289, 0.5594, 0.0000, 0.0000,
         0.0000]], device='cuda:0')
prefix log/lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2/
checkpoint_temp_path log/lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2//temp.pth
checkpoint_best_path log/lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2//best.pth
tensorboard_path log/lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2/
record_path log/lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2/record.txt
eps 0.1
parse <bound method DefaultConfig.parse of <config.DefaultConfig object at 0x7faca83d6550>>
output <bound method DefaultConfig.output of <config.DefaultConfig object at 0x7faca83d6550>>
train: True, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 9792
len(data): 9792, day_slot: 288, n_day: 34
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
10 10
epoch 0   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.7610223848445743 , validation loss: 1.037910245358944
epoch 1   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.4501175477224238 , validation loss: 0.9368389546871185
epoch 2   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.40343468621665357 , validation loss: 0.9465674161911011
epoch 3   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.3777180109538284 , validation loss: 0.8882697150111198
epoch 4   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.35963791900990055 , validation loss: 0.8250267431139946
epoch 5   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.34563322628245635 , validation loss: 0.8233063742518425
epoch 6   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.3306777652572183 , validation loss: 0.8149867653846741
epoch 7   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.3140025951114355 , validation loss: 0.742399625480175
epoch 8   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.29996133902493644 , validation loss: 0.738004669547081
epoch 9   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.28956032091496037 , validation loss: 0.7370507568120956
epoch 10   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.28290726215231654 , validation loss: 0.6919373348355293
epoch 11   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.27690814230956284 , validation loss: 0.6948527246713638
epoch 12   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.2724682005012737 , validation loss: 0.7447524815797806
epoch 13   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.2688148080133924 , validation loss: 0.6716557741165161
epoch 14   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.2668667613875632 , validation loss: 0.7324489429593086
epoch 15   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.2622540388621536 , validation loss: 0.6770624965429306
epoch 16   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.2607510998552921 , validation loss: 0.6784208416938782
epoch 17   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.25646502656095166 , validation loss: 0.652548685669899
epoch 18   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.25411825612479566 , validation loss: 0.6567429676651955
epoch 19   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.2518187200321871 , validation loss: 0.6986941024661064
epoch 20   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.24943572107483358 , validation loss: 0.6712541803717613
epoch 21   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.2471945613038306 , validation loss: 0.6865886449813843
epoch 22   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.24575231823266722 , validation loss: 0.6390088200569153
epoch 23   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.24413209247822856 , validation loss: 0.668173298239708
epoch 24   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.2417608195660161 , validation loss: 0.6726475432515144
epoch 25   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.24083383731982289 , validation loss: 0.7590417191386223
epoch 26   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.2419351207859376 , validation loss: 0.6401982381939888
epoch 27   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.2375582921154359 , validation loss: 0.6954851746559143
epoch 28   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.23746156546415068 , validation loss: 0.7799993306398392
epoch 29   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.23645671325571396 , validation loss: 0.6509847342967987
epoch 30   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.23478528068346136 , validation loss: 0.6429769173264503
epoch 31   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.23533368578144148 , validation loss: 0.6912699043750763
epoch 32   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.23384050995695824 , validation loss: 0.6993267387151718
epoch 33   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.23233761127088584 , validation loss: 0.6367653831839561
epoch 34   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.23188171579557307 , validation loss: 0.7215838804841042
epoch 35   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.2326037699685377 , validation loss: 0.6538743823766708
epoch 36   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.2311637705447627 , validation loss: 0.6321083381772041
epoch 37   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.22937514881292978 , validation loss: 0.6306137368083
epoch 38   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.229332672030318 , validation loss: 0.6474995911121368
epoch 39   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.22920405835497612 , validation loss: 0.7385720759630203
epoch 40   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.2303880917675355 , validation loss: 0.6507005244493484
epoch 41   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.2276674640529296 , validation loss: 0.6517225205898285
epoch 42   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.22678384886068456 , validation loss: 0.6607948616147041
epoch 43   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.22652664283911386 , validation loss: 0.6471201926469803
epoch 44   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.22752890020024544 , validation loss: 0.6495813727378845
epoch 45   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.22598195952527664 , validation loss: 0.7714671567082405
epoch 46   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.22582188949865453 , validation loss: 0.6567468568682671
epoch 47   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.224759438458611 , validation loss: 0.6474307999014854
epoch 48   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.22425668847327138 , validation loss: 0.6343675851821899
epoch 49   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.22393189136888467 , validation loss: 0.6247773170471191
epoch 50   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.22399184458396015 , validation loss: 0.6290018782019615
epoch 51   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.2237445744229298 , validation loss: 0.6690453588962555
epoch 52   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.22390450332679002 , validation loss: 0.661355160176754
epoch 53   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.22299145746464824 , validation loss: 0.6371518895030022
epoch 54   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.222971735923898 , validation loss: 0.6495529413223267
epoch 55   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.2231941938984628 , validation loss: 0.7132396474480629
epoch 56   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.22202980430687175 , validation loss: 0.641855962574482
epoch 57   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.22212561760462968 , validation loss: 0.6285044103860855
epoch 58   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.22138427139497271 , validation loss: 0.6519894599914551
epoch 59   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.2211053844760446 , validation loss: 0.6289469078183174
epoch 60   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.22158138044908934 , validation loss: 0.6769856438040733
epoch 61   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.22044803786511516 , validation loss: 0.6282264739274979
epoch 62   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.22132613378412583 , validation loss: 0.6385844647884369
epoch 63   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.22005372830465728 , validation loss: 0.6410752236843109
epoch 64   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.21913027821802625 , validation loss: 0.667549192905426
epoch 65   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.21943110841162064 , validation loss: 0.6532511860132217
epoch 66   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.21871884137976402 , validation loss: 0.6210862249135971
epoch 67   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.21808270993185977 , validation loss: 0.6482049599289894
epoch 68   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.21832905943487205 , validation loss: 0.6380722597241402
epoch 69   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.21784476468376085 , validation loss: 0.6292105540633202
epoch 70   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.21780285765143 , validation loss: 0.6774790287017822
epoch 71   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.21741540496255837 , validation loss: 0.6404764354228973
epoch 72   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.21765275299549103 , validation loss: 0.703902468085289
epoch 73   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.21721089032350802 , validation loss: 0.6533793359994888
epoch 74   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.21658595490689372 , validation loss: 0.6271547824144363
epoch 75   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.2169963565527224 , validation loss: 0.6293799057602882
epoch 76   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.21609963739619537 , validation loss: 0.6628070324659348
epoch 77   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.21629652936084598 , validation loss: 0.7110901400446892
epoch 78   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.21631522184493496 , validation loss: 0.6626318916678429
epoch 79   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.21616316133854435 , validation loss: 0.6625233963131905
epoch 80   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.21589675808654113 , validation loss: 0.6467010378837585
epoch 81   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.21661802483539955 , validation loss: 0.6573670506477356
epoch 82   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.21546165937302159 , validation loss: 0.6360032707452774
epoch 83   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.2168586347617355 , validation loss: 0.604811042547226
epoch 84   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.21453067368152096 , validation loss: 0.6980731636285782
epoch 85   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.2141565809062883 , validation loss: 0.6273778975009918
epoch 86   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.2142742019073636 , validation loss: 0.7153171673417091
epoch 87   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.2137502180595024 , validation loss: 0.6363676637411118
epoch 88   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.2139770636955897 , validation loss: 0.6507517546415329
epoch 89   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.2135940074336295 , validation loss: 0.6171402409672737
epoch 90   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.21368247270584106 , validation loss: 0.6348656266927719
epoch 91   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.2141517727982764 , validation loss: 0.6594903767108917
epoch 92   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.21363307360340567 , validation loss: 0.6786170527338982
epoch 93   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.2132206211487452 , validation loss: 0.6013508886098862
epoch 94   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.2128466668666578 , validation loss: 0.6714042127132416
epoch 95   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.21338277266306035 , validation loss: 0.6305074617266655
epoch 96   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.21259871096003288 , validation loss: 0.617866761982441
tensor(8.0934, device='cuda:0')
MAE: [0.26012788734475595, 0.3419208278192073, 0.36783001101758217, 0.3961945195388548, 0.4274084017416174, 0.460834863759078, 0.47216781297487387, 0.4750751005249463, 0.48944218704880205, 0.5256631334475481, 0.5391471212146055, 0.5539565851777485, 0.5672103129056542, 0.5831425985198506, 0.5846127294239194, 0.5852595693422193, 0.5885941589637131, 0.6039198255097282, 0.6041678366088549, 0.6085933250832112, 0.609740225209941, 0.610961722805328, 0.6009502398069064, 0.595195396762226, 0.5923398061225326, 0.6006833988623982, 0.5944206485739842, 0.5898890553503153, 0.5886185923840889, 0.5850265017082703, 0.578411500712799, 0.5778113533433565] , MAPE: [0.06565217040909065, 0.0967277946670422, 0.2064378101248411, 0.1604596566503464, 0.19577632193920133, 0.10672267865052641, 0.09499509532380919, 0.06559525624885808, 0.054703243260721006, 0.12489343276902669, 0.073078496598665, 0.05636984811419062, 0.1189258866913775, 0.1747333881117466, 0.06549497687514773, 0.050509542326212464, 0.06390112474827472, 0.08706006709119148, 0.05698632643492976, 0.056754145200219375, 0.12187851764634222, 0.12167921315145633, 0.09432794359131577, 0.028563617868749253, 0.0538404919213817, 0.025378077320657614, -0.0030467356256789592, -0.09275493297342165, -0.12492502353273088, -0.04152607447646268, -0.12699240571561063, -0.2803306312493633] %, RMSE: [0.455402402157353, 0.569986221852789, 0.6055421434134448, 0.6350458338341427, 0.6648158003295869, 0.7002128463465123, 0.7177596505888663, 0.7147859342714876, 0.7267219767602333, 0.7665673531116849, 0.783094607559289, 0.7912931268714396, 0.8051768498314209, 0.8143130407493525, 0.8128451247220888, 0.8083387359078733, 0.8154265385176592, 0.8301857782269162, 0.8294858554651282, 0.8334654523694076, 0.8344465466071294, 0.8316299605748955, 0.8162264579292445, 0.8074527176545263, 0.8010928250842819, 0.81078101379904, 0.8052607715118358, 0.7939234645091439, 0.7940043005300449, 0.7909579086723759, 0.7828426170400136, 0.7805586958449201]
epoch 97   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.21216312342999027 , validation loss: 0.6374421268701553
tensor(8.0315, device='cuda:0')
MAE: [0.27148020229590386, 0.35440599909249076, 0.38418947038884016, 0.40880756799054824, 0.44577833870637046, 0.4743399148975912, 0.49986643434060524, 0.5203809793850349, 0.5410894611416404, 0.5632488088586282, 0.5768442429682796, 0.5816946562217338, 0.5987965887354821, 0.6105052185657712, 0.6198528177920998, 0.6207056866839682, 0.6287125064755223, 0.6268780168894793, 0.6223972939388808, 0.6221547657170707, 0.6345894534144666, 0.6439411734447805, 0.6462720594115402, 0.656597551307881, 0.6590646153665388, 0.6499057065747371, 0.6457042849995196, 0.6436177924048808, 0.6543335158189701, 0.6664371855964059, 0.6764102151225676, 0.6895783322903606] , MAPE: [0.07652244830410185, 0.08786097240587157, 0.16802429376148437, 0.15413939178028851, 0.1671839422323964, 0.03924229637002297, 0.022291277237671558, 0.005350213229852596, -0.03554820336168632, 0.028842089549970175, -0.025572426244461238, -0.008975719957447134, -0.04217471797031245, 0.0017762016911616492, -0.10560781971080453, -0.04790863422277268, -0.07276423528242301, -0.05591389581674504, -0.06097208126503902, -0.09945695478785675, -0.10419343560679634, -0.02306545553415397, -0.08808645860209206, -0.08562907887197858, -0.04500553653474667, -0.008014265155952577, -0.014347606687662528, -0.05224458349287104, -0.1617623654627118, -0.057740483814898456, -0.10734129580756717, -0.2136218354239647] %, RMSE: [0.46638777855731267, 0.5777150003636914, 0.6135331141184978, 0.6345278630488944, 0.6656370122922467, 0.6918342252813504, 0.7211254644984495, 0.7355109295681795, 0.7495979492540626, 0.7724393712111046, 0.7868196941357346, 0.7850138210603219, 0.8011079054442803, 0.8052191880612172, 0.8109455448904979, 0.8063052946525168, 0.8179758373011022, 0.8103932091848237, 0.8023679955096976, 0.8027250639159335, 0.816966797559345, 0.8211994298676165, 0.8234279783244636, 0.8269462387221941, 0.8243199202942239, 0.8152159699723326, 0.8134434665432171, 0.8073690870640414, 0.8167302357342298, 0.8268877738821426, 0.8394294705765986, 0.8465476567432402]
epoch 98   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.21258225657191931 , validation loss: 0.689972810447216
tensor(7.9048, device='cuda:0')
MAE: [0.2714439463209284, 0.34971659814794887, 0.3950475642203651, 0.4361921146642609, 0.4813256023826135, 0.5172426347395156, 0.5497638946699612, 0.5688162618246141, 0.6060407602374164, 0.636389846491637, 0.6641496249246075, 0.6901947988637905, 0.6979744458555714, 0.7073986052003565, 0.7128528832369628, 0.7136766144333734, 0.7213747372943908, 0.7177978057819466, 0.7133332429987561, 0.7167777599928151, 0.7135009988309028, 0.7081794246084527, 0.7039791643985346, 0.691860279739095, 0.6976098986732361, 0.6920069326661988, 0.677910262781397, 0.673555205661213, 0.6747378329458388, 0.6707928075294788, 0.6599896317449657, 0.6458318941519816] , MAPE: [0.03833268982429433, 0.08993042457538697, 0.2148650404027992, 0.18983301883981654, 0.14989586559336418, 0.07183878774938328, 0.005405189596656914, 0.00998892929047327, -0.00023482080391143417, 0.07790550196767765, 0.11719916263777948, 0.14214541127787034, 0.13785150348664604, 0.1574676354522589, 0.038497441290863056, 0.04205185113316306, 0.0017179268417242654, 0.07535480744935284, 0.03326223795081796, 0.09971794118610278, 0.14697301903334142, 0.12039776946643617, 0.06918772169496545, 0.03953604306896954, -0.07468046031356429, -0.10726003004841764, -0.1560604109442565, -0.17803942467292144, -0.25012585733539533, -0.18237343540901232, -0.2095731839631353, -0.5305361758653926] %, RMSE: [0.46626317904379966, 0.5790538098827807, 0.6369904779888275, 0.6751905443296283, 0.7140893825928574, 0.7523961753601457, 0.7915193669681791, 0.810320394123461, 0.8471287013469919, 0.8812326960593133, 0.9158172248013923, 0.9411948348877242, 0.9498492104492459, 0.960910080444563, 0.9722965211795409, 0.9714672626177538, 0.9800799872387397, 0.9739450988377335, 0.9665681807581351, 0.967464214286277, 0.9588178508201047, 0.951713224960941, 0.9484804641135753, 0.9322019673356431, 0.9347098600801259, 0.9310233345311827, 0.9210793026136168, 0.909576045347508, 0.9054024852516748, 0.9018234123927397, 0.8937823266216979, 0.8799644244645252]
epoch 99   lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2 , train loss: 0.2117854572978674 , validation loss: 0.6661977544426918
tensor(7.7917, device='cuda:0')
MAE: [0.26595642788076446, 0.3550972637527421, 0.3837534751672029, 0.43205718515239194, 0.47823447926546037, 0.5039441572753809, 0.5194727947289297, 0.5409484756539201, 0.5639624220578326, 0.5999505254764532, 0.6127383770029415, 0.643018015367315, 0.6573862373410273, 0.6618761361805127, 0.6635090650007436, 0.6775258974467894, 0.6770620692016307, 0.6819842575847642, 0.668932289336952, 0.6795873705021193, 0.6800989081914124, 0.6689214837852596, 0.6606711007189966, 0.661004818843044, 0.6557632761271959, 0.6602181565481209, 0.6487785209507979, 0.6481335811701018, 0.6522392953194909, 0.6435154733753081, 0.6330032810046501, 0.6256095647116758] , MAPE: [0.09677864114222176, 0.08634093730224533, 0.20124291637796426, 0.17409756532360765, 0.18920324011541695, 0.09987585862953884, 0.04722672042022543, 0.13294056022481526, 0.05823112296374188, 0.14321654408089107, 0.15283891369292235, 0.16659636674956516, 0.20063488299808388, 0.19003112093995855, 0.09181553967803394, 0.15332397403777276, 0.11508321759150537, 0.1428373834809673, 0.11804368232631232, 0.16111929266664615, 0.16837420716152057, 0.16727928475247647, 0.11646029106396509, 0.1247330742872123, 0.06347169369321734, -0.00732967248391246, -0.041261687638836954, -0.10321950022599566, -0.2263094545477886, -0.10963991478145525, -0.10853372844882485, -0.36773300038708767] %, RMSE: [0.4636394067336851, 0.5830122998759969, 0.6182002742033466, 0.6682491134010073, 0.7126291633234375, 0.7406559150175485, 0.7608466898449008, 0.777490866586652, 0.800857041285167, 0.8392072929321114, 0.8570819791836327, 0.8876915015494228, 0.9059555980760996, 0.910478748281767, 0.910637365983887, 0.9244478672018229, 0.9278345389507655, 0.931470303787561, 0.91308370046049, 0.9226333145974063, 0.9250759204867486, 0.9097403593492178, 0.8982020558257692, 0.8939682882109988, 0.8915357591421317, 0.8944763698984428, 0.8790872583884531, 0.8738206120666666, 0.8814812866349127, 0.8701772130782288, 0.8606324021104973, 0.8531813259287752]
test loss: NIL 
MAE: [0.26595642788076446, 0.3550972637527421, 0.3837534751672029, 0.43205718515239194, 0.47823447926546037, 0.5039441572753809, 0.5194727947289297, 0.5409484756539201, 0.5639624220578326, 0.5999505254764532, 0.6127383770029415, 0.643018015367315, 0.6573862373410273, 0.6618761361805127, 0.6635090650007436, 0.6775258974467894, 0.6770620692016307, 0.6819842575847642, 0.668932289336952, 0.6795873705021193, 0.6800989081914124, 0.6689214837852596, 0.6606711007189966, 0.661004818843044, 0.6557632761271959, 0.6602181565481209, 0.6487785209507979, 0.6481335811701018, 0.6522392953194909, 0.6435154733753081, 0.6330032810046501, 0.6256095647116758] , MAPE: [0.09677864114222176, 0.08634093730224533, 0.20124291637796426, 0.17409756532360765, 0.18920324011541695, 0.09987585862953884, 0.04722672042022543, 0.13294056022481526, 0.05823112296374188, 0.14321654408089107, 0.15283891369292235, 0.16659636674956516, 0.20063488299808388, 0.19003112093995855, 0.09181553967803394, 0.15332397403777276, 0.11508321759150537, 0.1428373834809673, 0.11804368232631232, 0.16111929266664615, 0.16837420716152057, 0.16727928475247647, 0.11646029106396509, 0.1247330742872123, 0.06347169369321734, -0.00732967248391246, -0.041261687638836954, -0.10321950022599566, -0.2263094545477886, -0.10963991478145525, -0.10853372844882485, -0.36773300038708767] %, RMSE: [0.4636394067336851, 0.5830122998759969, 0.6182002742033466, 0.6682491134010073, 0.7126291633234375, 0.7406559150175485, 0.7608466898449008, 0.777490866586652, 0.800857041285167, 0.8392072929321114, 0.8570819791836327, 0.8876915015494228, 0.9059555980760996, 0.910478748281767, 0.910637365983887, 0.9244478672018229, 0.9278345389507655, 0.931470303787561, 0.91308370046049, 0.9226333145974063, 0.9250759204867486, 0.9097403593492178, 0.8982020558257692, 0.8939682882109988, 0.8915357591421317, 0.8944763698984428, 0.8790872583884531, 0.8738206120666666, 0.8814812866349127, 0.8701772130782288, 0.8606324021104973, 0.8531813259287752]
====================
training elapsedd with 319.87 seconds for 100 iterations, the sec/iter = 3.20

MAE_mean: [0.26595643 0.35509726 0.38375348 0.43205719 0.47823448 0.50394416
 0.51947279 0.54094848 0.56396242 0.59995053 0.61273838 0.64301802
 0.65738624 0.66187614 0.66350907 0.6775259  0.67706207 0.68198426
 0.66893229 0.67958737 0.68009891 0.66892148 0.6606711  0.66100482
 0.65576328 0.66021816 0.64877852 0.64813358 0.6522393  0.64351547
 0.63300328 0.62560956] , MAPE_mean: [ 0.09677864  0.08634094  0.20124292  0.17409757  0.18920324  0.09987586
  0.04722672  0.13294056  0.05823112  0.14321654  0.15283891  0.16659637
  0.20063488  0.19003112  0.09181554  0.15332397  0.11508322  0.14283738
  0.11804368  0.16111929  0.16837421  0.16727928  0.11646029  0.12473307
  0.06347169 -0.00732967 -0.04126169 -0.1032195  -0.22630945 -0.10963991
 -0.10853373 -0.367733  ] , RMSE_mean: [0.46363941 0.5830123  0.61820027 0.66824911 0.71262916 0.74065592
 0.76084669 0.77749087 0.80085704 0.83920729 0.85708198 0.8876915
 0.9059556  0.91047875 0.91063737 0.92444787 0.92783454 0.9314703
 0.9130837  0.92263331 0.92507592 0.90974036 0.89820206 0.89396829
 0.89153576 0.89447637 0.87908726 0.87382061 0.88148129 0.87017721
 0.8606324  0.85318133]

MAE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , MAPE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , RMSE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
Finished training with: lr1e-3_bs64_nh128_ra1e-5_dp0.3_wd1e-5_ah4_ck3_kt2
user config:
seed 666
device 0
scaler StandardScaler()
day_slot 288
n_route 10
n_his 96
n_pred 96
n_train 34
n_val 5
n_test 5
mode 1
n_c 10
model STAGNN_stamp
TPG TPGNN
name lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2
log_path log/TPGNN_r05p02kt3outer_337
crash 337
new_name TPGNN_r05p02kt3outer_337
batch_size 64
lr 0.0001
a 0.1
r 0.5
n_mask 1
adam {'use': True, 'weight_decay': 0.0001}
slr {'use': True, 'step_size': 400, 'gamma': 0.3}
resume False
start_epoch 0
epochs 100
n_layer 1
n_attr 64
n_hid 256
reg_A 1e-05
circle 288
drop_prob 0.3
CE {'use': True, 'kernel_size': 1, 'bias': False}
LE {'use': False, 'bias': False}
SE {'use': True, 'separate': True, 'no': False}
TE {'use': True, 'no': True}
attn {'head': 1, 'd_k': 32, 'd_v': 32, 'drop_prob': 0.2}
STstamp {'use': True, 'kt': 3, 'temperature': 1.0}
T4N {'use': True, 'step': 2, 'end_epoch': 10000, 'change_head': True, 'change_enc': True}
stamp_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/time_stamp_F_96.npy
data_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/V_France_processed_0.csv
adj_matrix_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/W_France_processed_0.csv
dis_mat tensor([[0.0000, 0.3661, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.6136, 0.0000,
         0.0000],
        [0.3661, 0.0000, 0.0000, 0.0000, 0.1098, 0.0000, 0.0000, 0.8975, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.3410, 0.8975, 0.0000, 0.0000, 0.0000, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.3410, 0.0000, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000,
         0.1494],
        [0.0000, 0.1098, 0.8975, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000, 0.6996,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000,
         0.2289],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000, 0.0000,
         0.5594],
        [0.6136, 0.8975, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.2117,
         0.0000],
        [0.0000, 0.4288, 0.4288, 0.0000, 0.6996, 0.0000, 0.0000, 0.2117, 0.0000,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.1494, 0.0000, 0.2289, 0.5594, 0.0000, 0.0000,
         0.0000]], device='cuda:0')
prefix log/lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2/
checkpoint_temp_path log/lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2//temp.pth
checkpoint_best_path log/lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2//best.pth
tensorboard_path log/lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2/
record_path log/lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2/record.txt
eps 0.1
parse <bound method DefaultConfig.parse of <config.DefaultConfig object at 0x7f5be7c55550>>
output <bound method DefaultConfig.output of <config.DefaultConfig object at 0x7f5be7c55550>>
train: True, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 9792
len(data): 9792, day_slot: 288, n_day: 34
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
10 10
epoch 0   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 1.2482105890909831 , validation loss: 1.0415592640638351
epoch 1   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.760291832334855 , validation loss: 1.045999400317669
epoch 2   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.6040863792101542 , validation loss: 1.0636544600129128
epoch 3   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.5440609291488049 , validation loss: 1.0856636613607407
epoch 4   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.5145152725425421 , validation loss: 1.0748609080910683
epoch 5   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.49265069938173484 , validation loss: 1.028366543352604
epoch 6   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.47547762300453933 , validation loss: 1.0008557885885239
epoch 7   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.46031232382736953 , validation loss: 0.9791162386536598
epoch 8   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.4478040419372858 , validation loss: 0.9677110388875008
epoch 9   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.43680811746447695 , validation loss: 0.9667863771319389
epoch 10   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.42698968099612816 , validation loss: 0.987722247838974
epoch 11   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.41852425710827695 , validation loss: 0.9398616552352905
epoch 12   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.4107467345162934 , validation loss: 0.9302780255675316
epoch 13   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.4039768658432306 , validation loss: 0.9356173947453499
epoch 14   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.39774901609794766 , validation loss: 0.9339575991034508
epoch 15   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.3921063308622323 , validation loss: 0.9485748186707497
epoch 16   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.38685907511150136 , validation loss: 0.9247979298233986
epoch 17   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.3821527841044407 , validation loss: 0.9089474081993103
epoch 18   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.3777185170089497 , validation loss: 0.9071665331721306
epoch 19   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.37343409131554994 , validation loss: 0.9140548631548882
epoch 20   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.36958041728711594 , validation loss: 0.8747053667902946
epoch 21   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.36572690220440135 , validation loss: 0.8681162446737289
epoch 22   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.362178783790738 , validation loss: 0.8812892436981201
epoch 23   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.3585498186887479 , validation loss: 0.8532956391572952
epoch 24   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.3551459885111042 , validation loss: 0.8448699787259102
epoch 25   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.35170885511473116 , validation loss: 0.8264660537242889
epoch 26   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.3484577396336724 , validation loss: 0.8184992969036102
epoch 27   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.34513266063204 , validation loss: 0.8076665624976158
epoch 28   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.3419582265264848 , validation loss: 0.8068982437252998
epoch 29   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.33843956215708865 , validation loss: 0.7996510565280914
epoch 30   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.33504653970400494 , validation loss: 0.7783806845545769
epoch 31   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.33133457805596145 , validation loss: 0.763819731771946
epoch 32   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.3274475435415904 , validation loss: 0.7497671321034431
epoch 33   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.32350241845729305 , validation loss: 0.7452854141592979
epoch 34   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.3198362734972262 , validation loss: 0.750617153942585
epoch 35   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.3157116548687804 , validation loss: 0.7283634021878242
epoch 36   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.3124513053426556 , validation loss: 0.7226409837603569
epoch 37   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.3092089377197565 , validation loss: 0.7004991918802261
epoch 38   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.30679790120498807 , validation loss: 0.7116034105420113
epoch 39   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.30434496437802033 , validation loss: 0.6960332095623016
epoch 40   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.30223756327348594 , validation loss: 0.714055672287941
epoch 41   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.3003598901571012 , validation loss: 0.6956328600645065
epoch 42   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.29845307212249905 , validation loss: 0.6950545310974121
epoch 43   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.29681770415867076 , validation loss: 0.690814308822155
epoch 44   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.2952181445617302 , validation loss: 0.6831681430339813
epoch 45   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.29367153258884654 , validation loss: 0.6844660490751266
epoch 46   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.29205870920536564 , validation loss: 0.6842586249113083
epoch 47   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.2907247181032218 , validation loss: 0.6892871782183647
epoch 48   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.28935852705263626 , validation loss: 0.6902740821242332
epoch 49   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.2880648602457607 , validation loss: 0.6767739951610565
epoch 50   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.286929657646254 , validation loss: 0.6830436140298843
epoch 51   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.2855508017773722 , validation loss: 0.6785734593868256
epoch 52   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.28453293325854284 , validation loss: 0.6806973069906235
epoch 53   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.2832730430013993 , validation loss: 0.689095564186573
epoch 54   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.2821929355462392 , validation loss: 0.6739999353885651
epoch 55   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.28107424051153895 , validation loss: 0.673532523214817
epoch 56   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.2798283094284581 , validation loss: 0.6713016852736473
epoch 57   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.27909891628751565 , validation loss: 0.6859948337078094
epoch 58   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.2779783139041826 , validation loss: 0.6768640801310539
epoch 59   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.27706143610617695 , validation loss: 0.6791123524308205
epoch 60   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.27595945140894723 , validation loss: 0.6666802540421486
epoch 61   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.2750355630528693 , validation loss: 0.679975263774395
epoch 62   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.2742106692463744 , validation loss: 0.666478842496872
epoch 63   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.273285891495499 , validation loss: 0.6690902858972549
epoch 64   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.2723869856666116 , validation loss: 0.6592971906065941
epoch 65   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.2715434350219427 , validation loss: 0.6683304533362389
epoch 66   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.27065372642348795 , validation loss: 0.6715864539146423
epoch 67   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.2698369280380361 , validation loss: 0.6659166663885117
epoch 68   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.2693304679557389 , validation loss: 0.6580877900123596
epoch 69   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.26827672971229927 , validation loss: 0.6555532813072205
epoch 70   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.26755179903086496 , validation loss: 0.6590524092316628
epoch 71   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.2667284429657693 , validation loss: 0.6773786395788193
epoch 72   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.2661239306131999 , validation loss: 0.6469212248921394
epoch 73   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.2651335664239584 , validation loss: 0.6628178432583809
epoch 74   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.26456884192485436 , validation loss: 0.6552257090806961
epoch 75   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.2638619828457926 , validation loss: 0.6559916287660599
epoch 76   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.2632247735472286 , validation loss: 0.6589602380990982
epoch 77   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.2627201877972659 , validation loss: 0.6591760888695717
epoch 78   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.26197553031584797 , validation loss: 0.6564686223864555
epoch 79   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.26132047030271266 , validation loss: 0.6550208032131195
epoch 80   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.26056262792325485 , validation loss: 0.6513117551803589
epoch 81   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.25979890981141257 , validation loss: 0.6531842201948166
epoch 82   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.25937216918842465 , validation loss: 0.649104505777359
epoch 83   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.25882156923705457 , validation loss: 0.6460397094488144
epoch 84   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.25808311794318406 , validation loss: 0.6514008045196533
epoch 85   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.25756087110323067 , validation loss: 0.648339293897152
epoch 86   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.2569289224989274 , validation loss: 0.659124568104744
epoch 87   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.256548859909469 , validation loss: 0.6633499413728714
epoch 88   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.25589455079798606 , validation loss: 0.6596410796046257
epoch 89   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.2555361244024015 , validation loss: 0.6406792178750038
epoch 90   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.25484492206105996 , validation loss: 0.6405552700161934
epoch 91   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.2542807097528495 , validation loss: 0.6427311226725578
epoch 92   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.253755204817828 , validation loss: 0.6364008486270905
epoch 93   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.25313650393018533 , validation loss: 0.6381902098655701
epoch 94   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.25257911810687944 , validation loss: 0.645649828016758
epoch 95   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.25213833065593944 , validation loss: 0.6471196785569191
epoch 96   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.25168079897469164 , validation loss: 0.6406005024909973
tensor(56.8356, device='cuda:0')
MAE: [0.30838172259471697, 0.37951208386354185, 0.4176615015837873, 0.4608282434842405, 0.48911721184158446, 0.5143881834212921, 0.5140520605341214, 0.5106724876723223, 0.5378721765662813, 0.5564844156237146, 0.5678786165142413, 0.5858266496345323, 0.6073911874760518, 0.6090233036299649, 0.5965195069427497, 0.5949347760313257, 0.611520082972579, 0.6144077929915841, 0.6183982673333478, 0.6267788367023327, 0.634844118997301, 0.6273506704085151, 0.6076813843473792, 0.5946197403629416, 0.600727469479646, 0.600851016753574, 0.5964812178479642, 0.5881262908989238, 0.5760667054666225, 0.5669885913048363, 0.5545645296819431, 0.5503243096723922] , MAPE: [0.11865435178390285, 0.0420312998299913, 0.18614258389808683, 0.15827433884575062, 0.1259584019908675, 0.10608424476737614, 0.06068711200778669, 0.054409255944756485, 0.026476844675606716, 0.10453378755792486, 0.114279946241547, 0.115366964667229, 0.12188940404608879, 0.13862907322639714, 0.08541583704091572, 0.06003665276612101, 0.057159870670730015, 0.10949578316441795, 0.10374421214792558, 0.05370760086943903, 0.11736736752911346, 0.09264884760727525, 0.06547677832631156, 0.050971361248006566, 0.09057795879145432, 0.06453274158876121, 0.034763645467554824, -0.014232484540267794, -0.04118122884616635, -0.02761058283946357, -0.05038882289587678, -0.13772096996131705] %, RMSE: [0.5733606848494333, 0.6526092772995459, 0.696839782204743, 0.7552469415230768, 0.7784173592124327, 0.8001940284219589, 0.7968585715275774, 0.7845039508131052, 0.8109548584903594, 0.8199224892076672, 0.8281216434277493, 0.8474959650166707, 0.8752050490837601, 0.8673215742182415, 0.8514051184997197, 0.8482751960633595, 0.8741060595132795, 0.863114164956237, 0.8654819411760685, 0.8789461873063709, 0.8862434083114609, 0.8684533501008432, 0.8464761019915517, 0.8242354446965731, 0.8326626725060713, 0.829377291771533, 0.8227471294163665, 0.808520467158214, 0.7856759998437713, 0.7698878163613168, 0.7613496157598256, 0.7613408769635529]
epoch 97   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.2512341799104915 , validation loss: 0.6439406871795654
tensor(56.6128, device='cuda:0')
MAE: [0.2954784538400523, 0.3832949444826827, 0.4212138718559608, 0.4624025710919853, 0.4855731166995217, 0.5152787314155667, 0.515475111064914, 0.5283301985259984, 0.5477670778047063, 0.5658414823427489, 0.5892111877290551, 0.6012344219044005, 0.6135809697262635, 0.6221002867689222, 0.612832564295644, 0.6290400543166612, 0.624882255117841, 0.6290480268756216, 0.6333586171853174, 0.6505309100279143, 0.646210259126941, 0.6404215662795858, 0.6210333272893481, 0.6245409862412927, 0.609927187790883, 0.6027488755286892, 0.6029485576749616, 0.6005582826242772, 0.5961232553890993, 0.5893606525260149, 0.5755334955050619, 0.5818904039044817] , MAPE: [0.11794568277120224, 0.047361294710918656, 0.19917514397618996, 0.17253794091041444, 0.12157726605140907, 0.10649148370002857, 0.06107926042881755, 0.06339876646143576, 0.04827699838396397, 0.11788384455823839, 0.10244667639190627, 0.1066771201766396, 0.1211608075966534, 0.13260433112634779, 0.06876900827225157, 0.04447578508942298, 0.056967498958819744, 0.1094705713376224, 0.07299304137043906, 0.036776588130706306, 0.10701795173601306, 0.08899908478518968, 0.05858742533857123, 0.038452469996499504, 0.07578090701314931, 0.05753320730513336, 0.019929137524141157, -0.022432450419549887, -0.04012410078567966, -0.03577742325118323, -0.045020173440132885, -0.10084901938511862] %, RMSE: [0.5576258385515439, 0.6631858508915406, 0.703483863549398, 0.758434613456913, 0.7720692239211796, 0.799554585100926, 0.7966406199547774, 0.8154547322530051, 0.8278305313046996, 0.8324714845941781, 0.8602307295824317, 0.866976739655407, 0.8787037802099318, 0.8802690771704129, 0.8695594519092169, 0.8991346597576967, 0.8898706828194819, 0.8809790569494905, 0.8830543305471277, 0.9099347667859959, 0.8971483560740978, 0.8830898547000977, 0.8608105750421071, 0.8655893029389854, 0.839308406226787, 0.8242251905474824, 0.8213679189903393, 0.8164603801482853, 0.8055627937273739, 0.791885128481584, 0.7804265912699342, 0.7964683046797131]
epoch 98   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.25083348505637226 , validation loss: 0.654407262802124
tensor(56.4011, device='cuda:0')
MAE: [0.30492246063790984, 0.3926755058951676, 0.4330729736603278, 0.47180524352899533, 0.5086170439057283, 0.5421972129808873, 0.5321880799418641, 0.5262327221673482, 0.5425908819468903, 0.5775251275934663, 0.5995663414291615, 0.6127540047681823, 0.6351460076319342, 0.6551773204508516, 0.638979043153681, 0.6329439917972945, 0.6332138952601355, 0.6409672246550776, 0.650663779367472, 0.6653473643866397, 0.6702838519576592, 0.6795698502425527, 0.6624987770060135, 0.6511207562016765, 0.6299429524497887, 0.6275408834441728, 0.6275327027788788, 0.6190684338317243, 0.6103097632404455, 0.6074755402216592, 0.5869172856593793, 0.5860628855378204] , MAPE: [0.11472579601150577, 0.05166654521622215, 0.1779405786492001, 0.16804408383464048, 0.1110828893868638, 0.10280222688242313, 0.05787583938985898, 0.043404148870050854, 0.028995451208434463, 0.0969078047805737, 0.10493235413664376, 0.09817567334910114, 0.09790697478366411, 0.1277830159823985, 0.06706838063147366, 0.043034523670987965, 0.036723438171788095, 0.07355497245308892, 0.0637483782933569, 0.021372039514333797, 0.08437727914386584, 0.06990915523055273, 0.05257820667618869, 0.02663531104847429, 0.06697380916048658, 0.03277835852018865, 0.012292291133852972, -0.040215785311866245, -0.05569624296652955, -0.04772629143447572, -0.046427138591744486, -0.1135283684405107] %, RMSE: [0.5653748999650977, 0.6699227330991444, 0.7161873225062885, 0.7695820513395936, 0.805980953800608, 0.8409963114489065, 0.8144289466478273, 0.7988476117721812, 0.8082869452851426, 0.8463927247072213, 0.8717382566054777, 0.8806022884366506, 0.9099436611063182, 0.9325258415842808, 0.9080482073369399, 0.8969592840488068, 0.8939670229574219, 0.8893168889999878, 0.9011496060077975, 0.9266172369294164, 0.9293905527215586, 0.940398352993508, 0.9238691904953331, 0.8983352015381313, 0.8605458417428068, 0.8525413687998968, 0.8516134461211843, 0.837026861685054, 0.8187148532001391, 0.8119250587366148, 0.7907330471438522, 0.7933408546331877]
epoch 99   lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2 , train loss: 0.250316294092758 , validation loss: 0.6367427408695221
tensor(56.1926, device='cuda:0')
MAE: [0.2960862343638329, 0.3676236365775856, 0.4098320725900073, 0.4414453731481101, 0.4744402103035797, 0.5043277980287357, 0.5020674773504401, 0.5069064940926955, 0.5369427496162196, 0.5669755691942787, 0.5769262889234983, 0.5805530145650096, 0.5945134854414644, 0.6080504607754884, 0.6004785883552443, 0.6060368267300817, 0.6118432750526009, 0.6196416908878948, 0.6208568346158592, 0.624854611219435, 0.6272958742934711, 0.6229929165364503, 0.6122116867744738, 0.6152167222007494, 0.6158558732705172, 0.6115447240426521, 0.6018683108370559, 0.590826357237841, 0.5924262358728297, 0.5836018424936253, 0.570999337870282, 0.5749390271455818] , MAPE: [0.11870350156358794, 0.051765444503109076, 0.2002735773447312, 0.16825970817543426, 0.110819192572928, 0.1127368280106943, 0.05621460371666957, 0.041284045468542974, 0.015706469404696277, 0.09850999924254042, 0.07251286442659209, 0.08153930105666507, 0.0959020067474143, 0.11308559090361574, 0.032442611085008545, -0.0013825933361283776, 0.0065497128969987314, 0.04978522790759711, 0.03765929690623022, -0.00035918849846265654, 0.07682693922917416, 0.05226586947306995, -0.0025531080454202684, -0.003333978219768526, 0.05231748753742161, 0.025581506066513066, -0.0036037715007166964, -0.054212309570233555, -0.06271796837885209, -0.05178789764718925, -0.07843326199479633, -0.14505645771099845] %, RMSE: [0.5620436956071191, 0.6412238764172483, 0.6889984002199323, 0.7314830383702844, 0.7618344460544212, 0.7881092457079257, 0.7778383059881959, 0.7783005579732893, 0.8089421153472514, 0.8334288272663914, 0.8351510064584058, 0.8306675322338554, 0.8470392567786829, 0.8584999830496894, 0.8450730506919454, 0.8523860561354307, 0.8577223283643257, 0.8514211738555778, 0.8505029188618363, 0.8576408153722215, 0.8562685039024245, 0.8416611900541053, 0.8302920456848807, 0.8335256533186775, 0.8349635884431219, 0.8248161076260617, 0.8102670143550912, 0.796452067500211, 0.7966177421747435, 0.7778844877875226, 0.7681127461962414, 0.7770177182008101]
test loss: NIL 
MAE: [0.2960862343638329, 0.3676236365775856, 0.4098320725900073, 0.4414453731481101, 0.4744402103035797, 0.5043277980287357, 0.5020674773504401, 0.5069064940926955, 0.5369427496162196, 0.5669755691942787, 0.5769262889234983, 0.5805530145650096, 0.5945134854414644, 0.6080504607754884, 0.6004785883552443, 0.6060368267300817, 0.6118432750526009, 0.6196416908878948, 0.6208568346158592, 0.624854611219435, 0.6272958742934711, 0.6229929165364503, 0.6122116867744738, 0.6152167222007494, 0.6158558732705172, 0.6115447240426521, 0.6018683108370559, 0.590826357237841, 0.5924262358728297, 0.5836018424936253, 0.570999337870282, 0.5749390271455818] , MAPE: [0.11870350156358794, 0.051765444503109076, 0.2002735773447312, 0.16825970817543426, 0.110819192572928, 0.1127368280106943, 0.05621460371666957, 0.041284045468542974, 0.015706469404696277, 0.09850999924254042, 0.07251286442659209, 0.08153930105666507, 0.0959020067474143, 0.11308559090361574, 0.032442611085008545, -0.0013825933361283776, 0.0065497128969987314, 0.04978522790759711, 0.03765929690623022, -0.00035918849846265654, 0.07682693922917416, 0.05226586947306995, -0.0025531080454202684, -0.003333978219768526, 0.05231748753742161, 0.025581506066513066, -0.0036037715007166964, -0.054212309570233555, -0.06271796837885209, -0.05178789764718925, -0.07843326199479633, -0.14505645771099845] %, RMSE: [0.5620436956071191, 0.6412238764172483, 0.6889984002199323, 0.7314830383702844, 0.7618344460544212, 0.7881092457079257, 0.7778383059881959, 0.7783005579732893, 0.8089421153472514, 0.8334288272663914, 0.8351510064584058, 0.8306675322338554, 0.8470392567786829, 0.8584999830496894, 0.8450730506919454, 0.8523860561354307, 0.8577223283643257, 0.8514211738555778, 0.8505029188618363, 0.8576408153722215, 0.8562685039024245, 0.8416611900541053, 0.8302920456848807, 0.8335256533186775, 0.8349635884431219, 0.8248161076260617, 0.8102670143550912, 0.796452067500211, 0.7966177421747435, 0.7778844877875226, 0.7681127461962414, 0.7770177182008101]
====================
training elapsedd with 351.30 seconds for 100 iterations, the sec/iter = 3.51

MAE_mean: [0.29608623 0.36762364 0.40983207 0.44144537 0.47444021 0.5043278
 0.50206748 0.50690649 0.53694275 0.56697557 0.57692629 0.58055301
 0.59451349 0.60805046 0.60047859 0.60603683 0.61184328 0.61964169
 0.62085683 0.62485461 0.62729587 0.62299292 0.61221169 0.61521672
 0.61585587 0.61154472 0.60186831 0.59082636 0.59242624 0.58360184
 0.57099934 0.57493903] , MAPE_mean: [ 0.1187035   0.05176544  0.20027358  0.16825971  0.11081919  0.11273683
  0.0562146   0.04128405  0.01570647  0.09851     0.07251286  0.0815393
  0.09590201  0.11308559  0.03244261 -0.00138259  0.00654971  0.04978523
  0.0376593  -0.00035919  0.07682694  0.05226587 -0.00255311 -0.00333398
  0.05231749  0.02558151 -0.00360377 -0.05421231 -0.06271797 -0.0517879
 -0.07843326 -0.14505646] , RMSE_mean: [0.5620437  0.64122388 0.6889984  0.73148304 0.76183445 0.78810925
 0.77783831 0.77830056 0.80894212 0.83342883 0.83515101 0.83066753
 0.84703926 0.85849998 0.84507305 0.85238606 0.85772233 0.85142117
 0.85050292 0.85764082 0.8562685  0.84166119 0.83029205 0.83352565
 0.83496359 0.82481611 0.81026701 0.79645207 0.79661774 0.77788449
 0.76811275 0.77701772]

MAE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , MAPE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , RMSE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
Finished training with: lr1e-4_bs64_nh256_ra1e-5_dp0.3_wd1e-4_ah1_ck5_kt2
user config:
seed 666
device 0
scaler StandardScaler()
day_slot 288
n_route 10
n_his 96
n_pred 96
n_train 34
n_val 5
n_test 5
mode 1
n_c 10
model STAGNN_stamp
TPG TPGNN
name lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2
log_path log/TPGNN_r05p02kt3outer_338
crash 338
new_name TPGNN_r05p02kt3outer_338
batch_size 64
lr 0.0001
a 0.1
r 0.5
n_mask 1
adam {'use': True, 'weight_decay': 0.0001}
slr {'use': True, 'step_size': 400, 'gamma': 0.3}
resume False
start_epoch 0
epochs 100
n_layer 1
n_attr 64
n_hid 256
reg_A 0.0001
circle 288
drop_prob 0.3
CE {'use': True, 'kernel_size': 1, 'bias': False}
LE {'use': False, 'bias': False}
SE {'use': True, 'separate': True, 'no': False}
TE {'use': True, 'no': True}
attn {'head': 1, 'd_k': 32, 'd_v': 32, 'drop_prob': 0.2}
STstamp {'use': True, 'kt': 3, 'temperature': 1.0}
T4N {'use': True, 'step': 2, 'end_epoch': 10000, 'change_head': True, 'change_enc': True}
stamp_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/time_stamp_F_96.npy
data_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/V_France_processed_0.csv
adj_matrix_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/W_France_processed_0.csv
dis_mat tensor([[0.0000, 0.3661, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.6136, 0.0000,
         0.0000],
        [0.3661, 0.0000, 0.0000, 0.0000, 0.1098, 0.0000, 0.0000, 0.8975, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.3410, 0.8975, 0.0000, 0.0000, 0.0000, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.3410, 0.0000, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000,
         0.1494],
        [0.0000, 0.1098, 0.8975, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000, 0.6996,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000,
         0.2289],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000, 0.0000,
         0.5594],
        [0.6136, 0.8975, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.2117,
         0.0000],
        [0.0000, 0.4288, 0.4288, 0.0000, 0.6996, 0.0000, 0.0000, 0.2117, 0.0000,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.1494, 0.0000, 0.2289, 0.5594, 0.0000, 0.0000,
         0.0000]], device='cuda:0')
prefix log/lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2/
checkpoint_temp_path log/lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2//temp.pth
checkpoint_best_path log/lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2//best.pth
tensorboard_path log/lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2/
record_path log/lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2/record.txt
eps 0.1
parse <bound method DefaultConfig.parse of <config.DefaultConfig object at 0x7f0dac99d550>>
output <bound method DefaultConfig.output of <config.DefaultConfig object at 0x7f0dac99d550>>
train: True, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 9792
len(data): 9792, day_slot: 288, n_day: 34
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
10 10
epoch 0   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 1.462408566007427 , validation loss: 1.0416888147592545
epoch 1   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.9709189429002649 , validation loss: 1.0460208058357239
epoch 2   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.8112201503678864 , validation loss: 1.0634138658642769
epoch 3   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.7477863956900204 , validation loss: 1.0855908766388893
epoch 4   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.7149158050032223 , validation loss: 1.0749218687415123
epoch 5   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.6897988366145714 , validation loss: 1.0289218053221703
epoch 6   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.6694404295846528 , validation loss: 1.0005770176649094
epoch 7   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.651160781290017 , validation loss: 0.9790810197591782
epoch 8   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.6355986338035733 , validation loss: 0.9672608152031898
epoch 9   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.6216215678289825 , validation loss: 0.966596744954586
epoch 10   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.6088801435395783 , validation loss: 0.9875789508223534
epoch 11   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.5975543342384637 , validation loss: 0.9398808479309082
epoch 12   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.5869755300821042 , validation loss: 0.9299719706177711
epoch 13   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.5774599278674406 , validation loss: 0.935455858707428
epoch 14   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.5685422151696449 , validation loss: 0.934107132256031
epoch 15   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.5602617088486167 , validation loss: 0.948781356215477
epoch 16   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.5524288486031925 , validation loss: 0.9250176101922989
epoch 17   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.5451877117156982 , validation loss: 0.9091788455843925
epoch 18   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.5382692019144694 , validation loss: 0.9073488861322403
epoch 19   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.5315456098201228 , validation loss: 0.9141041859984398
epoch 20   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.5252972332870259 , validation loss: 0.8749220296740532
epoch 21   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.519097739574956 , validation loss: 0.8682084456086159
epoch 22   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.5132451583357418 , validation loss: 0.8814248517155647
epoch 23   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.5073539047848945 , validation loss: 0.8534049540758133
epoch 24   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.5017290454284817 , validation loss: 0.8444846644997597
epoch 25   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.4961074643275317 , validation loss: 0.8267539590597153
epoch 26   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.4907163393263723 , validation loss: 0.8182266056537628
epoch 27   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.4852908160172257 , validation loss: 0.8082044124603271
epoch 28   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.48005006535380496 , validation loss: 0.806995801627636
epoch 29   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.47450486176154194 , validation loss: 0.7993030399084091
epoch 30   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.46911832982418583 , validation loss: 0.7785340771079063
epoch 31   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.4634346056218241 , validation loss: 0.7636689245700836
epoch 32   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.45763184451589395 , validation loss: 0.7500293478369713
epoch 33   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.4517780559904435 , validation loss: 0.7457135617733002
epoch 34   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.446232314787659 , validation loss: 0.7503823563456535
epoch 35   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.4402462746582779 , validation loss: 0.7276007011532784
epoch 36   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.4351477073688133 , validation loss: 0.7228019908070564
epoch 37   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.43011265876246435 , validation loss: 0.7002532854676247
epoch 38   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.42592531559514063 , validation loss: 0.7103804349899292
epoch 39   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.4217394724780438 , validation loss: 0.696038156747818
epoch 40   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.41793421670502306 , validation loss: 0.713862732052803
epoch 41   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.4143804989609064 , validation loss: 0.6949477046728134
epoch 42   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.41082355438494217 , validation loss: 0.6947251409292221
epoch 43   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.40756067575192917 , validation loss: 0.6907375603914261
epoch 44   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.4043894164702472 , validation loss: 0.6824267357587814
epoch 45   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.4012708056206797 , validation loss: 0.6845610216259956
epoch 46   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.3981090807447247 , validation loss: 0.6836102530360222
epoch 47   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.39525002065826864 , validation loss: 0.6882526949048042
epoch 48   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.3923974627373265 , validation loss: 0.6896862089633942
epoch 49   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.3896317826766594 , validation loss: 0.6768161654472351
epoch 50   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.387042524767857 , validation loss: 0.6822718754410744
epoch 51   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.3842400885095783 , validation loss: 0.6781566441059113
epoch 52   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.3818254523417529 , validation loss: 0.680660292506218
epoch 53   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.3791847696491316 , validation loss: 0.6874969229102135
epoch 54   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.3767445514015123 , validation loss: 0.6731021851301193
epoch 55   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.3742740300356173 , validation loss: 0.6732137575745583
epoch 56   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.3717210339564903 , validation loss: 0.670766144990921
epoch 57   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.36969028617821487 , validation loss: 0.6868109479546547
epoch 58   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.36727439539105283 , validation loss: 0.6759037598967552
epoch 59   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.365102618932724 , validation loss: 0.6795898005366325
epoch 60   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.3627572147285237 , validation loss: 0.6664957031607628
epoch 61   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.36061300015917014 , validation loss: 0.6793965175747871
epoch 62   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.3585836951639138 , validation loss: 0.6664335578680038
epoch 63   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.35646895158524605 , validation loss: 0.6685739457607269
epoch 64   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.354401839130065 , validation loss: 0.6588034257292747
epoch 65   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.35239684523320663 , validation loss: 0.6682199537754059
epoch 66   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.35036978184008133 , validation loss: 0.6723388284444809
epoch 67   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.3484460506953445 , validation loss: 0.6652698963880539
epoch 68   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.34684136393023474 , validation loss: 0.6578225940465927
epoch 69   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.34470226367314655 , validation loss: 0.6555015668272972
epoch 70   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.34289331295911 , validation loss: 0.658556155860424
epoch 71   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.3410165175503376 , validation loss: 0.6771434172987938
epoch 72   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.33937082512705935 , validation loss: 0.6466929763555527
epoch 73   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.33735285436405854 , validation loss: 0.6628098785877228
epoch 74   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.3357767474417593 , validation loss: 0.654680535197258
epoch 75   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.3340759289030935 , validation loss: 0.6555345878005028
epoch 76   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.3324490066836862 , validation loss: 0.6585757583379745
epoch 77   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.33097851685449187 , validation loss: 0.6585180461406708
epoch 78   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.3292733226336685 , validation loss: 0.6557090282440186
epoch 79   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.32768088403870077 , validation loss: 0.655311718583107
epoch 80   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.3260033516322865 , validation loss: 0.6509364098310471
epoch 81   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.3243135254757077 , validation loss: 0.652778871357441
epoch 82   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.3229852494071512 , validation loss: 0.6489646956324577
epoch 83   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.3215449960792766 , validation loss: 0.6451858282089233
epoch 84   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.31992222748550714 , validation loss: 0.6510441899299622
epoch 85   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.31854381339222776 , validation loss: 0.6479158103466034
epoch 86   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.3170611875898698 , validation loss: 0.6582522988319397
epoch 87   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.3158301050756492 , validation loss: 0.663065493106842
epoch 88   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.3143508779067619 , validation loss: 0.659135714173317
epoch 89   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.3131661596251469 , validation loss: 0.6403593793511391
epoch 90   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.31166473673839196 , validation loss: 0.6401121243834496
epoch 91   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.31029773576586855 , validation loss: 0.6424032673239708
epoch 92   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.3089958324151881 , validation loss: 0.6356448084115982
epoch 93   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.30761921113612606 , validation loss: 0.6378845423460007
epoch 94   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.3062746559872347 , validation loss: 0.6455525532364845
epoch 95   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.3050856829858294 , validation loss: 0.64695093780756
epoch 96   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.30388838052749634 , validation loss: 0.6402094885706902
tensor(58.3395, device='cuda:0')
MAE: [0.3083324063078683, 0.37923222834148357, 0.41728793457419294, 0.4601207352737829, 0.48874810566184756, 0.5138394502059739, 0.5132842934308286, 0.5103822726658401, 0.5382694682384093, 0.5565621018997327, 0.5668726418509158, 0.5844529475736403, 0.6064392195999162, 0.6078966157026973, 0.595508835624097, 0.5946362324016764, 0.6117374389095366, 0.6153932642110038, 0.6189772973032956, 0.6269085911815007, 0.6354006345470234, 0.6278925404330888, 0.6081674510526672, 0.5954532723946824, 0.6024034314929056, 0.6026148469304454, 0.5978021164491927, 0.5885529696492037, 0.5764856599413396, 0.567488991127916, 0.5553675194192178, 0.5514701859253583] , MAPE: [0.12092808525718284, 0.04329081347572205, 0.18612654890170197, 0.15764949141393614, 0.1284483635200298, 0.10733200211869977, 0.061271153511856795, 0.056818274190840214, 0.029253240016378468, 0.10711418185693247, 0.11572733986512494, 0.11554199582548255, 0.12423932103080118, 0.1383935625916983, 0.08626998353927137, 0.0631506984723084, 0.05996903656833441, 0.11339555740025802, 0.10655237837050682, 0.054981213386024144, 0.11845365806294908, 0.09243055467560685, 0.0670277061185889, 0.05348198430414657, 0.09054726770759762, 0.06429815578008066, 0.03643565053442048, -0.012273654734824434, -0.037212514654396, -0.02721771259897763, -0.05094805388294638, -0.13421382767945897] %, RMSE: [0.5738742934933977, 0.6525232579315104, 0.696462153872866, 0.754370714785729, 0.7780806875453955, 0.7996431478352891, 0.7958337267165974, 0.7841639360789384, 0.811910077758679, 0.8203696014822106, 0.8265858793995383, 0.8455293212720794, 0.8738136792381433, 0.8655128435457928, 0.8497175498904436, 0.8480583506172233, 0.8748084030891626, 0.8650912815500021, 0.866666486691967, 0.8793661635019021, 0.8869974890731424, 0.8692206580965827, 0.8469607016681543, 0.8253291450335278, 0.8349755491561661, 0.8318411732527263, 0.8244946289567153, 0.8087794095421944, 0.7856641372416652, 0.770073123982246, 0.7618594867325978, 0.7622226680647977]
epoch 97   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.30270975652862997 , validation loss: 0.6446083411574364
tensor(58.1483, device='cuda:0')
MAE: [0.29522340971501254, 0.38295892229217304, 0.421139747252419, 0.46247084283317946, 0.48608064873470475, 0.5161644328504648, 0.516693322157929, 0.5295047165376624, 0.5488276705675825, 0.5658046547795847, 0.5889443984917682, 0.6011773266658648, 0.6139213310975159, 0.6226361028721422, 0.6131763076570999, 0.6289644091756842, 0.6246401304705549, 0.6285784094219969, 0.6327479981615679, 0.6501357698387745, 0.6463008124319856, 0.6409640630204039, 0.6216731092318432, 0.6245289611566773, 0.6099218125334106, 0.6029739805839034, 0.6032308234005552, 0.6005053601859464, 0.5958074093610048, 0.5889244551054135, 0.5743793744620742, 0.5806713690446479] , MAPE: [0.11940524794184114, 0.04816097169953096, 0.20021199944619025, 0.17433537796340742, 0.12294369727562449, 0.10798181274430238, 0.06277977365255041, 0.06584092628920676, 0.04980870725764334, 0.12131723124049928, 0.1058454512997612, 0.1086958673777846, 0.12464566820584728, 0.13527827692841007, 0.07168758917993569, 0.04893521788251015, 0.061211285774580695, 0.11400607883010885, 0.07682239404223024, 0.04065176707409357, 0.11157251016197836, 0.09327849192386398, 0.06501647408185143, 0.04421602911915262, 0.07753219892389679, 0.058552662098404325, 0.02067391051434055, -0.020668675727177652, -0.03565304605323298, -0.03333310899146679, -0.042673128372932585, -0.0969006710481759] %, RMSE: [0.5572146071359072, 0.6626792831462278, 0.703600134021769, 0.7591579293115811, 0.7737007873369498, 0.8019059758459983, 0.7992657081853307, 0.8178303125559587, 0.8301314965693192, 0.8331864951789852, 0.8606037719834128, 0.8680111249215654, 0.8804433924077892, 0.8823771547571934, 0.8711006055256318, 0.9002212871352778, 0.8905193874907963, 0.8811909970896389, 0.883128837185747, 0.9107664806791076, 0.8986648774200209, 0.8854207198758292, 0.8632705450459716, 0.867162087634041, 0.840732646552273, 0.8258491213037665, 0.8229047624293492, 0.8176254662199476, 0.8062531957694471, 0.7926176458738313, 0.7801081330655968, 0.7960709246754037]
epoch 98   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.3015846393856348 , validation loss: 0.6541941165924072
tensor(57.9583, device='cuda:0')
MAE: [0.30433609868755046, 0.391908184341395, 0.4324201746167826, 0.4704469047820906, 0.5074723690389128, 0.5418333171518308, 0.5323444523206269, 0.5261501093270238, 0.5424023245559219, 0.5774397162889543, 0.5997451542410039, 0.6116366579955848, 0.6339475590042463, 0.6540502399321376, 0.6378301936672213, 0.6318921731291435, 0.6328149393942092, 0.6409969692406504, 0.6509440232216159, 0.6655151389930973, 0.6703463459759951, 0.6794101967987095, 0.6621902390842125, 0.6509166580188981, 0.6301560642324465, 0.6282793996701996, 0.6288053338064514, 0.6196643694263605, 0.6099883994137504, 0.6069711827842, 0.5859997498269011, 0.5854527545232595] , MAPE: [0.11566353017479404, 0.0533153182700073, 0.17791991199655616, 0.16848420281502052, 0.11351698242038183, 0.1050070929066062, 0.05891330615315645, 0.044791360287076476, 0.030232488418469917, 0.09739497033533516, 0.10542843771389354, 0.09844925054566833, 0.09989303182421394, 0.1288913373472307, 0.06752303828708839, 0.04419531268677338, 0.03762859517993458, 0.0745268990669205, 0.06383718973752525, 0.018753016258778347, 0.08525735093072896, 0.07104400390283089, 0.052532343849985015, 0.02745088765618797, 0.06688373133311823, 0.033464788038382, 0.010497239761320951, -0.04281773066335687, -0.054868943322913186, -0.04694195522099839, -0.04624856063661186, -0.11307975308017816] %, RMSE: [0.564703867384653, 0.6691114669159262, 0.7157796287191905, 0.7682097072208639, 0.8049353932026937, 0.8410645818076127, 0.8154575186097984, 0.7994571434490182, 0.8087458027809074, 0.8468957870643395, 0.8726979030562045, 0.8797491430824935, 0.9087457042843048, 0.9311181300352658, 0.9063791965192581, 0.8956846005343739, 0.8938621446039409, 0.8897430127647217, 0.9019006703351764, 0.9273011479600657, 0.9295906068910817, 0.9402568292244449, 0.923499292624485, 0.8984843180897069, 0.861409603596247, 0.8541914993746832, 0.8538651132788154, 0.8382101737003099, 0.8183922451943957, 0.8114170443995461, 0.789901699092855, 0.7931682160247086]
epoch 99   lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2 , train loss: 0.3003424528767081 , validation loss: 0.6366582438349724
tensor(57.7694, device='cuda:0')
MAE: [0.2954368820453792, 0.36681389464180647, 0.40940441269485145, 0.44033094282694085, 0.4735151600805063, 0.5034317034828601, 0.5011431414240337, 0.5057845094028054, 0.535178485281343, 0.5654804819730139, 0.5766916075510156, 0.580131286593903, 0.5934552387109737, 0.6069278645845725, 0.5991259036050898, 0.6041875553465228, 0.610077219614087, 0.6179458878496565, 0.6199119822561895, 0.6235050189358748, 0.6257786839701158, 0.6214214382743098, 0.6104652939859739, 0.6131772765467308, 0.6140621197154534, 0.6092957055534131, 0.6002395153735025, 0.5889805042755204, 0.5892685521094455, 0.5802131273688691, 0.5675643205901935, 0.5716909035800275] , MAPE: [0.11858775145363137, 0.0523318698340782, 0.20024581295867316, 0.16875254992964814, 0.11128163835352191, 0.11430585008447171, 0.05797209157826878, 0.044664489294984525, 0.01850878792517271, 0.10362156247438685, 0.07593192308935032, 0.08478074092509168, 0.10080218817426621, 0.11743696689670521, 0.03860038085716126, 0.006251898149350062, 0.011804548543919905, 0.05547912285219129, 0.043647769019853795, 0.0041090404232915914, 0.08194620283697181, 0.057371407901595485, 0.005061718227451136, 0.004666614869091007, 0.056562550972922725, 0.030547429822582888, -0.0009923801776537788, -0.05083455558370147, -0.058415131237975634, -0.051219729448929094, -0.07667534526094875, -0.142351459787211] %, RMSE: [0.5609880885694191, 0.6401067430475776, 0.6885298085040888, 0.7300847772644798, 0.7611421045440362, 0.7874740388646312, 0.7773322605832937, 0.777687254579536, 0.8076219141182329, 0.8328757554812746, 0.8370127599504316, 0.832446532637836, 0.8477182288073187, 0.8588066660296417, 0.8450479534147264, 0.8516952072327778, 0.8570963143297687, 0.8508991893427605, 0.851204340398103, 0.8577342626548234, 0.855766900748658, 0.8412830251676208, 0.8297632312056754, 0.833317903381945, 0.834661692179484, 0.8240624634442337, 0.8104457370594601, 0.7962823523016327, 0.7943463899895234, 0.7752609760934677, 0.7659868514240975, 0.7753212418803086]
test loss: NIL 
MAE: [0.2954368820453792, 0.36681389464180647, 0.40940441269485145, 0.44033094282694085, 0.4735151600805063, 0.5034317034828601, 0.5011431414240337, 0.5057845094028054, 0.535178485281343, 0.5654804819730139, 0.5766916075510156, 0.580131286593903, 0.5934552387109737, 0.6069278645845725, 0.5991259036050898, 0.6041875553465228, 0.610077219614087, 0.6179458878496565, 0.6199119822561895, 0.6235050189358748, 0.6257786839701158, 0.6214214382743098, 0.6104652939859739, 0.6131772765467308, 0.6140621197154534, 0.6092957055534131, 0.6002395153735025, 0.5889805042755204, 0.5892685521094455, 0.5802131273688691, 0.5675643205901935, 0.5716909035800275] , MAPE: [0.11858775145363137, 0.0523318698340782, 0.20024581295867316, 0.16875254992964814, 0.11128163835352191, 0.11430585008447171, 0.05797209157826878, 0.044664489294984525, 0.01850878792517271, 0.10362156247438685, 0.07593192308935032, 0.08478074092509168, 0.10080218817426621, 0.11743696689670521, 0.03860038085716126, 0.006251898149350062, 0.011804548543919905, 0.05547912285219129, 0.043647769019853795, 0.0041090404232915914, 0.08194620283697181, 0.057371407901595485, 0.005061718227451136, 0.004666614869091007, 0.056562550972922725, 0.030547429822582888, -0.0009923801776537788, -0.05083455558370147, -0.058415131237975634, -0.051219729448929094, -0.07667534526094875, -0.142351459787211] %, RMSE: [0.5609880885694191, 0.6401067430475776, 0.6885298085040888, 0.7300847772644798, 0.7611421045440362, 0.7874740388646312, 0.7773322605832937, 0.777687254579536, 0.8076219141182329, 0.8328757554812746, 0.8370127599504316, 0.832446532637836, 0.8477182288073187, 0.8588066660296417, 0.8450479534147264, 0.8516952072327778, 0.8570963143297687, 0.8508991893427605, 0.851204340398103, 0.8577342626548234, 0.855766900748658, 0.8412830251676208, 0.8297632312056754, 0.833317903381945, 0.834661692179484, 0.8240624634442337, 0.8104457370594601, 0.7962823523016327, 0.7943463899895234, 0.7752609760934677, 0.7659868514240975, 0.7753212418803086]
====================
training elapsedd with 351.21 seconds for 100 iterations, the sec/iter = 3.51

MAE_mean: [0.29543688 0.36681389 0.40940441 0.44033094 0.47351516 0.5034317
 0.50114314 0.50578451 0.53517849 0.56548048 0.57669161 0.58013129
 0.59345524 0.60692786 0.5991259  0.60418756 0.61007722 0.61794589
 0.61991198 0.62350502 0.62577868 0.62142144 0.61046529 0.61317728
 0.61406212 0.60929571 0.60023952 0.5889805  0.58926855 0.58021313
 0.56756432 0.5716909 ] , MAPE_mean: [ 0.11858775  0.05233187  0.20024581  0.16875255  0.11128164  0.11430585
  0.05797209  0.04466449  0.01850879  0.10362156  0.07593192  0.08478074
  0.10080219  0.11743697  0.03860038  0.0062519   0.01180455  0.05547912
  0.04364777  0.00410904  0.0819462   0.05737141  0.00506172  0.00466661
  0.05656255  0.03054743 -0.00099238 -0.05083456 -0.05841513 -0.05121973
 -0.07667535 -0.14235146] , RMSE_mean: [0.56098809 0.64010674 0.68852981 0.73008478 0.7611421  0.78747404
 0.77733226 0.77768725 0.80762191 0.83287576 0.83701276 0.83244653
 0.84771823 0.85880667 0.84504795 0.85169521 0.85709631 0.85089919
 0.85120434 0.85773426 0.8557669  0.84128303 0.82976323 0.8333179
 0.83466169 0.82406246 0.81044574 0.79628235 0.79434639 0.77526098
 0.76598685 0.77532124]

MAE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , MAPE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , RMSE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
Finished training with: lr1e-4_bs64_nh256_ra1e-4_dp0.3_wd1e-6_ah1_ck3_kt2
user config:
seed 666
device 0
scaler StandardScaler()
day_slot 288
n_route 10
n_his 96
n_pred 96
n_train 34
n_val 5
n_test 5
mode 1
n_c 10
model STAGNN_stamp
TPG TPGNN
name lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4
log_path log/TPGNN_r05p02kt3outer_339
crash 339
new_name TPGNN_r05p02kt3outer_339
batch_size 64
lr 0.0001
a 0.1
r 0.5
n_mask 1
adam {'use': True, 'weight_decay': 0.0001}
slr {'use': True, 'step_size': 400, 'gamma': 0.3}
resume False
start_epoch 0
epochs 100
n_layer 1
n_attr 64
n_hid 256
reg_A 1e-05
circle 288
drop_prob 0.1
CE {'use': True, 'kernel_size': 1, 'bias': False}
LE {'use': False, 'bias': False}
SE {'use': True, 'separate': True, 'no': False}
TE {'use': True, 'no': True}
attn {'head': 1, 'd_k': 32, 'd_v': 32, 'drop_prob': 0.2}
STstamp {'use': True, 'kt': 3, 'temperature': 1.0}
T4N {'use': True, 'step': 2, 'end_epoch': 10000, 'change_head': True, 'change_enc': True}
stamp_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/time_stamp_F_96.npy
data_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/V_France_processed_0.csv
adj_matrix_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/W_France_processed_0.csv
dis_mat tensor([[0.0000, 0.3661, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.6136, 0.0000,
         0.0000],
        [0.3661, 0.0000, 0.0000, 0.0000, 0.1098, 0.0000, 0.0000, 0.8975, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.3410, 0.8975, 0.0000, 0.0000, 0.0000, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.3410, 0.0000, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000,
         0.1494],
        [0.0000, 0.1098, 0.8975, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000, 0.6996,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000,
         0.2289],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000, 0.0000,
         0.5594],
        [0.6136, 0.8975, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.2117,
         0.0000],
        [0.0000, 0.4288, 0.4288, 0.0000, 0.6996, 0.0000, 0.0000, 0.2117, 0.0000,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.1494, 0.0000, 0.2289, 0.5594, 0.0000, 0.0000,
         0.0000]], device='cuda:0')
prefix log/lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4/
checkpoint_temp_path log/lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4//temp.pth
checkpoint_best_path log/lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4//best.pth
tensorboard_path log/lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4/
record_path log/lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4/record.txt
eps 0.1
parse <bound method DefaultConfig.parse of <config.DefaultConfig object at 0x7f4b79e55550>>
output <bound method DefaultConfig.output of <config.DefaultConfig object at 0x7f4b79e55550>>
train: True, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 9792
len(data): 9792, day_slot: 288, n_day: 34
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
10 10
epoch 0   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 1.2086536954430973 , validation loss: 1.0483398586511612
epoch 1   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.7100258796822791 , validation loss: 1.0453272834420204
epoch 2   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.5524685873704798 , validation loss: 1.0685165971517563
epoch 3   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.4935223273202485 , validation loss: 1.0834839195013046
epoch 4   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.4646245054170197 , validation loss: 1.069096527993679
epoch 5   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.44524492002001 , validation loss: 1.0371299907565117
epoch 6   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.43147319087795183 , validation loss: 0.9570780098438263
epoch 7   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.42042044623225344 , validation loss: 0.9548763558268547
epoch 8   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.4115053894473057 , validation loss: 0.9405488297343254
epoch 9   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.4043571890569201 , validation loss: 0.9172099679708481
epoch 10   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.39778878817371294 , validation loss: 0.9213756322860718
epoch 11   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.39193807279362397 , validation loss: 0.9090008363127708
epoch 12   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.38646052339497733 , validation loss: 0.9037990942597389
epoch 13   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.381523729539385 , validation loss: 0.892783634364605
epoch 14   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.37694232720954746 , validation loss: 0.8798960819840431
epoch 15   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.37245648514990715 , validation loss: 0.8689830154180527
epoch 16   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.36834116893656116 , validation loss: 0.8488711342215538
epoch 17   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.36421535178726794 , validation loss: 0.840017206966877
epoch 18   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.36032875671106224 , validation loss: 0.8290654867887497
epoch 19   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.3564853346815296 , validation loss: 0.827900268137455
epoch 20   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.3527098257167667 , validation loss: 0.799370251595974
epoch 21   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.34895886743769927 , validation loss: 0.78969307243824
epoch 22   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.34517542345851077 , validation loss: 0.7986944541335106
epoch 23   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.34131454720216636 , validation loss: 0.7822779938578606
epoch 24   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.3374504984593859 , validation loss: 0.7685185819864273
epoch 25   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.33348652778887283 , validation loss: 0.7551148980855942
epoch 26   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.32980554360969394 , validation loss: 0.7491552904248238
epoch 27   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.32602812788065744 , validation loss: 0.7347963452339172
epoch 28   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.32283694428556103 , validation loss: 0.7380993664264679
epoch 29   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.31912822992193934 , validation loss: 0.7230545207858086
epoch 30   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.31594299335105747 , validation loss: 0.7160444483160973
epoch 31   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.31304335711049097 , validation loss: 0.6982676088809967
epoch 32   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.3099958657049665 , validation loss: 0.7003541514277458
epoch 33   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.30739765541226255 , validation loss: 0.691413551568985
epoch 34   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.3049389410252665 , validation loss: 0.6971404105424881
epoch 35   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.302733253030216 , validation loss: 0.6864174157381058
epoch 36   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.30059291510020986 , validation loss: 0.6804288476705551
epoch 37   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.2985992805630553 , validation loss: 0.6689406707882881
epoch 38   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.297212247170654 , validation loss: 0.6768883913755417
epoch 39   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.2953876496530047 , validation loss: 0.6671041175723076
epoch 40   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.2938904908357882 , validation loss: 0.6821876540780067
epoch 41   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.29239682882439855 , validation loss: 0.6609852164983749
epoch 42   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.2910807927449544 , validation loss: 0.6643759980797768
epoch 43   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.2897026626502766 , validation loss: 0.6569371074438095
epoch 44   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.2886320656421138 , validation loss: 0.6607536301016808
epoch 45   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.28722606161061454 , validation loss: 0.6617100611329079
epoch 46   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.28601153282558217 , validation loss: 0.6590401455760002
epoch 47   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.28510573331047506 , validation loss: 0.662542924284935
epoch 48   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.28393249009169785 , validation loss: 0.6592937633395195
epoch 49   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.2830275051734027 , validation loss: 0.6543733328580856
epoch 50   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.28198854888186736 , validation loss: 0.6579179987311363
epoch 51   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.2807762979292402 , validation loss: 0.6553996279835701
epoch 52   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.2800176728005503 , validation loss: 0.6603491008281708
epoch 53   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.27893636565582425 , validation loss: 0.6587529554963112
epoch 54   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.278087400338229 , validation loss: 0.650670975446701
epoch 55   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.27697473355368074 , validation loss: 0.6562789082527161
epoch 56   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.2761058287293303 , validation loss: 0.6471168398857117
epoch 57   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.2755277133455463 , validation loss: 0.6559822782874107
epoch 58   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.27448822528708217 , validation loss: 0.6508617997169495
epoch 59   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.2736999713907055 , validation loss: 0.6563690453767776
epoch 60   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.2727554189223869 , validation loss: 0.6525319665670395
epoch 61   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.2719972875772738 , validation loss: 0.6605071425437927
epoch 62   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.2714126273697498 , validation loss: 0.654336966574192
epoch 63   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.27046692429804337 , validation loss: 0.6574530079960823
epoch 64   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.26975026697504756 , validation loss: 0.6463281214237213
epoch 65   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.2691550716465595 , validation loss: 0.6532911732792854
epoch 66   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.26804539795015375 , validation loss: 0.6513739824295044
epoch 67   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.2674328491968267 , validation loss: 0.6548904180526733
epoch 68   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.26682259726758095 , validation loss: 0.6444525569677353
epoch 69   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.2658633046290454 , validation loss: 0.645499549806118
epoch 70   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.26551810023831385 , validation loss: 0.650609515607357
epoch 71   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.2647424381153256 , validation loss: 0.6530940607190132
epoch 72   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.26422105758797887 , validation loss: 0.644240215420723
epoch 73   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.26344458291343614 , validation loss: 0.6542307212948799
epoch 74   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.2626432680031833 , validation loss: 0.6404869258403778
epoch 75   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.2620043970790564 , validation loss: 0.642966978251934
epoch 76   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.26152028114187953 , validation loss: 0.6495459750294685
epoch 77   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.26088061052210193 , validation loss: 0.6458446756005287
epoch 78   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.26044316648268234 , validation loss: 0.6422694027423859
epoch 79   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.2595413037959267 , validation loss: 0.6451068297028542
epoch 80   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.25893087714326146 , validation loss: 0.6442248597741127
epoch 81   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.25831205587761075 , validation loss: 0.6478608548641205
epoch 82   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.25795110563437146 , validation loss: 0.644458718597889
epoch 83   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.2574922094742457 , validation loss: 0.639035053551197
epoch 84   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.25662870968089385 , validation loss: 0.6418016776442528
epoch 85   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.2561921991553961 , validation loss: 0.6449558511376381
epoch 86   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.25546762230349523 , validation loss: 0.6423318460583687
epoch 87   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.2551720273845336 , validation loss: 0.6456285119056702
epoch 88   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.2547431152825262 , validation loss: 0.6497465148568153
epoch 89   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.25424863514946955 , validation loss: 0.6377959251403809
epoch 90   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.2534673696055132 , validation loss: 0.635100394487381
epoch 91   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.25295668548228695 , validation loss: 0.6372822225093842
epoch 92   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.2525426380190195 , validation loss: 0.6396992728114128
epoch 93   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.25212649241382 , validation loss: 0.6337701082229614
epoch 94   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.25137917960391326 , validation loss: 0.646400012075901
epoch 95   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.2509346659861359 , validation loss: 0.6358145698904991
epoch 96   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.2504074333929548 , validation loss: 0.6349124312400818
tensor(57.1178, device='cuda:0')
MAE: [0.29176972358746783, 0.3679704249208582, 0.4162224293848711, 0.4521974699315855, 0.49039558978386455, 0.5161814887164948, 0.5130541519423197, 0.5067896168863343, 0.5217823755249534, 0.5440261946349721, 0.5580380272166323, 0.5818155879968988, 0.5995925477045329, 0.6013851168227488, 0.5775826976964845, 0.5668612659031276, 0.5725710085817833, 0.5827609156728866, 0.5852274587688987, 0.5950479779192774, 0.5977213912610848, 0.5963023297703758, 0.5810329756620772, 0.556635670386178, 0.555202586313844, 0.5622729603162746, 0.5535901742251877, 0.5518210386427254, 0.5414127667916497, 0.5340731149646886, 0.5212732433504665, 0.5146711297774899] , MAPE: [0.09690278154347755, 0.04232502091073105, 0.16466203543975783, 0.15388104559667573, 0.12995204946258737, 0.12424473460621774, 0.056349917524434225, 0.039630747961532084, -0.011890204505147004, 0.04838036954521589, 0.06143938191832444, 0.08806917860859573, 0.10575750491599166, 0.11180269920701921, 0.049375274023707214, 0.033173159315123595, 0.03520855286547079, 0.04481034066141631, 0.11294962618457088, 0.08727065186281796, 0.165878120669435, 0.13236843827858955, 0.0744240093708384, 0.0889202137774555, 0.058508035233370316, 0.022247093934931832, 0.03208920779878249, -0.021969762855779035, -0.055430223252096206, -0.01207226176383742, -0.029682416637583676, -0.15529393147547266] %, RMSE: [0.5467715415076354, 0.6334866827207827, 0.6936063371602564, 0.7358371851372666, 0.7874711182624206, 0.8109812735042551, 0.7995304544143114, 0.7771719443761691, 0.7785145354643273, 0.7937372345591738, 0.8078977417441385, 0.834010743220585, 0.8610789117196059, 0.8547759278255433, 0.8187255460369863, 0.8028303243537123, 0.8048885919737694, 0.8078799213819029, 0.812689726420523, 0.8251555569472554, 0.8289546431727588, 0.8224424221887772, 0.8023706938745511, 0.7697422765392585, 0.7674247057736278, 0.7762873879834441, 0.7721066516226037, 0.7700423157128496, 0.7577780364203099, 0.7477941219677394, 0.7317535295132531, 0.7316708035905276]
epoch 97   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.2501506475256939 , validation loss: 0.6350842341780663
tensor(56.8985, device='cuda:0')
MAE: [0.28946034398582793, 0.3777100519788903, 0.42811656894954403, 0.4576947865663, 0.48165159757594705, 0.5047944584325648, 0.5155597347221289, 0.5300779357090708, 0.5379609090496892, 0.5601623370386084, 0.5884801577880364, 0.6038735517955471, 0.6015135639118626, 0.5996822132442876, 0.594469082763745, 0.6038278433903284, 0.5966259276486703, 0.6089824212137034, 0.6196103129677052, 0.6300573117958055, 0.6227449246753276, 0.6211054556887866, 0.6103179201257136, 0.6004439479343056, 0.5929424439186288, 0.5999134009926743, 0.5931172689257823, 0.593807821253449, 0.5908083614422796, 0.5804534751130748, 0.5790738045877403, 0.5841967482096756] , MAPE: [0.09297074126108032, 0.04784052763718118, 0.18696988075086488, 0.15939086055933885, 0.09833803728494683, 0.0899468235167724, 0.04500437363120487, 0.013044684671397955, -0.036224740133692805, 0.02276323903471588, 0.03785298431976866, 0.047158845004192214, 0.03712443710457217, 0.027889535668409265, -0.008086613387450156, -0.005855506664621626, -0.011642990188190675, -0.01940999249339247, 0.05506577175481015, 0.02702486309345893, 0.07118754783659674, 0.03574903859341632, 0.005889526051896704, 0.018693921630857056, -0.015387203493563593, -0.04316213037386613, -0.02549011822924925, -0.10292558271687516, -0.1270925873782565, -0.05739891723672062, -0.063457007073166, -0.18133862250077673] %, RMSE: [0.5422339023588284, 0.6450323049374983, 0.7064373449494311, 0.7386762202318874, 0.7606946851280059, 0.7758721839309329, 0.7894646369774115, 0.8060986723051313, 0.7934651989525294, 0.8027013239065686, 0.8404329703515336, 0.852268659694312, 0.8433773907134073, 0.8268825538162369, 0.8233115075353158, 0.8434651894163677, 0.8206797568651143, 0.8265695134215576, 0.8456249377422763, 0.8561994383627403, 0.8359762086666486, 0.8262105800115525, 0.8171951666580174, 0.8053152747387637, 0.7907294271269165, 0.7997719287543301, 0.7962236508819976, 0.7951261891096152, 0.7887925326616205, 0.7726846041712864, 0.7759049542168841, 0.7896813507347689]
epoch 98   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.24972128020782097 , validation loss: 0.6358450204133987
tensor(56.6780, device='cuda:0')
MAE: [0.29013889556068967, 0.37240196176775797, 0.42510603987391, 0.45853454125277004, 0.49338966372672505, 0.5183014250965309, 0.5106055640005123, 0.5131419898099122, 0.5220935780195922, 0.545118870754851, 0.5781306493313042, 0.6018134551752627, 0.6144296019232457, 0.6173634832298632, 0.5947791508965424, 0.5880818673108041, 0.5876308097997585, 0.593058744330612, 0.6016766795988396, 0.6155226197982803, 0.6176861639896927, 0.6153736250743884, 0.5991312468240095, 0.5885142054974303, 0.5755236049866324, 0.5773105455045925, 0.5704150707074969, 0.5705812608572587, 0.5604703372444227, 0.5546694465469301, 0.5455391365543162, 0.5514370483918519] , MAPE: [0.08750790146994629, 0.0504104917777666, 0.17115772432499352, 0.16798717841070798, 0.11460486113878096, 0.10942119163262554, 0.07581465816687548, 0.05140050036505647, -0.011546640268040307, 0.050133511647882094, 0.07007898421834173, 0.08363670674765503, 0.08323196848293948, 0.09599496795838763, 0.054596446341125066, 0.029076338712661288, 0.011220660519161497, 0.017130744688866356, 0.08184006926833183, 0.05956247400195091, 0.1097062182912524, 0.09452673986524442, 0.053934257970071224, 0.05239851225460652, 0.024023310084750435, 0.002747581241131501, 0.00577804965605556, -0.08579941767532293, -0.10196456629980341, -0.035978192035066796, -0.036637173043502454, -0.1554777675019169] %, RMSE: [0.5433166657926242, 0.6365876546774245, 0.7022168259556306, 0.7454944008323345, 0.7904385439844238, 0.8112546016590025, 0.7869221166549837, 0.781506528998491, 0.7728190640517189, 0.7890916978203686, 0.833980018691955, 0.8624763509103065, 0.8810515679150214, 0.8756282086074452, 0.8403756046250437, 0.8294612319827958, 0.8180428660616301, 0.8118990029601006, 0.8265339630230017, 0.8458748548787485, 0.845451036025187, 0.8395567846808145, 0.8213567169315349, 0.8033535039723805, 0.7806419871174967, 0.7818163253807329, 0.782239580408858, 0.7813836708069029, 0.7709973517935528, 0.7645697718049355, 0.7547355669686286, 0.7686165480663831]
epoch 99   lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4 , train loss: 0.24894190477389916 , validation loss: 0.639590859413147
tensor(56.4719, device='cuda:0')
MAE: [0.29491297296085156, 0.3717620016862974, 0.4245306355294954, 0.45627973943958344, 0.49763115489068105, 0.524690916473334, 0.5144383539712614, 0.5113382562589783, 0.5299201787869955, 0.5542690425005156, 0.5772584031652851, 0.5890853784229492, 0.5994621711287685, 0.6101096126183714, 0.5937858190727372, 0.5896988856258619, 0.5899339754529989, 0.5966595631764875, 0.6050963260310213, 0.6098920442699215, 0.6039991208561456, 0.6047995916220177, 0.5941395258822852, 0.5768459275879504, 0.5740518733716964, 0.574255404221182, 0.5657500707530945, 0.5602027389608785, 0.5590929300695197, 0.5533146041650902, 0.5440872738529573, 0.5388819175563061] , MAPE: [0.09455146060129099, 0.053656652814149226, 0.1701198096437615, 0.1518311131282736, 0.11640557279672441, 0.12439741091301951, 0.04468336756149434, 0.03004015829448934, -0.013033427802249357, 0.040705902580773105, 0.0363913802675856, 0.07302746808718945, 0.09687098001492973, 0.0941164299599033, 0.011559214179841237, 0.010734808184098471, 0.02135867285023422, 0.01591080964441962, 0.05928937878007232, 0.06469872752148956, 0.13722479804061485, 0.09520863442889357, 0.024639558550630474, 0.02874674846214625, 0.022848204177385437, -0.008986270426701725, 0.00035889494522737164, -0.07960216769645936, -0.09447449760720945, -0.03644656726688425, -0.047203564890936384, -0.1594427887633378] %, RMSE: [0.5532878459832054, 0.6362968459301461, 0.7018748289291377, 0.744183585944361, 0.8030612437691114, 0.8230504401145988, 0.7968019556288631, 0.7824145545710413, 0.7902427221369447, 0.805734541083677, 0.8317724917852127, 0.8424487226219068, 0.86220423455532, 0.8651946434161, 0.8378996400652995, 0.8340616447939928, 0.8249739859113143, 0.820987791125624, 0.8325428515317851, 0.8397316072435468, 0.8324858180145077, 0.8251142186070423, 0.8101510062652783, 0.7888243000105926, 0.784886330917601, 0.7810313101272943, 0.7769955708060724, 0.7744443833932232, 0.7783276709686768, 0.7661038781708379, 0.7520665458722878, 0.7530030860837633]
test loss: NIL 
MAE: [0.29491297296085156, 0.3717620016862974, 0.4245306355294954, 0.45627973943958344, 0.49763115489068105, 0.524690916473334, 0.5144383539712614, 0.5113382562589783, 0.5299201787869955, 0.5542690425005156, 0.5772584031652851, 0.5890853784229492, 0.5994621711287685, 0.6101096126183714, 0.5937858190727372, 0.5896988856258619, 0.5899339754529989, 0.5966595631764875, 0.6050963260310213, 0.6098920442699215, 0.6039991208561456, 0.6047995916220177, 0.5941395258822852, 0.5768459275879504, 0.5740518733716964, 0.574255404221182, 0.5657500707530945, 0.5602027389608785, 0.5590929300695197, 0.5533146041650902, 0.5440872738529573, 0.5388819175563061] , MAPE: [0.09455146060129099, 0.053656652814149226, 0.1701198096437615, 0.1518311131282736, 0.11640557279672441, 0.12439741091301951, 0.04468336756149434, 0.03004015829448934, -0.013033427802249357, 0.040705902580773105, 0.0363913802675856, 0.07302746808718945, 0.09687098001492973, 0.0941164299599033, 0.011559214179841237, 0.010734808184098471, 0.02135867285023422, 0.01591080964441962, 0.05928937878007232, 0.06469872752148956, 0.13722479804061485, 0.09520863442889357, 0.024639558550630474, 0.02874674846214625, 0.022848204177385437, -0.008986270426701725, 0.00035889494522737164, -0.07960216769645936, -0.09447449760720945, -0.03644656726688425, -0.047203564890936384, -0.1594427887633378] %, RMSE: [0.5532878459832054, 0.6362968459301461, 0.7018748289291377, 0.744183585944361, 0.8030612437691114, 0.8230504401145988, 0.7968019556288631, 0.7824145545710413, 0.7902427221369447, 0.805734541083677, 0.8317724917852127, 0.8424487226219068, 0.86220423455532, 0.8651946434161, 0.8378996400652995, 0.8340616447939928, 0.8249739859113143, 0.820987791125624, 0.8325428515317851, 0.8397316072435468, 0.8324858180145077, 0.8251142186070423, 0.8101510062652783, 0.7888243000105926, 0.784886330917601, 0.7810313101272943, 0.7769955708060724, 0.7744443833932232, 0.7783276709686768, 0.7661038781708379, 0.7520665458722878, 0.7530030860837633]
====================
training elapsedd with 350.59 seconds for 100 iterations, the sec/iter = 3.51

MAE_mean: [0.29491297 0.371762   0.42453064 0.45627974 0.49763115 0.52469092
 0.51443835 0.51133826 0.52992018 0.55426904 0.5772584  0.58908538
 0.59946217 0.61010961 0.59378582 0.58969889 0.58993398 0.59665956
 0.60509633 0.60989204 0.60399912 0.60479959 0.59413953 0.57684593
 0.57405187 0.5742554  0.56575007 0.56020274 0.55909293 0.5533146
 0.54408727 0.53888192] , MAPE_mean: [ 0.09455146  0.05365665  0.17011981  0.15183111  0.11640557  0.12439741
  0.04468337  0.03004016 -0.01303343  0.0407059   0.03639138  0.07302747
  0.09687098  0.09411643  0.01155921  0.01073481  0.02135867  0.01591081
  0.05928938  0.06469873  0.1372248   0.09520863  0.02463956  0.02874675
  0.0228482  -0.00898627  0.00035889 -0.07960217 -0.0944745  -0.03644657
 -0.04720356 -0.15944279] , RMSE_mean: [0.55328785 0.63629685 0.70187483 0.74418359 0.80306124 0.82305044
 0.79680196 0.78241455 0.79024272 0.80573454 0.83177249 0.84244872
 0.86220423 0.86519464 0.83789964 0.83406164 0.82497399 0.82098779
 0.83254285 0.83973161 0.83248582 0.82511422 0.81015101 0.7888243
 0.78488633 0.78103131 0.77699557 0.77444438 0.77832767 0.76610388
 0.75206655 0.75300309]

MAE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , MAPE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , RMSE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
Finished training with: lr1e-4_bs64_nh256_ra1e-5_dp0.1_wd1e-6_ah1_ck1_kt4
user config:
seed 666
device 0
scaler StandardScaler()
day_slot 288
n_route 10
n_his 96
n_pred 96
n_train 34
n_val 5
n_test 5
mode 1
n_c 10
model STAGNN_stamp
TPG TPGNN
name lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4
log_path log/TPGNN_r05p02kt3outer_341
crash 341
new_name TPGNN_r05p02kt3outer_341
batch_size 64
lr 0.001
a 0.1
r 0.5
n_mask 1
adam {'use': True, 'weight_decay': 0.0001}
slr {'use': True, 'step_size': 400, 'gamma': 0.3}
resume False
start_epoch 0
epochs 100
n_layer 1
n_attr 64
n_hid 128
reg_A 1e-05
circle 288
drop_prob 0.1
CE {'use': True, 'kernel_size': 1, 'bias': False}
LE {'use': False, 'bias': False}
SE {'use': True, 'separate': True, 'no': False}
TE {'use': True, 'no': True}
attn {'head': 1, 'd_k': 32, 'd_v': 32, 'drop_prob': 0.2}
STstamp {'use': True, 'kt': 3, 'temperature': 1.0}
T4N {'use': True, 'step': 2, 'end_epoch': 10000, 'change_head': True, 'change_enc': True}
stamp_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/time_stamp_F_96.npy
data_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/V_France_processed_0.csv
adj_matrix_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/W_France_processed_0.csv
dis_mat tensor([[0.0000, 0.3661, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.6136, 0.0000,
         0.0000],
        [0.3661, 0.0000, 0.0000, 0.0000, 0.1098, 0.0000, 0.0000, 0.8975, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.3410, 0.8975, 0.0000, 0.0000, 0.0000, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.3410, 0.0000, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000,
         0.1494],
        [0.0000, 0.1098, 0.8975, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000, 0.6996,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000,
         0.2289],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000, 0.0000,
         0.5594],
        [0.6136, 0.8975, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.2117,
         0.0000],
        [0.0000, 0.4288, 0.4288, 0.0000, 0.6996, 0.0000, 0.0000, 0.2117, 0.0000,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.1494, 0.0000, 0.2289, 0.5594, 0.0000, 0.0000,
         0.0000]], device='cuda:0')
prefix log/lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4/
checkpoint_temp_path log/lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4//temp.pth
checkpoint_best_path log/lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4//best.pth
tensorboard_path log/lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4/
record_path log/lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4/record.txt
eps 0.1
parse <bound method DefaultConfig.parse of <config.DefaultConfig object at 0x7f7d08055550>>
output <bound method DefaultConfig.output of <config.DefaultConfig object at 0x7f7d08055550>>
train: True, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 9792
len(data): 9792, day_slot: 288, n_day: 34
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
10 10
epoch 0   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.7238165666075314 , validation loss: 1.0192110762000084
epoch 1   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.42156115700216856 , validation loss: 0.8975424244999886
epoch 2   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.3835335479063146 , validation loss: 0.9057141244411469
epoch 3   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.3630546839798198 , validation loss: 0.7993769645690918
epoch 4   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.34634027995315253 , validation loss: 0.7919040247797966
epoch 5   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.3308812227903628 , validation loss: 0.7654577791690826
epoch 6   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.3148519718179516 , validation loss: 0.715330220758915
epoch 7   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.2981655048389061 , validation loss: 0.6902761459350586
epoch 8   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.28966783133207585 , validation loss: 0.7069965302944183
epoch 9   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.2834286876753265 , validation loss: 0.6770233437418938
epoch 10   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.2779298489000283 , validation loss: 0.6675285920500755
epoch 11   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.27261625376402165 , validation loss: 0.6673536896705627
epoch 12   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.2694934591943142 , validation loss: 0.6793492436408997
epoch 13   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.26569358420138267 , validation loss: 0.7009550184011459
epoch 14   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.26298268782157525 , validation loss: 0.7285116314888
epoch 15   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.25906456101174447 , validation loss: 0.6496356949210167
epoch 16   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.25608957544261335 , validation loss: 0.7452651560306549
epoch 17   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.25465266990895363 , validation loss: 0.6485318168997765
epoch 18   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.2533665530237497 , validation loss: 0.6480363234877586
epoch 19   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.2496979560922174 , validation loss: 0.6660942509770393
epoch 20   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.24847017287039289 , validation loss: 0.6614268645644188
epoch 21   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.24666114560529298 , validation loss: 0.6880189701914787
epoch 22   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.24494706181918874 , validation loss: 0.6353254094719887
epoch 23   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.24355418804813833 , validation loss: 0.6314888074994087
epoch 24   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.24355032806302987 , validation loss: 0.634809672832489
epoch 25   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.23998856018571293 , validation loss: 0.697102427482605
epoch 26   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.2402871230653688 , validation loss: 0.6527221649885178
epoch 27   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.23726569437513165 , validation loss: 0.6383891403675079
epoch 28   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.23628356468443776 , validation loss: 0.6207098215818405
epoch 29   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.23649740365206026 , validation loss: 0.8143078684806824
epoch 30   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.23584559530604118 , validation loss: 0.6440380737185478
epoch 31   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.23391159433944553 , validation loss: 0.6718835458159447
epoch 32   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.23332361380259195 , validation loss: 0.630944661796093
epoch 33   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.23352154154403537 , validation loss: 0.7045298218727112
epoch 34   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.23193842318712496 , validation loss: 0.6338153705000877
epoch 35   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.22999438526583652 , validation loss: 0.6268338933587074
epoch 36   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.22941777431497387 , validation loss: 0.6251799017190933
epoch 37   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.22847804836198396 , validation loss: 0.6215693578124046
epoch 38   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.2273196166052538 , validation loss: 0.6381523981690407
epoch 39   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.22766144398380728 , validation loss: 0.632662259042263
epoch 40   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.22676513358658434 , validation loss: 0.6348101273179054
epoch 41   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.22626823508271984 , validation loss: 0.6447811126708984
epoch 42   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.22623457891099594 , validation loss: 0.6419494524598122
epoch 43   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.22690112947248944 , validation loss: 0.634050264954567
epoch 44   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.22497905936895632 , validation loss: 0.633229061961174
epoch 45   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.22561589234015522 , validation loss: 0.6198598891496658
epoch 46   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.22426780035682753 , validation loss: 0.6246534511446953
epoch 47   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.22341610958763197 , validation loss: 0.6356688588857651
epoch 48   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.22256524773205028 , validation loss: 0.6269173622131348
epoch 49   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.22288937954341664 , validation loss: 0.6179566383361816
epoch 50   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.22187556618568943 , validation loss: 0.6411215960979462
epoch 51   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.2213150706945681 , validation loss: 0.6732377484440804
epoch 52   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.220954649588641 , validation loss: 0.6872828677296638
epoch 53   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.22083782448488123 , validation loss: 0.6142739057540894
epoch 54   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.22012259592028224 , validation loss: 0.7407286986708641
epoch 55   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.21985101641393176 , validation loss: 0.620211236178875
epoch 56   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.22004138400741652 , validation loss: 0.6705159246921539
epoch 57   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.2209447674891528 , validation loss: 0.7104099616408348
epoch 58   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.21908441361259012 , validation loss: 0.6133279874920845
epoch 59   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.2181713934622559 , validation loss: 0.6473336815834045
epoch 60   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.21897906620128482 , validation loss: 0.6353285536170006
epoch 61   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.21819250081099717 , validation loss: 0.6379604339599609
epoch 62   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.2183378993296156 , validation loss: 0.6921283081173897
epoch 63   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.2181614526346618 , validation loss: 0.6118255257606506
epoch 64   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.2167230295199974 , validation loss: 0.657700851559639
epoch 65   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.21664119234272078 , validation loss: 0.6382021903991699
epoch 66   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.21713049359181347 , validation loss: 0.6157700568437576
epoch 67   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.21618864349290437 , validation loss: 0.6663681790232658
epoch 68   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.21528609243093752 , validation loss: 0.6774172335863113
epoch 69   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.21549574154264786 , validation loss: 0.6131969541311264
epoch 70   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.2150978174279718 , validation loss: 0.6488932818174362
epoch 71   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.21528557264337353 , validation loss: 0.6236299425363541
epoch 72   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.21584249740722133 , validation loss: 0.8234647437930107
epoch 73   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.21451206125465094 , validation loss: 0.6081021279096603
epoch 74   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.21455331672640407 , validation loss: 0.5973718017339706
epoch 75   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.21420791190044552 , validation loss: 0.718147873878479
epoch 76   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.2138520362330418 , validation loss: 0.6725287809967995
epoch 77   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.21332072364348992 , validation loss: 0.6088210344314575
epoch 78   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.21328908351122164 , validation loss: 0.6309564188122749
epoch 79   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.21272149945006652 , validation loss: 0.6157642304897308
epoch 80   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.2138957407544641 , validation loss: 0.6562228575348854
epoch 81   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.21300687217244915 , validation loss: 0.6266495436429977
epoch 82   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.21204246288421108 , validation loss: 0.6109058856964111
epoch 83   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.21194162789513082 , validation loss: 0.6088151633739471
epoch 84   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.21168537145736172 , validation loss: 0.6124639064073563
epoch 85   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.21130964978068484 , validation loss: 0.5932265371084213
epoch 86   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.2111968041635027 , validation loss: 0.5951440930366516
epoch 87   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.2109277750931534 , validation loss: 0.6275205686688423
epoch 88   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.2114273146087048 , validation loss: 0.6631664708256721
epoch 89   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.21141056482698403 , validation loss: 0.6018058657646179
epoch 90   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.2112045507220661 , validation loss: 0.7106916233897209
epoch 91   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.21075969145578496 , validation loss: 0.610987514257431
epoch 92   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.21138698359330496 , validation loss: 0.6051215454936028
epoch 93   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.20941907722575992 , validation loss: 0.6067549511790276
epoch 94   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.20989295927917256 , validation loss: 0.5801989883184433
epoch 95   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.20996549404134937 , validation loss: 0.6150114834308624
epoch 96   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.20907920861945434 , validation loss: 0.6562830433249474
tensor(9.6485, device='cuda:0')
MAE: [0.2734192316651767, 0.35295749533201387, 0.3819339903953879, 0.415386129495947, 0.46338465175346577, 0.4872940083631535, 0.4948402464670158, 0.5082366419671891, 0.5269277623971713, 0.5451688382143789, 0.5485074480275441, 0.5704988627281693, 0.6026605016208186, 0.6060161166373141, 0.609016493485098, 0.608524936020912, 0.6093950429940884, 0.6130946276555818, 0.6069591824572111, 0.6194910253497974, 0.6348705510053899, 0.63367256815094, 0.6269959259325082, 0.6238168706280208, 0.6231114538826202, 0.6302329401591236, 0.6164233999780004, 0.620417795945535, 0.6365859240086116, 0.6363057141254665, 0.6215926786016711, 0.6214753256536559] , MAPE: [0.10794309039271051, 0.0913206577836956, 0.19982000740618833, 0.14485521586695277, 0.14112659534299402, 0.060721375967997614, 0.045749771400121444, 0.09884185676208515, 0.05863549114503783, 0.12142024457752246, 0.09957240925524828, 0.12973806816991387, 0.1296047421982968, 0.13644026201294576, 0.08809600792070323, 0.12829311789667908, 0.1357959410790762, 0.14043928669247724, 0.056633675662769466, 0.08525798884103857, 0.12144254399763274, 0.17322791304164095, 0.13231655964174652, 0.11573320107687549, 0.12225727443751148, -0.008757217621323341, -0.044433360394482264, -0.08385380473682519, -0.10456983295062283, -0.06611234430225503, -0.03642770993382581, -0.1092737127893986] %, RMSE: [0.4852800410785048, 0.5754472234533113, 0.6101109681521206, 0.6506392240203982, 0.6971499413212925, 0.7294416077025222, 0.7433190316312093, 0.7558593798082849, 0.7798422049799637, 0.8060219778613815, 0.810593011742992, 0.8385706085514095, 0.873200567391561, 0.8787392951242589, 0.8858249573419023, 0.8867234753524793, 0.8899791315263242, 0.8990530930428352, 0.8880017363682601, 0.9046255698172884, 0.925525279462844, 0.9286332248972826, 0.9254566622705193, 0.9202865218614796, 0.9205971885355617, 0.9318578322629997, 0.9195074542163959, 0.9234022762016603, 0.9424103613109777, 0.9504041689793339, 0.9381302578920168, 0.945442910957314]
epoch 97   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.2096163577893201 , validation loss: 0.5930105224251747
tensor(9.5324, device='cuda:0')
MAE: [0.2738277123512258, 0.3446904180008803, 0.3755026500594332, 0.40064612527929977, 0.4417506319694413, 0.45334405677661915, 0.4718651181794511, 0.47897848283103905, 0.48790665811945483, 0.5037378812967271, 0.5200456786944925, 0.5228428110680015, 0.5491502880452911, 0.5596607169298666, 0.5643786110978612, 0.5598209468784175, 0.5512803919897559, 0.5527916644678749, 0.5585046923859525, 0.5583310583272239, 0.5741572008437487, 0.5740466045275254, 0.5713627576649419, 0.5663262976166437, 0.5493019658698671, 0.5511794717010764, 0.5496951452558189, 0.5501561151057021, 0.5550683115795255, 0.5543273123676322, 0.5453169290114617, 0.5415020549317976] , MAPE: [0.12713816172149855, 0.11758891734830164, 0.22475738693352282, 0.15440337828370398, 0.09506640618070106, 0.01439946030405248, 0.04140795265457331, 0.073211853182944, 0.03967428215653197, 0.12214626835303337, 0.1061171133358802, 0.09609569342821937, 0.051364812199710064, 0.08518609795608108, 0.03498949195629468, 0.06195686885091604, 0.06608807057021192, 0.040007982302373686, -0.003317371560986749, -0.013121681317310336, -0.03805704383042428, 0.029541380191857917, 0.01951580801451613, 0.007487486778526986, 0.02371148346695562, -0.138936102655897, -0.11547751795228081, -0.1878693176652293, -0.23411797026111072, -0.24067833772380404, -0.18825315252805913, -0.2186951813288003] %, RMSE: [0.4841047774227452, 0.5620434481775418, 0.5932903327882671, 0.6211431776153742, 0.6617673234572654, 0.6745292481078897, 0.6994918984856071, 0.7014303271926552, 0.7059743025532182, 0.7210788093159922, 0.7381127745182899, 0.7370991887987326, 0.7620460750511093, 0.7756347519180865, 0.7762693139932645, 0.7674397621097533, 0.7540345887930915, 0.7557037833683254, 0.7610021152800946, 0.758421806009748, 0.7719177015760403, 0.7713202290339175, 0.7675095064991465, 0.7586304667235522, 0.7349694311748831, 0.7388565542400163, 0.740465649761687, 0.7362746518384401, 0.7425526927595055, 0.741529662517491, 0.7317840672282369, 0.7317497935355269]
epoch 98   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.20934357830122405 , validation loss: 0.737848311662674
tensor(9.3873, device='cuda:0')
MAE: [0.2849644151566185, 0.3648418615672008, 0.409336179937284, 0.4532610988812809, 0.5076531185263519, 0.5490175930253163, 0.5792015339572405, 0.6046348643276034, 0.6423040278981795, 0.6654235125505894, 0.6902375582044886, 0.7184381874888828, 0.737773174684994, 0.7430576738715172, 0.7484888231535394, 0.7467076862924108, 0.7495371360381701, 0.7465040703102486, 0.762324409148819, 0.7688965679691702, 0.7594127593389184, 0.7631178007768371, 0.762078559154203, 0.7533011156122786, 0.760176348107454, 0.7609582026229845, 0.7699890756704989, 0.7683654207597995, 0.7638374743514608, 0.769341994318919, 0.7669046315228202, 0.7609433030388942] , MAPE: [0.12945637347339067, 0.17261622549498817, 0.2661089036453894, 0.21320248511082496, 0.16521575575755124, 0.0844426005180942, 0.02489997199497554, 0.09661031520888032, 0.05279037641495942, 0.16922923848510163, 0.22686649205388246, 0.24295161629558634, 0.30094681379337584, 0.19649835333323223, 0.13755200811227922, 0.10247404698214072, 0.10022010984939772, 0.16914217478438154, 0.1441014717972673, 0.20151624354274036, 0.3825581465907086, 0.30263863261203705, 0.32701863569068573, 0.2773202221338954, 0.2443898316838667, 0.1741893057190854, 0.14738728194633743, 0.2424810048492059, 0.30834237087345867, 0.23673870753070622, 0.1905427492406044, -0.15522457576024984] %, RMSE: [0.47644990335157844, 0.5683711473117279, 0.619053181408203, 0.668361583408839, 0.7198043852451044, 0.7655890888616742, 0.8011064274701157, 0.8316995129661151, 0.8735069796816783, 0.9005839951824745, 0.9347520635438147, 0.9714880504743568, 0.9935154870431414, 1.005964679747372, 1.0155451032428804, 1.0172215093196202, 1.0201751430083124, 1.016165174774987, 1.0321990411034978, 1.043143112423583, 1.0342056497863255, 1.0389328857014621, 1.0398473299640016, 1.0345295496932074, 1.0421881387796468, 1.0433782741998099, 1.0562347101226794, 1.058818499202738, 1.055417991848061, 1.0606251486972877, 1.0619447578905747, 1.0630607204267748]
epoch 99   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4 , train loss: 0.21004825538279964 , validation loss: 0.6424257829785347
tensor(9.3383, device='cuda:0')
MAE: [0.3033232595604489, 0.3729623293079743, 0.4034092695871848, 0.4333630710579071, 0.48050636893157495, 0.498864328097168, 0.5122253073406281, 0.5218769593208491, 0.5524665414138706, 0.5542631661085431, 0.5572900712929819, 0.5683040162713564, 0.5975219962388738, 0.6037219204421433, 0.6114964221767389, 0.6119920544691153, 0.628101206535147, 0.6263529193130581, 0.6195577703232004, 0.628656367843721, 0.6522360505121424, 0.6521734097941788, 0.6484092500106883, 0.650035311007877, 0.6623009355251015, 0.6658785146455636, 0.6525536694189475, 0.6589743834808612, 0.6773085198207691, 0.6825704675878292, 0.6715253169627227, 0.6729193697985953] , MAPE: [0.15986565671994465, 0.0943218616687981, 0.1945825983985427, 0.12283055609381355, 0.08446247703723915, 0.0342984708428682, 0.03069686975691587, 0.0572418740243692, 0.029880372861524538, 0.08111945897104343, 0.04177211502343854, 0.04821412026002756, 0.009464793877355687, 0.06012854412939464, 0.003433586753609731, 0.036705964817149446, 0.04092822008562582, 0.012797090220082066, -0.03686741867778372, -0.05229557660528334, -0.08948589454050963, -0.015572400458277678, -0.046404737602252055, -0.04614063435688389, -0.030497030446179255, -0.11962390281799484, -0.11811378384070212, -0.21058272045734577, -0.24011776610361604, -0.2311284496911595, -0.15358055788545674, -0.20492744575678576] %, RMSE: [0.5141212156242753, 0.5898659351125667, 0.6224145709445658, 0.6590097894501692, 0.7032609355480952, 0.7226618863394336, 0.7396979541985218, 0.7455253054621624, 0.7761799774121048, 0.7766701241109074, 0.7788618648734855, 0.7920400170441626, 0.8167824896517237, 0.8222486582156595, 0.8311063142374201, 0.8307879552785375, 0.852611598536663, 0.8524186317959394, 0.839976104984601, 0.8530998215944516, 0.8772640744575833, 0.8768485123443408, 0.8734744022134718, 0.8741811481433538, 0.886259999413259, 0.8898794617036435, 0.8748574003776043, 0.8789806591337885, 0.8942427176233593, 0.8986590904679608, 0.8886352273607248, 0.8962226338599268]
test loss: NIL 
MAE: [0.3033232595604489, 0.3729623293079743, 0.4034092695871848, 0.4333630710579071, 0.48050636893157495, 0.498864328097168, 0.5122253073406281, 0.5218769593208491, 0.5524665414138706, 0.5542631661085431, 0.5572900712929819, 0.5683040162713564, 0.5975219962388738, 0.6037219204421433, 0.6114964221767389, 0.6119920544691153, 0.628101206535147, 0.6263529193130581, 0.6195577703232004, 0.628656367843721, 0.6522360505121424, 0.6521734097941788, 0.6484092500106883, 0.650035311007877, 0.6623009355251015, 0.6658785146455636, 0.6525536694189475, 0.6589743834808612, 0.6773085198207691, 0.6825704675878292, 0.6715253169627227, 0.6729193697985953] , MAPE: [0.15986565671994465, 0.0943218616687981, 0.1945825983985427, 0.12283055609381355, 0.08446247703723915, 0.0342984708428682, 0.03069686975691587, 0.0572418740243692, 0.029880372861524538, 0.08111945897104343, 0.04177211502343854, 0.04821412026002756, 0.009464793877355687, 0.06012854412939464, 0.003433586753609731, 0.036705964817149446, 0.04092822008562582, 0.012797090220082066, -0.03686741867778372, -0.05229557660528334, -0.08948589454050963, -0.015572400458277678, -0.046404737602252055, -0.04614063435688389, -0.030497030446179255, -0.11962390281799484, -0.11811378384070212, -0.21058272045734577, -0.24011776610361604, -0.2311284496911595, -0.15358055788545674, -0.20492744575678576] %, RMSE: [0.5141212156242753, 0.5898659351125667, 0.6224145709445658, 0.6590097894501692, 0.7032609355480952, 0.7226618863394336, 0.7396979541985218, 0.7455253054621624, 0.7761799774121048, 0.7766701241109074, 0.7788618648734855, 0.7920400170441626, 0.8167824896517237, 0.8222486582156595, 0.8311063142374201, 0.8307879552785375, 0.852611598536663, 0.8524186317959394, 0.839976104984601, 0.8530998215944516, 0.8772640744575833, 0.8768485123443408, 0.8734744022134718, 0.8741811481433538, 0.886259999413259, 0.8898794617036435, 0.8748574003776043, 0.8789806591337885, 0.8942427176233593, 0.8986590904679608, 0.8886352273607248, 0.8962226338599268]
====================
training elapsedd with 319.68 seconds for 100 iterations, the sec/iter = 3.20

MAE_mean: [0.30332326 0.37296233 0.40340927 0.43336307 0.48050637 0.49886433
 0.51222531 0.52187696 0.55246654 0.55426317 0.55729007 0.56830402
 0.597522   0.60372192 0.61149642 0.61199205 0.62810121 0.62635292
 0.61955777 0.62865637 0.65223605 0.65217341 0.64840925 0.65003531
 0.66230094 0.66587851 0.65255367 0.65897438 0.67730852 0.68257047
 0.67152532 0.67291937] , MAPE_mean: [ 0.15986566  0.09432186  0.1945826   0.12283056  0.08446248  0.03429847
  0.03069687  0.05724187  0.02988037  0.08111946  0.04177212  0.04821412
  0.00946479  0.06012854  0.00343359  0.03670596  0.04092822  0.01279709
 -0.03686742 -0.05229558 -0.08948589 -0.0155724  -0.04640474 -0.04614063
 -0.03049703 -0.1196239  -0.11811378 -0.21058272 -0.24011777 -0.23112845
 -0.15358056 -0.20492745] , RMSE_mean: [0.51412122 0.58986594 0.62241457 0.65900979 0.70326094 0.72266189
 0.73969795 0.74552531 0.77617998 0.77667012 0.77886186 0.79204002
 0.81678249 0.82224866 0.83110631 0.83078796 0.8526116  0.85241863
 0.8399761  0.85309982 0.87726407 0.87684851 0.8734744  0.87418115
 0.88626    0.88987946 0.8748574  0.87898066 0.89424272 0.89865909
 0.88863523 0.89622263]

MAE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , MAPE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , RMSE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
Finished training with: lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-5_ah2_ck3_kt4
user config:
seed 666
device 0
scaler StandardScaler()
day_slot 288
n_route 10
n_his 96
n_pred 96
n_train 34
n_val 5
n_test 5
mode 1
n_c 10
model STAGNN_stamp
TPG TPGNN
name lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2
log_path log/TPGNN_r05p02kt3outer_342
crash 342
new_name TPGNN_r05p02kt3outer_342
batch_size 64
lr 0.001
a 0.1
r 0.5
n_mask 1
adam {'use': True, 'weight_decay': 0.0001}
slr {'use': True, 'step_size': 400, 'gamma': 0.3}
resume False
start_epoch 0
epochs 100
n_layer 1
n_attr 64
n_hid 128
reg_A 1e-05
circle 288
drop_prob 0.1
CE {'use': True, 'kernel_size': 1, 'bias': False}
LE {'use': False, 'bias': False}
SE {'use': True, 'separate': True, 'no': False}
TE {'use': True, 'no': True}
attn {'head': 1, 'd_k': 32, 'd_v': 32, 'drop_prob': 0.2}
STstamp {'use': True, 'kt': 3, 'temperature': 1.0}
T4N {'use': True, 'step': 2, 'end_epoch': 10000, 'change_head': True, 'change_enc': True}
stamp_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/time_stamp_F_96.npy
data_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/V_France_processed_0.csv
adj_matrix_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/W_France_processed_0.csv
dis_mat tensor([[0.0000, 0.3661, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.6136, 0.0000,
         0.0000],
        [0.3661, 0.0000, 0.0000, 0.0000, 0.1098, 0.0000, 0.0000, 0.8975, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.3410, 0.8975, 0.0000, 0.0000, 0.0000, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.3410, 0.0000, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000,
         0.1494],
        [0.0000, 0.1098, 0.8975, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000, 0.6996,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000,
         0.2289],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000, 0.0000,
         0.5594],
        [0.6136, 0.8975, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.2117,
         0.0000],
        [0.0000, 0.4288, 0.4288, 0.0000, 0.6996, 0.0000, 0.0000, 0.2117, 0.0000,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.1494, 0.0000, 0.2289, 0.5594, 0.0000, 0.0000,
         0.0000]], device='cuda:0')
prefix log/lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2/
checkpoint_temp_path log/lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2//temp.pth
checkpoint_best_path log/lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2//best.pth
tensorboard_path log/lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2/
record_path log/lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2/record.txt
eps 0.1
parse <bound method DefaultConfig.parse of <config.DefaultConfig object at 0x7f435f4d5550>>
output <bound method DefaultConfig.output of <config.DefaultConfig object at 0x7f435f4d5550>>
train: True, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 9792
len(data): 9792, day_slot: 288, n_day: 34
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
10 10
epoch 0   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.7238165666075314 , validation loss: 1.0192110762000084
epoch 1   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.42156115700216856 , validation loss: 0.8975424244999886
epoch 2   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.3835335479063146 , validation loss: 0.9057141244411469
epoch 3   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.3630546839798198 , validation loss: 0.7993769645690918
epoch 4   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.34634027995315253 , validation loss: 0.7919040247797966
epoch 5   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.3308812227903628 , validation loss: 0.7654577791690826
epoch 6   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.3148519718179516 , validation loss: 0.715330220758915
epoch 7   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.2981655048389061 , validation loss: 0.6902761459350586
epoch 8   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.28966783133207585 , validation loss: 0.7069965302944183
epoch 9   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.2834286876753265 , validation loss: 0.6770233437418938
epoch 10   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.2779298489000283 , validation loss: 0.6675285920500755
epoch 11   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.27261625376402165 , validation loss: 0.6673536896705627
epoch 12   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.2694934591943142 , validation loss: 0.6793492436408997
epoch 13   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.26569358420138267 , validation loss: 0.7009550184011459
epoch 14   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.26298268782157525 , validation loss: 0.7285116314888
epoch 15   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.25906456101174447 , validation loss: 0.6496356949210167
epoch 16   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.25608957544261335 , validation loss: 0.7452651560306549
epoch 17   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.25465266990895363 , validation loss: 0.6485318168997765
epoch 18   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.2533665530237497 , validation loss: 0.6480363234877586
epoch 19   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.2496979560922174 , validation loss: 0.6660942509770393
epoch 20   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.24847017287039289 , validation loss: 0.6614268645644188
epoch 21   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.24666114560529298 , validation loss: 0.6880189701914787
epoch 22   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.24494706181918874 , validation loss: 0.6353254094719887
epoch 23   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.24355418804813833 , validation loss: 0.6314888074994087
epoch 24   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.24355032806302987 , validation loss: 0.634809672832489
epoch 25   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.23998856018571293 , validation loss: 0.697102427482605
epoch 26   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.2402871230653688 , validation loss: 0.6527221649885178
epoch 27   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.23726569437513165 , validation loss: 0.6383891403675079
epoch 28   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.23628356468443776 , validation loss: 0.6207098215818405
epoch 29   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.23649740365206026 , validation loss: 0.8143078684806824
epoch 30   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.23584559530604118 , validation loss: 0.6440380737185478
epoch 31   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.23391159433944553 , validation loss: 0.6718835458159447
epoch 32   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.23332361380259195 , validation loss: 0.630944661796093
epoch 33   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.23352154154403537 , validation loss: 0.7045298218727112
epoch 34   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.23193842318712496 , validation loss: 0.6338153705000877
epoch 35   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.22999438526583652 , validation loss: 0.6268338933587074
epoch 36   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.22941777431497387 , validation loss: 0.6251799017190933
epoch 37   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.22847804836198396 , validation loss: 0.6215693578124046
epoch 38   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.2273196166052538 , validation loss: 0.6381523981690407
epoch 39   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.22766144398380728 , validation loss: 0.632662259042263
epoch 40   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.22676513358658434 , validation loss: 0.6348101273179054
epoch 41   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.22626823508271984 , validation loss: 0.6447811126708984
epoch 42   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.22623457891099594 , validation loss: 0.6419494524598122
epoch 43   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.22690112947248944 , validation loss: 0.634050264954567
epoch 44   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.22497905936895632 , validation loss: 0.633229061961174
epoch 45   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.22561589234015522 , validation loss: 0.6198598891496658
epoch 46   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.22426780035682753 , validation loss: 0.6246534511446953
epoch 47   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.22341610958763197 , validation loss: 0.6356688588857651
epoch 48   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.22256524773205028 , validation loss: 0.6269173622131348
epoch 49   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.22288937954341664 , validation loss: 0.6179566383361816
epoch 50   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.22187556618568943 , validation loss: 0.6411215960979462
epoch 51   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.2213150706945681 , validation loss: 0.6732377484440804
epoch 52   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.220954649588641 , validation loss: 0.6872828677296638
epoch 53   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.22083782448488123 , validation loss: 0.6142739057540894
epoch 54   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.22012259592028224 , validation loss: 0.7407286986708641
epoch 55   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.21985101641393176 , validation loss: 0.620211236178875
epoch 56   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.22004138400741652 , validation loss: 0.6705159246921539
epoch 57   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.2209447674891528 , validation loss: 0.7104099616408348
epoch 58   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.21908441361259012 , validation loss: 0.6133279874920845
epoch 59   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.2181713934622559 , validation loss: 0.6473336815834045
epoch 60   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.21897906620128482 , validation loss: 0.6353285536170006
epoch 61   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.21819250081099717 , validation loss: 0.6379604339599609
epoch 62   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.2183378993296156 , validation loss: 0.6921283081173897
epoch 63   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.2181614526346618 , validation loss: 0.6118255257606506
epoch 64   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.2167230295199974 , validation loss: 0.657700851559639
epoch 65   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.21664119234272078 , validation loss: 0.6382021903991699
epoch 66   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.21713049359181347 , validation loss: 0.6157700568437576
epoch 67   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.21618864349290437 , validation loss: 0.6663681790232658
epoch 68   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.21528609243093752 , validation loss: 0.6774172335863113
epoch 69   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.21549574154264786 , validation loss: 0.6131969541311264
epoch 70   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.2150978174279718 , validation loss: 0.6488932818174362
epoch 71   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.21528557264337353 , validation loss: 0.6236299425363541
epoch 72   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.21584249740722133 , validation loss: 0.8234647437930107
epoch 73   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.21451206125465094 , validation loss: 0.6081021279096603
epoch 74   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.21455331672640407 , validation loss: 0.5973718017339706
epoch 75   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.21420791190044552 , validation loss: 0.718147873878479
epoch 76   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.2138520362330418 , validation loss: 0.6725287809967995
epoch 77   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.21332072364348992 , validation loss: 0.6088210344314575
epoch 78   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.21328908351122164 , validation loss: 0.6309564188122749
epoch 79   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.21272149945006652 , validation loss: 0.6157642304897308
epoch 80   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.2138957407544641 , validation loss: 0.6562228575348854
epoch 81   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.21300687217244915 , validation loss: 0.6266495436429977
epoch 82   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.21204246288421108 , validation loss: 0.6109058856964111
epoch 83   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.21194162789513082 , validation loss: 0.6088151633739471
epoch 84   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.21168537145736172 , validation loss: 0.6124639064073563
epoch 85   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.21130964978068484 , validation loss: 0.5932265371084213
epoch 86   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.2111968041635027 , validation loss: 0.5951440930366516
epoch 87   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.2109277750931534 , validation loss: 0.6275205686688423
epoch 88   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.2114273146087048 , validation loss: 0.6631664708256721
epoch 89   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.21141056482698403 , validation loss: 0.6018058657646179
epoch 90   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.2112045507220661 , validation loss: 0.7106916233897209
epoch 91   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.21075969145578496 , validation loss: 0.610987514257431
epoch 92   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.21138698359330496 , validation loss: 0.6051215454936028
epoch 93   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.20941907722575992 , validation loss: 0.6067549511790276
epoch 94   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.20989295927917256 , validation loss: 0.5801989883184433
epoch 95   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.20996549404134937 , validation loss: 0.6150114834308624
epoch 96   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.20907920861945434 , validation loss: 0.6562830433249474
tensor(9.6485, device='cuda:0')
MAE: [0.2734192316651767, 0.35295749533201387, 0.3819339903953879, 0.415386129495947, 0.46338465175346577, 0.4872940083631535, 0.4948402464670158, 0.5082366419671891, 0.5269277623971713, 0.5451688382143789, 0.5485074480275441, 0.5704988627281693, 0.6026605016208186, 0.6060161166373141, 0.609016493485098, 0.608524936020912, 0.6093950429940884, 0.6130946276555818, 0.6069591824572111, 0.6194910253497974, 0.6348705510053899, 0.63367256815094, 0.6269959259325082, 0.6238168706280208, 0.6231114538826202, 0.6302329401591236, 0.6164233999780004, 0.620417795945535, 0.6365859240086116, 0.6363057141254665, 0.6215926786016711, 0.6214753256536559] , MAPE: [0.10794309039271051, 0.0913206577836956, 0.19982000740618833, 0.14485521586695277, 0.14112659534299402, 0.060721375967997614, 0.045749771400121444, 0.09884185676208515, 0.05863549114503783, 0.12142024457752246, 0.09957240925524828, 0.12973806816991387, 0.1296047421982968, 0.13644026201294576, 0.08809600792070323, 0.12829311789667908, 0.1357959410790762, 0.14043928669247724, 0.056633675662769466, 0.08525798884103857, 0.12144254399763274, 0.17322791304164095, 0.13231655964174652, 0.11573320107687549, 0.12225727443751148, -0.008757217621323341, -0.044433360394482264, -0.08385380473682519, -0.10456983295062283, -0.06611234430225503, -0.03642770993382581, -0.1092737127893986] %, RMSE: [0.4852800410785048, 0.5754472234533113, 0.6101109681521206, 0.6506392240203982, 0.6971499413212925, 0.7294416077025222, 0.7433190316312093, 0.7558593798082849, 0.7798422049799637, 0.8060219778613815, 0.810593011742992, 0.8385706085514095, 0.873200567391561, 0.8787392951242589, 0.8858249573419023, 0.8867234753524793, 0.8899791315263242, 0.8990530930428352, 0.8880017363682601, 0.9046255698172884, 0.925525279462844, 0.9286332248972826, 0.9254566622705193, 0.9202865218614796, 0.9205971885355617, 0.9318578322629997, 0.9195074542163959, 0.9234022762016603, 0.9424103613109777, 0.9504041689793339, 0.9381302578920168, 0.945442910957314]
epoch 97   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.2096163577893201 , validation loss: 0.5930105224251747
tensor(9.5324, device='cuda:0')
MAE: [0.2738277123512258, 0.3446904180008803, 0.3755026500594332, 0.40064612527929977, 0.4417506319694413, 0.45334405677661915, 0.4718651181794511, 0.47897848283103905, 0.48790665811945483, 0.5037378812967271, 0.5200456786944925, 0.5228428110680015, 0.5491502880452911, 0.5596607169298666, 0.5643786110978612, 0.5598209468784175, 0.5512803919897559, 0.5527916644678749, 0.5585046923859525, 0.5583310583272239, 0.5741572008437487, 0.5740466045275254, 0.5713627576649419, 0.5663262976166437, 0.5493019658698671, 0.5511794717010764, 0.5496951452558189, 0.5501561151057021, 0.5550683115795255, 0.5543273123676322, 0.5453169290114617, 0.5415020549317976] , MAPE: [0.12713816172149855, 0.11758891734830164, 0.22475738693352282, 0.15440337828370398, 0.09506640618070106, 0.01439946030405248, 0.04140795265457331, 0.073211853182944, 0.03967428215653197, 0.12214626835303337, 0.1061171133358802, 0.09609569342821937, 0.051364812199710064, 0.08518609795608108, 0.03498949195629468, 0.06195686885091604, 0.06608807057021192, 0.040007982302373686, -0.003317371560986749, -0.013121681317310336, -0.03805704383042428, 0.029541380191857917, 0.01951580801451613, 0.007487486778526986, 0.02371148346695562, -0.138936102655897, -0.11547751795228081, -0.1878693176652293, -0.23411797026111072, -0.24067833772380404, -0.18825315252805913, -0.2186951813288003] %, RMSE: [0.4841047774227452, 0.5620434481775418, 0.5932903327882671, 0.6211431776153742, 0.6617673234572654, 0.6745292481078897, 0.6994918984856071, 0.7014303271926552, 0.7059743025532182, 0.7210788093159922, 0.7381127745182899, 0.7370991887987326, 0.7620460750511093, 0.7756347519180865, 0.7762693139932645, 0.7674397621097533, 0.7540345887930915, 0.7557037833683254, 0.7610021152800946, 0.758421806009748, 0.7719177015760403, 0.7713202290339175, 0.7675095064991465, 0.7586304667235522, 0.7349694311748831, 0.7388565542400163, 0.740465649761687, 0.7362746518384401, 0.7425526927595055, 0.741529662517491, 0.7317840672282369, 0.7317497935355269]
epoch 98   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.20934357830122405 , validation loss: 0.737848311662674
tensor(9.3873, device='cuda:0')
MAE: [0.2849644151566185, 0.3648418615672008, 0.409336179937284, 0.4532610988812809, 0.5076531185263519, 0.5490175930253163, 0.5792015339572405, 0.6046348643276034, 0.6423040278981795, 0.6654235125505894, 0.6902375582044886, 0.7184381874888828, 0.737773174684994, 0.7430576738715172, 0.7484888231535394, 0.7467076862924108, 0.7495371360381701, 0.7465040703102486, 0.762324409148819, 0.7688965679691702, 0.7594127593389184, 0.7631178007768371, 0.762078559154203, 0.7533011156122786, 0.760176348107454, 0.7609582026229845, 0.7699890756704989, 0.7683654207597995, 0.7638374743514608, 0.769341994318919, 0.7669046315228202, 0.7609433030388942] , MAPE: [0.12945637347339067, 0.17261622549498817, 0.2661089036453894, 0.21320248511082496, 0.16521575575755124, 0.0844426005180942, 0.02489997199497554, 0.09661031520888032, 0.05279037641495942, 0.16922923848510163, 0.22686649205388246, 0.24295161629558634, 0.30094681379337584, 0.19649835333323223, 0.13755200811227922, 0.10247404698214072, 0.10022010984939772, 0.16914217478438154, 0.1441014717972673, 0.20151624354274036, 0.3825581465907086, 0.30263863261203705, 0.32701863569068573, 0.2773202221338954, 0.2443898316838667, 0.1741893057190854, 0.14738728194633743, 0.2424810048492059, 0.30834237087345867, 0.23673870753070622, 0.1905427492406044, -0.15522457576024984] %, RMSE: [0.47644990335157844, 0.5683711473117279, 0.619053181408203, 0.668361583408839, 0.7198043852451044, 0.7655890888616742, 0.8011064274701157, 0.8316995129661151, 0.8735069796816783, 0.9005839951824745, 0.9347520635438147, 0.9714880504743568, 0.9935154870431414, 1.005964679747372, 1.0155451032428804, 1.0172215093196202, 1.0201751430083124, 1.016165174774987, 1.0321990411034978, 1.043143112423583, 1.0342056497863255, 1.0389328857014621, 1.0398473299640016, 1.0345295496932074, 1.0421881387796468, 1.0433782741998099, 1.0562347101226794, 1.058818499202738, 1.055417991848061, 1.0606251486972877, 1.0619447578905747, 1.0630607204267748]
epoch 99   lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2 , train loss: 0.21004825538279964 , validation loss: 0.6424257829785347
tensor(9.3383, device='cuda:0')
MAE: [0.3033232595604489, 0.3729623293079743, 0.4034092695871848, 0.4333630710579071, 0.48050636893157495, 0.498864328097168, 0.5122253073406281, 0.5218769593208491, 0.5524665414138706, 0.5542631661085431, 0.5572900712929819, 0.5683040162713564, 0.5975219962388738, 0.6037219204421433, 0.6114964221767389, 0.6119920544691153, 0.628101206535147, 0.6263529193130581, 0.6195577703232004, 0.628656367843721, 0.6522360505121424, 0.6521734097941788, 0.6484092500106883, 0.650035311007877, 0.6623009355251015, 0.6658785146455636, 0.6525536694189475, 0.6589743834808612, 0.6773085198207691, 0.6825704675878292, 0.6715253169627227, 0.6729193697985953] , MAPE: [0.15986565671994465, 0.0943218616687981, 0.1945825983985427, 0.12283055609381355, 0.08446247703723915, 0.0342984708428682, 0.03069686975691587, 0.0572418740243692, 0.029880372861524538, 0.08111945897104343, 0.04177211502343854, 0.04821412026002756, 0.009464793877355687, 0.06012854412939464, 0.003433586753609731, 0.036705964817149446, 0.04092822008562582, 0.012797090220082066, -0.03686741867778372, -0.05229557660528334, -0.08948589454050963, -0.015572400458277678, -0.046404737602252055, -0.04614063435688389, -0.030497030446179255, -0.11962390281799484, -0.11811378384070212, -0.21058272045734577, -0.24011776610361604, -0.2311284496911595, -0.15358055788545674, -0.20492744575678576] %, RMSE: [0.5141212156242753, 0.5898659351125667, 0.6224145709445658, 0.6590097894501692, 0.7032609355480952, 0.7226618863394336, 0.7396979541985218, 0.7455253054621624, 0.7761799774121048, 0.7766701241109074, 0.7788618648734855, 0.7920400170441626, 0.8167824896517237, 0.8222486582156595, 0.8311063142374201, 0.8307879552785375, 0.852611598536663, 0.8524186317959394, 0.839976104984601, 0.8530998215944516, 0.8772640744575833, 0.8768485123443408, 0.8734744022134718, 0.8741811481433538, 0.886259999413259, 0.8898794617036435, 0.8748574003776043, 0.8789806591337885, 0.8942427176233593, 0.8986590904679608, 0.8886352273607248, 0.8962226338599268]
test loss: NIL 
MAE: [0.3033232595604489, 0.3729623293079743, 0.4034092695871848, 0.4333630710579071, 0.48050636893157495, 0.498864328097168, 0.5122253073406281, 0.5218769593208491, 0.5524665414138706, 0.5542631661085431, 0.5572900712929819, 0.5683040162713564, 0.5975219962388738, 0.6037219204421433, 0.6114964221767389, 0.6119920544691153, 0.628101206535147, 0.6263529193130581, 0.6195577703232004, 0.628656367843721, 0.6522360505121424, 0.6521734097941788, 0.6484092500106883, 0.650035311007877, 0.6623009355251015, 0.6658785146455636, 0.6525536694189475, 0.6589743834808612, 0.6773085198207691, 0.6825704675878292, 0.6715253169627227, 0.6729193697985953] , MAPE: [0.15986565671994465, 0.0943218616687981, 0.1945825983985427, 0.12283055609381355, 0.08446247703723915, 0.0342984708428682, 0.03069686975691587, 0.0572418740243692, 0.029880372861524538, 0.08111945897104343, 0.04177211502343854, 0.04821412026002756, 0.009464793877355687, 0.06012854412939464, 0.003433586753609731, 0.036705964817149446, 0.04092822008562582, 0.012797090220082066, -0.03686741867778372, -0.05229557660528334, -0.08948589454050963, -0.015572400458277678, -0.046404737602252055, -0.04614063435688389, -0.030497030446179255, -0.11962390281799484, -0.11811378384070212, -0.21058272045734577, -0.24011776610361604, -0.2311284496911595, -0.15358055788545674, -0.20492744575678576] %, RMSE: [0.5141212156242753, 0.5898659351125667, 0.6224145709445658, 0.6590097894501692, 0.7032609355480952, 0.7226618863394336, 0.7396979541985218, 0.7455253054621624, 0.7761799774121048, 0.7766701241109074, 0.7788618648734855, 0.7920400170441626, 0.8167824896517237, 0.8222486582156595, 0.8311063142374201, 0.8307879552785375, 0.852611598536663, 0.8524186317959394, 0.839976104984601, 0.8530998215944516, 0.8772640744575833, 0.8768485123443408, 0.8734744022134718, 0.8741811481433538, 0.886259999413259, 0.8898794617036435, 0.8748574003776043, 0.8789806591337885, 0.8942427176233593, 0.8986590904679608, 0.8886352273607248, 0.8962226338599268]
====================
training elapsedd with 301.77 seconds for 100 iterations, the sec/iter = 3.02

MAE_mean: [0.30332326 0.37296233 0.40340927 0.43336307 0.48050637 0.49886433
 0.51222531 0.52187696 0.55246654 0.55426317 0.55729007 0.56830402
 0.597522   0.60372192 0.61149642 0.61199205 0.62810121 0.62635292
 0.61955777 0.62865637 0.65223605 0.65217341 0.64840925 0.65003531
 0.66230094 0.66587851 0.65255367 0.65897438 0.67730852 0.68257047
 0.67152532 0.67291937] , MAPE_mean: [ 0.15986566  0.09432186  0.1945826   0.12283056  0.08446248  0.03429847
  0.03069687  0.05724187  0.02988037  0.08111946  0.04177212  0.04821412
  0.00946479  0.06012854  0.00343359  0.03670596  0.04092822  0.01279709
 -0.03686742 -0.05229558 -0.08948589 -0.0155724  -0.04640474 -0.04614063
 -0.03049703 -0.1196239  -0.11811378 -0.21058272 -0.24011777 -0.23112845
 -0.15358056 -0.20492745] , RMSE_mean: [0.51412122 0.58986594 0.62241457 0.65900979 0.70326094 0.72266189
 0.73969795 0.74552531 0.77617998 0.77667012 0.77886186 0.79204002
 0.81678249 0.82224866 0.83110631 0.83078796 0.8526116  0.85241863
 0.8399761  0.85309982 0.87726407 0.87684851 0.8734744  0.87418115
 0.88626    0.88987946 0.8748574  0.87898066 0.89424272 0.89865909
 0.88863523 0.89622263]

MAE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , MAPE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , RMSE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
Finished training with: lr1e-3_bs64_nh128_ra1e-5_dp0.1_wd1e-4_ah4_ck3_kt2
user config:
seed 666
device 0
scaler StandardScaler()
day_slot 288
n_route 10
n_his 96
n_pred 96
n_train 34
n_val 5
n_test 5
mode 1
n_c 10
model STAGNN_stamp
TPG TPGNN
name lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2
log_path log/TPGNN_r05p02kt3outer_343
crash 343
new_name TPGNN_r05p02kt3outer_343
batch_size 64
lr 0.0001
a 0.1
r 0.5
n_mask 1
adam {'use': True, 'weight_decay': 0.0001}
slr {'use': True, 'step_size': 400, 'gamma': 0.3}
resume False
start_epoch 0
epochs 100
n_layer 1
n_attr 64
n_hid 128
reg_A 0.001
circle 288
drop_prob 0.3
CE {'use': True, 'kernel_size': 1, 'bias': False}
LE {'use': False, 'bias': False}
SE {'use': True, 'separate': True, 'no': False}
TE {'use': True, 'no': True}
attn {'head': 1, 'd_k': 32, 'd_v': 32, 'drop_prob': 0.2}
STstamp {'use': True, 'kt': 3, 'temperature': 1.0}
T4N {'use': True, 'step': 2, 'end_epoch': 10000, 'change_head': True, 'change_enc': True}
stamp_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/time_stamp_F_96.npy
data_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/V_France_processed_0.csv
adj_matrix_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/W_France_processed_0.csv
dis_mat tensor([[0.0000, 0.3661, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.6136, 0.0000,
         0.0000],
        [0.3661, 0.0000, 0.0000, 0.0000, 0.1098, 0.0000, 0.0000, 0.8975, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.3410, 0.8975, 0.0000, 0.0000, 0.0000, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.3410, 0.0000, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000,
         0.1494],
        [0.0000, 0.1098, 0.8975, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000, 0.6996,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000,
         0.2289],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000, 0.0000,
         0.5594],
        [0.6136, 0.8975, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.2117,
         0.0000],
        [0.0000, 0.4288, 0.4288, 0.0000, 0.6996, 0.0000, 0.0000, 0.2117, 0.0000,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.1494, 0.0000, 0.2289, 0.5594, 0.0000, 0.0000,
         0.0000]], device='cuda:0')
prefix log/lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2/
checkpoint_temp_path log/lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2//temp.pth
checkpoint_best_path log/lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2//best.pth
tensorboard_path log/lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2/
record_path log/lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2/record.txt
eps 0.1
parse <bound method DefaultConfig.parse of <config.DefaultConfig object at 0x7efe1f981550>>
output <bound method DefaultConfig.output of <config.DefaultConfig object at 0x7efe1f981550>>
train: True, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 9792
len(data): 9792, day_slot: 288, n_day: 34
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
10 10
epoch 0   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 3.799991574941897 , validation loss: 0.991878017783165
epoch 1   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 3.2230007975709203 , validation loss: 0.9910518676042557
epoch 2   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 2.9689638427659575 , validation loss: 1.0237684473395348
epoch 3   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 2.8414530333350685 , validation loss: 1.0587408691644669
epoch 4   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 2.758420182209389 , validation loss: 1.0088698416948318
epoch 5   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 2.689731205210966 , validation loss: 1.000396616756916
epoch 6   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 2.635126632802627 , validation loss: 0.997014731168747
epoch 7   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 2.5856529637879015 , validation loss: 0.9769019484519958
epoch 8   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 2.5391847619823382 , validation loss: 0.9674568027257919
epoch 9   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 2.4949176965975295 , validation loss: 0.9503763243556023
epoch 10   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 2.452438924826828 , validation loss: 0.9402058646082878
epoch 11   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 2.4117515040378943 , validation loss: 0.9369114190340042
epoch 12   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 2.3724731417263256 , validation loss: 0.9258476197719574
epoch 13   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 2.3345401193581377 , validation loss: 0.9558930099010468
epoch 14   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 2.297976386313345 , validation loss: 0.9412354603409767
epoch 15   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 2.2624495543685614 , validation loss: 0.9343949556350708
epoch 16   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 2.2280297045614206 , validation loss: 0.9395379573106766
epoch 17   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 2.1945401920991787 , validation loss: 0.918836385011673
epoch 18   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 2.1620160551632153 , validation loss: 0.9259177967905998
epoch 19   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 2.1301806347042906 , validation loss: 0.9127190783619881
epoch 20   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 2.0991212994444606 , validation loss: 0.8837959840893745
epoch 21   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 2.068846155615414 , validation loss: 0.9114168584346771
epoch 22   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 2.0391153214024564 , validation loss: 0.9419293254613876
epoch 23   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 2.010083759532255 , validation loss: 0.9078096300363541
epoch 24   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.9815407453798781 , validation loss: 0.8639839887619019
epoch 25   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.9537789330762976 , validation loss: 0.8705786317586899
epoch 26   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.9262893153171914 , validation loss: 0.8400290384888649
epoch 27   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.899292081010108 , validation loss: 0.8661440908908844
epoch 28   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.8728516943314497 , validation loss: 0.8328888937830925
epoch 29   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.8467624491336299 , validation loss: 0.8396223783493042
epoch 30   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.8209624196968826 , validation loss: 0.8447326570749283
epoch 31   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.7954212918001062 , validation loss: 0.7823729813098907
epoch 32   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.7702416064692479 , validation loss: 0.7678787708282471
epoch 33   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.7455365050072764 , validation loss: 0.7727712020277977
epoch 34   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.7213621817383111 , validation loss: 0.7654993683099747
epoch 35   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.6977238351223516 , validation loss: 0.766953356564045
epoch 36   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.6745769393210317 , validation loss: 0.7439189404249191
epoch 37   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.6517122843686272 , validation loss: 0.7428874969482422
epoch 38   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.6297803088730456 , validation loss: 0.7266513705253601
epoch 39   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.6084848244984944 , validation loss: 0.7374691814184189
epoch 40   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.5873403759563671 , validation loss: 0.7245936021208763
epoch 41   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.5669201355354458 , validation loss: 0.7207064032554626
epoch 42   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.5463040810005337 , validation loss: 0.7125498428940773
epoch 43   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.5267672071269913 , validation loss: 0.7058876156806946
epoch 44   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.5076493539062201 , validation loss: 0.7193055972456932
epoch 45   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.4886784670399684 , validation loss: 0.7005516886711121
epoch 46   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.4701302121667301 , validation loss: 0.6997968479990959
epoch 47   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.4518275027181589 , validation loss: 0.713378295302391
epoch 48   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.4340700822718002 , validation loss: 0.7015695720911026
epoch 49   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.4163474054897534 , validation loss: 0.6907467469573021
epoch 50   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.3990993336135267 , validation loss: 0.6960396096110344
epoch 51   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.38198548672246 , validation loss: 0.696637712419033
epoch 52   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.3653762083427579 , validation loss: 0.692466638982296
epoch 53   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.3489471229852414 , validation loss: 0.6922407746315002
epoch 54   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.3326328548730588 , validation loss: 0.6903557181358337
epoch 55   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.3167165798299454 , validation loss: 0.6904765516519547
epoch 56   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.3010130372701907 , validation loss: 0.6935189738869667
epoch 57   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.285863109663421 , validation loss: 0.6910253688693047
epoch 58   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.2707362689223944 , validation loss: 0.6941753476858139
epoch 59   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.2557450486164468 , validation loss: 0.6959598064422607
epoch 60   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.2410543923284494 , validation loss: 0.692006342113018
epoch 61   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.226707051782047 , validation loss: 0.691353403031826
epoch 62   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.2123275597890217 , validation loss: 0.6876839473843575
epoch 63   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.198301584112878 , validation loss: 0.6934067904949188
epoch 64   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.1844104201185937 , validation loss: 0.6806064546108246
epoch 65   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.1708106924505794 , validation loss: 0.6742618829011917
epoch 66   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.1575866774016736 , validation loss: 0.6840497404336929
epoch 67   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.1442986352770936 , validation loss: 0.674723744392395
epoch 68   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.1313990845399744 , validation loss: 0.6739600226283073
epoch 69   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.1184764516119863 , validation loss: 0.6865647509694099
epoch 70   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.1058528750550514 , validation loss: 0.685854859650135
epoch 71   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.0933486223220825 , validation loss: 0.6885907202959061
epoch 72   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.0812962288950003 , validation loss: 0.6801973804831505
epoch 73   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.069325837434507 , validation loss: 0.70804313570261
epoch 74   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.0574180448756498 , validation loss: 0.679099828004837
epoch 75   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.0455959170472389 , validation loss: 0.6709043309092522
epoch 76   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.0338911589454203 , validation loss: 0.6693701222538948
epoch 77   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.0228048189013612 , validation loss: 0.6748918518424034
epoch 78   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.0115436327223684 , validation loss: 0.6719582229852676
epoch 79   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 1.0002293738664365 , validation loss: 0.6832216903567314
epoch 80   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 0.9895117201057135 , validation loss: 0.655756838619709
epoch 81   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 0.9787539559252122 , validation loss: 0.675472617149353
epoch 82   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 0.9682607650756836 , validation loss: 0.6906809508800507
epoch 83   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 0.9578863370652292 , validation loss: 0.6753541752696037
epoch 84   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 0.9475212027044857 , validation loss: 0.6757055297493935
epoch 85   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 0.937445554078794 , validation loss: 0.6642386838793755
epoch 86   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 0.9273221679762298 , validation loss: 0.6770843863487244
epoch 87   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 0.917567324404623 , validation loss: 0.6550987586379051
epoch 88   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 0.9079048119339288 , validation loss: 0.6636297553777695
epoch 89   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 0.8982757890925688 , validation loss: 0.6634171456098557
epoch 90   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 0.8886216271157358 , validation loss: 0.6531037464737892
epoch 91   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 0.8794680775380602 , validation loss: 0.6734611093997955
epoch 92   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 0.8701925219274035 , validation loss: 0.6591134890913963
epoch 93   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 0.8611919202056586 , validation loss: 0.6821016520261765
epoch 94   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 0.852302721902436 , validation loss: 0.6695325076580048
epoch 95   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 0.8433714625882167 , validation loss: 0.6746569201350212
epoch 96   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 0.8347398054366019 , validation loss: 0.6576634868979454
tensor(58.5421, device='cuda:0')
MAE: [0.29779353432146083, 0.3765606543928692, 0.4188729044548284, 0.4593917625796856, 0.5114700146676185, 0.5410600646658196, 0.5299090194803922, 0.5307095908739402, 0.5534661619079098, 0.5699049712241311, 0.5800003161797895, 0.5926569839094564, 0.6165267577502377, 0.6277750310866335, 0.6233867282808288, 0.6211783442064428, 0.6307771959370866, 0.6362373971322686, 0.6345418409291732, 0.6282247449008306, 0.6303737863802265, 0.6308703624353428, 0.6146037362661866, 0.6002831661230741, 0.6021689832901832, 0.6005326375146348, 0.585214303068279, 0.577367095957635, 0.5885507368426962, 0.583887191779105, 0.5625443916053502, 0.5479817734201698] , MAPE: [0.13493915843507528, 0.08628224286051947, 0.16159565848375182, 0.1916999645373008, 0.14330406335109053, 0.11637799942592932, 0.08340874312867977, 0.08182056556842841, 0.062465898435750074, 0.13116065293915188, 0.11323266938564273, 0.15103747344926244, 0.12185116574980112, 0.15777972478718869, 0.1083179727976451, 0.07569319911200323, 0.0725620627947831, 0.10092631976917829, 0.06625696925599112, 0.08151672110930037, 0.13085240534316814, 0.1339976471614965, 0.08427761863135809, 0.04018395677791277, 0.030216324822284094, 0.038516118509782545, 0.01518419194026531, -0.03635378021924497, -0.08001955320849054, -0.03815695066381841, -0.04741685826740631, -0.12958081269777605] %, RMSE: [0.5693570595210694, 0.6629701742141595, 0.707094646887753, 0.7454842013236204, 0.8269900610929858, 0.8685884790189877, 0.8337610857269583, 0.8258882565173469, 0.8446385753368864, 0.8502502887181342, 0.849245717190881, 0.8621292477466407, 0.8982965029916083, 0.9126208157526541, 0.897023545351379, 0.8961857249990188, 0.9084040444329372, 0.903540731416826, 0.884105910257867, 0.874108693559737, 0.880191125328686, 0.878005745944273, 0.851446619703301, 0.8373876359194291, 0.840296549241553, 0.8329005608317201, 0.8082746031931438, 0.7954267027448653, 0.8151651048259446, 0.813104373753861, 0.779991214087523, 0.7693262368007971]
epoch 97   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 0.8262003414771136 , validation loss: 0.6490111798048019
tensor(58.3556, device='cuda:0')
MAE: [0.2928850817029393, 0.3819828841931273, 0.4176340891253779, 0.44979330048310695, 0.4911788594419348, 0.5035458947890966, 0.5014447817796861, 0.5177310878086413, 0.5469188150679021, 0.5696212675145914, 0.581312413988923, 0.5829872028990505, 0.6004788237860061, 0.5974660417675665, 0.5926564600917789, 0.593909411955932, 0.6113849508741237, 0.6221225556877163, 0.6297041699272994, 0.6200692177544703, 0.612520444249043, 0.6025055756416057, 0.5902529015176997, 0.5868822058455385, 0.5980686747145445, 0.5986018067559938, 0.5859680446452394, 0.5757811105424135, 0.5727130988476433, 0.5580553086140414, 0.5515716034915183, 0.5397815158871031] , MAPE: [0.13721575970559288, 0.07639747849403798, 0.1638248124592192, 0.19372694173561708, 0.1677625619367969, 0.11429880129944199, 0.0948871429962788, 0.114040200553574, 0.06799041289899027, 0.1513298769808679, 0.14708808732510978, 0.14573405553522872, 0.10901021993673808, 0.14908932134957045, 0.10546983789933723, 0.08452749069392788, 0.056319015564075335, 0.10604408497886868, 0.06754968023314092, 0.077691822301169, 0.12582809036593934, 0.13062332582010547, 0.10273798644382773, 0.0625168148290761, 0.06940526337353224, 0.06241498642648254, 0.027673109938089312, -0.029169495311109937, -0.08772260352001472, -0.037072265244690046, -0.03982800110573605, -0.1722256935579905] %, RMSE: [0.5619742383259111, 0.6777957559580912, 0.7072994047504041, 0.7357168574198258, 0.7959286777005495, 0.8094297422675182, 0.79342591405552, 0.8154373342796016, 0.8428869940897683, 0.8587509902068607, 0.8621111516621768, 0.8572351222859439, 0.8801683366972471, 0.8697314512519115, 0.8565769014898044, 0.8617322077626588, 0.8872344746976756, 0.8911086062135832, 0.8909362597919885, 0.8708709771522042, 0.8577094009382803, 0.8382844435352874, 0.8197544239736976, 0.8273631372924735, 0.8452249653033967, 0.8445592363096434, 0.8219208118258402, 0.8044246267012288, 0.7989378513719422, 0.7828610853118475, 0.7757171649699872, 0.7723206843792022]
epoch 98   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 0.8178370326173072 , validation loss: 0.6513984650373459
tensor(58.1689, device='cuda:0')
MAE: [0.296042679749026, 0.37210065405777437, 0.40775037141958465, 0.4591990269791604, 0.5065958719575758, 0.5266274149308807, 0.511453915402178, 0.5256931132823229, 0.551586867091582, 0.556324716504356, 0.5589509030592811, 0.584202436893103, 0.609672092255397, 0.6087252743599801, 0.5958543833406623, 0.6114466926278834, 0.6221222846555649, 0.6214638828960507, 0.6187093541110606, 0.6212728800975055, 0.6231077689335672, 0.6095089975919229, 0.5850333078474421, 0.5821423478455273, 0.5879869873380077, 0.5794116366769849, 0.5645061691934915, 0.5607936484163109, 0.5616141075986563, 0.5523840632193635, 0.5371574441481805, 0.5296189727349994] , MAPE: [0.14398423406147653, 0.10034721892314394, 0.1607007241389923, 0.18229355347016946, 0.13692495380977204, 0.1145696957467867, 0.0818200923647053, 0.09374979054495738, 0.07462240967674606, 0.1495479827059891, 0.1308426224712742, 0.15245793900678184, 0.13345699921530504, 0.15954115914561326, 0.10439694394940817, 0.08971129360110912, 0.0699390944862347, 0.09830056659439243, 0.07550374275319742, 0.07750307441299173, 0.13671246361755113, 0.13491673440709662, 0.08205222138891644, 0.06857088926575895, 0.061738096405241936, 0.05586156062910828, 0.022198225823954136, -0.0259536943884345, -0.07686153210187616, -0.03718505223693936, -0.051391724300667345, -0.22295619349482146] %, RMSE: [0.5676125059467628, 0.6602300757307253, 0.691999118324812, 0.7500211657900888, 0.8217683960646984, 0.8478988955005301, 0.8052975413902973, 0.8220168400824786, 0.8471604895347578, 0.8369965953324494, 0.8248060674629641, 0.8583163560610542, 0.8941939391167175, 0.8902481540122252, 0.85961670472277, 0.8882097315547358, 0.9022229336178277, 0.8904177398922725, 0.8683444624705814, 0.8675238344515657, 0.8702679238128377, 0.8456874251098573, 0.8055801811211957, 0.8142593560074759, 0.8255269489092809, 0.8106746594360517, 0.7885280604871311, 0.7836876068722969, 0.786901136815811, 0.7787106536282353, 0.7586765192451772, 0.7605947390263159]
epoch 99   lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2 , train loss: 0.8093521419693442 , validation loss: 0.6512240171432495
tensor(57.9819, device='cuda:0')
MAE: [0.30543737366814744, 0.3832957298552483, 0.4188986875490314, 0.46876181600092115, 0.5138391936186355, 0.5365368712198028, 0.530905277588856, 0.5422492107073056, 0.5706671184163118, 0.5918616297407095, 0.5957057214410226, 0.6038098088064299, 0.6228058520940699, 0.6329630198592762, 0.6280858097803423, 0.635040938569252, 0.6339868427162088, 0.6401409970197021, 0.6466494738126232, 0.6468882909384508, 0.6487331137731287, 0.6423099949687104, 0.635249053981616, 0.6306721438719056, 0.6322555435283743, 0.6357358420578783, 0.6171976488020232, 0.6071418051824895, 0.6057792130160654, 0.6023662594340972, 0.5960461005836379, 0.5869480179277123] , MAPE: [0.13221812708674782, 0.07399356508766265, 0.15818881266137716, 0.16889189883794595, 0.13820842229440009, 0.08511582674187837, 0.06254420639872647, 0.050410480509894974, 0.028980675355847568, 0.09282381721901871, 0.07516583248957291, 0.09380852921878483, 0.057920978074766136, 0.0636493006083615, 0.03857087687294589, 0.01832107449674855, 0.011466103799295487, 0.023063804053181793, -0.01092046315583146, 0.004509298205915742, 0.04590288233577273, 0.045618807112437446, 0.007895688697210869, -0.02823849502677196, -0.02369886576664753, -0.02855887613800527, -0.05140487817235648, -0.08185962232959111, -0.10766610620248722, -0.0780681365316634, -0.0715314827527438, -0.15614688492018236] %, RMSE: [0.5799029863854671, 0.6695748946716586, 0.6995118396131804, 0.7526955917438635, 0.816650388713144, 0.8438973830149024, 0.8151860390176535, 0.8256790592924736, 0.8539627409950182, 0.8674427108516471, 0.8555166446682019, 0.8602033772082848, 0.8832106842333927, 0.8935807799967566, 0.8739290416159331, 0.8875695442811969, 0.8835402003160515, 0.8808088893172751, 0.8766306234077886, 0.872364993585732, 0.8721554155935783, 0.8588288179337941, 0.8449288826674068, 0.845431084718987, 0.848827164300917, 0.8536379307191682, 0.8270825772117081, 0.8094751550255397, 0.8039696803052186, 0.8013322764111372, 0.791084714955793, 0.7883961262970971]
test loss: NIL 
MAE: [0.30543737366814744, 0.3832957298552483, 0.4188986875490314, 0.46876181600092115, 0.5138391936186355, 0.5365368712198028, 0.530905277588856, 0.5422492107073056, 0.5706671184163118, 0.5918616297407095, 0.5957057214410226, 0.6038098088064299, 0.6228058520940699, 0.6329630198592762, 0.6280858097803423, 0.635040938569252, 0.6339868427162088, 0.6401409970197021, 0.6466494738126232, 0.6468882909384508, 0.6487331137731287, 0.6423099949687104, 0.635249053981616, 0.6306721438719056, 0.6322555435283743, 0.6357358420578783, 0.6171976488020232, 0.6071418051824895, 0.6057792130160654, 0.6023662594340972, 0.5960461005836379, 0.5869480179277123] , MAPE: [0.13221812708674782, 0.07399356508766265, 0.15818881266137716, 0.16889189883794595, 0.13820842229440009, 0.08511582674187837, 0.06254420639872647, 0.050410480509894974, 0.028980675355847568, 0.09282381721901871, 0.07516583248957291, 0.09380852921878483, 0.057920978074766136, 0.0636493006083615, 0.03857087687294589, 0.01832107449674855, 0.011466103799295487, 0.023063804053181793, -0.01092046315583146, 0.004509298205915742, 0.04590288233577273, 0.045618807112437446, 0.007895688697210869, -0.02823849502677196, -0.02369886576664753, -0.02855887613800527, -0.05140487817235648, -0.08185962232959111, -0.10766610620248722, -0.0780681365316634, -0.0715314827527438, -0.15614688492018236] %, RMSE: [0.5799029863854671, 0.6695748946716586, 0.6995118396131804, 0.7526955917438635, 0.816650388713144, 0.8438973830149024, 0.8151860390176535, 0.8256790592924736, 0.8539627409950182, 0.8674427108516471, 0.8555166446682019, 0.8602033772082848, 0.8832106842333927, 0.8935807799967566, 0.8739290416159331, 0.8875695442811969, 0.8835402003160515, 0.8808088893172751, 0.8766306234077886, 0.872364993585732, 0.8721554155935783, 0.8588288179337941, 0.8449288826674068, 0.845431084718987, 0.848827164300917, 0.8536379307191682, 0.8270825772117081, 0.8094751550255397, 0.8039696803052186, 0.8013322764111372, 0.791084714955793, 0.7883961262970971]
====================
training elapsedd with 316.70 seconds for 100 iterations, the sec/iter = 3.17

MAE_mean: [0.30543737 0.38329573 0.41889869 0.46876182 0.51383919 0.53653687
 0.53090528 0.54224921 0.57066712 0.59186163 0.59570572 0.60380981
 0.62280585 0.63296302 0.62808581 0.63504094 0.63398684 0.640141
 0.64664947 0.64688829 0.64873311 0.64230999 0.63524905 0.63067214
 0.63225554 0.63573584 0.61719765 0.60714181 0.60577921 0.60236626
 0.5960461  0.58694802] , MAPE_mean: [ 0.13221813  0.07399357  0.15818881  0.1688919   0.13820842  0.08511583
  0.06254421  0.05041048  0.02898068  0.09282382  0.07516583  0.09380853
  0.05792098  0.0636493   0.03857088  0.01832107  0.0114661   0.0230638
 -0.01092046  0.0045093   0.04590288  0.04561881  0.00789569 -0.0282385
 -0.02369887 -0.02855888 -0.05140488 -0.08185962 -0.10766611 -0.07806814
 -0.07153148 -0.15614688] , RMSE_mean: [0.57990299 0.66957489 0.69951184 0.75269559 0.81665039 0.84389738
 0.81518604 0.82567906 0.85396274 0.86744271 0.85551664 0.86020338
 0.88321068 0.89358078 0.87392904 0.88756954 0.8835402  0.88080889
 0.87663062 0.87236499 0.87215542 0.85882882 0.84492888 0.84543108
 0.84882716 0.85363793 0.82708258 0.80947516 0.80396968 0.80133228
 0.79108471 0.78839613]

MAE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , MAPE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , RMSE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
Finished training with: lr1e-4_bs64_nh128_ra1e-3_dp0.3_wd1e-5_ah1_ck1_kt2
user config:
seed 666
device 0
scaler StandardScaler()
day_slot 288
n_route 10
n_his 96
n_pred 96
n_train 34
n_val 5
n_test 5
mode 1
n_c 10
model STAGNN_stamp
TPG TPGNN
name lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4
log_path log/TPGNN_r05p02kt3outer_344
crash 344
new_name TPGNN_r05p02kt3outer_344
batch_size 64
lr 0.0001
a 0.1
r 0.5
n_mask 1
adam {'use': True, 'weight_decay': 0.0001}
slr {'use': True, 'step_size': 400, 'gamma': 0.3}
resume False
start_epoch 0
epochs 100
n_layer 1
n_attr 64
n_hid 64
reg_A 1e-05
circle 288
drop_prob 0.2
CE {'use': True, 'kernel_size': 1, 'bias': False}
LE {'use': False, 'bias': False}
SE {'use': True, 'separate': True, 'no': False}
TE {'use': True, 'no': True}
attn {'head': 1, 'd_k': 32, 'd_v': 32, 'drop_prob': 0.2}
STstamp {'use': True, 'kt': 3, 'temperature': 1.0}
T4N {'use': True, 'step': 2, 'end_epoch': 10000, 'change_head': True, 'change_enc': True}
stamp_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/time_stamp_F_96.npy
data_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/V_France_processed_0.csv
adj_matrix_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/W_France_processed_0.csv
dis_mat tensor([[0.0000, 0.3661, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.6136, 0.0000,
         0.0000],
        [0.3661, 0.0000, 0.0000, 0.0000, 0.1098, 0.0000, 0.0000, 0.8975, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.3410, 0.8975, 0.0000, 0.0000, 0.0000, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.3410, 0.0000, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000,
         0.1494],
        [0.0000, 0.1098, 0.8975, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000, 0.6996,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000,
         0.2289],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000, 0.0000,
         0.5594],
        [0.6136, 0.8975, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.2117,
         0.0000],
        [0.0000, 0.4288, 0.4288, 0.0000, 0.6996, 0.0000, 0.0000, 0.2117, 0.0000,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.1494, 0.0000, 0.2289, 0.5594, 0.0000, 0.0000,
         0.0000]], device='cuda:0')
prefix log/lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4/
checkpoint_temp_path log/lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4//temp.pth
checkpoint_best_path log/lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4//best.pth
tensorboard_path log/lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4/
record_path log/lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4/record.txt
eps 0.1
parse <bound method DefaultConfig.parse of <config.DefaultConfig object at 0x7f57714d5550>>
output <bound method DefaultConfig.output of <config.DefaultConfig object at 0x7f57714d5550>>
train: True, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 9792
len(data): 9792, day_slot: 288, n_day: 34
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
10 10
epoch 0   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 1.4179858156279022 , validation loss: 0.9600584208965302
epoch 1   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.991697230759789 , validation loss: 0.9304886013269424
epoch 2   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.7775624943714515 , validation loss: 0.9870684295892715
epoch 3   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.6218804015832788 , validation loss: 0.9874265938997269
epoch 4   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.5488782186134189 , validation loss: 1.0169718861579895
epoch 5   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.5197354601878746 , validation loss: 1.0378524661064148
epoch 6   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.5004406436985614 , validation loss: 1.0249934419989586
epoch 7   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.4850109552635866 , validation loss: 1.023764245212078
epoch 8   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.47248827300819696 , validation loss: 1.0290974155068398
epoch 9   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.46185988713713255 , validation loss: 1.0022447481751442
epoch 10   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.45256438734484655 , validation loss: 0.999068409204483
epoch 11   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.4441703709901548 , validation loss: 0.9785220548510551
epoch 12   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.4363350552671096 , validation loss: 0.9590053707361221
epoch 13   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.42913730880793405 , validation loss: 0.9638944491744041
epoch 14   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.4224232955306184 , validation loss: 0.9607596173882484
epoch 15   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.4161731296894597 , validation loss: 0.9494373127818108
epoch 16   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.41043613412800956 , validation loss: 0.9527449011802673
epoch 17   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.40539612781767753 , validation loss: 0.9320434629917145
epoch 18   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.40054821968078613 , validation loss: 0.935647040605545
epoch 19   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.396116211718204 , validation loss: 0.9493700265884399
epoch 20   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.3919438684687895 , validation loss: 0.9254825934767723
epoch 21   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.3879745824664247 , validation loss: 0.9220202639698982
epoch 22   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.384225537963942 , validation loss: 0.9244549125432968
epoch 23   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.380707766495499 , validation loss: 0.9176516830921173
epoch 24   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.3773510707359688 , validation loss: 0.935185618698597
epoch 25   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.3742033406799915 , validation loss: 0.9180467128753662
epoch 26   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.37124930760439706 , validation loss: 0.8989576399326324
epoch 27   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.3682588175231335 , validation loss: 0.8934641182422638
epoch 28   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.365598166105794 , validation loss: 0.8789615854620934
epoch 29   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.3630017112283146 , validation loss: 0.9126458987593651
epoch 30   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.36028314630190533 , validation loss: 0.8698777332901955
epoch 31   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.357906053463618 , validation loss: 0.8681029006838799
epoch 32   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.35533513742334705 , validation loss: 0.8424152359366417
epoch 33   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.35286145993307527 , validation loss: 0.8568345233798027
epoch 34   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.3504023440912658 , validation loss: 0.8316406533122063
epoch 35   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.3478962393367992 , validation loss: 0.8433616161346436
epoch 36   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.3455295007602841 , validation loss: 0.8235314190387726
epoch 37   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.3425412014418957 , validation loss: 0.8040203154087067
epoch 38   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.3395777999186048 , validation loss: 0.8022590428590775
epoch 39   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.3364640526911792 , validation loss: 0.780262716114521
epoch 40   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.33247436378516404 , validation loss: 0.7704852670431137
epoch 41   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.32828736772724226 , validation loss: 0.7831433564424515
epoch 42   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.32284028448310553 , validation loss: 0.7493294551968575
epoch 43   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.318401926872777 , validation loss: 0.7402492612600327
epoch 44   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.31491652364824335 , validation loss: 0.7238626480102539
epoch 45   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.31172113851004957 , validation loss: 0.7190761864185333
epoch 46   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.3093714749111849 , validation loss: 0.7122350186109543
epoch 47   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.3071798021886863 , validation loss: 0.7217344269156456
epoch 48   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.30514177095656303 , validation loss: 0.7109863087534904
epoch 49   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.3033159123916252 , validation loss: 0.6939870119094849
epoch 50   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.30144261028252395 , validation loss: 0.7035968080163002
epoch 51   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.29994558469921934 , validation loss: 0.6919404864311218
epoch 52   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.2983028228376426 , validation loss: 0.6986451745033264
epoch 53   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.2968589558320887 , validation loss: 0.6904830858111382
epoch 54   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.29550407213323254 , validation loss: 0.6910070478916168
epoch 55   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.29416923429451736 , validation loss: 0.6781750246882439
epoch 56   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.2928946433114071 , validation loss: 0.6878617480397224
epoch 57   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.29166093001178667 , validation loss: 0.6824952587485313
epoch 58   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.2904900078680001 , validation loss: 0.672547347843647
epoch 59   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.28932128934299245 , validation loss: 0.6805665343999863
epoch 60   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.28831765932195325 , validation loss: 0.6668325513601303
epoch 61   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.28702573974927265 , validation loss: 0.6805749088525772
epoch 62   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.28607238273994595 , validation loss: 0.6716122254729271
epoch 63   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.2849039248391694 , validation loss: 0.6686624437570572
epoch 64   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.2839658488245571 , validation loss: 0.6676295548677444
epoch 65   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.28305816475082846 , validation loss: 0.6720907688140869
epoch 66   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.28206127706696005 , validation loss: 0.6611372232437134
epoch 67   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.2809668633283353 , validation loss: 0.6647337079048157
epoch 68   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.28018609916462617 , validation loss: 0.6664910241961479
epoch 69   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.2792247037092845 , validation loss: 0.6652916446328163
epoch 70   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.27840010967909123 , validation loss: 0.6757171601057053
epoch 71   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.27738213013200197 , validation loss: 0.6662140339612961
epoch 72   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.2766752768965328 , validation loss: 0.6539346575737
epoch 73   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.2757927658511143 , validation loss: 0.664435401558876
epoch 74   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.2749602677775364 , validation loss: 0.6632822901010513
epoch 75   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.27410594505422253 , validation loss: 0.6581001356244087
epoch 76   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.27330001896502926 , validation loss: 0.6653478443622589
epoch 77   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.2726621674556358 , validation loss: 0.6554054915904999
epoch 78   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.272066334883372 , validation loss: 0.6608944460749626
epoch 79   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.2709343223010792 , validation loss: 0.6541213244199753
epoch 80   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.27036486127797293 , validation loss: 0.6530379951000214
epoch 81   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.26972685082286013 , validation loss: 0.6507121548056602
epoch 82   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.2690247472594766 , validation loss: 0.6536500006914139
epoch 83   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.26851533499418523 , validation loss: 0.66152174025774
epoch 84   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.26760313966695 , validation loss: 0.65324766933918
epoch 85   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.267133223659852 , validation loss: 0.6498125120997429
epoch 86   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.2664807625845367 , validation loss: 0.6529008895158768
epoch 87   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.2658356267447565 , validation loss: 0.6520340219140053
epoch 88   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.2651492842272216 , validation loss: 0.6560338959097862
epoch 89   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.26464370915702745 , validation loss: 0.6424583718180656
epoch 90   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.2639761251561782 , validation loss: 0.650033988058567
epoch 91   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.2633992074167027 , validation loss: 0.6431034654378891
epoch 92   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.2627934749219932 , validation loss: 0.6447743773460388
epoch 93   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.2623203189349642 , validation loss: 0.6409838646650314
epoch 94   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.2617513131277234 , validation loss: 0.6435898765921593
epoch 95   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.2611073904177722 , validation loss: 0.6407157108187675
epoch 96   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.26054881542336705 , validation loss: 0.6409996375441551
tensor(56.6172, device='cuda:0')
MAE: [0.3128283362128993, 0.3848661846786584, 0.43394964318098406, 0.4865582386961149, 0.5269355894915145, 0.5399018788779366, 0.5392289026688362, 0.5361025353275316, 0.5628623865788668, 0.5756890962887363, 0.5829870235190256, 0.6091785118703913, 0.6272362615901631, 0.6423356917768371, 0.6355692932620337, 0.6217013990037988, 0.6350060929661405, 0.6359424958116923, 0.6443778665628783, 0.6572661701877861, 0.6676658341958734, 0.6767860608889731, 0.6723844282440458, 0.6444090084232313, 0.6303095081085627, 0.6304266107247989, 0.6332309038933251, 0.6320165117822357, 0.6251144804517479, 0.6357246489984166, 0.6340844870673626, 0.6200123917246141] , MAPE: [0.12459844951205239, 0.050818318037862874, 0.12104007708488726, 0.10217538499337568, 0.08280105887243726, 0.09164033548604418, 0.061337372279004675, 0.03710781181657797, 0.004859434697475793, 0.05538850407812207, 0.06631751245698417, 0.0802491149379507, 0.06742743993526619, 0.09018819436913394, 0.029507585862404984, 0.010183249302196423, 0.04477505818342195, 0.0461547189130755, 0.05759053135952629, 0.03775396878573955, 0.01783541787205265, 0.0020440243554485185, -0.006736575201393487, -0.06345941272064366, -0.0349508033694217, -0.013721887014671853, -0.031361595606826664, -0.05626817091958616, -0.05750318141157869, -0.013426265742618664, -0.036114320341900014, -0.17792254810310304] %, RMSE: [0.5896131206770124, 0.6612917804936231, 0.6986140280652549, 0.7678695242485404, 0.8363319867082362, 0.8374238361164835, 0.8271818664408652, 0.8098342222530261, 0.8284837325896456, 0.817043782005112, 0.8121331305534639, 0.8471322462959024, 0.876264421002947, 0.888898763930655, 0.8670112727146119, 0.8441572524030942, 0.8507591569031373, 0.8401100611371226, 0.8443295675386158, 0.8654628273637337, 0.8848572794099886, 0.8937374917757358, 0.8794502892442868, 0.8370531482003708, 0.8152937851790203, 0.8186967148648561, 0.8251674892150509, 0.8194231448852185, 0.8160780061304633, 0.834247846316849, 0.8282460622267591, 0.8146874686007746]
epoch 97   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.26008810628862944 , validation loss: 0.6378267630934715
tensor(56.3846, device='cuda:0')
MAE: [0.30803854401703423, 0.3845529025029775, 0.423459689929006, 0.4880692223692793, 0.530504791730458, 0.5403011017662387, 0.539692925674668, 0.530894025634667, 0.5597498090822518, 0.5734703092598692, 0.5738015093354835, 0.6048292487398386, 0.6247333916774038, 0.628045518946325, 0.6277907396993149, 0.6166683719559698, 0.6274020868711673, 0.6210100447793597, 0.624596896302339, 0.6390234297871129, 0.6430486607636066, 0.6440072235039713, 0.6337471669057826, 0.6039391384857524, 0.5956855974014196, 0.6028719139917149, 0.6014681050208273, 0.608811651529725, 0.604150411451053, 0.6107324177422321, 0.6053946757003588, 0.5861192001767226] , MAPE: [0.12870146289249007, 0.05367387710962314, 0.13886528389205252, 0.12057998764057573, 0.10170234445964656, 0.08796551574744373, 0.0818297965968233, 0.07696633788377692, 0.0422362376889814, 0.10418701522775983, 0.12170811512034337, 0.12874678227324374, 0.11045874068876958, 0.15370932138703772, 0.1020421295617131, 0.08350010155993211, 0.07887953468921118, 0.11316094662002815, 0.1369862606652956, 0.12143527879722335, 0.09908586547749457, 0.10144873093207878, 0.06411426903388329, 0.011359267866478383, 0.01809722704141077, 0.033114130547565415, 0.012649073767651007, -0.029137491362628297, -0.025526549942436215, 0.005906199666949891, 0.004688366248116939, -0.13033056620622446] %, RMSE: [0.5800849460662165, 0.6658715246611088, 0.688435598777926, 0.7791362837520126, 0.8451460552480833, 0.8487277108309201, 0.8423042215280903, 0.814663085879028, 0.8388994095619708, 0.8344108201828048, 0.819143345920198, 0.8565748782411463, 0.88853330326895, 0.8913869299425099, 0.8824048310511767, 0.8623953115814693, 0.8658773912155673, 0.8449005994849199, 0.8399942498332034, 0.8649646580617637, 0.8737359962005903, 0.875844003077135, 0.858268110840012, 0.8162407983416655, 0.8021241672331403, 0.8174753079892232, 0.8152240033978764, 0.8201820981653322, 0.8208499803801723, 0.8384361064223677, 0.8310796149545375, 0.808665171147085]
epoch 98   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.25976191314996455 , validation loss: 0.6428702548146248
tensor(56.1622, device='cuda:0')
MAE: [0.3083245758105732, 0.387640643697424, 0.43052209627156907, 0.480544874992452, 0.524307699938852, 0.5394122994257157, 0.5407400038446655, 0.5410110061934468, 0.5718656430742943, 0.5864874471424474, 0.593009281164016, 0.6140098193982981, 0.6278582694888423, 0.6296557512022939, 0.6278555935139278, 0.6159704542713067, 0.6333766153775463, 0.6334637525020954, 0.6322132413636548, 0.639003795494239, 0.646477649846335, 0.6527375822360675, 0.6496997449564335, 0.625587074374108, 0.6161615606205365, 0.622314021831628, 0.6178398236330868, 0.6221471173515947, 0.614428711408346, 0.6200453528988453, 0.6126936857788295, 0.5944266227740295] , MAPE: [0.1156487281632849, 0.03849414642216251, 0.1280934501165577, 0.0994064260305826, 0.08929297360083098, 0.09572805970369541, 0.08036156306551234, 0.07264971255800794, 0.019706203705767547, 0.09708196650139932, 0.10581451086468602, 0.10911252791010316, 0.08931715246403384, 0.1307028013356234, 0.08201639752786279, 0.06518638561843094, 0.0735791505339253, 0.09808301255758012, 0.10289739614343883, 0.09199443877049357, 0.0682490580031149, 0.07450958408196288, 0.028437884542058173, -0.01740869722541508, 0.008716845026955872, 0.030903237189544897, 0.0016673140466476062, -0.03824772390689684, -0.04811769563186561, -0.01649038549810564, -0.026918006612706692, -0.14911968742412354] %, RMSE: [0.583685788333005, 0.6698199234832101, 0.6945646482128054, 0.760186155135496, 0.8320139936709705, 0.8407634974983467, 0.8344262923601392, 0.8198515010914242, 0.8460937206334171, 0.8439389650039057, 0.8366999114187553, 0.8613914140990311, 0.8854972883934179, 0.8851942215677825, 0.8757220804965895, 0.8574019141948269, 0.8686247219146505, 0.8564722116184951, 0.8448655143713387, 0.859286500586255, 0.8749105151750887, 0.884205687158159, 0.8760597833059623, 0.84085548616102, 0.8241110631683283, 0.8354061202870707, 0.8293451698985226, 0.8330094874169574, 0.8290473069705364, 0.8438344551845572, 0.8331108946320227, 0.8124282436302341]
epoch 99   lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4 , train loss: 0.2590048675443612 , validation loss: 0.6378986909985542
tensor(55.9415, device='cuda:0')
MAE: [0.31180113871951504, 0.39089394822447876, 0.4381285819487128, 0.4849671289886434, 0.5185297064071271, 0.5280502997701699, 0.52373564967828, 0.5242117889938857, 0.545557678338025, 0.5539365709849546, 0.5681242274028278, 0.5882574456500024, 0.5994420959600776, 0.6110400933388275, 0.6085600373625141, 0.6054626097503243, 0.6233199553925198, 0.6324463770500164, 0.638053940939765, 0.6438163043693015, 0.6416028700347453, 0.6480608795955777, 0.6398203156832798, 0.6164752598306568, 0.6165832394520877, 0.626843428312196, 0.6343685260276819, 0.6421442021201028, 0.6222587393375939, 0.6242754724076421, 0.6205882802194694, 0.607214501229374] , MAPE: [0.125586962801401, 0.04659140529387364, 0.13537688621394764, 0.10776720936373824, 0.09146993952641218, 0.09644535423999805, 0.06926095972089598, 0.08153611868924159, 0.03748245446294436, 0.09766734111702763, 0.11367732755016516, 0.09742460869301288, 0.07605373277965817, 0.1336249035075859, 0.08975736426142736, 0.08150752139050702, 0.07637845634823195, 0.11232752853583247, 0.11510579500445302, 0.07347361572228729, 0.05538802649799108, 0.05604573021848091, 0.029497488538360164, -0.02743157672302164, -0.014208492722929955, 0.007215820090851528, 0.0010641012132916715, -0.029071977964655518, -0.03039812612714553, -0.0016514726155080481, -0.012889429585095771, -0.09402186222336034] %, RMSE: [0.5861267534267456, 0.6722346793614252, 0.7067836654514223, 0.7654856876113043, 0.8203013491606491, 0.8214108837138198, 0.8066227197127588, 0.7986791293051478, 0.8105010209158239, 0.7999343359855421, 0.8084448333605527, 0.8305703786627011, 0.8496642456534964, 0.862107984255655, 0.8502809935864941, 0.8456363453649384, 0.8590436634358962, 0.8604665097484739, 0.8545102454890888, 0.8630415082483466, 0.861540446728213, 0.8683522116071785, 0.854266035356894, 0.8246355622231861, 0.8251339232614279, 0.842294878657924, 0.8519886902671207, 0.8553844473931519, 0.8294189368880119, 0.8359639355244749, 0.8331205298827002, 0.819618837080325]
test loss: NIL 
MAE: [0.31180113871951504, 0.39089394822447876, 0.4381285819487128, 0.4849671289886434, 0.5185297064071271, 0.5280502997701699, 0.52373564967828, 0.5242117889938857, 0.545557678338025, 0.5539365709849546, 0.5681242274028278, 0.5882574456500024, 0.5994420959600776, 0.6110400933388275, 0.6085600373625141, 0.6054626097503243, 0.6233199553925198, 0.6324463770500164, 0.638053940939765, 0.6438163043693015, 0.6416028700347453, 0.6480608795955777, 0.6398203156832798, 0.6164752598306568, 0.6165832394520877, 0.626843428312196, 0.6343685260276819, 0.6421442021201028, 0.6222587393375939, 0.6242754724076421, 0.6205882802194694, 0.607214501229374] , MAPE: [0.125586962801401, 0.04659140529387364, 0.13537688621394764, 0.10776720936373824, 0.09146993952641218, 0.09644535423999805, 0.06926095972089598, 0.08153611868924159, 0.03748245446294436, 0.09766734111702763, 0.11367732755016516, 0.09742460869301288, 0.07605373277965817, 0.1336249035075859, 0.08975736426142736, 0.08150752139050702, 0.07637845634823195, 0.11232752853583247, 0.11510579500445302, 0.07347361572228729, 0.05538802649799108, 0.05604573021848091, 0.029497488538360164, -0.02743157672302164, -0.014208492722929955, 0.007215820090851528, 0.0010641012132916715, -0.029071977964655518, -0.03039812612714553, -0.0016514726155080481, -0.012889429585095771, -0.09402186222336034] %, RMSE: [0.5861267534267456, 0.6722346793614252, 0.7067836654514223, 0.7654856876113043, 0.8203013491606491, 0.8214108837138198, 0.8066227197127588, 0.7986791293051478, 0.8105010209158239, 0.7999343359855421, 0.8084448333605527, 0.8305703786627011, 0.8496642456534964, 0.862107984255655, 0.8502809935864941, 0.8456363453649384, 0.8590436634358962, 0.8604665097484739, 0.8545102454890888, 0.8630415082483466, 0.861540446728213, 0.8683522116071785, 0.854266035356894, 0.8246355622231861, 0.8251339232614279, 0.842294878657924, 0.8519886902671207, 0.8553844473931519, 0.8294189368880119, 0.8359639355244749, 0.8331205298827002, 0.819618837080325]
====================
training elapsedd with 309.50 seconds for 100 iterations, the sec/iter = 3.09

MAE_mean: [0.31180114 0.39089395 0.43812858 0.48496713 0.51852971 0.5280503
 0.52373565 0.52421179 0.54555768 0.55393657 0.56812423 0.58825745
 0.5994421  0.61104009 0.60856004 0.60546261 0.62331996 0.63244638
 0.63805394 0.6438163  0.64160287 0.64806088 0.63982032 0.61647526
 0.61658324 0.62684343 0.63436853 0.6421442  0.62225874 0.62427547
 0.62058828 0.6072145 ] , MAPE_mean: [ 0.12558696  0.04659141  0.13537689  0.10776721  0.09146994  0.09644535
  0.06926096  0.08153612  0.03748245  0.09766734  0.11367733  0.09742461
  0.07605373  0.1336249   0.08975736  0.08150752  0.07637846  0.11232753
  0.1151058   0.07347362  0.05538803  0.05604573  0.02949749 -0.02743158
 -0.01420849  0.00721582  0.0010641  -0.02907198 -0.03039813 -0.00165147
 -0.01288943 -0.09402186] , RMSE_mean: [0.58612675 0.67223468 0.70678367 0.76548569 0.82030135 0.82141088
 0.80662272 0.79867913 0.81050102 0.79993434 0.80844483 0.83057038
 0.84966425 0.86210798 0.85028099 0.84563635 0.85904366 0.86046651
 0.85451025 0.86304151 0.86154045 0.86835221 0.85426604 0.82463556
 0.82513392 0.84229488 0.85198869 0.85538445 0.82941894 0.83596394
 0.83312053 0.81961884]

MAE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , MAPE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , RMSE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
Finished training with: lr1e-4_bs64_nh64_ra1e-5_dp0.2_wd1e-6_ah2_ck3_kt4
user config:
seed 666
device 0
scaler StandardScaler()
day_slot 288
n_route 10
n_his 96
n_pred 96
n_train 34
n_val 5
n_test 5
mode 1
n_c 10
model STAGNN_stamp
TPG TPGNN
name lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6
log_path log/TPGNN_r05p02kt3outer_345
crash 345
new_name TPGNN_r05p02kt3outer_345
batch_size 64
lr 0.001
a 0.1
r 0.5
n_mask 1
adam {'use': True, 'weight_decay': 0.0001}
slr {'use': True, 'step_size': 400, 'gamma': 0.3}
resume False
start_epoch 0
epochs 100
n_layer 1
n_attr 64
n_hid 64
reg_A 0.001
circle 288
drop_prob 0.3
CE {'use': True, 'kernel_size': 1, 'bias': False}
LE {'use': False, 'bias': False}
SE {'use': True, 'separate': True, 'no': False}
TE {'use': True, 'no': True}
attn {'head': 1, 'd_k': 32, 'd_v': 32, 'drop_prob': 0.2}
STstamp {'use': True, 'kt': 3, 'temperature': 1.0}
T4N {'use': True, 'step': 2, 'end_epoch': 10000, 'change_head': True, 'change_enc': True}
stamp_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/time_stamp_F_96.npy
data_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/V_France_processed_0.csv
adj_matrix_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/W_France_processed_0.csv
dis_mat tensor([[0.0000, 0.3661, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.6136, 0.0000,
         0.0000],
        [0.3661, 0.0000, 0.0000, 0.0000, 0.1098, 0.0000, 0.0000, 0.8975, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.3410, 0.8975, 0.0000, 0.0000, 0.0000, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.3410, 0.0000, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000,
         0.1494],
        [0.0000, 0.1098, 0.8975, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000, 0.6996,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000,
         0.2289],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000, 0.0000,
         0.5594],
        [0.6136, 0.8975, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.2117,
         0.0000],
        [0.0000, 0.4288, 0.4288, 0.0000, 0.6996, 0.0000, 0.0000, 0.2117, 0.0000,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.1494, 0.0000, 0.2289, 0.5594, 0.0000, 0.0000,
         0.0000]], device='cuda:0')
prefix log/lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6/
checkpoint_temp_path log/lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6//temp.pth
checkpoint_best_path log/lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6//best.pth
tensorboard_path log/lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6/
record_path log/lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6/record.txt
eps 0.1
parse <bound method DefaultConfig.parse of <config.DefaultConfig object at 0x7ff471146550>>
output <bound method DefaultConfig.output of <config.DefaultConfig object at 0x7ff471146550>>
train: True, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 9792
len(data): 9792, day_slot: 288, n_day: 34
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
10 10
epoch 0   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 2.9956568549661076 , validation loss: 1.03597292304039
epoch 1   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 2.328626599966311 , validation loss: 1.0223266929388046
epoch 2   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 2.01295969766729 , validation loss: 0.9663005843758583
epoch 3   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 1.768259976424423 , validation loss: 0.9712208360433578
epoch 4   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 1.57076423775916 , validation loss: 0.8719198703765869
epoch 5   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 1.4068925146963083 , validation loss: 0.8495663329958916
epoch 6   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 1.2679360941344617 , validation loss: 0.8157394230365753
epoch 7   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 1.1446316031848682 , validation loss: 0.769460029900074
epoch 8   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 1.036063020135842 , validation loss: 0.7103556096553802
epoch 9   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.9474379677398532 , validation loss: 0.6767211258411407
epoch 10   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.8728197053367016 , validation loss: 0.6815935671329498
epoch 11   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.8070751335106644 , validation loss: 0.6699958741664886
epoch 12   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.7505800186419019 , validation loss: 0.6486370787024498
epoch 13   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.7017552735758763 , validation loss: 0.649094894528389
epoch 14   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.6568649013837179 , validation loss: 0.6516551598906517
epoch 15   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.6191742525381201 , validation loss: 0.6613914370536804
epoch 16   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.5834303930693981 , validation loss: 0.6303369253873825
epoch 17   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.5524185369996464 , validation loss: 0.6487250626087189
epoch 18   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.5242453918737524 , validation loss: 0.6572903916239738
epoch 19   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.49978923271684084 , validation loss: 0.6522986069321632
epoch 20   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.4761405522916831 , validation loss: 0.6176547110080719
epoch 21   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.4555714936817394 , validation loss: 0.6187488809227943
epoch 22   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.4371957889958924 , validation loss: 0.6116699501872063
epoch 23   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.4217137595017751 , validation loss: 0.6716796532273293
epoch 24   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.40620005539819304 , validation loss: 0.6196470931172371
epoch 25   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.3914245741040099 , validation loss: 0.6057566478848457
epoch 26   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.3791047854750764 , validation loss: 0.6004272475838661
epoch 27   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.36621109293956383 , validation loss: 0.6114217266440392
epoch 28   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.35619093506943944 , validation loss: 0.615644283592701
epoch 29   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.3468853357960196 , validation loss: 0.616975411772728
epoch 30   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.33700470597136256 , validation loss: 0.6066222935914993
epoch 31   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.3283122433166878 , validation loss: 0.6111941710114479
epoch 32   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.32127195129207536 , validation loss: 0.6040936559438705
epoch 33   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.31440991163253784 , validation loss: 0.6138208657503128
epoch 34   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.3079502068313898 , validation loss: 0.6208656206727028
epoch 35   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.3017983121030471 , validation loss: 0.6162352859973907
epoch 36   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.29578832785288495 , validation loss: 0.6431753858923912
epoch 37   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.2901185143227671 , validation loss: 0.6291072443127632
epoch 38   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.28547657412641186 , validation loss: 0.612588107585907
epoch 39   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.282228993434532 , validation loss: 0.6331680193543434
epoch 40   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.2784274652892468 , validation loss: 0.6804386898875237
epoch 41   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.2735108300751331 , validation loss: 0.627018392086029
epoch 42   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.2689607371302212 , validation loss: 0.6127664297819138
epoch 43   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.266285754886328 , validation loss: 0.6136633008718491
epoch 44   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.26313166612503575 , validation loss: 0.613726831972599
epoch 45   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.2597113599379857 , validation loss: 0.6208858639001846
epoch 46   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.25711851698510785 , validation loss: 0.6007683016359806
epoch 47   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.25417447732944115 , validation loss: 0.6023176088929176
epoch 48   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.25442901049174516 , validation loss: 0.6450011506676674
epoch 49   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.2495597650607427 , validation loss: 0.6195045411586761
epoch 50   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.24852917971564273 , validation loss: 0.6150411516427994
epoch 51   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.24717957424182518 , validation loss: 0.6856712028384209
epoch 52   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.24401249955682194 , validation loss: 0.5986695140600204
epoch 53   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.24206912050060198 , validation loss: 0.6078556329011917
epoch 54   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.24049169000457316 , validation loss: 0.651548221707344
epoch 55   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.2396861142387577 , validation loss: 0.6165859326720238
epoch 56   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.23836320551002727 , validation loss: 0.6850815266370773
epoch 57   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.2361142801887849 , validation loss: 0.5889278054237366
epoch 58   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.23479879516012528 , validation loss: 0.5952884033322334
epoch 59   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.23368933913754483 , validation loss: 0.7054403498768806
epoch 60   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.2330852270710702 , validation loss: 0.6200468391180038
epoch 61   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.23208620559935475 , validation loss: 0.6035489439964294
epoch 62   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.23115970486519383 , validation loss: 0.7028393819928169
epoch 63   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.23080565444394655 , validation loss: 0.6396163105964661
epoch 64   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.22897235932303409 , validation loss: 0.6060544550418854
epoch 65   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.22785351586108113 , validation loss: 0.6064362786710262
epoch 66   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.22711373164373286 , validation loss: 0.6346243247389793
epoch 67   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.2259229360257878 , validation loss: 0.6528174579143524
epoch 68   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.22492350111989415 , validation loss: 0.6192309558391571
epoch 69   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.22518980152466717 , validation loss: 0.6038467958569527
epoch 70   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.2248944248638901 , validation loss: 0.599390547722578
epoch 71   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.22367414598371468 , validation loss: 0.6303940564393997
epoch 72   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.2229376461576013 , validation loss: 0.6339734718203545
epoch 73   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.22259195353470596 , validation loss: 0.670777827501297
epoch 74   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.2229525899770213 , validation loss: 0.6146214976906776
epoch 75   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.22073649162170933 , validation loss: 0.6096005141735077
epoch 76   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.22036659162418515 , validation loss: 0.6137711256742477
epoch 77   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.22057204883472592 , validation loss: 0.6066814288496971
epoch 78   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.22020816306273142 , validation loss: 0.6138349026441574
epoch 79   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.21895173776383495 , validation loss: 0.6020641475915909
epoch 80   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.21967250634642208 , validation loss: 0.632996454834938
epoch 81   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.2190928091021145 , validation loss: 0.6710545346140862
epoch 82   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.217822982692251 , validation loss: 0.5996643528342247
epoch 83   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.21736477607605503 , validation loss: 0.6190553605556488
epoch 84   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.21719547814013912 , validation loss: 0.6323013007640839
epoch 85   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.21738236879601197 , validation loss: 0.6156163886189461
epoch 86   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.2172795934420006 , validation loss: 0.6294166818261147
epoch 87   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.2167115158894483 , validation loss: 0.6215166822075844
epoch 88   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.21692802771633746 , validation loss: 0.6136579811573029
epoch 89   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.21596077230631136 , validation loss: 0.6336918622255325
epoch 90   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.21648804697335935 , validation loss: 0.6079182401299477
epoch 91   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.21550949268481312 , validation loss: 0.7282050102949142
epoch 92   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.21586929174030528 , validation loss: 0.5990481600165367
epoch 93   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.21528543531894684 , validation loss: 0.6245693489909172
epoch 94   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.21461263386642232 , validation loss: 0.6131542325019836
epoch 95   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.21393507426860287 , validation loss: 0.6054396964609623
epoch 96   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.2142177682881262 , validation loss: 0.6507804840803146
tensor(17.9333, device='cuda:0')
MAE: [0.26977339759584246, 0.3437115393820958, 0.38879855603094876, 0.44053759088394107, 0.4520131055446169, 0.471225165159888, 0.4932321818299668, 0.5129411277347773, 0.5450428890672598, 0.5608265424321031, 0.5718961665744787, 0.6095105523072644, 0.6126539030275547, 0.6158240263050748, 0.6372463329787337, 0.6406862768161197, 0.6477173498180724, 0.6440247668299017, 0.6500266324659598, 0.6693247099533753, 0.6687106794151525, 0.6663280879857845, 0.6715756698192779, 0.6661403538206035, 0.663198553121063, 0.6487950323251336, 0.6434630561462537, 0.6561551688509734, 0.6487656069239698, 0.6432608684847496, 0.6529731913738567, 0.6556336223387841] , MAPE: [0.06643102217604033, 0.04966526859930924, 0.19193909877933263, 0.1701526978397748, 0.1611251284146517, 0.09306009421631671, 0.10306968326135191, 0.0753660891217944, 0.08033154956852347, 0.14892881430432736, 0.16146731839985132, 0.1658807980605628, 0.14498111719369544, 0.1438035244184901, 0.09054855579894082, 0.07730459075087451, 0.07919671568838932, 0.12408511184805376, 0.09264936541279745, 0.07654929800178092, 0.11745546101033058, 0.12185471231582005, 0.1208083929248156, 0.0833700152937102, 0.03808577738198231, -0.013680992787586856, -0.011397892814381624, 0.0014152698923375207, -0.112833951539402, 0.13566334596597746, 0.016575983346322282, -0.11104036109044173] %, RMSE: [0.4791561266515915, 0.5634950098895888, 0.6231042880561768, 0.6824387667377445, 0.6923450053016634, 0.7159672046843351, 0.7464168348442923, 0.7741434292408932, 0.8080930877001353, 0.8220779440728129, 0.8384193628110038, 0.8865367975730462, 0.8881248349439321, 0.8882571999280615, 0.9112836680019047, 0.9210078780630305, 0.9314009361342684, 0.9224412563173296, 0.9320717236587909, 0.9547972527000248, 0.9487918004316778, 0.9442643163758974, 0.9513486161290541, 0.9477594735197337, 0.9497351329713789, 0.9271139855246856, 0.9243047811660676, 0.9389337820731314, 0.9280822689536863, 0.9209150815699618, 0.9314780071715221, 0.9437876671157533]
epoch 97   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.21413111949668212 , validation loss: 0.6527527719736099
tensor(17.8085, device='cuda:0')
MAE: [0.2803134761472261, 0.36577667014978194, 0.40979102889095076, 0.4318146011598178, 0.46030964798706864, 0.5005194236278611, 0.5160282778236823, 0.5487643116413011, 0.5773037365330479, 0.5982278091080256, 0.6109028156142029, 0.6179966455479105, 0.6234417208963909, 0.6275376774447481, 0.6338098861223337, 0.6562651135579481, 0.6655441851499154, 0.6709445217985314, 0.6818125996074265, 0.672221005774804, 0.6586780506707536, 0.6509576422884369, 0.6523972938793529, 0.656635105269625, 0.6473570872336318, 0.6534106003823354, 0.65970023051826, 0.6548552638431531, 0.6358969761719255, 0.6287428634917153, 0.6251141998118039, 0.6303345808532742] , MAPE: [0.10126084321949409, 0.09503915228447385, 0.24261428027510398, 0.17908518135381415, 0.12754357518727252, 0.05408965509313761, -0.014993605419042875, 0.03728846105512969, 0.029109860420333266, 0.1774825428741607, 0.17905848509561242, 0.15938263781787587, 0.1517687154042933, 0.14382768667369034, 0.029758459653310955, 0.004109535320183699, 0.0411191420261022, 0.17688572466968722, 0.09397778553581561, 0.09253511367174892, 0.16509823047864874, 0.16015541760085303, 0.12764338959899424, 0.07060723729741646, 0.0371444626027699, 0.07664352849378195, -0.06888911564814013, -0.026888315329437994, -0.1008432122618491, -0.10765402302530946, -0.10465968995995505, -0.3438537754465048] %, RMSE: [0.4791472157969877, 0.5645386205410519, 0.6175447191313104, 0.6316631381029011, 0.6625590391659694, 0.7079032946179977, 0.7255435369705511, 0.7665254622038005, 0.7908141233140417, 0.8075920008948324, 0.8242686288838295, 0.8346429659648917, 0.8471151645979753, 0.8491053084677292, 0.8519412065568231, 0.8783846509321162, 0.8874363955126842, 0.888714167023402, 0.8968206335404743, 0.8939132277407167, 0.8812296330419302, 0.8626879575615334, 0.857964002067404, 0.86253630412397, 0.8540022227074888, 0.8538228577979248, 0.861615953674089, 0.8607857704137793, 0.847586264070385, 0.8354334061645473, 0.830162589684347, 0.8391034268296479]
epoch 98   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.21371797399193632 , validation loss: 0.6153236329555511
tensor(17.6881, device='cuda:0')
MAE: [0.26501737859301727, 0.34483278368321274, 0.3906429762176248, 0.4327506591202979, 0.44670789103244535, 0.47641551143604993, 0.4952362293066438, 0.5296360590481728, 0.5342998091926433, 0.554885637020481, 0.5668204497745664, 0.585919867407761, 0.590025108216004, 0.6007520558443112, 0.613290170088948, 0.6238834152931405, 0.6126098065867482, 0.6223127133933078, 0.6309783142390325, 0.6434306702768603, 0.6323112878930208, 0.6358369025257752, 0.6364831969561535, 0.6327177247451138, 0.6201335989420792, 0.6222108787300122, 0.6214869829827977, 0.6275874183807023, 0.6236088347515648, 0.623410930490102, 0.6318021666813527, 0.6348910353540145] , MAPE: [0.04889986252155816, 0.06196748196941737, 0.1965310061206758, 0.16379890025423519, 0.14459663336132797, 0.06053551981081891, 0.07301645206913686, 0.041971987433750385, 0.054402592510234604, 0.11333346106069547, 0.14126476532100157, 0.11414346535283275, 0.1082574157301868, 0.10091273582954507, 0.00547315369877417, -0.037139806343625376, 0.025757769828196615, 0.04987253441058877, 0.03136467620475967, -0.025801058519936464, 0.0817828953936822, 0.07762225410762692, 0.01939522586837287, -0.03779293770212818, -0.060209466795408235, -0.16413251983420984, -0.15348763423231335, -0.14000301988293293, -0.229785430211386, -0.037349070626549234, -0.12304056179821347, -0.2497724828555383] %, RMSE: [0.45698854422713503, 0.5478773375136984, 0.6047212556684559, 0.6492475399372869, 0.6686762387237336, 0.7069996542830173, 0.7321599469273867, 0.7818018001425286, 0.7734814487154781, 0.7884486165366709, 0.8001185932738697, 0.8205075814201093, 0.824472975815008, 0.8301326178748306, 0.8414862553812716, 0.8585532000656461, 0.8379026850541811, 0.8446194234357969, 0.8550492927806571, 0.871836089491873, 0.8557976347512889, 0.8530673619532267, 0.8508666915853897, 0.8480320810130254, 0.8331684576003205, 0.8292157447400267, 0.829817622504173, 0.838280830124269, 0.83549929338095, 0.8325222616924748, 0.8373557629650908, 0.8467897500156729]
epoch 99   lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6 , train loss: 0.21301871216764637 , validation loss: 0.64003836363554
tensor(17.5820, device='cuda:0')
MAE: [0.2820353198440304, 0.3562348392413276, 0.4008750960265392, 0.44665183269428377, 0.46584996682486124, 0.47779421260892463, 0.4897354619713865, 0.5148247451821976, 0.5595640078446223, 0.5728123241459432, 0.594125595226039, 0.6236308908831213, 0.6343090489950299, 0.6245615504710867, 0.6336989455054197, 0.6463226185500929, 0.6705585108764623, 0.6771997503967975, 0.6868913798199333, 0.6918484064552587, 0.6822064976670693, 0.6617481302731123, 0.6614166998623189, 0.6555972618324509, 0.6549286437126779, 0.656978748027312, 0.661944753464273, 0.6673725119941225, 0.6527926043096507, 0.6273396393779627, 0.6226140260309481, 0.6150446010175517] , MAPE: [0.09302379426119288, 0.09877884033966494, 0.24370924313231035, 0.22141488979740614, 0.17216186298587907, 0.13201804636631517, 0.09085130210389496, 0.11443171594971215, 0.09785398314580965, 0.19794499736322455, 0.21402206939358648, 0.22722757768566412, 0.16286367689906237, 0.17951918516274465, 0.09507226715512458, 0.04255108809207666, 0.02132023631792201, 0.12522589903602005, 0.131798191460776, 0.12470662135643898, 0.132258485534352, 0.09903062285935824, 0.09694848567940782, 0.04866411146782242, -0.006633213665012328, 0.013945214513682679, -0.041736730567396435, -0.11617714128516868, -0.2135196332753631, -0.1207594500259273, -0.12311380436462734, -0.33427058240083124] %, RMSE: [0.5004137299723954, 0.5706635373795609, 0.6244253057306307, 0.6699158110320736, 0.6847710911032027, 0.6964025007167682, 0.7085323827513402, 0.7410903462249252, 0.7854840263809063, 0.7937475519032468, 0.8136523582191769, 0.84553821935243, 0.8597738549518852, 0.8464168003940498, 0.850111215792992, 0.8660828942101835, 0.895225231225616, 0.8990109924170239, 0.9049946691761692, 0.91563279424127, 0.9068273131291146, 0.8746375346380336, 0.8678435922292965, 0.863306062231935, 0.8640240197532644, 0.862714072822544, 0.865246284362789, 0.8720802622666058, 0.8638761642078101, 0.83283156989249, 0.826104616726807, 0.8232574895742394]
test loss: NIL 
MAE: [0.2820353198440304, 0.3562348392413276, 0.4008750960265392, 0.44665183269428377, 0.46584996682486124, 0.47779421260892463, 0.4897354619713865, 0.5148247451821976, 0.5595640078446223, 0.5728123241459432, 0.594125595226039, 0.6236308908831213, 0.6343090489950299, 0.6245615504710867, 0.6336989455054197, 0.6463226185500929, 0.6705585108764623, 0.6771997503967975, 0.6868913798199333, 0.6918484064552587, 0.6822064976670693, 0.6617481302731123, 0.6614166998623189, 0.6555972618324509, 0.6549286437126779, 0.656978748027312, 0.661944753464273, 0.6673725119941225, 0.6527926043096507, 0.6273396393779627, 0.6226140260309481, 0.6150446010175517] , MAPE: [0.09302379426119288, 0.09877884033966494, 0.24370924313231035, 0.22141488979740614, 0.17216186298587907, 0.13201804636631517, 0.09085130210389496, 0.11443171594971215, 0.09785398314580965, 0.19794499736322455, 0.21402206939358648, 0.22722757768566412, 0.16286367689906237, 0.17951918516274465, 0.09507226715512458, 0.04255108809207666, 0.02132023631792201, 0.12522589903602005, 0.131798191460776, 0.12470662135643898, 0.132258485534352, 0.09903062285935824, 0.09694848567940782, 0.04866411146782242, -0.006633213665012328, 0.013945214513682679, -0.041736730567396435, -0.11617714128516868, -0.2135196332753631, -0.1207594500259273, -0.12311380436462734, -0.33427058240083124] %, RMSE: [0.5004137299723954, 0.5706635373795609, 0.6244253057306307, 0.6699158110320736, 0.6847710911032027, 0.6964025007167682, 0.7085323827513402, 0.7410903462249252, 0.7854840263809063, 0.7937475519032468, 0.8136523582191769, 0.84553821935243, 0.8597738549518852, 0.8464168003940498, 0.850111215792992, 0.8660828942101835, 0.895225231225616, 0.8990109924170239, 0.9049946691761692, 0.91563279424127, 0.9068273131291146, 0.8746375346380336, 0.8678435922292965, 0.863306062231935, 0.8640240197532644, 0.862714072822544, 0.865246284362789, 0.8720802622666058, 0.8638761642078101, 0.83283156989249, 0.826104616726807, 0.8232574895742394]
====================
training elapsedd with 311.84 seconds for 100 iterations, the sec/iter = 3.12

MAE_mean: [0.28203532 0.35623484 0.4008751  0.44665183 0.46584997 0.47779421
 0.48973546 0.51482475 0.55956401 0.57281232 0.5941256  0.62363089
 0.63430905 0.62456155 0.63369895 0.64632262 0.67055851 0.67719975
 0.68689138 0.69184841 0.6822065  0.66174813 0.6614167  0.65559726
 0.65492864 0.65697875 0.66194475 0.66737251 0.6527926  0.62733964
 0.62261403 0.6150446 ] , MAPE_mean: [ 0.09302379  0.09877884  0.24370924  0.22141489  0.17216186  0.13201805
  0.0908513   0.11443172  0.09785398  0.197945    0.21402207  0.22722758
  0.16286368  0.17951919  0.09507227  0.04255109  0.02132024  0.1252259
  0.13179819  0.12470662  0.13225849  0.09903062  0.09694849  0.04866411
 -0.00663321  0.01394521 -0.04173673 -0.11617714 -0.21351963 -0.12075945
 -0.1231138  -0.33427058] , RMSE_mean: [0.50041373 0.57066354 0.62442531 0.66991581 0.68477109 0.6964025
 0.70853238 0.74109035 0.78548403 0.79374755 0.81365236 0.84553822
 0.85977385 0.8464168  0.85011122 0.86608289 0.89522523 0.89901099
 0.90499467 0.91563279 0.90682731 0.87463753 0.86784359 0.86330606
 0.86402402 0.86271407 0.86524628 0.87208026 0.86387616 0.83283157
 0.82610462 0.82325749]

MAE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , MAPE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , RMSE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
Finished training with: lr1e-3_bs64_nh64_ra1e-3_dp0.3_wd1e-6_ah2_ck3_kt6
user config:
seed 666
device 0
scaler StandardScaler()
day_slot 288
n_route 10
n_his 96
n_pred 96
n_train 34
n_val 5
n_test 5
mode 1
n_c 10
model STAGNN_stamp
TPG TPGNN
name lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6
log_path log/TPGNN_r05p02kt3outer_347
crash 347
new_name TPGNN_r05p02kt3outer_347
batch_size 64
lr 0.001
a 0.1
r 0.5
n_mask 1
adam {'use': True, 'weight_decay': 0.0001}
slr {'use': True, 'step_size': 400, 'gamma': 0.3}
resume False
start_epoch 0
epochs 100
n_layer 1
n_attr 64
n_hid 256
reg_A 0.0001
circle 288
drop_prob 0.2
CE {'use': True, 'kernel_size': 1, 'bias': False}
LE {'use': False, 'bias': False}
SE {'use': True, 'separate': True, 'no': False}
TE {'use': True, 'no': True}
attn {'head': 1, 'd_k': 32, 'd_v': 32, 'drop_prob': 0.2}
STstamp {'use': True, 'kt': 3, 'temperature': 1.0}
T4N {'use': True, 'step': 2, 'end_epoch': 10000, 'change_head': True, 'change_enc': True}
stamp_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/time_stamp_F_96.npy
data_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/V_France_processed_0.csv
adj_matrix_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/W_France_processed_0.csv
dis_mat tensor([[0.0000, 0.3661, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.6136, 0.0000,
         0.0000],
        [0.3661, 0.0000, 0.0000, 0.0000, 0.1098, 0.0000, 0.0000, 0.8975, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.3410, 0.8975, 0.0000, 0.0000, 0.0000, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.3410, 0.0000, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000,
         0.1494],
        [0.0000, 0.1098, 0.8975, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000, 0.6996,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000,
         0.2289],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000, 0.0000,
         0.5594],
        [0.6136, 0.8975, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.2117,
         0.0000],
        [0.0000, 0.4288, 0.4288, 0.0000, 0.6996, 0.0000, 0.0000, 0.2117, 0.0000,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.1494, 0.0000, 0.2289, 0.5594, 0.0000, 0.0000,
         0.0000]], device='cuda:0')
prefix log/lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6/
checkpoint_temp_path log/lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6//temp.pth
checkpoint_best_path log/lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6//best.pth
tensorboard_path log/lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6/
record_path log/lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6/record.txt
eps 0.1
parse <bound method DefaultConfig.parse of <config.DefaultConfig object at 0x7f795f7d6550>>
output <bound method DefaultConfig.output of <config.DefaultConfig object at 0x7f795f7d6550>>
train: True, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 9792
len(data): 9792, day_slot: 288, n_day: 34
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
10 10
epoch 0   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.8721267779668173 , validation loss: 1.0821998193860054
epoch 1   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.5973819389062769 , validation loss: 0.9797218441963196
epoch 2   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.5339433819639916 , validation loss: 0.8955596163868904
epoch 3   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.4929463325762281 , validation loss: 0.9024268165230751
epoch 4   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.46318505908928664 , validation loss: 0.8580350056290627
epoch 5   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.4355401659713072 , validation loss: 0.8008718192577362
epoch 6   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.41000432827893424 , validation loss: 0.8136909082531929
epoch 7   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.38412456360517766 , validation loss: 0.7426235973834991
epoch 8   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.36078118109235574 , validation loss: 0.7002033591270447
epoch 9   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.34551961047976626 , validation loss: 0.6918081119656563
epoch 10   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.33248395428938027 , validation loss: 0.6995756477117538
epoch 11   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.3212060092710981 , validation loss: 0.6942819580435753
epoch 12   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.31215760579296187 , validation loss: 0.6909748464822769
epoch 13   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.3050810647945778 , validation loss: 0.7622837275266647
epoch 14   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.2987695727862564 , validation loss: 0.7488737553358078
epoch 15   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.2918068176391078 , validation loss: 0.6570703908801079
epoch 16   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.2859591935195175 , validation loss: 0.6647934466600418
epoch 17   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.2804584468112272 , validation loss: 0.6738928258419037
epoch 18   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.27936046672802345 , validation loss: 0.7590297609567642
epoch 19   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.2713224052214155 , validation loss: 0.7170295119285583
epoch 20   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.26923124112334906 , validation loss: 0.6860313266515732
epoch 21   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.2643835293311699 , validation loss: 0.6695669516921043
epoch 22   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.2611536970909904 , validation loss: 0.6638385951519012
epoch 23   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.259056694075173 , validation loss: 0.6622895896434784
epoch 24   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.2571670208491531 , validation loss: 0.7419986575841904
epoch 25   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.2554733309091306 , validation loss: 0.6568218097090721
epoch 26   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.253731224174593 , validation loss: 0.6876691654324532
epoch 27   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.24912668092578066 , validation loss: 0.666643314063549
epoch 28   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.25064243960614296 , validation loss: 0.6902165338397026
epoch 29   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.24520847639616797 , validation loss: 0.7289487794041634
epoch 30   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.24385439765219594 , validation loss: 0.6481650173664093
epoch 31   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.24363180498282114 , validation loss: 0.6567174717783928
epoch 32   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.2424929030970031 , validation loss: 0.6725880727171898
epoch 33   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.23923187629849302 , validation loss: 0.6350240185856819
epoch 34   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.23903472780012616 , validation loss: 0.8210438415408134
epoch 35   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.23928279561154983 , validation loss: 0.6802259311079979
epoch 36   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.23691405151404588 , validation loss: 0.6771800145506859
epoch 37   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.23551922978139392 , validation loss: 0.7327901273965836
epoch 38   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.23448535040313123 , validation loss: 0.6469259262084961
epoch 39   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.23551353666127897 , validation loss: 0.6567632555961609
epoch 40   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.23286619139652626 , validation loss: 0.6246216520667076
epoch 41   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.2330587436171139 , validation loss: 0.8045135587453842
epoch 42   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.23283184626523187 , validation loss: 0.8052754327654839
epoch 43   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.2318153097933414 , validation loss: 0.6656784191727638
epoch 44   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.22978940664553174 , validation loss: 0.7004807144403458
epoch 45   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.23147897539185544 , validation loss: 0.6577697247266769
epoch 46   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.2290462056795756 , validation loss: 0.7424142956733704
epoch 47   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.2291976669255425 , validation loss: 0.717849425971508
epoch 48   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.22878016823647068 , validation loss: 0.6731923893094063
epoch 49   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.2279331359793158 , validation loss: 0.6724579855799675
epoch 50   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.2256410817305247 , validation loss: 0.6555033326148987
epoch 51   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.22626996595485538 , validation loss: 0.7387257590889931
epoch 52   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.22642509434737412 , validation loss: 0.6703023239970207
epoch 53   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.2248194676403906 , validation loss: 0.6335977464914322
epoch 54   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.22404966634862564 , validation loss: 0.636176586151123
epoch 55   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.22346963631171807 , validation loss: 0.6504341959953308
epoch 56   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.22560094822855556 , validation loss: 0.6383742690086365
epoch 57   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.22247622644200044 , validation loss: 0.6689278483390808
epoch 58   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.22225257082312716 , validation loss: 0.6693771257996559
epoch 59   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.22226520642346026 , validation loss: 0.6386396735906601
epoch 60   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.2237012333729688 , validation loss: 0.6436319649219513
epoch 61   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.22248470111220492 , validation loss: 0.6304521262645721
epoch 62   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.22056379797411899 , validation loss: 0.6316522136330605
epoch 63   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.2198422445970423 , validation loss: 0.6183543652296066
epoch 64   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.21985074147289874 , validation loss: 0.64399004727602
epoch 65   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.22013640199221818 , validation loss: 0.6899153739213943
epoch 66   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.21969620240669624 , validation loss: 0.6549584865570068
epoch 67   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.21927205195613936 , validation loss: 0.6308802217245102
epoch 68   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.21886355093881196 , validation loss: 0.67097357660532
epoch 69   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.21922360272968516 , validation loss: 0.66972815990448
epoch 70   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.2181030529386857 , validation loss: 0.7765451520681381
epoch 71   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.21822145610463387 , validation loss: 0.7214804291725159
epoch 72   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.22068093687880272 , validation loss: 0.6472080126404762
epoch 73   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.2171066385858199 , validation loss: 0.6325711756944656
epoch 74   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.2165411377654356 , validation loss: 0.6732791662216187
epoch 75   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.21833792708668054 , validation loss: 0.6671783030033112
epoch 76   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.2162733335121005 , validation loss: 0.677261084318161
epoch 77   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.21576403373596714 , validation loss: 0.6421727389097214
epoch 78   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.21566719050500907 , validation loss: 0.699465811252594
epoch 79   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.21582473522307827 , validation loss: 0.6958053559064865
epoch 80   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.21717965865836425 , validation loss: 0.621586911380291
epoch 81   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.21411412603714886 , validation loss: 0.6418595910072327
epoch 82   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.21434605209266439 , validation loss: 0.6742491275072098
epoch 83   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.21591702775627958 , validation loss: 0.6774276122450829
epoch 84   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.21478884214279698 , validation loss: 0.6319726705551147
epoch 85   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.2136921821271672 , validation loss: 0.6119631677865982
epoch 86   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.21398800436188192 , validation loss: 0.6548480167984962
epoch 87   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.2135294287228117 , validation loss: 0.6297698467969894
epoch 88   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.2137802541255951 , validation loss: 0.636690579354763
epoch 89   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.21298901649082408 , validation loss: 0.6145778298377991
epoch 90   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.21282514637591793 , validation loss: 0.6417587772011757
epoch 91   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.2130195942579531 , validation loss: 0.6093451902270317
epoch 92   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.21231295285271665 , validation loss: 0.6798878684639931
epoch 93   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.21241257646504572 , validation loss: 0.6030580326914787
epoch 94   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.21218669706699894 , validation loss: 0.625665657222271
epoch 95   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.21122939095777624 , validation loss: 0.6892556920647621
epoch 96   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.21211862680958768 , validation loss: 0.6420672610402107
tensor(13.9605, device='cuda:0')
MAE: [0.28738943232232994, 0.34628444599491764, 0.3868637043513242, 0.41632497628365844, 0.44549017401239305, 0.4654092257102164, 0.49565517706105233, 0.5009903157421762, 0.522688756735861, 0.5386566494071146, 0.5465449648593389, 0.5540584473515447, 0.572972447417446, 0.5692908919109128, 0.5866280835609614, 0.5862643118333264, 0.5899920037619232, 0.5891998440244226, 0.5856444353468179, 0.5816461663819926, 0.5848898662428957, 0.5781112421483531, 0.5809155593945923, 0.5724916738534788, 0.5745876734523275, 0.5756307139286061, 0.5724078392515861, 0.5622110848051025, 0.5573858122858842, 0.5573689139505714, 0.5560664607903238, 0.5509851505288604] , MAPE: [0.12168487889700738, 0.13514036163469578, 0.21128436558732105, 0.20021996035064618, 0.2567227883298957, 0.1720325869522887, 0.1294389964401939, 0.16637134240208012, 0.11021748946363961, 0.1864394406183299, 0.2220733311919645, 0.15098483538620694, 0.24545410704332585, 0.2644968240125016, 0.1534477564833996, 0.13200217414389906, 0.13374616497401962, 0.13334850464670384, 0.167378112262774, 0.14529571172985614, 0.246751972556638, 0.20215015730418542, 0.18106397921646125, 0.11101105887793274, 0.05968128565805376, -0.012654869183455413, 0.03464250537990046, -0.1270277124469723, -0.1961565264852924, -0.1912796868714888, -0.022047111036996452, -0.3321295456313023] %, RMSE: [0.5123866782653207, 0.5841696461205406, 0.6346932565657933, 0.6605192006437197, 0.6828435558237185, 0.7052866446794529, 0.7473386781563103, 0.7523441307104777, 0.7723516107068129, 0.78065035669718, 0.7881214239196277, 0.7907971214637537, 0.8065774752079595, 0.8023788120270657, 0.8219683230123267, 0.819916443587362, 0.8246364157103068, 0.8151668291675742, 0.8087403359235628, 0.8052034872249956, 0.8041815623355364, 0.7937206399021602, 0.798465179173948, 0.7913734812969205, 0.7914520740374307, 0.788124099703781, 0.786069235248619, 0.7798385311241618, 0.7734671257915697, 0.7741515840472663, 0.7789344919854246, 0.7773598667394386]
epoch 97   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.2108197966042687 , validation loss: 0.6444534882903099
tensor(13.8042, device='cuda:0')
MAE: [0.29117933156256826, 0.37007635520871957, 0.42035166987885253, 0.4491417520233075, 0.4915803573349702, 0.5150312676353707, 0.529017943176873, 0.5453535203812356, 0.5767756474140993, 0.6019755253732473, 0.6142228974075508, 0.6240420553698829, 0.6430566658536644, 0.6513233506952211, 0.6522011787129431, 0.6604248457979986, 0.6666868712107853, 0.6730397960251754, 0.6807546704646545, 0.6901617465390987, 0.7000841454550931, 0.6961689705524555, 0.6844879290163901, 0.6881069338675012, 0.6862874594092676, 0.6876308318029744, 0.688099365902527, 0.6988539461276888, 0.7103257619403303, 0.7079334031506298, 0.6936233931482222, 0.7003931551438171] , MAPE: [0.12494915011846856, 0.10501064650836814, 0.1704823701165241, 0.11977986379413065, 0.14231818249015277, -9.291280110438052e-06, 0.06365374147510348, 0.014371213406243677, -0.0301729100603117, -0.00587434063203733, 0.048938626359757195, -0.05030334975137183, -0.05185026436064215, -0.03649706933410963, -0.05007777940328281, -0.08243446486698416, -0.09227586901338862, -0.12829268260014043, -0.08042492513925308, -0.1960097849977049, -0.18316822825501355, -0.17222857426803231, -0.08513580881951487, -0.1716176158869933, -0.1608669387710703, -0.21076770456605615, -0.12711158111835794, -0.24393692980030612, -0.3113998468312706, -0.25988394090051276, -0.20668498857726927, -0.1633552132928912] %, RMSE: [0.5109590923282629, 0.5990071655842892, 0.6495075818677356, 0.6774531203744086, 0.7140007830079358, 0.736637873948619, 0.7554603051616421, 0.7747784939425361, 0.8068582447888712, 0.8233870736285231, 0.8297495861941702, 0.8390001460813116, 0.8553056203438205, 0.8620308186644655, 0.8616979965382205, 0.8725119615132604, 0.8802232188030301, 0.8821188631312062, 0.8823732981466982, 0.8896620724784863, 0.8917653976873328, 0.8834092209584962, 0.8663698751808957, 0.8689909444014224, 0.8653095488799376, 0.8605518525700117, 0.8564955514138081, 0.8654367944503382, 0.8703511637691919, 0.8647529856631362, 0.8499626469242683, 0.8567550847708496]
epoch 98   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.21137340337622398 , validation loss: 0.6938820779323578
tensor(13.6578, device='cuda:0')
MAE: [0.2867999232558476, 0.35601404371952217, 0.4012505218118775, 0.451301986281424, 0.5001588931038361, 0.5051701934789259, 0.5180094899807471, 0.5408762433706331, 0.5589832254301411, 0.5797930660427154, 0.5927170034173453, 0.620316304002226, 0.6443916581352194, 0.6282241135067547, 0.6386538678453755, 0.6581654520285767, 0.6559823953262386, 0.6621326578917347, 0.6737585840072752, 0.6908211291717731, 0.6976828676643637, 0.6851259285955661, 0.68211501072881, 0.6874893071886498, 0.6843284953544972, 0.6890779820579997, 0.6989256170981554, 0.7153806248981237, 0.7263112028160122, 0.7148304509672999, 0.7015527848394338, 0.707562027569937] , MAPE: [0.07668793607408776, 0.07021432032500093, 0.2558174171845549, 0.22244531248006058, 0.2460036388811373, 0.1265987067396733, 0.15117634257802154, 0.16378089390487469, 0.06798372363812678, 0.1783352676370063, 0.25673996606592503, 0.2062119328156731, 0.2284758181022432, 0.2473599591536853, 0.16092118165439706, 0.1790789471223912, 0.14354861724442447, 0.15751329461600183, 0.18568892708441875, 0.2162712401234828, 0.2513938241375739, 0.1747126072451242, 0.20634873737385448, 0.18520233265814653, 0.1542235454650939, 0.04769345192502123, 0.11293073115339286, -0.022035936405390175, -0.13545816718792866, -0.062464394115962295, -0.015904025319731837, -0.192348879496858] %, RMSE: [0.5166074981438434, 0.6016129420958242, 0.6582945534394706, 0.719804909480265, 0.7745899380251812, 0.7852417219221688, 0.8101127719480004, 0.8417643564510523, 0.861931828470616, 0.8813091168929866, 0.8975087152773458, 0.9301990822417843, 0.9593066649244653, 0.9481352380621794, 0.95872668459769, 0.9818098429709322, 0.9811029589282451, 0.9853773299874227, 0.995995753472656, 1.0184175372242055, 1.0247327761763119, 1.013649995488821, 1.0131620560934294, 1.019298871451149, 1.014125178112883, 1.0184939906787802, 1.029828744896052, 1.0521332648807191, 1.0629492748394147, 1.0555924141738953, 1.047709343596851, 1.0654667149820727]
epoch 99   lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6 , train loss: 0.21021450150246715 , validation loss: 0.639884889125824
tensor(13.5023, device='cuda:0')
MAE: [0.2815332781127894, 0.3410419122416756, 0.3760383502544701, 0.4084709396098078, 0.4417816437985364, 0.46179816159582937, 0.4792882606081818, 0.49506706697904723, 0.5167917527563717, 0.5256005519380812, 0.5366662617538547, 0.5451739581342133, 0.5547134011920503, 0.5663991825522605, 0.5758660312085269, 0.5797330399034257, 0.5857421767533056, 0.586312492369991, 0.5901555314383556, 0.5879412275433694, 0.5820510147894089, 0.5858093819079786, 0.5943484059289175, 0.5945170220483056, 0.5955119842782463, 0.5910575516649628, 0.5965133479825154, 0.5889327744749787, 0.5758535805987867, 0.575129219845667, 0.5773548295923038, 0.5713033445365727] , MAPE: [0.13551193048725613, 0.0870592156428824, 0.21734610656829167, 0.2148480688023584, 0.2578140258195391, 0.13315425125257196, 0.13197543391329597, 0.1811856006246169, 0.10889543756836875, 0.1749381081632743, 0.20552449100630443, 0.18039314523898545, 0.23110580477623557, 0.2630571386459933, 0.18630619774755575, 0.15067883434534413, 0.13737355249887692, 0.15406449220074736, 0.18456824843156075, 0.20867745906841123, 0.27152483125728677, 0.21691121879192315, 0.2155670181728682, 0.11471268692896816, 0.11134673871508227, 0.03956664189145964, 0.075268825904488, -0.077626195505019, -0.17328652374212775, -0.09420184683665565, -0.06398440438564254, -0.24141307874815537] %, RMSE: [0.5067262788473277, 0.5794453013107306, 0.626907379410444, 0.662450728485237, 0.6955012224548917, 0.7181650683931629, 0.7413941506875592, 0.7579494841797193, 0.7854232996677182, 0.7872700026744311, 0.7995398253540251, 0.8033291697545275, 0.8164710347736379, 0.8315658909059909, 0.8347444073857844, 0.8372345856972573, 0.8507306132795167, 0.8488648861828352, 0.848409786103147, 0.8461961450411811, 0.8360420858906673, 0.8349131814947008, 0.8410704661983783, 0.8412696520605848, 0.8419075471212224, 0.8318805562955995, 0.8397840313234773, 0.8322275830743254, 0.8186541012828166, 0.8163365183748543, 0.8194918959953429, 0.8142566513490478]
test loss: NIL 
MAE: [0.2815332781127894, 0.3410419122416756, 0.3760383502544701, 0.4084709396098078, 0.4417816437985364, 0.46179816159582937, 0.4792882606081818, 0.49506706697904723, 0.5167917527563717, 0.5256005519380812, 0.5366662617538547, 0.5451739581342133, 0.5547134011920503, 0.5663991825522605, 0.5758660312085269, 0.5797330399034257, 0.5857421767533056, 0.586312492369991, 0.5901555314383556, 0.5879412275433694, 0.5820510147894089, 0.5858093819079786, 0.5943484059289175, 0.5945170220483056, 0.5955119842782463, 0.5910575516649628, 0.5965133479825154, 0.5889327744749787, 0.5758535805987867, 0.575129219845667, 0.5773548295923038, 0.5713033445365727] , MAPE: [0.13551193048725613, 0.0870592156428824, 0.21734610656829167, 0.2148480688023584, 0.2578140258195391, 0.13315425125257196, 0.13197543391329597, 0.1811856006246169, 0.10889543756836875, 0.1749381081632743, 0.20552449100630443, 0.18039314523898545, 0.23110580477623557, 0.2630571386459933, 0.18630619774755575, 0.15067883434534413, 0.13737355249887692, 0.15406449220074736, 0.18456824843156075, 0.20867745906841123, 0.27152483125728677, 0.21691121879192315, 0.2155670181728682, 0.11471268692896816, 0.11134673871508227, 0.03956664189145964, 0.075268825904488, -0.077626195505019, -0.17328652374212775, -0.09420184683665565, -0.06398440438564254, -0.24141307874815537] %, RMSE: [0.5067262788473277, 0.5794453013107306, 0.626907379410444, 0.662450728485237, 0.6955012224548917, 0.7181650683931629, 0.7413941506875592, 0.7579494841797193, 0.7854232996677182, 0.7872700026744311, 0.7995398253540251, 0.8033291697545275, 0.8164710347736379, 0.8315658909059909, 0.8347444073857844, 0.8372345856972573, 0.8507306132795167, 0.8488648861828352, 0.848409786103147, 0.8461961450411811, 0.8360420858906673, 0.8349131814947008, 0.8410704661983783, 0.8412696520605848, 0.8419075471212224, 0.8318805562955995, 0.8397840313234773, 0.8322275830743254, 0.8186541012828166, 0.8163365183748543, 0.8194918959953429, 0.8142566513490478]
====================
training elapsedd with 350.66 seconds for 100 iterations, the sec/iter = 3.51

MAE_mean: [0.28153328 0.34104191 0.37603835 0.40847094 0.44178164 0.46179816
 0.47928826 0.49506707 0.51679175 0.52560055 0.53666626 0.54517396
 0.5547134  0.56639918 0.57586603 0.57973304 0.58574218 0.58631249
 0.59015553 0.58794123 0.58205101 0.58580938 0.59434841 0.59451702
 0.59551198 0.59105755 0.59651335 0.58893277 0.57585358 0.57512922
 0.57735483 0.57130334] , MAPE_mean: [ 0.13551193  0.08705922  0.21734611  0.21484807  0.25781403  0.13315425
  0.13197543  0.1811856   0.10889544  0.17493811  0.20552449  0.18039315
  0.2311058   0.26305714  0.1863062   0.15067883  0.13737355  0.15406449
  0.18456825  0.20867746  0.27152483  0.21691122  0.21556702  0.11471269
  0.11134674  0.03956664  0.07526883 -0.0776262  -0.17328652 -0.09420185
 -0.0639844  -0.24141308] , RMSE_mean: [0.50672628 0.5794453  0.62690738 0.66245073 0.69550122 0.71816507
 0.74139415 0.75794948 0.7854233  0.78727    0.79953983 0.80332917
 0.81647103 0.83156589 0.83474441 0.83723459 0.85073061 0.84886489
 0.84840979 0.84619615 0.83604209 0.83491318 0.84107047 0.84126965
 0.84190755 0.83188056 0.83978403 0.83222758 0.8186541  0.81633652
 0.8194919  0.81425665]

MAE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , MAPE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , RMSE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
Finished training with: lr1e-3_bs64_nh256_ra1e-4_dp0.2_wd1e-5_ah4_ck5_kt6
user config:
seed 666
device 0
scaler StandardScaler()
day_slot 288
n_route 10
n_his 96
n_pred 96
n_train 34
n_val 5
n_test 5
mode 1
n_c 10
model STAGNN_stamp
TPG TPGNN
name lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6
log_path log/TPGNN_r05p02kt3outer_348
crash 348
new_name TPGNN_r05p02kt3outer_348
batch_size 64
lr 0.0001
a 0.1
r 0.5
n_mask 1
adam {'use': True, 'weight_decay': 0.0001}
slr {'use': True, 'step_size': 400, 'gamma': 0.3}
resume False
start_epoch 0
epochs 100
n_layer 1
n_attr 64
n_hid 128
reg_A 0.0001
circle 288
drop_prob 0.1
CE {'use': True, 'kernel_size': 1, 'bias': False}
LE {'use': False, 'bias': False}
SE {'use': True, 'separate': True, 'no': False}
TE {'use': True, 'no': True}
attn {'head': 1, 'd_k': 32, 'd_v': 32, 'drop_prob': 0.2}
STstamp {'use': True, 'kt': 3, 'temperature': 1.0}
T4N {'use': True, 'step': 2, 'end_epoch': 10000, 'change_head': True, 'change_enc': True}
stamp_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/time_stamp_F_96.npy
data_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/V_France_processed_0.csv
adj_matrix_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/W_France_processed_0.csv
dis_mat tensor([[0.0000, 0.3661, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.6136, 0.0000,
         0.0000],
        [0.3661, 0.0000, 0.0000, 0.0000, 0.1098, 0.0000, 0.0000, 0.8975, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.3410, 0.8975, 0.0000, 0.0000, 0.0000, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.3410, 0.0000, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000,
         0.1494],
        [0.0000, 0.1098, 0.8975, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000, 0.6996,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000,
         0.2289],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000, 0.0000,
         0.5594],
        [0.6136, 0.8975, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.2117,
         0.0000],
        [0.0000, 0.4288, 0.4288, 0.0000, 0.6996, 0.0000, 0.0000, 0.2117, 0.0000,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.1494, 0.0000, 0.2289, 0.5594, 0.0000, 0.0000,
         0.0000]], device='cuda:0')
prefix log/lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6/
checkpoint_temp_path log/lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6//temp.pth
checkpoint_best_path log/lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6//best.pth
tensorboard_path log/lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6/
record_path log/lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6/record.txt
eps 0.1
parse <bound method DefaultConfig.parse of <config.DefaultConfig object at 0x7fa6cbfd6550>>
output <bound method DefaultConfig.output of <config.DefaultConfig object at 0x7fa6cbfd6550>>
train: True, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 9792
len(data): 9792, day_slot: 288, n_day: 34
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
10 10
epoch 0   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 1.6282481445985681 , validation loss: 0.9920074194669724
epoch 1   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 1.072145168687783 , validation loss: 1.0104330033063889
epoch 2   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.8443538978988049 , validation loss: 1.0513394325971603
epoch 3   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.7538869883499894 , validation loss: 1.0663998574018478
epoch 4   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.7069978129629996 , validation loss: 1.0353278368711472
epoch 5   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.6709455754242691 , validation loss: 1.0002566128969193
epoch 6   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.6500487327575684 , validation loss: 0.9780183583498001
epoch 7   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.6333366889579624 , validation loss: 0.963966928422451
epoch 8   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.6196860717792138 , validation loss: 0.9524424895644188
epoch 9   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.6079312516193763 , validation loss: 0.9405072256922722
epoch 10   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.5971335067468531 , validation loss: 0.9277216345071793
epoch 11   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.5873988294133953 , validation loss: 0.9144162461161613
epoch 12   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.5783646352150861 , validation loss: 0.9155686944723129
epoch 13   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.569900742932862 , validation loss: 0.8997366428375244
epoch 14   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.5617882083444035 , validation loss: 0.9114410281181335
epoch 15   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.5540459635210973 , validation loss: 0.8880382776260376
epoch 16   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.5465737651376164 , validation loss: 0.879273384809494
epoch 17   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.5394025222927916 , validation loss: 0.8602266386151314
epoch 18   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.5327371978292278 , validation loss: 0.8909076303243637
epoch 19   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.5257884415925718 , validation loss: 0.8406685143709183
epoch 20   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.5193146145811268 , validation loss: 0.8333897590637207
epoch 21   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.5129528057341483 , validation loss: 0.8321100175380707
epoch 22   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.506337453921636 , validation loss: 0.8093801662325859
epoch 23   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.5000110952293172 , validation loss: 0.8070613369345665
epoch 24   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.4934075223464592 , validation loss: 0.7751424834132195
epoch 25   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.4868513053538753 , validation loss: 0.7688283324241638
epoch 26   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.48032055941282537 , validation loss: 0.7569680437445641
epoch 27   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.47432806211359363 , validation loss: 0.7579867318272591
epoch 28   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.46830400532367183 , validation loss: 0.72536351531744
epoch 29   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.4626559334642747 , validation loss: 0.7342119589447975
epoch 30   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.45711802092252996 , validation loss: 0.744073361158371
epoch 31   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.45202617493330266 , validation loss: 0.7056879699230194
epoch 32   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.4473993439300388 , validation loss: 0.7043626010417938
epoch 33   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.44276758969998825 , validation loss: 0.7005929201841354
epoch 34   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.4383488852603763 , validation loss: 0.6999032646417618
epoch 35   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.43440500427694884 , validation loss: 0.7079741805791855
epoch 36   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.43032675981521606 , validation loss: 0.6944223865866661
epoch 37   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.4265892038158342 , validation loss: 0.6921014189720154
epoch 38   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.42305660832161995 , validation loss: 0.6863299906253815
epoch 39   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.4197784259038813 , validation loss: 0.6900576055049896
epoch 40   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.4164580918994604 , validation loss: 0.7026957869529724
epoch 41   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.4132580809733447 , validation loss: 0.6849795803427696
epoch 42   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.40997736594256234 , validation loss: 0.6813326552510262
epoch 43   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.4070369525282991 , validation loss: 0.6773841977119446
epoch 44   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.40435028251479654 , validation loss: 0.6901358067989349
epoch 45   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.40138574791889564 , validation loss: 0.6795812398195267
epoch 46   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.39856193696751313 , validation loss: 0.6774220615625381
epoch 47   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.395955340535033 , validation loss: 0.6753653362393379
epoch 48   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.3932934987778757 , validation loss: 0.6701465249061584
epoch 49   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.39076659258674173 , validation loss: 0.6701810210943222
epoch 50   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.3881468860542073 , validation loss: 0.6725930720567703
epoch 51   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.38561881523506314 , validation loss: 0.6698314175009727
epoch 52   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.3832540377682331 , validation loss: 0.6767991632223129
epoch 53   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.3808072793717478 , validation loss: 0.6702000796794891
epoch 54   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.3785860059308071 , validation loss: 0.6742762103676796
epoch 55   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.3761804314220653 , validation loss: 0.6695909723639488
epoch 56   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.373926428603191 , validation loss: 0.6669768244028091
epoch 57   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.37199530005455017 , validation loss: 0.6664826199412346
epoch 58   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.3697699477859572 , validation loss: 0.6714496314525604
epoch 59   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.367549563739814 , validation loss: 0.6673861816525459
epoch 60   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.3655291322399588 , validation loss: 0.6730838641524315
epoch 61   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.3634489020880531 , validation loss: 0.672133706510067
epoch 62   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.36168672641118366 , validation loss: 0.6696644797921181
epoch 63   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.3597208986095354 , validation loss: 0.6735972762107849
epoch 64   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.3575419836184558 , validation loss: 0.6653175130486488
epoch 65   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.35583065888460946 , validation loss: 0.6586602553725243
epoch 66   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.35392358256321327 , validation loss: 0.6617052778601646
epoch 67   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.35205591075560627 , validation loss: 0.6623005419969559
epoch 68   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.3502962373050989 , validation loss: 0.655991442501545
epoch 69   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.3482710023721059 , validation loss: 0.6568266972899437
epoch 70   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.346688636377746 , validation loss: 0.6703226268291473
epoch 71   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.3449515308819565 , validation loss: 0.660770446062088
epoch 72   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.34326135469417945 , validation loss: 0.6566266864538193
epoch 73   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.3415309044660306 , validation loss: 0.6589209213852882
epoch 74   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.339911305436901 , validation loss: 0.6495860442519188
epoch 75   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.3381510026314679 , validation loss: 0.6479451805353165
epoch 76   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.3366783296360689 , validation loss: 0.6534320712089539
epoch 77   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.3352592669281305 , validation loss: 0.6543574407696724
epoch 78   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.3336099310248506 , validation loss: 0.6574305146932602
epoch 79   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.3318808113827425 , validation loss: 0.651020847260952
epoch 80   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.3304308027613397 , validation loss: 0.6452438831329346
epoch 81   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.3289447683914035 , validation loss: 0.6440577432513237
epoch 82   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.32745619147431615 , validation loss: 0.6568574234843254
epoch 83   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.3262144052514843 , validation loss: 0.6550948470830917
epoch 84   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.32452325961169076 , validation loss: 0.6532931849360466
epoch 85   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.32347039556970786 , validation loss: 0.6493906453251839
epoch 86   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.3216969446808684 , validation loss: 0.6438036486506462
epoch 87   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.32032937220498625 , validation loss: 0.643759585916996
epoch 88   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.3190237570042704 , validation loss: 0.6455753147602081
epoch 89   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.3175581985828923 , validation loss: 0.6382562220096588
epoch 90   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.3162541056380552 , validation loss: 0.6373487338423729
epoch 91   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.3148254197017819 , validation loss: 0.6450278908014297
epoch 92   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.3135533274388781 , validation loss: 0.6392636075615883
epoch 93   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.3123774440849529 , validation loss: 0.6471325233578682
epoch 94   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.31106754962135763 , validation loss: 0.6428264379501343
epoch 95   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.309652377577389 , validation loss: 0.6391216889023781
epoch 96   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.30855448397935603 , validation loss: 0.6404258832335472
tensor(58.3060, device='cuda:0')
MAE: [0.30531720020616254, 0.39107689689739233, 0.42561801126092363, 0.45907844403974674, 0.4976008028429501, 0.5219296035249286, 0.5198846862499708, 0.5264135203387627, 0.5444170226150951, 0.5731472149996336, 0.5760400142595556, 0.5857454696509834, 0.6041318929832928, 0.6158927184293411, 0.6131596677327893, 0.6261852566024154, 0.6318524787198637, 0.6385420215809622, 0.6309124742836221, 0.6188010835818486, 0.6278346440123068, 0.6342448115894168, 0.6240409475852995, 0.6172122895097379, 0.6049856618284872, 0.6108362085702493, 0.5982534616521186, 0.5887958927177969, 0.5967262667847663, 0.5986604176154456, 0.5810989199911926, 0.5685345394075992] , MAPE: [0.10437373546232154, 0.08029656674202829, 0.13988351891043516, 0.13387540770281758, 0.15147033998440185, 0.08686729884122758, 0.04714292098702047, 0.04167992605942514, 0.019976816530954202, 0.0926105604593718, 0.0815952140850036, 0.04371710302540732, 0.05385514242084908, 0.0929674435586287, 0.04826495329962087, -0.010687625902493668, -0.016075919690720746, 0.02938692079857892, 0.0013195589773378517, 0.007128408877683093, 0.07505079085216737, 0.029241178861780803, 0.009927299716359859, -0.022784347789075236, -0.009754161420435772, -0.009873250816869501, -0.0505831801793124, -0.09986801797796531, -0.10722107499142984, -0.09388854244949996, -0.08540874193044447, -0.20704832913880308] %, RMSE: [0.5767192713004212, 0.6618003929418915, 0.6916798111523818, 0.7275800727186708, 0.7871853076722012, 0.8074865899901518, 0.7944363410426525, 0.7986857181351451, 0.809553887357815, 0.8265633672111026, 0.8151210553992868, 0.8281299522290448, 0.8549627736139808, 0.865413711983885, 0.8551817180082748, 0.8809614153836393, 0.8830478627441065, 0.87659721991421, 0.8482446946747152, 0.8327607085666232, 0.8438412767033814, 0.849653266433531, 0.8354016360047417, 0.8302205315008742, 0.8144580137672879, 0.8172762832833086, 0.7963840845193803, 0.7858767452293873, 0.7982458247926166, 0.8099356174441098, 0.7826910198489314, 0.7768195670813953]
epoch 97   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.30738680386075784 , validation loss: 0.6388195604085922
tensor(58.1152, device='cuda:0')
MAE: [0.28371271223549915, 0.3769517331660639, 0.42406305426059615, 0.4471704454458866, 0.4891572314222372, 0.4906801205143793, 0.49767900961691264, 0.5091510650893846, 0.5247873671514165, 0.5563309368329872, 0.5756830671757998, 0.5771495829104955, 0.5928293776303799, 0.5819813532197906, 0.5836937904569138, 0.579050345182726, 0.5886904817182071, 0.6040589519853214, 0.6148482005282776, 0.6048722173988857, 0.609569270061041, 0.6125177825530319, 0.6008461589514057, 0.5855294804814627, 0.5762811329188882, 0.5891510249022874, 0.5913220300604157, 0.5829574599892823, 0.5868359035954417, 0.5783247264766509, 0.5578684955013474, 0.5391994395068626] , MAPE: [0.10153884079185502, 0.06070992383092458, 0.16239404993945164, 0.15720492983953854, 0.1631167061565043, 0.09897317831795459, 0.07603998493458619, 0.07734062154113286, 0.03253618061900758, 0.09797614436310094, 0.11708336340489416, 0.07046046450022145, 0.08019867426543381, 0.10869986405288447, 0.0740949331240627, 0.020272934253133423, -0.0024907364852089775, 0.044612993078675965, 0.037899034870572425, 0.05514278427532696, 0.13759039910756815, 0.08931415877578608, 0.05186000094131552, 0.02771430947659141, 0.0337964252049473, 0.010355536074040952, -0.0252419096888127, -0.06937076010005297, -0.10860080919842112, -0.07724490804768158, -0.050112135471109355, -0.26143624283882033] %, RMSE: [0.5422923397126066, 0.6494426906297837, 0.7033387097647475, 0.719854075647211, 0.7834972792885829, 0.7666934537011317, 0.7751093019406023, 0.7875295217082164, 0.7935257930257902, 0.8168585472972436, 0.8379887186943596, 0.8360963679457567, 0.8546097009133042, 0.8296319798081353, 0.8314123088511743, 0.8277174921305419, 0.8379223715344705, 0.8443562448317171, 0.8477584952558516, 0.8356533394645294, 0.8352260311235596, 0.835328407982948, 0.8217687649654939, 0.8061327623756024, 0.7902432591443534, 0.8035573993813997, 0.8110431782591627, 0.8050827448760098, 0.8091010148872612, 0.8006511733665075, 0.7769375996227137, 0.7655992131943006]
epoch 98   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.3061203249529296 , validation loss: 0.6399653032422066
tensor(57.9239, device='cuda:0')
MAE: [0.2949631905544204, 0.3850992127257332, 0.43448922065864365, 0.47346462458640953, 0.5001254412124279, 0.5090373925837813, 0.5114660555736843, 0.533876978510165, 0.5498174379315688, 0.5622284151947836, 0.5722426120464008, 0.589461255511845, 0.5967369082481745, 0.5905767146868574, 0.5895174059118192, 0.6138955128507823, 0.6154403514868205, 0.6226200250854965, 0.6226696423222263, 0.6197854738334942, 0.6146249138413131, 0.611459941259134, 0.5966967149886312, 0.593689320894323, 0.5856362450260131, 0.5883856556138274, 0.5823923039547715, 0.5746681417618907, 0.5652955247887131, 0.5598003013958175, 0.544232938355507, 0.5402048751097365] , MAPE: [0.08827778017968758, 0.08502175561974581, 0.1789718673317398, 0.14539969585624557, 0.15975229019700865, 0.09645503425286284, 0.07637556050290739, 0.09541789208575135, 0.06729356021539097, 0.10608571222495887, 0.12870184377529703, 0.09659176441374416, 0.09687975697913064, 0.129230028365099, 0.10408144746658023, 0.05770793062210707, 0.017691233824543535, 0.06547288044600905, 0.05776875554221519, 0.05808654346775153, 0.12978742087472317, 0.08498763504612275, 0.04832873163486323, 0.035285973550293344, 0.029191480310616975, 0.02532312169642555, -0.019555053087251414, -0.07796669067261074, -0.09423147331591103, -0.06976464116143558, -0.06118626094775481, -0.19783810670887536] %, RMSE: [0.5610318120196985, 0.6602726377273341, 0.7131086620475223, 0.7552979894187749, 0.7938328009792175, 0.7903964882700107, 0.7874944155561763, 0.8198262320983907, 0.8285726728229494, 0.8199163751036425, 0.8236257421203697, 0.8499199211399989, 0.8573304339132993, 0.8402105164336987, 0.8365713463761456, 0.8808350684359222, 0.875263511666479, 0.868223133195746, 0.8543176089002451, 0.852397832468709, 0.8392215838202199, 0.8297432770710499, 0.8120086301822966, 0.8197346716028959, 0.8061601068198443, 0.8030643736107762, 0.7976250356379166, 0.793047038722713, 0.7779325139823743, 0.777276684818674, 0.7600887514752721, 0.7682655227262424]
epoch 99   lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6 , train loss: 0.3047895145182516 , validation loss: 0.6373220831155777
tensor(57.7358, device='cuda:0')
MAE: [0.3003188351422702, 0.37801957063012054, 0.42517204947107157, 0.46688089832279484, 0.5021869433373597, 0.5220936762549213, 0.5267415785226136, 0.5384689195821849, 0.5587766606504693, 0.5797598873924694, 0.5870349909097302, 0.5957123540107583, 0.6048479596967089, 0.6166096438337886, 0.6126100164920706, 0.6261140455574412, 0.6201158439707894, 0.6277004545765746, 0.6294846016429749, 0.6296642596356226, 0.6329054214496204, 0.6373789675234212, 0.6352824512210473, 0.6305494241393411, 0.6119193236206264, 0.6169772445531466, 0.6045007009293462, 0.5930403109267354, 0.589717686647146, 0.5925241311873818, 0.5880115431921614, 0.5788146939992751] , MAPE: [0.10867311237915901, 0.08018385809804666, 0.14169169629176995, 0.14012816198894482, 0.15857880423548176, 0.10112346217290681, 0.05749724872357791, 0.04655815665216783, 0.030125578886267643, 0.09355061201427872, 0.08911140438470555, 0.04433815621118632, 0.04573548360813839, 0.07035228428564148, 0.03659038510519505, -0.014079101109521982, -0.01115239852865661, 0.022501447439030504, 0.008400861318193174, 0.020843241446706726, 0.06895656121847311, 0.037055353760054824, 0.0062516372964343, -0.01879633471730391, 0.0009791679706450877, -0.0032018024048146303, -0.03170306784135035, -0.09278422619925437, -0.09583787498255164, -0.08939507563143895, -0.07243236595747954, -0.21186550368208645] %, RMSE: [0.5709227343574906, 0.6432127665437708, 0.6917179277864683, 0.7398593887533836, 0.7946176431496486, 0.8012215767225476, 0.7978048176478246, 0.8124398190827019, 0.8298943862795491, 0.8340137711255236, 0.8278529644766943, 0.8381977220105218, 0.8482926677309387, 0.8582025028342498, 0.8439368346850691, 0.8719132317799653, 0.8631878767945996, 0.8585825973846443, 0.8457627066306288, 0.8478405292327147, 0.8479330260699485, 0.8493983736170202, 0.8433938364608563, 0.8433978207636882, 0.8198202627084765, 0.8216162459006564, 0.8049132757132419, 0.7915565813062622, 0.7854105898061006, 0.7950564913936651, 0.7843548485794147, 0.7855092843319619]
test loss: NIL 
MAE: [0.3003188351422702, 0.37801957063012054, 0.42517204947107157, 0.46688089832279484, 0.5021869433373597, 0.5220936762549213, 0.5267415785226136, 0.5384689195821849, 0.5587766606504693, 0.5797598873924694, 0.5870349909097302, 0.5957123540107583, 0.6048479596967089, 0.6166096438337886, 0.6126100164920706, 0.6261140455574412, 0.6201158439707894, 0.6277004545765746, 0.6294846016429749, 0.6296642596356226, 0.6329054214496204, 0.6373789675234212, 0.6352824512210473, 0.6305494241393411, 0.6119193236206264, 0.6169772445531466, 0.6045007009293462, 0.5930403109267354, 0.589717686647146, 0.5925241311873818, 0.5880115431921614, 0.5788146939992751] , MAPE: [0.10867311237915901, 0.08018385809804666, 0.14169169629176995, 0.14012816198894482, 0.15857880423548176, 0.10112346217290681, 0.05749724872357791, 0.04655815665216783, 0.030125578886267643, 0.09355061201427872, 0.08911140438470555, 0.04433815621118632, 0.04573548360813839, 0.07035228428564148, 0.03659038510519505, -0.014079101109521982, -0.01115239852865661, 0.022501447439030504, 0.008400861318193174, 0.020843241446706726, 0.06895656121847311, 0.037055353760054824, 0.0062516372964343, -0.01879633471730391, 0.0009791679706450877, -0.0032018024048146303, -0.03170306784135035, -0.09278422619925437, -0.09583787498255164, -0.08939507563143895, -0.07243236595747954, -0.21186550368208645] %, RMSE: [0.5709227343574906, 0.6432127665437708, 0.6917179277864683, 0.7398593887533836, 0.7946176431496486, 0.8012215767225476, 0.7978048176478246, 0.8124398190827019, 0.8298943862795491, 0.8340137711255236, 0.8278529644766943, 0.8381977220105218, 0.8482926677309387, 0.8582025028342498, 0.8439368346850691, 0.8719132317799653, 0.8631878767945996, 0.8585825973846443, 0.8457627066306288, 0.8478405292327147, 0.8479330260699485, 0.8493983736170202, 0.8433938364608563, 0.8433978207636882, 0.8198202627084765, 0.8216162459006564, 0.8049132757132419, 0.7915565813062622, 0.7854105898061006, 0.7950564913936651, 0.7843548485794147, 0.7855092843319619]
====================
training elapsedd with 319.82 seconds for 100 iterations, the sec/iter = 3.20

MAE_mean: [0.30031884 0.37801957 0.42517205 0.4668809  0.50218694 0.52209368
 0.52674158 0.53846892 0.55877666 0.57975989 0.58703499 0.59571235
 0.60484796 0.61660964 0.61261002 0.62611405 0.62011584 0.62770045
 0.6294846  0.62966426 0.63290542 0.63737897 0.63528245 0.63054942
 0.61191932 0.61697724 0.6045007  0.59304031 0.58971769 0.59252413
 0.58801154 0.57881469] , MAPE_mean: [ 0.10867311  0.08018386  0.1416917   0.14012816  0.1585788   0.10112346
  0.05749725  0.04655816  0.03012558  0.09355061  0.0891114   0.04433816
  0.04573548  0.07035228  0.03659039 -0.0140791  -0.0111524   0.02250145
  0.00840086  0.02084324  0.06895656  0.03705535  0.00625164 -0.01879633
  0.00097917 -0.0032018  -0.03170307 -0.09278423 -0.09583787 -0.08939508
 -0.07243237 -0.2118655 ] , RMSE_mean: [0.57092273 0.64321277 0.69171793 0.73985939 0.79461764 0.80122158
 0.79780482 0.81243982 0.82989439 0.83401377 0.82785296 0.83819772
 0.84829267 0.8582025  0.84393683 0.87191323 0.86318788 0.8585826
 0.84576271 0.84784053 0.84793303 0.84939837 0.84339384 0.84339782
 0.81982026 0.82161625 0.80491328 0.79155658 0.78541059 0.79505649
 0.78435485 0.78550928]

MAE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , MAPE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , RMSE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
Finished training with: lr1e-4_bs64_nh128_ra1e-4_dp0.1_wd1e-5_ah1_ck3_kt6
user config:
seed 666
device 0
scaler StandardScaler()
day_slot 288
n_route 10
n_his 96
n_pred 96
n_train 34
n_val 5
n_test 5
mode 1
n_c 10
model STAGNN_stamp
TPG TPGNN
name lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4
log_path log/TPGNN_r05p02kt3outer_349
crash 349
new_name TPGNN_r05p02kt3outer_349
batch_size 64
lr 0.001
a 0.1
r 0.5
n_mask 1
adam {'use': True, 'weight_decay': 0.0001}
slr {'use': True, 'step_size': 400, 'gamma': 0.3}
resume False
start_epoch 0
epochs 100
n_layer 1
n_attr 64
n_hid 256
reg_A 1e-05
circle 288
drop_prob 0.3
CE {'use': True, 'kernel_size': 1, 'bias': False}
LE {'use': False, 'bias': False}
SE {'use': True, 'separate': True, 'no': False}
TE {'use': True, 'no': True}
attn {'head': 1, 'd_k': 32, 'd_v': 32, 'drop_prob': 0.2}
STstamp {'use': True, 'kt': 3, 'temperature': 1.0}
T4N {'use': True, 'step': 2, 'end_epoch': 10000, 'change_head': True, 'change_enc': True}
stamp_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/time_stamp_F_96.npy
data_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/V_France_processed_0.csv
adj_matrix_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/W_France_processed_0.csv
dis_mat tensor([[0.0000, 0.3661, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.6136, 0.0000,
         0.0000],
        [0.3661, 0.0000, 0.0000, 0.0000, 0.1098, 0.0000, 0.0000, 0.8975, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.3410, 0.8975, 0.0000, 0.0000, 0.0000, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.3410, 0.0000, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000,
         0.1494],
        [0.0000, 0.1098, 0.8975, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000, 0.6996,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000,
         0.2289],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000, 0.0000,
         0.5594],
        [0.6136, 0.8975, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.2117,
         0.0000],
        [0.0000, 0.4288, 0.4288, 0.0000, 0.6996, 0.0000, 0.0000, 0.2117, 0.0000,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.1494, 0.0000, 0.2289, 0.5594, 0.0000, 0.0000,
         0.0000]], device='cuda:0')
prefix log/lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4/
checkpoint_temp_path log/lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4//temp.pth
checkpoint_best_path log/lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4//best.pth
tensorboard_path log/lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4/
record_path log/lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4/record.txt
eps 0.1
parse <bound method DefaultConfig.parse of <config.DefaultConfig object at 0x7f9dd2105550>>
output <bound method DefaultConfig.output of <config.DefaultConfig object at 0x7f9dd2105550>>
train: True, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 9792
len(data): 9792, day_slot: 288, n_day: 34
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
10 10
epoch 0   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.6917150283561033 , validation loss: 1.0861186683177948
epoch 1   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.4396032965650745 , validation loss: 0.9756975173950195
epoch 2   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.3960392235540876 , validation loss: 0.9895333647727966
epoch 3   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.37161556938115287 , validation loss: 0.8933790773153305
epoch 4   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.35734782791605185 , validation loss: 0.8829092085361481
epoch 5   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.3439919422654545 , validation loss: 0.8794465512037277
epoch 6   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.33193299700232115 , validation loss: 0.7711098566651344
epoch 7   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.31306834314383714 , validation loss: 0.7179785296320915
epoch 8   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.2990562430783814 , validation loss: 0.7300290167331696
epoch 9   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.29004740072231666 , validation loss: 0.6955049484968185
epoch 10   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.28138843061877233 , validation loss: 0.6822210550308228
epoch 11   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.2767251332600911 , validation loss: 0.6864653676748276
epoch 12   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.2719217644018285 , validation loss: 0.8269476220011711
epoch 13   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.26906923102397545 , validation loss: 0.6762326881289482
epoch 14   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.2652796974369124 , validation loss: 0.7848099768161774
epoch 15   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.26250167366336374 , validation loss: 0.6491294577717781
epoch 16   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.2601257279223087 , validation loss: 0.7496743872761726
epoch 17   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.25646352271238965 , validation loss: 0.6591305658221245
epoch 18   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.2551030426048765 , validation loss: 0.6572749763727188
epoch 19   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.2520309374028561 , validation loss: 0.6652090325951576
epoch 20   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.2512669633416569 , validation loss: 0.6889200583100319
epoch 21   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.24928993395730561 , validation loss: 0.7109469845890999
epoch 22   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.24766340968655606 , validation loss: 0.6492146030068398
epoch 23   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.24570931552671918 , validation loss: 0.6620809137821198
epoch 24   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.24563725380336537 , validation loss: 0.6318815723061562
epoch 25   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.24522935759787465 , validation loss: 0.8411822468042374
epoch 26   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.24341539425008438 , validation loss: 0.6903279572725296
epoch 27   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.2398852673815746 , validation loss: 0.7011162340641022
epoch 28   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.24046697657482297 , validation loss: 0.6777209714055061
epoch 29   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.23844054808803633 , validation loss: 0.7162414193153381
epoch 30   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.2378238395732992 , validation loss: 0.6945770829916
epoch 31   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.23805983423017987 , validation loss: 0.6410266533493996
epoch 32   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.23860954595547096 , validation loss: 0.648952841758728
epoch 33   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.23491473671268015 , validation loss: 0.6430843472480774
epoch 34   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.2340347974323759 , validation loss: 0.6934904083609581
epoch 35   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.2336447425917083 , validation loss: 0.6416996866464615
epoch 36   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.23373894597969802 , validation loss: 0.6962359547615051
epoch 37   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.2323731610587999 , validation loss: 0.6867470741271973
epoch 38   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.2333264920641394 , validation loss: 0.671847328543663
epoch 39   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.23224416199852438 , validation loss: 0.6598376557230949
epoch 40   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.231232261540843 , validation loss: 0.6229731887578964
epoch 41   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.23110094111339718 , validation loss: 0.7287698537111282
epoch 42   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.23072167033073948 , validation loss: 0.8278129026293755
epoch 43   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.2315247599400726 , validation loss: 0.6803091019392014
epoch 44   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.228499910995072 , validation loss: 0.6398006901144981
epoch 45   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.22781148348368851 , validation loss: 0.6379440650343895
epoch 46   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.22799194852511087 , validation loss: 0.64287319034338
epoch 47   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.2279844766154009 , validation loss: 0.6660817414522171
epoch 48   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.22699432221113466 , validation loss: 0.6908143237233162
epoch 49   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.22662304371011024 , validation loss: 0.7211065664887428
epoch 50   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.2272458806926129 , validation loss: 0.8551887646317482
epoch 51   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.22592493833280078 , validation loss: 0.6556801795959473
epoch 52   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.22592848802314086 , validation loss: 0.7088277712464333
epoch 53   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.22545479705520705 , validation loss: 0.6507096961140633
epoch 54   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.2247404204864128 , validation loss: 0.6946036070585251
epoch 55   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.22427972742155486 , validation loss: 0.7792192623019218
epoch 56   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.2238018737704146 , validation loss: 0.637902595102787
epoch 57   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.22508573853502087 , validation loss: 0.8026822283864021
epoch 58   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.22468245029449463 , validation loss: 0.6839019805192947
epoch 59   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.22248250187612048 , validation loss: 0.6508955955505371
epoch 60   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.22284326979926988 , validation loss: 0.6705684065818787
epoch 61   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.22181782477042256 , validation loss: 0.6334394589066505
epoch 62   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.22245073610661076 , validation loss: 0.6765270382165909
epoch 63   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.2216895947269365 , validation loss: 0.6610511913895607
epoch 64   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.220973693857006 , validation loss: 0.7043396160006523
epoch 65   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.22217943533962847 , validation loss: 0.6566121205687523
epoch 66   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.22083763924299502 , validation loss: 0.652800939977169
epoch 67   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.2201144701125575 , validation loss: 0.6865680143237114
epoch 68   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.2197257303724102 , validation loss: 0.7377472892403603
epoch 69   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.220573332379846 , validation loss: 0.6287525519728661
epoch 70   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.219406728943189 , validation loss: 0.6995443254709244
epoch 71   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.21979344300195283 , validation loss: 0.6510267108678818
epoch 72   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.21874661305371454 , validation loss: 0.6408231258392334
epoch 73   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.21817699016309253 , validation loss: 0.6619210764765739
epoch 74   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.21835870456461812 , validation loss: 0.6477426737546921
epoch 75   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.21835795015681023 , validation loss: 0.6574172973632812
epoch 76   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.21885371997075923 , validation loss: 0.690868116915226
epoch 77   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.21756330862933515 , validation loss: 0.6852414757013321
epoch 78   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.21748712395920472 , validation loss: 0.7127551212906837
epoch 79   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.21704093001636804 , validation loss: 0.7810654044151306
epoch 80   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.2177801117593167 , validation loss: 0.7246095389127731
epoch 81   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.21692843852089902 , validation loss: 0.7148590609431267
epoch 82   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.21567568854958402 , validation loss: 0.6579677909612656
epoch 83   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.21930945620817296 , validation loss: 0.7900154143571854
epoch 84   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.22210736251344868 , validation loss: 0.6308086216449738
epoch 85   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.21441967084127314 , validation loss: 0.6941341161727905
epoch 86   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.21452014089799396 , validation loss: 0.6629143729805946
epoch 87   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.21565775777779372 , validation loss: 0.7819448485970497
epoch 88   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.2146818643691493 , validation loss: 0.6747311353683472
epoch 89   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.21434473144073113 , validation loss: 0.6354153454303741
epoch 90   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.21395418573828304 , validation loss: 0.6311696246266365
epoch 91   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.21381056630143933 , validation loss: 0.6165691539645195
epoch 92   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.21450617646469788 , validation loss: 0.7133767828345299
epoch 93   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.2175801405135323 , validation loss: 0.8734265342354774
epoch 94   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.2209487136672525 , validation loss: 0.6018987894058228
epoch 95   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.21208533060316945 , validation loss: 0.7958076819777489
epoch 96   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.21310759584108988 , validation loss: 0.6202313601970673
tensor(7.8791, device='cuda:0')
MAE: [0.2911220044596601, 0.35065670986155756, 0.38889956766585865, 0.4163621766867174, 0.4466388744591332, 0.4706295130778219, 0.5075582829972287, 0.5313757551000597, 0.5563127285969857, 0.5611550822370138, 0.5536719022689329, 0.5512083483929026, 0.5693830689415336, 0.5610221687615993, 0.578514571559913, 0.5880810793566028, 0.5977301379587002, 0.5884786408553956, 0.5666503012412679, 0.560563916908097, 0.5678718709144933, 0.5586475041001728, 0.5636334048593705, 0.5739978061923661, 0.5777363282388326, 0.5637278020086208, 0.5410760619086166, 0.5260941189540953, 0.5274809854012943, 0.5194637755650221, 0.5244057043019644, 0.53819746444021] , MAPE: [0.06898378557156076, 0.08496599891029995, 0.17474100551290814, 0.16631357679286668, 0.13384474093237286, 0.09807842134799187, 0.06423185768754303, 0.09859818726836538, 0.04251075597885893, 0.1171019463990959, 0.11049214155170628, 0.08938854088644184, 0.1126375428022524, 0.1389630162298437, 0.0723815021084558, 0.06844235173567888, 0.09990514937243976, 0.11857994448416387, 0.12039941042791884, 0.08612629913253897, 0.11815266276605321, 0.17273886100396263, 0.15319201049399556, 0.08545861880986495, 0.11066194200649444, 0.1141305145995269, 0.18786290876638173, 0.13929543722815857, 0.047725470717954355, 0.037790697265564006, 0.06304326039210059, 0.03785662153637344] %, RMSE: [0.5201204777773748, 0.5776551623910179, 0.6230510926673998, 0.6515368878236918, 0.6833697871045068, 0.709912014954901, 0.7556277538862275, 0.7851029631116099, 0.8004669199082167, 0.7883821829616829, 0.7812110877040259, 0.7751713665432002, 0.7954461810614265, 0.7833557905494489, 0.8033601480452957, 0.8192089547961885, 0.8217892101028944, 0.7982393737196721, 0.7699108241045878, 0.7638807166638761, 0.7711420415211693, 0.7648763128278446, 0.7667820646501176, 0.7832014805689206, 0.7812304576909178, 0.7594911507684368, 0.7302715654610741, 0.7132600440221981, 0.715570927493373, 0.710775009822532, 0.7169947157821472, 0.7356640406670906]
epoch 97   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.21220880250136057 , validation loss: 0.6360213831067085
tensor(7.7981, device='cuda:0')
MAE: [0.28598004440152924, 0.3640068547949003, 0.4126865769252085, 0.44613067427856523, 0.4899681343030684, 0.5166537966625285, 0.5285369314353183, 0.5477975572204006, 0.5659120567272581, 0.5827370958444998, 0.5870576636270457, 0.588920000573409, 0.6213296550973174, 0.6312792958301905, 0.6322658084417434, 0.6476751854439678, 0.6413707822449889, 0.6382758636392423, 0.6394198774857466, 0.6460873419239387, 0.6675820874731949, 0.6739801250267582, 0.662858697665836, 0.6572250197297826, 0.6428183700839423, 0.6320072762456665, 0.6313153789574568, 0.6311668779777805, 0.6568092905996924, 0.6591952034735035, 0.6542058273362591, 0.6574305791974299] , MAPE: [0.05869852624317066, 0.08811059163106827, 0.15973251667842409, 0.1472268376001829, 0.13677614966636048, 0.06910948410065326, 0.035960394708879566, 0.09832952944507532, 0.01360153626006687, 0.08407126523484716, 0.04079804697208845, 0.05987135433852346, 0.0499645397105415, 0.09742000936339106, 0.028725008615502635, 0.03878089230832855, 0.03062456692995914, 0.060586629670230194, 0.006768622652216248, -0.03837005449062304, -0.021700652742208722, 0.007373121962867576, 0.009686976023394609, -0.018427406263933157, 0.043154001086678766, 0.004120374045009176, 0.05992354626933109, -0.0004777700135834784, -0.07307896638657542, -0.08359131631149176, -0.06971318416189122, -0.07449138404003383] %, RMSE: [0.514452930598401, 0.600132498027881, 0.6551022953277343, 0.691604774868548, 0.7348527192901504, 0.7653788559449506, 0.7839183997700014, 0.8079404524630802, 0.8236718524218776, 0.832508292678777, 0.8379387701377474, 0.8344293199744044, 0.8690071939515688, 0.8825678153189298, 0.8834710340695455, 0.9017872893353985, 0.8871998054725566, 0.8748106999624248, 0.8691793996770493, 0.8654238414196059, 0.8838913483434723, 0.8915696070904239, 0.8700819000427574, 0.8594518274606505, 0.8398509922790194, 0.8191546376567281, 0.8115868229959292, 0.806704276640739, 0.8268818352452111, 0.8275997415824743, 0.8178517087197819, 0.8177711377065906]
epoch 98   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.21213462948799133 , validation loss: 0.7194128856062889
tensor(7.7666, device='cuda:0')
MAE: [0.2882159011288709, 0.3671341639240128, 0.40456152483734503, 0.4463212881426413, 0.4971896445943215, 0.5258288962881743, 0.549784596344629, 0.5890567869222579, 0.6227799298694914, 0.6512139242415115, 0.6548100484682957, 0.6669937201477011, 0.6926131075697461, 0.7022008298087826, 0.710566270359283, 0.739492786229809, 0.7473371131188169, 0.7337788645504523, 0.708812843907202, 0.7129702716328434, 0.7132721900678787, 0.6999485578146024, 0.6945724141812816, 0.7124382497777336, 0.7253955907109626, 0.7129809844132858, 0.6835128053462075, 0.6766409839924002, 0.6878036073257321, 0.6836095832441885, 0.6708013442412173, 0.6792655518754702] , MAPE: [0.07690105432161873, 0.09492441524834708, 0.25469065214878733, 0.2599882716334007, 0.21599568808189962, 0.1624533819538762, 0.0891231452053732, 0.14252992075233367, 0.1002271130635897, 0.19751467854245383, 0.1988449181137914, 0.23545172813587303, 0.26743178431867604, 0.2717788905556405, 0.1439615937373325, 0.15543148317453198, 0.1587133647868717, 0.17017642503409416, 0.18260908649404434, 0.2282014818212345, 0.29493511177887916, 0.22799584886352003, 0.16583493110455558, 0.126810427237238, 0.0978471155865817, 0.07843475239027949, -0.025052896103450097, 0.019588175077092883, -0.10398550370539186, -0.07428766198753627, -0.10423639975478735, -0.2758730180777931] %, RMSE: [0.5189874364779024, 0.6060981959065754, 0.651185484725471, 0.7013566164957508, 0.7527631329004917, 0.7866830536350965, 0.8169952457490738, 0.8682316956390133, 0.8970940908634086, 0.9202850950719873, 0.9286222188621852, 0.9380416245423008, 0.9664819578478101, 0.9844106727585902, 0.9956919501305037, 1.0313806133607692, 1.0358468927869902, 1.0158927681096233, 0.9856869674236143, 0.9874765613449605, 0.9896114836273667, 0.976649337078437, 0.9695660748486075, 0.9912176288944754, 1.0034761746596517, 0.99053262792701, 0.9544977054409415, 0.9477689661883019, 0.9571317142569409, 0.9530157154865738, 0.9376966903088119, 0.9502220675995348]
epoch 99   lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4 , train loss: 0.21172918116345124 , validation loss: 0.6381139755249023
tensor(7.7948, device='cuda:0')
MAE: [0.27935175855019967, 0.32996153944940065, 0.35612783161222394, 0.3904763017782999, 0.42938827352655917, 0.47023642203588156, 0.48913150446835096, 0.49937963427591725, 0.5262267888135748, 0.5279687205064543, 0.5231813547721843, 0.5258526596983837, 0.5417003458720084, 0.5612907031385862, 0.5701020316487735, 0.5778032768896022, 0.5918953791650531, 0.58495225954532, 0.5724238130354236, 0.5795741314202855, 0.5922350261350806, 0.614932367161454, 0.6236482633542769, 0.6214705688606218, 0.6274372574746532, 0.6141882370016778, 0.5940043381749431, 0.5912250266496821, 0.5894554246111399, 0.6061506931867796, 0.6130034598832009, 0.6217905462410339] , MAPE: [0.07816060286310511, 0.06272181406614614, 0.17614756681572188, 0.19200562803616664, 0.14859117336088604, 0.1244633971847661, 0.06904250676193414, 0.08735046157716535, 0.017073280561271907, 0.07093615978539393, 0.019613454861611018, 0.09120377988333334, 0.10854696252416596, 0.16363139733076865, 0.05087091393146018, 0.030939528287518, 0.02579581654621, 0.03902797553374709, -0.0019329593013434974, 0.008799621637749484, 0.09754166962263813, 0.16219308179912406, 0.11946672206541124, 0.06685963622790031, 0.15378563722109959, 0.1731743699834969, 0.28434739460048747, 0.19108747145266197, 0.15922102454772816, 0.1493495089666361, 0.2131054011261098, 0.1750822297738461] %, RMSE: [0.5151132563720118, 0.5616480467024753, 0.5945196324783725, 0.6422708407202363, 0.6804766357236082, 0.719423357967389, 0.7375386037428073, 0.7458722252360822, 0.769651623289212, 0.7567133927019237, 0.7476210053246116, 0.751780627987843, 0.7713445745445091, 0.7806755637175247, 0.7830526927171388, 0.7879556847526351, 0.8055210862069028, 0.7877270441426706, 0.7701685673141558, 0.7791854363142517, 0.7899812547561381, 0.8118989802919016, 0.8148807498581342, 0.8143734271493356, 0.8186179130811253, 0.799567191204713, 0.7800416363051581, 0.7783981047191318, 0.7774522019609682, 0.7952959635960517, 0.8014691672175653, 0.8146477110743999]
test loss: NIL 
MAE: [0.27935175855019967, 0.32996153944940065, 0.35612783161222394, 0.3904763017782999, 0.42938827352655917, 0.47023642203588156, 0.48913150446835096, 0.49937963427591725, 0.5262267888135748, 0.5279687205064543, 0.5231813547721843, 0.5258526596983837, 0.5417003458720084, 0.5612907031385862, 0.5701020316487735, 0.5778032768896022, 0.5918953791650531, 0.58495225954532, 0.5724238130354236, 0.5795741314202855, 0.5922350261350806, 0.614932367161454, 0.6236482633542769, 0.6214705688606218, 0.6274372574746532, 0.6141882370016778, 0.5940043381749431, 0.5912250266496821, 0.5894554246111399, 0.6061506931867796, 0.6130034598832009, 0.6217905462410339] , MAPE: [0.07816060286310511, 0.06272181406614614, 0.17614756681572188, 0.19200562803616664, 0.14859117336088604, 0.1244633971847661, 0.06904250676193414, 0.08735046157716535, 0.017073280561271907, 0.07093615978539393, 0.019613454861611018, 0.09120377988333334, 0.10854696252416596, 0.16363139733076865, 0.05087091393146018, 0.030939528287518, 0.02579581654621, 0.03902797553374709, -0.0019329593013434974, 0.008799621637749484, 0.09754166962263813, 0.16219308179912406, 0.11946672206541124, 0.06685963622790031, 0.15378563722109959, 0.1731743699834969, 0.28434739460048747, 0.19108747145266197, 0.15922102454772816, 0.1493495089666361, 0.2131054011261098, 0.1750822297738461] %, RMSE: [0.5151132563720118, 0.5616480467024753, 0.5945196324783725, 0.6422708407202363, 0.6804766357236082, 0.719423357967389, 0.7375386037428073, 0.7458722252360822, 0.769651623289212, 0.7567133927019237, 0.7476210053246116, 0.751780627987843, 0.7713445745445091, 0.7806755637175247, 0.7830526927171388, 0.7879556847526351, 0.8055210862069028, 0.7877270441426706, 0.7701685673141558, 0.7791854363142517, 0.7899812547561381, 0.8118989802919016, 0.8148807498581342, 0.8143734271493356, 0.8186179130811253, 0.799567191204713, 0.7800416363051581, 0.7783981047191318, 0.7774522019609682, 0.7952959635960517, 0.8014691672175653, 0.8146477110743999]
====================
training elapsedd with 351.55 seconds for 100 iterations, the sec/iter = 3.52

MAE_mean: [0.27935176 0.32996154 0.35612783 0.3904763  0.42938827 0.47023642
 0.4891315  0.49937963 0.52622679 0.52796872 0.52318135 0.52585266
 0.54170035 0.5612907  0.57010203 0.57780328 0.59189538 0.58495226
 0.57242381 0.57957413 0.59223503 0.61493237 0.62364826 0.62147057
 0.62743726 0.61418824 0.59400434 0.59122503 0.58945542 0.60615069
 0.61300346 0.62179055] , MAPE_mean: [ 0.0781606   0.06272181  0.17614757  0.19200563  0.14859117  0.1244634
  0.06904251  0.08735046  0.01707328  0.07093616  0.01961345  0.09120378
  0.10854696  0.1636314   0.05087091  0.03093953  0.02579582  0.03902798
 -0.00193296  0.00879962  0.09754167  0.16219308  0.11946672  0.06685964
  0.15378564  0.17317437  0.28434739  0.19108747  0.15922102  0.14934951
  0.2131054   0.17508223] , RMSE_mean: [0.51511326 0.56164805 0.59451963 0.64227084 0.68047664 0.71942336
 0.7375386  0.74587223 0.76965162 0.75671339 0.74762101 0.75178063
 0.77134457 0.78067556 0.78305269 0.78795568 0.80552109 0.78772704
 0.77016857 0.77918544 0.78998125 0.81189898 0.81488075 0.81437343
 0.81861791 0.79956719 0.78004164 0.7783981  0.7774522  0.79529596
 0.80146917 0.81464771]

MAE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , MAPE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , RMSE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
Finished training with: lr1e-3_bs64_nh256_ra1e-5_dp0.3_wd1e-6_ah2_ck1_kt4
user config:
seed 666
device 0
scaler StandardScaler()
day_slot 288
n_route 10
n_his 96
n_pred 96
n_train 34
n_val 5
n_test 5
mode 1
n_c 10
model STAGNN_stamp
TPG TPGNN
name lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6
log_path log/TPGNN_r05p02kt3outer_350
crash 350
new_name TPGNN_r05p02kt3outer_350
batch_size 64
lr 0.0001
a 0.1
r 0.5
n_mask 1
adam {'use': True, 'weight_decay': 0.0001}
slr {'use': True, 'step_size': 400, 'gamma': 0.3}
resume False
start_epoch 0
epochs 100
n_layer 1
n_attr 64
n_hid 64
reg_A 1e-05
circle 288
drop_prob 0.1
CE {'use': True, 'kernel_size': 1, 'bias': False}
LE {'use': False, 'bias': False}
SE {'use': True, 'separate': True, 'no': False}
TE {'use': True, 'no': True}
attn {'head': 1, 'd_k': 32, 'd_v': 32, 'drop_prob': 0.2}
STstamp {'use': True, 'kt': 3, 'temperature': 1.0}
T4N {'use': True, 'step': 2, 'end_epoch': 10000, 'change_head': True, 'change_enc': True}
stamp_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/time_stamp_F_96.npy
data_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/V_France_processed_0.csv
adj_matrix_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/W_France_processed_0.csv
dis_mat tensor([[0.0000, 0.3661, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.6136, 0.0000,
         0.0000],
        [0.3661, 0.0000, 0.0000, 0.0000, 0.1098, 0.0000, 0.0000, 0.8975, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.3410, 0.8975, 0.0000, 0.0000, 0.0000, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.3410, 0.0000, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000,
         0.1494],
        [0.0000, 0.1098, 0.8975, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000, 0.6996,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000,
         0.2289],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000, 0.0000,
         0.5594],
        [0.6136, 0.8975, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.2117,
         0.0000],
        [0.0000, 0.4288, 0.4288, 0.0000, 0.6996, 0.0000, 0.0000, 0.2117, 0.0000,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.1494, 0.0000, 0.2289, 0.5594, 0.0000, 0.0000,
         0.0000]], device='cuda:0')
prefix log/lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6/
checkpoint_temp_path log/lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6//temp.pth
checkpoint_best_path log/lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6//best.pth
tensorboard_path log/lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6/
record_path log/lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6/record.txt
eps 0.1
parse <bound method DefaultConfig.parse of <config.DefaultConfig object at 0x7f7fcb895550>>
output <bound method DefaultConfig.output of <config.DefaultConfig object at 0x7f7fcb895550>>
train: True, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 9792
len(data): 9792, day_slot: 288, n_day: 34
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
10 10
epoch 0   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 1.4028453219170665 , validation loss: 0.9535955637693405
epoch 1   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.9736258995299246 , validation loss: 0.9325728118419647
epoch 2   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.7529213288251091 , validation loss: 0.993391864001751
epoch 3   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.5952270299780602 , validation loss: 0.9966751262545586
epoch 4   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.5253170886460472 , validation loss: 1.0283189862966537
epoch 5   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.4979356375395083 , validation loss: 1.0471874624490738
epoch 6   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.4795641063475141 , validation loss: 1.0120012164115906
epoch 7   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.4645879893910651 , validation loss: 1.006910465657711
epoch 8   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.45221270416297166 , validation loss: 1.009785421192646
epoch 9   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.44222220077234153 , validation loss: 0.9886620417237282
epoch 10   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.4332028528054555 , validation loss: 1.0074933767318726
epoch 11   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.4251125431528278 , validation loss: 0.9692597389221191
epoch 12   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.4178134460075229 , validation loss: 0.9521221294999123
epoch 13   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.4112750285980748 , validation loss: 0.9542762637138367
epoch 14   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.4053265621849135 , validation loss: 0.9478458240628242
epoch 15   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.39991608671113554 , validation loss: 0.9268901646137238
epoch 16   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.3950515132324368 , validation loss: 0.9350755885243416
epoch 17   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.39065395032658295 , validation loss: 0.9150849655270576
epoch 18   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.38668614216879305 , validation loss: 0.9228750839829445
epoch 19   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.3829414102376676 , validation loss: 0.9368464797735214
epoch 20   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.37946241626552507 , validation loss: 0.8968851715326309
epoch 21   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.37616944955844506 , validation loss: 0.8967034295201302
epoch 22   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.3728376825650533 , validation loss: 0.8859376087784767
epoch 23   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.36985594034194946 , validation loss: 0.906151719391346
epoch 24   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.3667902893879834 , validation loss: 0.9035368114709854
epoch 25   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.3640251089544857 , validation loss: 0.8840292617678642
epoch 26   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.36128062886350293 , validation loss: 0.8644175156950951
epoch 27   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.35855932037035626 , validation loss: 0.8360486626625061
epoch 28   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.35596095171629216 , validation loss: 0.8341426700353622
epoch 29   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.3533032238483429 , validation loss: 0.8350663632154465
epoch 30   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.3506860066862667 , validation loss: 0.8304769694805145
epoch 31   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.3479141487794764 , validation loss: 0.8262210413813591
epoch 32   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.34519536238090665 , validation loss: 0.7966980338096619
epoch 33   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.3419851047151229 , validation loss: 0.8053580075502396
epoch 34   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.3386034819425321 , validation loss: 0.7801967561244965
epoch 35   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.33469022138445986 , validation loss: 0.78384979814291
epoch 36   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.32999788604530633 , validation loss: 0.7422238141298294
epoch 37   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.3247925592403786 , validation loss: 0.7371891066431999
epoch 38   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.31980835398038227 , validation loss: 0.7252146676182747
epoch 39   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.3158550589692359 , validation loss: 0.7135996744036674
epoch 40   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.3126649330644047 , validation loss: 0.709323562681675
epoch 41   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.3100438281601551 , validation loss: 0.7135530635714531
epoch 42   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.30756577966259974 , validation loss: 0.6971608474850655
epoch 43   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.30550142772057476 , validation loss: 0.6969668716192245
epoch 44   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.3037136080218296 , validation loss: 0.6845665127038956
epoch 45   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.30184106733284743 , validation loss: 0.6823080480098724
epoch 46   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.30030451159851224 , validation loss: 0.6800424158573151
epoch 47   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.29890336417684366 , validation loss: 0.6924059391021729
epoch 48   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.2973912182976218 , validation loss: 0.6743947714567184
epoch 49   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.29617156292877944 , validation loss: 0.6732679456472397
epoch 50   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.2946910636097777 , validation loss: 0.6798685789108276
epoch 51   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.2934446837387833 , validation loss: 0.6754146590828896
epoch 52   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.2921595327994403 , validation loss: 0.6777004599571228
epoch 53   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.29096710974094914 , validation loss: 0.6736614108085632
epoch 54   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.2900148676890953 , validation loss: 0.6676901206374168
epoch 55   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.28888895640186235 , validation loss: 0.6598031967878342
epoch 56   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.2879522378538169 , validation loss: 0.6716831177473068
epoch 57   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.2869152824083964 , validation loss: 0.6595923602581024
epoch 58   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.285826723949582 , validation loss: 0.6538514047861099
epoch 59   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.28506415381151085 , validation loss: 0.6621546745300293
epoch 60   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.283903593526167 , validation loss: 0.6589764282107353
epoch 61   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.28297310307914136 , validation loss: 0.6615092232823372
epoch 62   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.28226883154289395 , validation loss: 0.6592156365513802
epoch 63   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.2812989500223422 , validation loss: 0.6582149267196655
epoch 64   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.280457054867464 , validation loss: 0.657087042927742
epoch 65   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.27965182942502637 , validation loss: 0.6567275300621986
epoch 66   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.27877020952748316 , validation loss: 0.6490002945065498
epoch 67   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.277854559468288 , validation loss: 0.6542923077940941
epoch 68   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.277213687990226 , validation loss: 0.6576680615544319
epoch 69   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.27633267699503433 , validation loss: 0.653366893529892
epoch 70   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.2756822424776414 , validation loss: 0.6634642705321312
epoch 71   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.2749071933475195 , validation loss: 0.6479107961058617
epoch 72   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.27420533988990037 , validation loss: 0.6431773379445076
epoch 73   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.27348944194176616 , validation loss: 0.6494613215327263
epoch 74   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.2728451557603537 , validation loss: 0.6512735188007355
epoch 75   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.2721561883010116 , validation loss: 0.6441729590296745
epoch 76   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.27141081351859897 , validation loss: 0.6528409123420715
epoch 77   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.27074351030237537 , validation loss: 0.6466299369931221
epoch 78   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.270239287147335 , validation loss: 0.654729887843132
epoch 79   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.2693878143441443 , validation loss: 0.6490607261657715
epoch 80   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.26871610155292586 , validation loss: 0.644064411520958
epoch 81   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.26823639811254013 , validation loss: 0.6550280004739761
epoch 82   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.2675731380780538 , validation loss: 0.6468475833535194
epoch 83   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.2672188398884792 , validation loss: 0.6507904529571533
epoch 84   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.26636506032709983 , validation loss: 0.6504471153020859
epoch 85   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.26579979997055203 , validation loss: 0.6440960690379143
epoch 86   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.2652437917742075 , validation loss: 0.647242359817028
epoch 87   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.2646434216522703 , validation loss: 0.6459119990468025
epoch 88   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.26416731085263045 , validation loss: 0.6490401476621628
epoch 89   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.26365286404011296 , validation loss: 0.6393931955099106
epoch 90   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.263061476688759 , validation loss: 0.6456649824976921
epoch 91   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.2624986703489341 , validation loss: 0.6435602083802223
epoch 92   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.2619342765971726 , validation loss: 0.642988495528698
epoch 93   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.2614134088450787 , validation loss: 0.6472856104373932
epoch 94   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.2609251667471493 , validation loss: 0.6422780081629753
epoch 95   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.26030319198673846 , validation loss: 0.6345967054367065
epoch 96   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.25985916104971196 , validation loss: 0.6417280659079552
tensor(56.6440, device='cuda:0')
MAE: [0.3084989482082772, 0.3826349281137521, 0.4312182178090029, 0.4822472125446405, 0.5242854683980653, 0.539600513135419, 0.541251772713761, 0.5405428738100935, 0.5687039553193548, 0.5874458954056975, 0.5938827644344227, 0.6193682585437734, 0.6392667162415245, 0.6526055230246377, 0.6515976093291814, 0.6418943509843547, 0.6489953175116061, 0.6497069201802778, 0.6523304492336958, 0.6642933496099311, 0.682442377510183, 0.6912687182443735, 0.6814032185169839, 0.6577116300012033, 0.6469513803534209, 0.6416524588499103, 0.6429050876901091, 0.6431640370748937, 0.646537614488763, 0.6550887418546013, 0.6492755245035227, 0.6438810504743464] , MAPE: [0.14776952989560066, 0.05387222244792433, 0.11919872815614373, 0.08310062051883638, 0.07406789608000593, 0.09057436813403535, 0.042320126474261206, 0.022073015736215857, -0.008362747755138079, 0.03403771651264346, 0.03494020540969321, 0.021887062657871267, 0.021117809907216012, 0.07227413220908949, -0.006112318697287639, -0.04047104754160547, -0.028192441553944368, 0.0007372503338763299, 0.011815558958837052, -0.04621290704635698, -0.03606205373147944, -0.02344529690472985, -0.05949356241924592, -0.10212550854228182, -0.06360248988739109, -0.03816323794220132, -0.08406405035670386, -0.11030063943226927, -0.13514754872909535, -0.052296400000867806, -0.08540617965095791, -0.19655023766539934] %, RMSE: [0.5786201135966742, 0.6568103707841298, 0.6955913699584039, 0.756739773928286, 0.8251712028037858, 0.8285367426072038, 0.8260389625310401, 0.8106215098945473, 0.8328002163088465, 0.829078251416814, 0.8192097647297241, 0.8512540147051652, 0.8880281242178575, 0.8983010782614036, 0.8837278574437275, 0.8676653727544061, 0.868921659133514, 0.8571391526655466, 0.8514249269095179, 0.869285353247086, 0.901030104624583, 0.9092907292854568, 0.8900917042003684, 0.853753536474423, 0.8361654677507308, 0.8289777294471581, 0.8317292966104659, 0.8305888440689798, 0.8388876876752852, 0.851106070192398, 0.8390544557636, 0.8326805106317293]
epoch 97   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.2593952776754604 , validation loss: 0.6383833289146423
tensor(56.4178, device='cuda:0')
MAE: [0.3121117457799306, 0.3929246197180035, 0.4382782923039433, 0.48325748800386475, 0.5260972289790966, 0.5395497888000202, 0.5451498495551191, 0.5385245700239099, 0.568507597616576, 0.5958896300584539, 0.601600739096589, 0.6195177651922574, 0.6299270802411759, 0.6320840591445719, 0.6347326531802717, 0.6160701977703529, 0.6259160362197489, 0.6392135995814634, 0.6416504113267646, 0.6433190013053491, 0.6540965773057692, 0.662522982135415, 0.647730049949485, 0.6139686076437152, 0.6118588404115481, 0.6214727003661167, 0.6174524018014829, 0.6116156883326541, 0.612338459797818, 0.6249848576020641, 0.6153070099782391, 0.6028249066637963] , MAPE: [0.1462177643518068, 0.05056231835371101, 0.15194889352142268, 0.1129855043248912, 0.08206177272775517, 0.08841197850372727, 0.06075201730827045, 0.055048066558266544, 0.029066699469774377, 0.08756113753415738, 0.09748742813200956, 0.07014410599748443, 0.04753480065127921, 0.10854648429446148, 0.04747594128577062, 0.030015025173503, 0.027194531976619495, 0.05383059848952059, 0.0891254542650146, 0.02791147747206665, 0.03376343951424414, 0.035753801408411036, 0.0010579579664135026, -0.024295115857817157, -0.022298217408005604, -0.005523837927648481, -0.02410573894275621, -0.08208246468915605, -0.065049569910625, -0.03133452368876927, -0.03117509293544122, -0.16245853231742002] %, RMSE: [0.5792413945672347, 0.6688944044344362, 0.7083927960238515, 0.7605718361006578, 0.8250817091727626, 0.8302760512650467, 0.8417410967769298, 0.8167244552621828, 0.8421754079591808, 0.8575416887944278, 0.8503222888231217, 0.865364343359653, 0.8832184060487941, 0.8819951608883735, 0.8778820493007113, 0.8483544749655442, 0.8531174538086795, 0.8635866872683776, 0.8579263581942044, 0.8580590904607048, 0.8741529288345461, 0.8855993864168654, 0.8640668590405148, 0.8139398655324799, 0.8092841845903107, 0.8276115419720445, 0.824499968008463, 0.8130751129817105, 0.8130087850829418, 0.835349213454815, 0.8244773817153636, 0.8056148700428212]
epoch 98   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.25893254782639297 , validation loss: 0.6384555101394653
tensor(56.1900, device='cuda:0')
MAE: [0.302329710246131, 0.38156148267281004, 0.43136912700976965, 0.47632749822576403, 0.5187348945483028, 0.5359812805977333, 0.5381526070076627, 0.5449712702345832, 0.5672495620363612, 0.5847390040855125, 0.5963882617331734, 0.6135083389627872, 0.6257939254765197, 0.6298464400743701, 0.6312114919030789, 0.6242087024550155, 0.6326697556588549, 0.637131821490325, 0.6402791317682905, 0.6443806214824549, 0.6535515908916125, 0.6617441077111769, 0.6533784292669026, 0.6305176971720282, 0.6213097626310725, 0.6233330211995803, 0.6250587133475647, 0.6243123778725792, 0.6226331917006407, 0.6272241378388339, 0.615689782401182, 0.6072743046694656] , MAPE: [0.13102456045728048, 0.0556493076394893, 0.12414909952034296, 0.09226033750258325, 0.08989141071425018, 0.09906337923416958, 0.06942379495299411, 0.058795367640760966, 0.012413948835104766, 0.07431087976771239, 0.07486111174342366, 0.061638553098927865, 0.045474249505715145, 0.11342735375486375, 0.0454254436478518, 0.026079995346200993, 0.009681407427189473, 0.04059442065402952, 0.062069771557634684, 0.007299404730209803, 0.01982315288547885, 0.020044140976722552, -0.021852026015283663, -0.04652035618254305, -0.03144628411508915, -0.002442375058692294, -0.05197914391028312, -0.11296910715249359, -0.1054952959389277, -0.04808627397591277, -0.08166809429457776, -0.22678512464524783] %, RMSE: [0.5693375478057796, 0.6547614490389844, 0.6964735104747783, 0.7534178561268142, 0.820186500230034, 0.825622276140068, 0.8258907283928119, 0.8228571851682227, 0.8369679735428973, 0.834309766362541, 0.83425983461403, 0.8548204822065061, 0.8784440280195875, 0.8768431892374644, 0.871433304682499, 0.8642871456011799, 0.8649535939507771, 0.8574742551883617, 0.8533437887468671, 0.8620655624665311, 0.8793129377286145, 0.8875047896209167, 0.8738091453319319, 0.8405816921303837, 0.8249262047926165, 0.828597412250561, 0.8327551023125986, 0.8328648360686899, 0.8308637790911578, 0.8402716662015227, 0.8258461387875027, 0.8152515176168149]
epoch 99   lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6 , train loss: 0.2582736669802198 , validation loss: 0.6370744854211807
tensor(55.9760, device='cuda:0')
MAE: [0.30264177321773217, 0.3839508020403536, 0.43729840496410954, 0.4844859690478398, 0.5167726958518098, 0.5242045286309319, 0.5244294117769399, 0.5274492043199152, 0.545705055554503, 0.556987538280292, 0.5748689681268537, 0.594919888311421, 0.6042233729869434, 0.6103525307090933, 0.6097257651903273, 0.6045357111299929, 0.6139463573208405, 0.6272184702022404, 0.6368905097265373, 0.63951322584461, 0.6425092503067452, 0.6515097850818455, 0.6404182973262115, 0.6199496816160138, 0.6192343908446581, 0.6286075140159462, 0.6346534283885482, 0.6322101688853552, 0.6217237875499215, 0.6269889157022512, 0.6217346142512775, 0.608952066951345] , MAPE: [0.14646353620878744, 0.06138698043239593, 0.1487028391439661, 0.10689153161593869, 0.07320542701995907, 0.10855196547527382, 0.06819453859948385, 0.07580257696418072, 0.042728055803166444, 0.10271145816976415, 0.11092272071151286, 0.06692495514194889, 0.06774533403324763, 0.12644068338150355, 0.06557336710340622, 0.0378074195482, 0.043445057234497014, 0.0777123860254963, 0.10800795490218905, 0.035294270807822666, 0.03375165342013152, 0.04109073130512303, -0.007830108124936796, -0.042758189954519805, -0.021968256620154357, -0.0011768339753520588, -0.023353913437236657, -0.0862329000417898, -0.07436657772536304, -0.03132465901179119, -0.0487343060936582, -0.14476813141300976] %, RMSE: [0.5686283696950512, 0.659874571292051, 0.7107810413717233, 0.7674595474354667, 0.8159764506316896, 0.8107681990316948, 0.810518866786157, 0.805563605681498, 0.8151039481469748, 0.8056196073205462, 0.8184301403854407, 0.8412935783691612, 0.8580346099425127, 0.8596075120007809, 0.8509849105156769, 0.8458120148718868, 0.8487969078879906, 0.8548149312766984, 0.857291232490303, 0.8627540701920233, 0.8676097575053884, 0.8742359764174634, 0.8584577508243071, 0.8333139480753964, 0.8313829866849025, 0.8439546517834858, 0.8525494288657802, 0.8466553452025356, 0.8303761388533595, 0.8360139033579151, 0.8310263910259604, 0.8134809532708952]
test loss: NIL 
MAE: [0.30264177321773217, 0.3839508020403536, 0.43729840496410954, 0.4844859690478398, 0.5167726958518098, 0.5242045286309319, 0.5244294117769399, 0.5274492043199152, 0.545705055554503, 0.556987538280292, 0.5748689681268537, 0.594919888311421, 0.6042233729869434, 0.6103525307090933, 0.6097257651903273, 0.6045357111299929, 0.6139463573208405, 0.6272184702022404, 0.6368905097265373, 0.63951322584461, 0.6425092503067452, 0.6515097850818455, 0.6404182973262115, 0.6199496816160138, 0.6192343908446581, 0.6286075140159462, 0.6346534283885482, 0.6322101688853552, 0.6217237875499215, 0.6269889157022512, 0.6217346142512775, 0.608952066951345] , MAPE: [0.14646353620878744, 0.06138698043239593, 0.1487028391439661, 0.10689153161593869, 0.07320542701995907, 0.10855196547527382, 0.06819453859948385, 0.07580257696418072, 0.042728055803166444, 0.10271145816976415, 0.11092272071151286, 0.06692495514194889, 0.06774533403324763, 0.12644068338150355, 0.06557336710340622, 0.0378074195482, 0.043445057234497014, 0.0777123860254963, 0.10800795490218905, 0.035294270807822666, 0.03375165342013152, 0.04109073130512303, -0.007830108124936796, -0.042758189954519805, -0.021968256620154357, -0.0011768339753520588, -0.023353913437236657, -0.0862329000417898, -0.07436657772536304, -0.03132465901179119, -0.0487343060936582, -0.14476813141300976] %, RMSE: [0.5686283696950512, 0.659874571292051, 0.7107810413717233, 0.7674595474354667, 0.8159764506316896, 0.8107681990316948, 0.810518866786157, 0.805563605681498, 0.8151039481469748, 0.8056196073205462, 0.8184301403854407, 0.8412935783691612, 0.8580346099425127, 0.8596075120007809, 0.8509849105156769, 0.8458120148718868, 0.8487969078879906, 0.8548149312766984, 0.857291232490303, 0.8627540701920233, 0.8676097575053884, 0.8742359764174634, 0.8584577508243071, 0.8333139480753964, 0.8313829866849025, 0.8439546517834858, 0.8525494288657802, 0.8466553452025356, 0.8303761388533595, 0.8360139033579151, 0.8310263910259604, 0.8134809532708952]
====================
training elapsedd with 311.85 seconds for 100 iterations, the sec/iter = 3.12

MAE_mean: [0.30264177 0.3839508  0.4372984  0.48448597 0.5167727  0.52420453
 0.52442941 0.5274492  0.54570506 0.55698754 0.57486897 0.59491989
 0.60422337 0.61035253 0.60972577 0.60453571 0.61394636 0.62721847
 0.63689051 0.63951323 0.64250925 0.65150979 0.6404183  0.61994968
 0.61923439 0.62860751 0.63465343 0.63221017 0.62172379 0.62698892
 0.62173461 0.60895207] , MAPE_mean: [ 0.14646354  0.06138698  0.14870284  0.10689153  0.07320543  0.10855197
  0.06819454  0.07580258  0.04272806  0.10271146  0.11092272  0.06692496
  0.06774533  0.12644068  0.06557337  0.03780742  0.04344506  0.07771239
  0.10800795  0.03529427  0.03375165  0.04109073 -0.00783011 -0.04275819
 -0.02196826 -0.00117683 -0.02335391 -0.0862329  -0.07436658 -0.03132466
 -0.04873431 -0.14476813] , RMSE_mean: [0.56862837 0.65987457 0.71078104 0.76745955 0.81597645 0.8107682
 0.81051887 0.80556361 0.81510395 0.80561961 0.81843014 0.84129358
 0.85803461 0.85960751 0.85098491 0.84581201 0.84879691 0.85481493
 0.85729123 0.86275407 0.86760976 0.87423598 0.85845775 0.83331395
 0.83138299 0.84395465 0.85254943 0.84665535 0.83037614 0.8360139
 0.83102639 0.81348095]

MAE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , MAPE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , RMSE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
Finished training with: lr1e-4_bs64_nh64_ra1e-5_dp0.1_wd1e-6_ah2_ck5_kt6
user config:
seed 666
device 0
scaler StandardScaler()
day_slot 288
n_route 10
n_his 96
n_pred 96
n_train 34
n_val 5
n_test 5
mode 1
n_c 10
model STAGNN_stamp
TPG TPGNN
name lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4
log_path log/TPGNN_r05p02kt3outer_351
crash 351
new_name TPGNN_r05p02kt3outer_351
batch_size 64
lr 0.0001
a 0.1
r 0.5
n_mask 1
adam {'use': True, 'weight_decay': 0.0001}
slr {'use': True, 'step_size': 400, 'gamma': 0.3}
resume False
start_epoch 0
epochs 100
n_layer 1
n_attr 64
n_hid 64
reg_A 0.0001
circle 288
drop_prob 0.1
CE {'use': True, 'kernel_size': 1, 'bias': False}
LE {'use': False, 'bias': False}
SE {'use': True, 'separate': True, 'no': False}
TE {'use': True, 'no': True}
attn {'head': 1, 'd_k': 32, 'd_v': 32, 'drop_prob': 0.2}
STstamp {'use': True, 'kt': 3, 'temperature': 1.0}
T4N {'use': True, 'step': 2, 'end_epoch': 10000, 'change_head': True, 'change_enc': True}
stamp_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/time_stamp_F_96.npy
data_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/V_France_processed_0.csv
adj_matrix_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/W_France_processed_0.csv
dis_mat tensor([[0.0000, 0.3661, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.6136, 0.0000,
         0.0000],
        [0.3661, 0.0000, 0.0000, 0.0000, 0.1098, 0.0000, 0.0000, 0.8975, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.3410, 0.8975, 0.0000, 0.0000, 0.0000, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.3410, 0.0000, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000,
         0.1494],
        [0.0000, 0.1098, 0.8975, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000, 0.6996,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000,
         0.2289],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000, 0.0000,
         0.5594],
        [0.6136, 0.8975, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.2117,
         0.0000],
        [0.0000, 0.4288, 0.4288, 0.0000, 0.6996, 0.0000, 0.0000, 0.2117, 0.0000,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.1494, 0.0000, 0.2289, 0.5594, 0.0000, 0.0000,
         0.0000]], device='cuda:0')
prefix log/lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4/
checkpoint_temp_path log/lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4//temp.pth
checkpoint_best_path log/lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4//best.pth
tensorboard_path log/lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4/
record_path log/lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4/record.txt
eps 0.1
parse <bound method DefaultConfig.parse of <config.DefaultConfig object at 0x7f0b58b53550>>
output <bound method DefaultConfig.output of <config.DefaultConfig object at 0x7f0b58b53550>>
train: True, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 9792
len(data): 9792, day_slot: 288, n_day: 34
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
10 10
epoch 0   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 1.6170725752325619 , validation loss: 0.9538293853402138
epoch 1   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 1.18430491288503 , validation loss: 0.9329777210950851
epoch 2   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.9600678507019492 , validation loss: 0.9938585385680199
epoch 3   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.7989886216088837 , validation loss: 0.9970621839165688
epoch 4   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.725710930777531 , validation loss: 1.0286623537540436
epoch 5   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.6950569889124703 , validation loss: 1.0482772663235664
epoch 6   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.6734977352852914 , validation loss: 1.0124970078468323
epoch 7   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.6553990186429491 , validation loss: 1.0069423168897629
epoch 8   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.6399711475652807 , validation loss: 1.009494587779045
epoch 9   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.6269880579967125 , validation loss: 0.9886049255728722
epoch 10   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.615044422009412 , validation loss: 1.0071991607546806
epoch 11   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.6040929497457018 , validation loss: 0.9688461050391197
epoch 12   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.5939932979789435 , validation loss: 0.9518288001418114
epoch 13   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.5847078585157207 , validation loss: 0.9538749605417252
epoch 14   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.5760679665733787 , validation loss: 0.9470212161540985
epoch 15   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.5680150787035624 , validation loss: 0.9262303858995438
epoch 16   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.5605608715730555 , validation loss: 0.9343088269233704
epoch 17   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.5536254106783399 , validation loss: 0.9142924845218658
epoch 18   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.5471711988542595 , validation loss: 0.922975666821003
epoch 19   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.5409841338793436 , validation loss: 0.9358761161565781
epoch 20   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.5351134491901771 , validation loss: 0.8968599289655685
epoch 21   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.5294699575386795 , validation loss: 0.8964419066905975
epoch 22   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.5238388659907323 , validation loss: 0.8857716917991638
epoch 23   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.5185910638640908 , validation loss: 0.9059403464198112
epoch 24   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.5133097060755187 , validation loss: 0.903632141649723
epoch 25   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.5083632580205506 , validation loss: 0.8834866583347321
epoch 26   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.5034832574573218 , validation loss: 0.8645239397883415
epoch 27   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.4986579184438668 , validation loss: 0.8365439102053642
epoch 28   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.49399833761009515 , validation loss: 0.8345690295100212
epoch 29   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.4893191450951146 , validation loss: 0.8353016451001167
epoch 30   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.4847150257989472 , validation loss: 0.8302218690514565
epoch 31   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.4799979282360451 , validation loss: 0.8268975093960762
epoch 32   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.47536182169820745 , validation loss: 0.7969415336847305
epoch 33   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.47028161556113 , validation loss: 0.8066012561321259
epoch 34   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.4650837907604143 , validation loss: 0.7806229516863823
epoch 35   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.45939357958587945 , validation loss: 0.784143790602684
epoch 36   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.4529393928892472 , validation loss: 0.7433989644050598
epoch 37   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.4459726752019396 , validation loss: 0.7380903288722038
epoch 38   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.439144792510014 , validation loss: 0.7260329276323318
epoch 39   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.433389345220491 , validation loss: 0.7148160040378571
epoch 40   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.428412072798785 , validation loss: 0.7091456353664398
epoch 41   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.4240809182325999 , validation loss: 0.7139716073870659
epoch 42   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.41994376276053635 , validation loss: 0.6970938146114349
epoch 43   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.4162298885046267 , validation loss: 0.6974532380700111
epoch 44   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.4128454386019239 , validation loss: 0.6849112138152122
epoch 45   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.40940435318385854 , validation loss: 0.6833114251494408
epoch 46   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.406309283247181 , validation loss: 0.6804691106081009
epoch 47   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.4034049224619772 , validation loss: 0.692295677959919
epoch 48   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.4003918691008699 , validation loss: 0.6744285002350807
epoch 49   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.397704833278469 , validation loss: 0.6739481389522552
epoch 50   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.39477993577134374 , validation loss: 0.6800364181399345
epoch 51   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.39210550866874994 , validation loss: 0.6760698482394218
epoch 52   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.389411645192726 , validation loss: 0.6779629737138748
epoch 53   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.3868328297839445 , validation loss: 0.6742366999387741
epoch 54   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.3845289846261342 , validation loss: 0.668245367705822
epoch 55   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.38206227152955297 , validation loss: 0.6608501672744751
epoch 56   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.3798065378385432 , validation loss: 0.6721661984920502
epoch 57   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.3774735477625155 , validation loss: 0.6597564220428467
epoch 58   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.375111356085422 , validation loss: 0.6542233824729919
epoch 59   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.3730970895757862 , validation loss: 0.6631159707903862
epoch 60   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.3706910931596569 , validation loss: 0.6596488729119301
epoch 61   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.3685325238050199 , validation loss: 0.6615191474556923
epoch 62   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.3666369371554431 , validation loss: 0.6600232347846031
epoch 63   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.36447455018174413 , validation loss: 0.659454308450222
epoch 64   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.3624564976084466 , validation loss: 0.6576784551143646
epoch 65   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.3605189189022663 , validation loss: 0.6568170040845871
epoch 66   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.3585065299389409 , validation loss: 0.6496292054653168
epoch 67   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.35646217418651954 , validation loss: 0.6548201888799667
epoch 68   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.3547131337371527 , validation loss: 0.6582254096865654
epoch 69   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.352748059758953 , validation loss: 0.6543742194771767
epoch 70   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.35102737242100285 , validation loss: 0.664484791457653
epoch 71   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.3491998735596152 , validation loss: 0.6488710343837738
epoch 72   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.3474627271586773 , validation loss: 0.6440585181117058
epoch 73   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.3457174084934534 , validation loss: 0.6500149592757225
epoch 74   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.34408245717777924 , validation loss: 0.6526358127593994
epoch 75   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.34238825592340205 , validation loss: 0.6446279808878899
epoch 76   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.3406646292583615 , validation loss: 0.6531358957290649
epoch 77   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.3390297100824468 , validation loss: 0.647353932261467
epoch 78   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.33756011724472046 , validation loss: 0.6558680534362793
epoch 79   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.3357894560870002 , validation loss: 0.6503427252173424
epoch 80   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.3341933798556234 , validation loss: 0.6450131013989449
epoch 81   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.3328055873805401 , validation loss: 0.6550678461790085
epoch 82   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.3312441437852149 , validation loss: 0.6471050828695297
epoch 83   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.3300059951987921 , validation loss: 0.6516433134675026
epoch 84   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.32826154664451 , validation loss: 0.6512759774923325
epoch 85   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.3268446741150875 , validation loss: 0.6443093121051788
epoch 86   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.32542192643763973 , validation loss: 0.6475521326065063
epoch 87   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.32399477502878976 , validation loss: 0.6467608511447906
epoch 88   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.32268407473377153 , validation loss: 0.6503142267465591
epoch 89   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.3213712158156376 , validation loss: 0.6401110216975212
epoch 90   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.3199731304365046 , validation loss: 0.6462312638759613
epoch 91   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.3186186388427136 , validation loss: 0.6444214060902596
epoch 92   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.3172662468517528 , validation loss: 0.6431339830160141
epoch 93   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.3159662543558607 , validation loss: 0.6474616080522537
epoch 94   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.3147192597389221 , validation loss: 0.6432066783308983
epoch 95   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.31336327627593397 , validation loss: 0.6347008720040321
epoch 96   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.3121725963611229 , validation loss: 0.6423584073781967
tensor(58.2536, device='cuda:0')
MAE: [0.30784137489686997, 0.3814030082387485, 0.429939457468074, 0.48121936492746714, 0.5249273883322849, 0.5404504001117552, 0.5412241334637109, 0.5401255440197348, 0.5676367313176701, 0.5864598433216361, 0.5927354183541514, 0.6193012884977398, 0.6404429290500546, 0.6539187876456753, 0.6525477937718411, 0.6418254042194061, 0.6478258215956697, 0.648401670185177, 0.6517395176289161, 0.6644341088608675, 0.68383311983774, 0.6932873610109475, 0.6825004898499428, 0.658144828461149, 0.6471169819126443, 0.6416685338529575, 0.6418921747169044, 0.6424167643391441, 0.646491850760487, 0.6550005813530579, 0.6493370150139114, 0.6432831936143338] , MAPE: [0.1510676656331304, 0.05788169677968551, 0.11992486080805037, 0.08451790193647876, 0.08052566210764518, 0.09390849287214523, 0.04556117604525949, 0.02370614622798496, -0.004916053364421217, 0.036665553712992946, 0.038597416382936456, 0.0245197689786677, 0.027074576150139504, 0.07491223747955429, 0.0012161578414330487, -0.032432964689425865, -0.021537947893177506, 0.00575217642778766, 0.018634110294368247, -0.04169241314152611, -0.031794183441496586, -0.01972159024773252, -0.05214478720333271, -0.09421138639411812, -0.05905611343037327, -0.030693354823388946, -0.07593992558139924, -0.10451219905799701, -0.11691507546505837, -0.04638258847286781, -0.08192782573055082, -0.19640183638152425] %, RMSE: [0.5780662153747219, 0.655449813475493, 0.6931752121228332, 0.7553973963611368, 0.8269847137730046, 0.8312532267322282, 0.8265871292747636, 0.8110575384138146, 0.8326849595698393, 0.828594211119587, 0.8180207677466512, 0.8519832263148428, 0.8907780563878904, 0.9015235695008722, 0.8862903997271329, 0.8692377020925883, 0.8687815325185264, 0.8565534488727659, 0.8511592117252684, 0.8699174131340085, 0.9028762084703049, 0.912046993083447, 0.8916295340975917, 0.8542102405358403, 0.8367412511063804, 0.8297889307354881, 0.8307746391313352, 0.8300466328433292, 0.8393661266165398, 0.8514205316437465, 0.839439633619807, 0.8325862957965878]
epoch 97   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.3109597587117962 , validation loss: 0.6391816586256027
tensor(58.0614, device='cuda:0')
MAE: [0.31102059842500185, 0.39292221810659106, 0.4375632069220517, 0.48341379973254905, 0.5268177662713012, 0.539911259257033, 0.5453083957693319, 0.5386708395325185, 0.5707987375134967, 0.5986672187931643, 0.6042062575270221, 0.621773394778102, 0.6311017376243991, 0.6332813821925023, 0.6355124814723877, 0.6162581876897705, 0.6258882790821192, 0.6394144772500107, 0.6427547811618862, 0.6447702302461125, 0.6573237513808399, 0.6651330391644049, 0.6503091976349962, 0.616532269041294, 0.6145679838244908, 0.6253212691628441, 0.6205005581231461, 0.6143255319719001, 0.6149338894681861, 0.6270381833674367, 0.6177931775655789, 0.6050580866631006] , MAPE: [0.14546607601432754, 0.051079408018224956, 0.15206776472316144, 0.10945440329765521, 0.084363073510781, 0.08732742138837642, 0.06146862130530224, 0.053780724135585746, 0.028782759284955862, 0.08726107814886605, 0.09909767262378082, 0.07162344508094788, 0.04951079544636366, 0.11052951776928727, 0.049978105078123766, 0.03515134389921495, 0.028099056937775008, 0.05317203214452074, 0.08864209923299735, 0.027056352138050774, 0.03134466584523439, 0.033746532554233856, 0.004188586185691091, -0.024585770251296615, -0.021898863650288328, -0.0027375743365918585, -0.022287737642386063, -0.08135397515877164, -0.0636251905716874, -0.032318466544008335, -0.04006741177185064, -0.16360927225026956] %, RMSE: [0.5781860258397941, 0.6693220965260485, 0.7065100470124421, 0.7603757941780774, 0.8257931114656555, 0.8307095358286363, 0.8412602410130176, 0.8163147035413236, 0.8450101539873759, 0.8608231054755717, 0.8532358046459777, 0.8680574397341498, 0.8841626905458331, 0.8833307979773614, 0.8782923011342717, 0.8485097816948239, 0.852844798287917, 0.8637054049618954, 0.8586423200611384, 0.8593998422751368, 0.8772962477585069, 0.887934379767989, 0.8667486988476585, 0.8163830688247657, 0.8121788073218121, 0.8325958113605888, 0.8278130180692391, 0.8158244989028051, 0.8155909024640348, 0.8368902747927535, 0.826574722646212, 0.8069403649674537]
epoch 98   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.3098006593246086 , validation loss: 0.6392171233892441
tensor(57.8676, device='cuda:0')
MAE: [0.3021952760653551, 0.38093094849863, 0.4305803356060672, 0.4757622485096115, 0.5196708100552181, 0.5364517727013216, 0.5379090693608387, 0.5448730698999824, 0.5677574385771739, 0.5848070358460981, 0.5955090932786158, 0.6131749598194183, 0.6265444909168657, 0.6289051323656722, 0.6296311793057728, 0.6215898604220567, 0.6300307338829776, 0.6340467895987952, 0.6372725655672323, 0.6421662275038045, 0.6524957124312821, 0.6606516784240405, 0.6512123662867996, 0.6271165835194904, 0.6182927694298403, 0.6200979937668698, 0.6203560362644878, 0.619139932206611, 0.61822999349152, 0.6233238143422016, 0.612935717276384, 0.6037942612801016] , MAPE: [0.13424114581273758, 0.05918310057784409, 0.1275001106246692, 0.09342923236320291, 0.09328924385530346, 0.10163579010855606, 0.07365490726421806, 0.06263244164371311, 0.016617955305036864, 0.07958702825381572, 0.08375220421031532, 0.06858516034389787, 0.055441341347117506, 0.12245287644996707, 0.057138910783939637, 0.03932609555288698, 0.02116238196532519, 0.0505676565876293, 0.07205187606436234, 0.017621193386743866, 0.02776198581609156, 0.02843441097670686, -0.009658468086224472, -0.03629030164595232, -0.022499235377295337, 0.009604518899852206, -0.03484699536244923, -0.0975754517846688, -0.08392900968060503, -0.03691885783977941, -0.07566528907600795, -0.2080821450765709] %, RMSE: [0.5693670334566902, 0.6541622157965012, 0.6951783875949507, 0.7527464812263659, 0.8223018533506379, 0.8275737402172868, 0.8265488893909273, 0.823814037284221, 0.8385062899169654, 0.8355892730088189, 0.8342865544802266, 0.855943745814707, 0.8810750706680163, 0.8779177961256495, 0.8717900168007331, 0.8634331303977973, 0.8636904287202976, 0.8558757308842568, 0.8513280274239817, 0.8613052591371743, 0.8792649761816755, 0.8876465106606881, 0.8731974861223945, 0.8380796977377126, 0.8234496437513656, 0.8276061689789151, 0.8299917445563588, 0.8296610776197423, 0.8288689566465165, 0.8391186525976057, 0.8263674972817241, 0.8140195940542992]
epoch 99   lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4 , train loss: 0.30843015920882133 , validation loss: 0.6378716602921486
tensor(57.6805, device='cuda:0')
MAE: [0.30072988158024694, 0.3827562786449592, 0.43606701013286475, 0.4838226812300224, 0.5171614235002048, 0.5244849202201999, 0.5243698954920178, 0.5277488890392994, 0.5460441327469481, 0.5574517514704506, 0.5752368905664105, 0.5957813788073608, 0.6060087355262763, 0.6120335759668006, 0.6101699969003496, 0.6039230420955063, 0.6128262824103351, 0.6258945241893075, 0.6371788580673411, 0.6397677317188726, 0.6442079532474817, 0.6533236996295679, 0.6415202248879929, 0.6206582799361846, 0.6199718812359593, 0.6302139845160172, 0.6356917212181484, 0.6324719462893212, 0.62194610169311, 0.6274670058942026, 0.6221847478857206, 0.6091509029562057] , MAPE: [0.14680988274609175, 0.06144901875323093, 0.14826563170044896, 0.10685760685146072, 0.07615262893775655, 0.10882902461714075, 0.06915896325817118, 0.07687793976675897, 0.04404270722247137, 0.10109159254300955, 0.11209645024737706, 0.06837444865544141, 0.0699939728937095, 0.1276192178073021, 0.06823893254061443, 0.04190951042384337, 0.04696216301124896, 0.07679422663801046, 0.108882624944732, 0.03769123045465062, 0.03154613549649831, 0.03846196301762041, -0.0035896209683392278, -0.04091956072694864, -0.018495246392892874, 0.002889696121133009, -0.017801836776352782, -0.08333492769360165, -0.06984327805076111, -0.030143814582051228, -0.056917660452543095, -0.14676925457807885] %, RMSE: [0.5660949460124837, 0.6591837154561443, 0.709161431457714, 0.7670863782489886, 0.8167505279505117, 0.8114498742023468, 0.8101189060795545, 0.8057370173529659, 0.8149810713277018, 0.8056069604066577, 0.8182208142373467, 0.8425053340577452, 0.8605807646768631, 0.8623418727841492, 0.851221693830972, 0.8452755835835697, 0.8475380652434514, 0.8531995082616475, 0.8578003373314393, 0.8634376265623932, 0.8691612169027527, 0.8759244585909907, 0.8594300558120973, 0.8334394789948407, 0.8316634178507758, 0.8458301773589684, 0.8538418335615919, 0.8469624252864092, 0.8305328011286994, 0.8362054954164738, 0.8312841627100764, 0.812822209346107]
test loss: NIL 
MAE: [0.30072988158024694, 0.3827562786449592, 0.43606701013286475, 0.4838226812300224, 0.5171614235002048, 0.5244849202201999, 0.5243698954920178, 0.5277488890392994, 0.5460441327469481, 0.5574517514704506, 0.5752368905664105, 0.5957813788073608, 0.6060087355262763, 0.6120335759668006, 0.6101699969003496, 0.6039230420955063, 0.6128262824103351, 0.6258945241893075, 0.6371788580673411, 0.6397677317188726, 0.6442079532474817, 0.6533236996295679, 0.6415202248879929, 0.6206582799361846, 0.6199718812359593, 0.6302139845160172, 0.6356917212181484, 0.6324719462893212, 0.62194610169311, 0.6274670058942026, 0.6221847478857206, 0.6091509029562057] , MAPE: [0.14680988274609175, 0.06144901875323093, 0.14826563170044896, 0.10685760685146072, 0.07615262893775655, 0.10882902461714075, 0.06915896325817118, 0.07687793976675897, 0.04404270722247137, 0.10109159254300955, 0.11209645024737706, 0.06837444865544141, 0.0699939728937095, 0.1276192178073021, 0.06823893254061443, 0.04190951042384337, 0.04696216301124896, 0.07679422663801046, 0.108882624944732, 0.03769123045465062, 0.03154613549649831, 0.03846196301762041, -0.0035896209683392278, -0.04091956072694864, -0.018495246392892874, 0.002889696121133009, -0.017801836776352782, -0.08333492769360165, -0.06984327805076111, -0.030143814582051228, -0.056917660452543095, -0.14676925457807885] %, RMSE: [0.5660949460124837, 0.6591837154561443, 0.709161431457714, 0.7670863782489886, 0.8167505279505117, 0.8114498742023468, 0.8101189060795545, 0.8057370173529659, 0.8149810713277018, 0.8056069604066577, 0.8182208142373467, 0.8425053340577452, 0.8605807646768631, 0.8623418727841492, 0.851221693830972, 0.8452755835835697, 0.8475380652434514, 0.8531995082616475, 0.8578003373314393, 0.8634376265623932, 0.8691612169027527, 0.8759244585909907, 0.8594300558120973, 0.8334394789948407, 0.8316634178507758, 0.8458301773589684, 0.8538418335615919, 0.8469624252864092, 0.8305328011286994, 0.8362054954164738, 0.8312841627100764, 0.812822209346107]
====================
training elapsedd with 311.51 seconds for 100 iterations, the sec/iter = 3.12

MAE_mean: [0.30072988 0.38275628 0.43606701 0.48382268 0.51716142 0.52448492
 0.5243699  0.52774889 0.54604413 0.55745175 0.57523689 0.59578138
 0.60600874 0.61203358 0.61017    0.60392304 0.61282628 0.62589452
 0.63717886 0.63976773 0.64420795 0.6533237  0.64152022 0.62065828
 0.61997188 0.63021398 0.63569172 0.63247195 0.6219461  0.62746701
 0.62218475 0.6091509 ] , MAPE_mean: [ 0.14680988  0.06144902  0.14826563  0.10685761  0.07615263  0.10882902
  0.06915896  0.07687794  0.04404271  0.10109159  0.11209645  0.06837445
  0.06999397  0.12761922  0.06823893  0.04190951  0.04696216  0.07679423
  0.10888262  0.03769123  0.03154614  0.03846196 -0.00358962 -0.04091956
 -0.01849525  0.0028897  -0.01780184 -0.08333493 -0.06984328 -0.03014381
 -0.05691766 -0.14676925] , RMSE_mean: [0.56609495 0.65918372 0.70916143 0.76708638 0.81675053 0.81144987
 0.81011891 0.80573702 0.81498107 0.80560696 0.81822081 0.84250533
 0.86058076 0.86234187 0.85122169 0.84527558 0.84753807 0.85319951
 0.85780034 0.86343763 0.86916122 0.87592446 0.85943006 0.83343948
 0.83166342 0.84583018 0.85384183 0.84696243 0.8305328  0.8362055
 0.83128416 0.81282221]

MAE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , MAPE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , RMSE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
Finished training with: lr1e-4_bs64_nh64_ra1e-4_dp0.1_wd1e-4_ah4_ck3_kt4
user config:
seed 666
device 0
scaler StandardScaler()
day_slot 288
n_route 10
n_his 96
n_pred 96
n_train 34
n_val 5
n_test 5
mode 1
n_c 10
model STAGNN_stamp
TPG TPGNN
name lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6
log_path log/TPGNN_r05p02kt3outer_353
crash 353
new_name TPGNN_r05p02kt3outer_353
batch_size 64
lr 0.0001
a 0.1
r 0.5
n_mask 1
adam {'use': True, 'weight_decay': 0.0001}
slr {'use': True, 'step_size': 400, 'gamma': 0.3}
resume False
start_epoch 0
epochs 100
n_layer 1
n_attr 64
n_hid 64
reg_A 0.001
circle 288
drop_prob 0.2
CE {'use': True, 'kernel_size': 1, 'bias': False}
LE {'use': False, 'bias': False}
SE {'use': True, 'separate': True, 'no': False}
TE {'use': True, 'no': True}
attn {'head': 1, 'd_k': 32, 'd_v': 32, 'drop_prob': 0.2}
STstamp {'use': True, 'kt': 3, 'temperature': 1.0}
T4N {'use': True, 'step': 2, 'end_epoch': 10000, 'change_head': True, 'change_enc': True}
stamp_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/time_stamp_F_96.npy
data_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/V_France_processed_0.csv
adj_matrix_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/W_France_processed_0.csv
dis_mat tensor([[0.0000, 0.3661, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.6136, 0.0000,
         0.0000],
        [0.3661, 0.0000, 0.0000, 0.0000, 0.1098, 0.0000, 0.0000, 0.8975, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.3410, 0.8975, 0.0000, 0.0000, 0.0000, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.3410, 0.0000, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000,
         0.1494],
        [0.0000, 0.1098, 0.8975, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000, 0.6996,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000,
         0.2289],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000, 0.0000,
         0.5594],
        [0.6136, 0.8975, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.2117,
         0.0000],
        [0.0000, 0.4288, 0.4288, 0.0000, 0.6996, 0.0000, 0.0000, 0.2117, 0.0000,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.1494, 0.0000, 0.2289, 0.5594, 0.0000, 0.0000,
         0.0000]], device='cuda:0')
prefix log/lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6/
checkpoint_temp_path log/lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6//temp.pth
checkpoint_best_path log/lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6//best.pth
tensorboard_path log/lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6/
record_path log/lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6/record.txt
eps 0.1
parse <bound method DefaultConfig.parse of <config.DefaultConfig object at 0x7ff6056d5550>>
output <bound method DefaultConfig.output of <config.DefaultConfig object at 0x7ff6056d5550>>
train: True, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 9792
len(data): 9792, day_slot: 288, n_day: 34
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
10 10
epoch 0   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 3.7741263800976323 , validation loss: 0.9602443128824234
epoch 1   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 3.3086545233633005 , validation loss: 0.9308628514409065
epoch 2   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 3.056182169446758 , validation loss: 0.9873497113585472
epoch 3   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 2.8631102197310505 , validation loss: 0.9878909885883331
epoch 4   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 2.7534959736992333 , validation loss: 1.017220325767994
epoch 5   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 2.688569419524249 , validation loss: 1.0392199605703354
epoch 6   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 2.634283837150125 , validation loss: 1.025292158126831
epoch 7   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 2.5846160206140256 , validation loss: 1.0243394896388054
epoch 8   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 2.538582544700772 , validation loss: 1.0290041640400887
epoch 9   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 2.495156381644455 , validation loss: 1.0017914399504662
epoch 10   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 2.453743574666042 , validation loss: 0.9989971145987511
epoch 11   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 2.4138970562056 , validation loss: 0.9784934371709824
epoch 12   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 2.375250395606546 , validation loss: 0.9588900953531265
epoch 13   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 2.3378576203888537 , validation loss: 0.9639326557517052
epoch 14   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 2.3015482285443474 , validation loss: 0.9604124054312706
epoch 15   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 2.266281899283914 , validation loss: 0.9493083134293556
epoch 16   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 2.232092721789491 , validation loss: 0.9523287415504456
epoch 17   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 2.199150108823589 , validation loss: 0.9320265427231789
epoch 18   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 2.1669357150208715 , validation loss: 0.9353408589959145
epoch 19   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 2.1356493818993663 , validation loss: 0.9491080865263939
epoch 20   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 2.105129363490086 , validation loss: 0.9251384884119034
epoch 21   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 2.0752977015925387 , validation loss: 0.9219012260437012
epoch 22   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 2.0461619134042777 , validation loss: 0.9240111634135246
epoch 23   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 2.0177162535050335 , validation loss: 0.9177396148443222
epoch 24   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.9898808540082444 , validation loss: 0.9348596557974815
epoch 25   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.9626902669083839 , validation loss: 0.9180030003190041
epoch 26   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.936118714949664 , validation loss: 0.8988269418478012
epoch 27   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.909928934246886 , validation loss: 0.8932573646306992
epoch 28   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.8844700677722108 , validation loss: 0.8786701634526253
epoch 29   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.8594696217892217 , validation loss: 0.9124359339475632
epoch 30   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.8347298724978578 , validation loss: 0.8695666566491127
epoch 31   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.8107099626578538 , validation loss: 0.8683202043175697
epoch 32   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.7868645682054407 , validation loss: 0.8423237949609756
epoch 33   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.7634781412049836 , validation loss: 0.857346385717392
epoch 34   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.7404548257004981 , validation loss: 0.831896111369133
epoch 35   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.7177267097959332 , validation loss: 0.8433037102222443
epoch 36   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.6954737106959026 , validation loss: 0.8234048262238503
epoch 37   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.6729419278163535 , validation loss: 0.8039241507649422
epoch 38   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.6507518875832652 , validation loss: 0.8024029582738876
epoch 39   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.6287376506655824 , validation loss: 0.7803591713309288
epoch 40   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.6061540000578935 , validation loss: 0.7702977284789085
epoch 41   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.583671438927744 , validation loss: 0.7840326204895973
epoch 42   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.5601871037015729 , validation loss: 0.7499165385961533
epoch 43   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.53792512884327 , validation loss: 0.7407305389642715
epoch 44   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.5169033092610977 , validation loss: 0.7237633243203163
epoch 45   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.496468422459621 , validation loss: 0.7196160331368446
epoch 46   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.4771571860593908 , validation loss: 0.7121720239520073
epoch 47   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.4582857571396173 , validation loss: 0.7209836691617966
epoch 48   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.4398192658143885 , validation loss: 0.7115393504500389
epoch 49   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.421849437788421 , validation loss: 0.6938491314649582
epoch 50   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.4040712725882436 , validation loss: 0.7033030465245247
epoch 51   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.386903120022194 , validation loss: 0.6919079571962357
epoch 52   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.3698377048268038 , validation loss: 0.6977556347846985
epoch 53   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.353211996602077 , validation loss: 0.6913093701004982
epoch 54   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.3369090931088317 , validation loss: 0.6907616853713989
epoch 55   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.3208384817721797 , validation loss: 0.6786780133843422
epoch 56   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.3050526403913312 , validation loss: 0.6881718635559082
epoch 57   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.2895383343977087 , validation loss: 0.6824775263667107
epoch 58   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.274292176845027 , validation loss: 0.6727220043540001
epoch 59   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.2592598620583029 , validation loss: 0.6810461133718491
epoch 60   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.2445999290428909 , validation loss: 0.6673354059457779
epoch 61   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.2298419288560456 , validation loss: 0.6807546615600586
epoch 62   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.2156363234800451 , validation loss: 0.6725200191140175
epoch 63   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.2013958435432583 , validation loss: 0.6691661179065704
epoch 64   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.1875851668563544 , validation loss: 0.6677182540297508
epoch 65   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.174012174793318 , validation loss: 0.6721101254224777
epoch 66   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.1605094460880054 , validation loss: 0.6617270037531853
epoch 67   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.1471008786968155 , validation loss: 0.6647583916783333
epoch 68   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.1341753356597002 , validation loss: 0.6670329719781876
epoch 69   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.1212623259600472 , validation loss: 0.6658987700939178
epoch 70   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.1086421340119605 , validation loss: 0.6765355244278908
epoch 71   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.0960001080643897 , validation loss: 0.66646708548069
epoch 72   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.083847585846396 , validation loss: 0.6533511057496071
epoch 73   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.0716706771476596 , validation loss: 0.6652950420975685
epoch 74   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.0597152943704642 , validation loss: 0.6636244207620621
epoch 75   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.0478722979040707 , validation loss: 0.6579603850841522
epoch 76   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.0362496633155673 , validation loss: 0.6655643060803413
epoch 77   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.0249553685094797 , validation loss: 0.6556679531931877
epoch 78   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.0138409932454426 , validation loss: 0.6622939109802246
epoch 79   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 1.0023426752464444 , validation loss: 0.6542737931013107
epoch 80   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 0.9915587060591754 , validation loss: 0.6537009477615356
epoch 81   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 0.9808428941988477 , validation loss: 0.6515075042843819
epoch 82   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 0.9701944297435237 , validation loss: 0.6541629731655121
epoch 83   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 0.9598855843731001 , validation loss: 0.6617869138717651
epoch 84   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 0.9493119424464656 , validation loss: 0.6535665467381477
epoch 85   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 0.9393213905540168 , validation loss: 0.6500619277358055
epoch 86   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 0.9292679686172336 , validation loss: 0.6536507904529572
epoch 87   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 0.9193443959834529 , validation loss: 0.6525200232863426
epoch 88   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 0.9095273520432267 , validation loss: 0.6569274291396141
epoch 89   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 0.900008007591846 , validation loss: 0.6429324150085449
epoch 90   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 0.890453065142912 , validation loss: 0.6504597514867783
epoch 91   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 0.8810908151607887 , validation loss: 0.6438560485839844
epoch 92   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 0.87184512498332 , validation loss: 0.645237036049366
epoch 93   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 0.8628451812501047 , validation loss: 0.6411062106490135
epoch 94   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 0.8538493630932826 , validation loss: 0.6439881026744843
epoch 95   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 0.8449228405952454 , validation loss: 0.6413716301321983
epoch 96   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 0.8361712308490977 , validation loss: 0.6410659924149513
tensor(58.5346, device='cuda:0')
MAE: [0.312671394678308, 0.3836648597700771, 0.43277012888457356, 0.4857381270722169, 0.5262026192234426, 0.5383333075150233, 0.5369426648842036, 0.5340777043936793, 0.5613786471555413, 0.5742442450023343, 0.5814360459310185, 0.6081931064861644, 0.6265536177442553, 0.6412046456614452, 0.6351734698890257, 0.6213971304947261, 0.6346909543687536, 0.6353307265454192, 0.6434120404966098, 0.6560478607461471, 0.6667446648064501, 0.6761627087482857, 0.6718098820214035, 0.6441028466352176, 0.6306007914513964, 0.6310131414362335, 0.6327749227697855, 0.6308643702521306, 0.624538400870239, 0.6349133715663374, 0.6333295402157398, 0.6200751681203387] , MAPE: [0.12403617884144681, 0.05289287716256723, 0.12102263645649727, 0.10324788283823735, 0.0826372913843604, 0.09523308806109648, 0.06293134613939795, 0.04161648403690257, 0.0073853943657179785, 0.05770747973150682, 0.06918342883692416, 0.08539913964940574, 0.07161962792440557, 0.09335561460653799, 0.02954089312328862, 0.012609173785307033, 0.04534051772263429, 0.04817472810260557, 0.05889279334183774, 0.04008424244616145, 0.020813609308193523, 0.00505916587120887, -0.003722485312843964, -0.05969543692964602, -0.031166183014133868, -0.010571723249020804, -0.028240865104289133, -0.05391074469950309, -0.05599324707707544, -0.012762361210381792, -0.03429042959116224, -0.17317437053626863] %, RMSE: [0.5899997215890472, 0.6598666955030237, 0.6968760528609738, 0.76712967984546, 0.8360403287491212, 0.8362998214097819, 0.8248510380168054, 0.8079069841329106, 0.8277125448433925, 0.8160399761637852, 0.8112632477837116, 0.8472285919841733, 0.8764951407713885, 0.8884427005031541, 0.8667550887808019, 0.8443806899658871, 0.8509210677677308, 0.840016176728468, 0.8436975155754364, 0.8644964544872128, 0.884429706508613, 0.893295055341588, 0.8790965782891638, 0.8370704489707039, 0.8159920222350909, 0.8196040362464572, 0.8248664427164587, 0.8180796486272041, 0.8153668200412145, 0.83332442443332, 0.827743608592499, 0.8148777963582969]
epoch 97   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 0.8276337128059537 , validation loss: 0.6376578882336617
tensor(58.3478, device='cuda:0')
MAE: [0.30818445821023865, 0.38426347988062376, 0.42345234135377036, 0.48824006139435183, 0.5298759495626328, 0.5398653497047645, 0.538604857622617, 0.5297519437530913, 0.5592823094070034, 0.5736984779167268, 0.5743878340525265, 0.6051698333096028, 0.6256285864879982, 0.6299690977641449, 0.6300680520174275, 0.6188573142089256, 0.6299462447120548, 0.6240625547366121, 0.6276813664124107, 0.6415305957532267, 0.64551935715236, 0.6461415430368644, 0.63541675279301, 0.6054033174703723, 0.5987224650050792, 0.6068350446243416, 0.6053091726605733, 0.6116000696686432, 0.6066176265501178, 0.6131668833931236, 0.6073647136290165, 0.5881935628972103] , MAPE: [0.12333847890150453, 0.04988675566268434, 0.13418725737363724, 0.11583482467775838, 0.09487703794722695, 0.0876690601062413, 0.07895717529497186, 0.07391799756232041, 0.03888185952064586, 0.09989129532060163, 0.11519144224975686, 0.12273360194942612, 0.10693587221906202, 0.14685081996832786, 0.09419609786290147, 0.07723908902771805, 0.07070439666595439, 0.10528356737768282, 0.13007111867095258, 0.11132716592080824, 0.09118703906643973, 0.09431673297886593, 0.05772388617464608, 0.004762632009626087, 0.015893470405049792, 0.030890527960817746, 0.007296331221444506, -0.03261769714279187, -0.02969723743303756, 0.0007347999688852386, -0.0033930047223891717, -0.14126074146773107] %, RMSE: [0.5802378793239209, 0.6646202993704112, 0.6869099972185795, 0.7774962658889772, 0.842721428209673, 0.8468552269175824, 0.8388245482682193, 0.8106130984031563, 0.8362877268373715, 0.8328635265813551, 0.817900403633835, 0.8547708419409851, 0.8877182775529547, 0.8919930197113026, 0.8825642851942187, 0.862589187021844, 0.8665138361603307, 0.846847893754764, 0.8418395975865192, 0.8654925035579242, 0.8742534093686655, 0.8759928569659261, 0.8574526239987412, 0.8150863787209843, 0.8034768295307859, 0.8202111495572827, 0.8177456204308481, 0.8209387788140636, 0.8212901586195788, 0.83850652847223, 0.8303887164929821, 0.807677966188759]
epoch 98   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 0.8193438310249179 , validation loss: 0.6429174244403839
tensor(58.1608, device='cuda:0')
MAE: [0.3078232417393898, 0.38614516194794596, 0.428637351160869, 0.4785281860885047, 0.5232103745710374, 0.5383548900888292, 0.5391514016286537, 0.5393764632913409, 0.5702866195364058, 0.5848735995640614, 0.5915375194919401, 0.6118474532156876, 0.6262541413729645, 0.6282219325059776, 0.6265835942699545, 0.6145942274665402, 0.6327249503447723, 0.6322361249530438, 0.6312448270313595, 0.6376618977052342, 0.6457293063778545, 0.6521646317209779, 0.6491929229987382, 0.6250736970531264, 0.616000035200076, 0.6225076508936809, 0.6170715558997442, 0.620805417986337, 0.6128312188300505, 0.6185340685739191, 0.6112138601392507, 0.5920491421864051] , MAPE: [0.1168360308198489, 0.04062786512238435, 0.12842440458271925, 0.09826834779987714, 0.09011731737542336, 0.0990334137254321, 0.08151002153920907, 0.0769376611483365, 0.02350932565284293, 0.09915843356426532, 0.11006872234830019, 0.11301684713275312, 0.09382249277704648, 0.1337262488498842, 0.0850285486256648, 0.07049351642165722, 0.07444346238855397, 0.10050459700170604, 0.10675303891442774, 0.0950233102235529, 0.07298206840763012, 0.07863339851538953, 0.03498599665868336, -0.010755097049308854, 0.013281440708762846, 0.036219283415726354, 0.004472352296979432, -0.03479675868322674, -0.04603276664204536, -0.016131643240999242, -0.027096010386300533, -0.14311184751519757] %, RMSE: [0.5833713752730849, 0.6680979301290488, 0.6919398770908253, 0.75776409433412, 0.8316214861892852, 0.8409784317175633, 0.8336548277452597, 0.8188938108583872, 0.8451564874894224, 0.842859550753917, 0.8359642290244685, 0.8597776472708057, 0.8847091828643217, 0.8845603507725474, 0.8747283705767047, 0.8568295191549954, 0.8685929485979066, 0.8556907672890842, 0.8444601369889435, 0.8584063327906504, 0.8750776045711787, 0.8846924692388751, 0.8768166733130356, 0.841639963102258, 0.8251003677394807, 0.8369640857061261, 0.829760988834499, 0.8325466426109864, 0.8280992051733659, 0.8430206583204415, 0.8327743467612808, 0.8109339045637549]
epoch 99   lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6 , train loss: 0.8107347523464876 , validation loss: 0.6385680437088013
tensor(57.9739, device='cuda:0')
MAE: [0.3112356893525977, 0.3901128289390586, 0.4377716162619805, 0.48551844399124766, 0.5179696871995081, 0.5265336011112044, 0.5226027065534721, 0.5232975452310723, 0.5445072996856395, 0.5530262015279882, 0.568222427032888, 0.588411717217454, 0.5993104166385823, 0.6107992412384177, 0.6084640456344357, 0.6047558542748087, 0.6235006055473974, 0.6330495677346882, 0.639296448934708, 0.6444118567621432, 0.6418616876779029, 0.6487317200446713, 0.6397990316609593, 0.6167830328988968, 0.6176203926838935, 0.6287989358692286, 0.6353600503963217, 0.6419071415133928, 0.6218437116854277, 0.6239475403134663, 0.6201849082361945, 0.6060491565338423] , MAPE: [0.124106556585328, 0.0494789791056366, 0.13507407282775846, 0.10951537658436435, 0.0908390043048877, 0.09835063136962079, 0.07301588084378889, 0.08579160838598834, 0.04044694755269279, 0.09838554709922935, 0.11811106716659815, 0.10252361211687908, 0.08046127367137029, 0.13587481189968026, 0.09319943417271434, 0.08677641867791254, 0.07642127238630171, 0.11476897446087773, 0.11761899908947862, 0.07934535052094455, 0.05724082036749772, 0.058517721691648907, 0.033149779054003806, -0.023529976012791897, -0.013320383139833155, 0.00755065223198959, 0.0002663264270828672, -0.030985327978863275, -0.03370504085778333, -0.005246520948508688, -0.017077781781668237, -0.09134507863572319] %, RMSE: [0.586319947956171, 0.6722351700417467, 0.7067035557654312, 0.766895358447922, 0.8196698035461129, 0.8196898967591075, 0.8053148315908538, 0.7975220130544187, 0.8094986218927666, 0.7992358087173784, 0.809350490068017, 0.8317527684175627, 0.8499620875928415, 0.8623841327049541, 0.8502805202827939, 0.8452741511407942, 0.8597404150706205, 0.8620203700046963, 0.8571748741550245, 0.8645803273511353, 0.8623094751271931, 0.869853629389328, 0.8549339685890475, 0.8257560895993925, 0.8270771023847987, 0.8457061932471559, 0.8540512018567049, 0.8555547136283081, 0.8289062655069946, 0.8357610688737913, 0.8330715537041077, 0.8182619837851641]
test loss: NIL 
MAE: [0.3112356893525977, 0.3901128289390586, 0.4377716162619805, 0.48551844399124766, 0.5179696871995081, 0.5265336011112044, 0.5226027065534721, 0.5232975452310723, 0.5445072996856395, 0.5530262015279882, 0.568222427032888, 0.588411717217454, 0.5993104166385823, 0.6107992412384177, 0.6084640456344357, 0.6047558542748087, 0.6235006055473974, 0.6330495677346882, 0.639296448934708, 0.6444118567621432, 0.6418616876779029, 0.6487317200446713, 0.6397990316609593, 0.6167830328988968, 0.6176203926838935, 0.6287989358692286, 0.6353600503963217, 0.6419071415133928, 0.6218437116854277, 0.6239475403134663, 0.6201849082361945, 0.6060491565338423] , MAPE: [0.124106556585328, 0.0494789791056366, 0.13507407282775846, 0.10951537658436435, 0.0908390043048877, 0.09835063136962079, 0.07301588084378889, 0.08579160838598834, 0.04044694755269279, 0.09838554709922935, 0.11811106716659815, 0.10252361211687908, 0.08046127367137029, 0.13587481189968026, 0.09319943417271434, 0.08677641867791254, 0.07642127238630171, 0.11476897446087773, 0.11761899908947862, 0.07934535052094455, 0.05724082036749772, 0.058517721691648907, 0.033149779054003806, -0.023529976012791897, -0.013320383139833155, 0.00755065223198959, 0.0002663264270828672, -0.030985327978863275, -0.03370504085778333, -0.005246520948508688, -0.017077781781668237, -0.09134507863572319] %, RMSE: [0.586319947956171, 0.6722351700417467, 0.7067035557654312, 0.766895358447922, 0.8196698035461129, 0.8196898967591075, 0.8053148315908538, 0.7975220130544187, 0.8094986218927666, 0.7992358087173784, 0.809350490068017, 0.8317527684175627, 0.8499620875928415, 0.8623841327049541, 0.8502805202827939, 0.8452741511407942, 0.8597404150706205, 0.8620203700046963, 0.8571748741550245, 0.8645803273511353, 0.8623094751271931, 0.869853629389328, 0.8549339685890475, 0.8257560895993925, 0.8270771023847987, 0.8457061932471559, 0.8540512018567049, 0.8555547136283081, 0.8289062655069946, 0.8357610688737913, 0.8330715537041077, 0.8182619837851641]
====================
training elapsedd with 309.94 seconds for 100 iterations, the sec/iter = 3.10

MAE_mean: [0.31123569 0.39011283 0.43777162 0.48551844 0.51796969 0.5265336
 0.52260271 0.52329755 0.5445073  0.5530262  0.56822243 0.58841172
 0.59931042 0.61079924 0.60846405 0.60475585 0.62350061 0.63304957
 0.63929645 0.64441186 0.64186169 0.64873172 0.63979903 0.61678303
 0.61762039 0.62879894 0.63536005 0.64190714 0.62184371 0.62394754
 0.62018491 0.60604916] , MAPE_mean: [ 0.12410656  0.04947898  0.13507407  0.10951538  0.090839    0.09835063
  0.07301588  0.08579161  0.04044695  0.09838555  0.11811107  0.10252361
  0.08046127  0.13587481  0.09319943  0.08677642  0.07642127  0.11476897
  0.117619    0.07934535  0.05724082  0.05851772  0.03314978 -0.02352998
 -0.01332038  0.00755065  0.00026633 -0.03098533 -0.03370504 -0.00524652
 -0.01707778 -0.09134508] , RMSE_mean: [0.58631995 0.67223517 0.70670356 0.76689536 0.8196698  0.8196899
 0.80531483 0.79752201 0.80949862 0.79923581 0.80935049 0.83175277
 0.84996209 0.86238413 0.85028052 0.84527415 0.85974042 0.86202037
 0.85717487 0.86458033 0.86230948 0.86985363 0.85493397 0.82575609
 0.8270771  0.84570619 0.8540512  0.85555471 0.82890627 0.83576107
 0.83307155 0.81826198]

MAE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , MAPE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , RMSE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
Finished training with: lr1e-4_bs64_nh64_ra1e-3_dp0.2_wd1e-5_ah4_ck1_kt6
user config:
seed 666
device 0
scaler StandardScaler()
day_slot 288
n_route 10
n_his 96
n_pred 96
n_train 34
n_val 5
n_test 5
mode 1
n_c 10
model STAGNN_stamp
TPG TPGNN
name lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6
log_path log/TPGNN_r05p02kt3outer_354
crash 354
new_name TPGNN_r05p02kt3outer_354
batch_size 64
lr 0.0001
a 0.1
r 0.5
n_mask 1
adam {'use': True, 'weight_decay': 0.0001}
slr {'use': True, 'step_size': 400, 'gamma': 0.3}
resume False
start_epoch 0
epochs 100
n_layer 1
n_attr 64
n_hid 64
reg_A 0.001
circle 288
drop_prob 0.3
CE {'use': True, 'kernel_size': 1, 'bias': False}
LE {'use': False, 'bias': False}
SE {'use': True, 'separate': True, 'no': False}
TE {'use': True, 'no': True}
attn {'head': 1, 'd_k': 32, 'd_v': 32, 'drop_prob': 0.2}
STstamp {'use': True, 'kt': 3, 'temperature': 1.0}
T4N {'use': True, 'step': 2, 'end_epoch': 10000, 'change_head': True, 'change_enc': True}
stamp_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/time_stamp_F_96.npy
data_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/V_France_processed_0.csv
adj_matrix_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/W_France_processed_0.csv
dis_mat tensor([[0.0000, 0.3661, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.6136, 0.0000,
         0.0000],
        [0.3661, 0.0000, 0.0000, 0.0000, 0.1098, 0.0000, 0.0000, 0.8975, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.3410, 0.8975, 0.0000, 0.0000, 0.0000, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.3410, 0.0000, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000,
         0.1494],
        [0.0000, 0.1098, 0.8975, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000, 0.6996,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000,
         0.2289],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000, 0.0000,
         0.5594],
        [0.6136, 0.8975, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.2117,
         0.0000],
        [0.0000, 0.4288, 0.4288, 0.0000, 0.6996, 0.0000, 0.0000, 0.2117, 0.0000,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.1494, 0.0000, 0.2289, 0.5594, 0.0000, 0.0000,
         0.0000]], device='cuda:0')
prefix log/lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6/
checkpoint_temp_path log/lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6//temp.pth
checkpoint_best_path log/lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6//best.pth
tensorboard_path log/lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6/
record_path log/lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6/record.txt
eps 0.1
parse <bound method DefaultConfig.parse of <config.DefaultConfig object at 0x7fa666c55550>>
output <bound method DefaultConfig.output of <config.DefaultConfig object at 0x7fa666c55550>>
train: True, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 9792
len(data): 9792, day_slot: 288, n_day: 34
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
10 10
epoch 0   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 3.7901181940938913 , validation loss: 0.9563765972852707
epoch 1   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 3.3268475205290553 , validation loss: 0.9312080144882202
epoch 2   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 3.0794875528298173 , validation loss: 0.9833678677678108
epoch 3   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 2.887923385582718 , validation loss: 0.9831566289067268
epoch 4   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 2.7749817137624704 , validation loss: 1.0083043724298477
epoch 5   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 2.7078500448488723 , validation loss: 1.024967074394226
epoch 6   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 2.6519746967390474 , validation loss: 1.0267912298440933
epoch 7   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 2.601265888588101 , validation loss: 1.0367421582341194
epoch 8   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 2.5542105880438113 , validation loss: 1.0324194729328156
epoch 9   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 2.509823719660441 , validation loss: 1.0004623159766197
epoch 10   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 2.46758313740001 , validation loss: 0.9943811446428299
epoch 11   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 2.4269684810264436 , validation loss: 0.9939219728112221
epoch 12   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 2.387699328216852 , validation loss: 0.9682597666978836
epoch 13   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 2.3497761137345257 , validation loss: 0.9751296788454056
epoch 14   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 2.3129610641329896 , validation loss: 0.9705565422773361
epoch 15   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 2.277076795989392 , validation loss: 0.956474557518959
epoch 16   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 2.2422039275075876 , validation loss: 0.9636694490909576
epoch 17   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 2.2086007688559737 , validation loss: 0.9524118155241013
epoch 18   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 2.175943977692548 , validation loss: 0.9515168145298958
epoch 19   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 2.14417056943856 , validation loss: 0.9494564235210419
epoch 20   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 2.1133147781970454 , validation loss: 0.9320449978113174
epoch 21   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 2.0830865841285857 , validation loss: 0.9418051019310951
epoch 22   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 2.053677993662217 , validation loss: 0.943520687520504
epoch 23   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 2.0249702346091176 , validation loss: 0.9316154345870018
epoch 24   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.9968108663371964 , validation loss: 0.9381224438548088
epoch 25   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.9693936226414699 , validation loss: 0.9325784519314766
epoch 26   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.9427490912231744 , validation loss: 0.9197384417057037
epoch 27   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.91628874984442 , validation loss: 0.9125866666436195
epoch 28   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.8906262084549548 , validation loss: 0.9116506054997444
epoch 29   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.8654936739042693 , validation loss: 0.9321345686912537
epoch 30   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.8407372516744278 , validation loss: 0.9073382467031479
epoch 31   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.8165852158677345 , validation loss: 0.9048905447125435
epoch 32   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.7927867150774188 , validation loss: 0.87886893004179
epoch 33   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.7695113069870894 , validation loss: 0.8901660591363907
epoch 34   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.7466628083995743 , validation loss: 0.8694280534982681
epoch 35   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.7241436757293402 , validation loss: 0.8802431896328926
epoch 36   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.7020398168002857 , validation loss: 0.8590529635548592
epoch 37   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.6802466663659787 , validation loss: 0.8466344773769379
epoch 38   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.658765711036383 , validation loss: 0.8462624475359917
epoch 39   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.6376841278637158 , validation loss: 0.8208286464214325
epoch 40   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.6168436489853204 , validation loss: 0.8224685862660408
epoch 41   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.5963782843421488 , validation loss: 0.8243981003761292
epoch 42   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.575480757975111 , validation loss: 0.7987780943512917
epoch 43   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.5549524671891157 , validation loss: 0.7949690073728561
epoch 44   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.5345113324184043 , validation loss: 0.787726454436779
epoch 45   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.5134062977398144 , validation loss: 0.7817888259887695
epoch 46   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.4924654399647432 , validation loss: 0.7654528692364693
epoch 47   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.470922778634464 , validation loss: 0.7784101441502571
epoch 48   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.4502910609338797 , validation loss: 0.7517320439219475
epoch 49   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.4306933879852295 , validation loss: 0.7192009463906288
epoch 50   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.4118827254164452 , validation loss: 0.7399228736758232
epoch 51   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.3938347872565775 , validation loss: 0.7131172940135002
epoch 52   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.3762935680501602 , validation loss: 0.727943167090416
epoch 53   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.3592526094586241 , validation loss: 0.711053729057312
epoch 54   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.3424603378071505 , validation loss: 0.7112453430891037
epoch 55   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.3260725082135667 , validation loss: 0.703806683421135
epoch 56   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.3098969693277396 , validation loss: 0.7066275030374527
epoch 57   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.2940551650290395 , validation loss: 0.6920898109674454
epoch 58   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.2785681369257909 , validation loss: 0.6877728030085564
epoch 59   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.2634417800342335 , validation loss: 0.6969166547060013
epoch 60   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.2484385967254639 , validation loss: 0.6839712485671043
epoch 61   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.2335857293185066 , validation loss: 0.693235881626606
epoch 62   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.2191647828793992 , validation loss: 0.6825606301426888
epoch 63   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.2048863008910535 , validation loss: 0.6785313561558723
epoch 64   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.1907500449348898 , validation loss: 0.6819326654076576
epoch 65   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.1770376224143833 , validation loss: 0.6801061108708382
epoch 66   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.1634011455610687 , validation loss: 0.6741973087191582
epoch 67   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.1499375619140326 , validation loss: 0.6722138524055481
epoch 68   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.1368615884406894 , validation loss: 0.6741036027669907
epoch 69   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.1238930903229059 , validation loss: 0.6726690605282784
epoch 70   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.1111403797187058 , validation loss: 0.6795553788542747
epoch 71   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.0983767883450377 , validation loss: 0.6708016023039818
epoch 72   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.086090410456938 , validation loss: 0.6567020863294601
epoch 73   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.073918623082778 , validation loss: 0.6699880659580231
epoch 74   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.0618491359785491 , validation loss: 0.6736205667257309
epoch 75   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.0499994965160595 , validation loss: 0.6664204820990562
epoch 76   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.0381938242444806 , validation loss: 0.6672959625720978
epoch 77   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.0269594730115403 , validation loss: 0.660778097808361
epoch 78   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.0156715664209104 , validation loss: 0.667216069996357
epoch 79   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 1.0041991776111079 , validation loss: 0.6608790382742882
epoch 80   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 0.9934202000206592 , validation loss: 0.6573584452271461
epoch 81   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 0.9825665459913366 , validation loss: 0.654232881963253
epoch 82   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 0.9718143694541034 , validation loss: 0.6500179767608643
epoch 83   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 0.9615430925406662 , validation loss: 0.6632480919361115
epoch 84   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 0.9509871917612412 , validation loss: 0.6564457565546036
epoch 85   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 0.9409038190748177 , validation loss: 0.6543080881237984
epoch 86   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 0.9307352362894544 , validation loss: 0.6507744267582893
epoch 87   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 0.9209163025313732 , validation loss: 0.6539057791233063
epoch 88   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 0.9110372627482695 , validation loss: 0.653704322874546
epoch 89   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 0.9016736348470052 , validation loss: 0.6401903554797173
epoch 90   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 0.8919077807781743 , validation loss: 0.6442588418722153
epoch 91   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 0.882497251033783 , validation loss: 0.6437221765518188
epoch 92   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 0.8732836304926405 , validation loss: 0.6451492607593536
epoch 93   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 0.8642585067188039 , validation loss: 0.6444964408874512
epoch 94   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 0.8553354950512156 , validation loss: 0.6459969356656075
epoch 95   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 0.8464754060202954 , validation loss: 0.6419808492064476
epoch 96   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 0.8376290389135772 , validation loss: 0.6401750966906548
tensor(58.5333, device='cuda:0')
MAE: [0.30018505366595905, 0.381012295880595, 0.43372322793953966, 0.47808424651641973, 0.5093785487791312, 0.5271119692047923, 0.5243112319929659, 0.5216975245855211, 0.5509862660964202, 0.5690012284459489, 0.5807462786479862, 0.5974658940204409, 0.6089212202499669, 0.6297125064631559, 0.6232510770114197, 0.6052983360697237, 0.6180410163250474, 0.617319966990155, 0.6315077921857616, 0.6377578604885752, 0.6467526198965833, 0.6513269686034506, 0.6407486905864219, 0.610391366079296, 0.6037837816817091, 0.6033415559686951, 0.6106596507012998, 0.6116914653831843, 0.6052785445131438, 0.6124583695976774, 0.6026464174783875, 0.5860265645710271] , MAPE: [0.11374092214046222, 0.048891716703162565, 0.11670423105629563, 0.1102676470190801, 0.10345896187222643, 0.10192766750701322, 0.042807166623467695, 0.04219801542911434, 0.004647506016268174, 0.04705003569403378, 0.07332924911833728, 0.11343018351155142, 0.06068872213987429, 0.09840998109120319, 0.03665584648716007, 0.025974263170381203, 0.047858944567992744, 0.05600535012186942, 0.0536038327839864, 0.040316310958545556, 0.05084617918992137, 0.012579499826211177, 0.013400935003523908, -0.03729514567527113, -0.011949592388502668, -0.0026106460667671347, -0.031040771961519397, -0.0465557759302517, -0.05693755190396446, -0.03238967461291864, -0.04171814814925532, -0.13879523346578335] %, RMSE: [0.5647996765647315, 0.6592561745129467, 0.7055033482808098, 0.7562967548181708, 0.8001092497355877, 0.8107466785301957, 0.7978703771171879, 0.7791780311174664, 0.8027307498707563, 0.8049169978622572, 0.8083503645932216, 0.8283604566777512, 0.8442900145970249, 0.8681681456804797, 0.8530450907984873, 0.8241350928366891, 0.8363600107867553, 0.8238119308021556, 0.8378173773629503, 0.8511900888291578, 0.8676823435477132, 0.8704512693222273, 0.852825380458584, 0.80919337371451, 0.7976932453481503, 0.8039338990690377, 0.8117920348954222, 0.8089817071050861, 0.8053263205107846, 0.822180331679927, 0.8062830934404187, 0.7905272002811253]
epoch 97   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 0.8291658957799276 , validation loss: 0.6358274966478348
tensor(58.3467, device='cuda:0')
MAE: [0.30477324769169706, 0.3821140472961532, 0.42880444715634836, 0.48149657970812826, 0.5157936928238835, 0.5279191114363674, 0.5256968286065097, 0.5284424022343202, 0.5610223547489257, 0.5796960158004743, 0.5777794878532361, 0.5957877611987216, 0.6127306995315228, 0.6221632446855614, 0.6190836080255889, 0.6112988000328547, 0.6239377848312412, 0.6172649795078126, 0.6242513465483855, 0.6339682531906004, 0.6386985309109015, 0.6359191621494354, 0.6259762595816679, 0.6047435499168933, 0.6028842384299052, 0.6054600007643866, 0.6084073221030616, 0.6152420653506498, 0.6142474852921921, 0.6196938623015568, 0.6099928064995743, 0.5941113682070114] , MAPE: [0.11329275872447941, 0.05444631736179797, 0.12817618276844084, 0.11245154817492165, 0.10001054889961901, 0.08599703597794979, 0.050270870320196503, 0.04692072604913697, 0.011052354910229717, 0.07316017366615213, 0.08528439311149527, 0.11003443372591289, 0.06927775500198381, 0.10386043131589702, 0.04484125400615554, 0.03547525039292991, 0.053513394972524296, 0.057647443903686924, 0.05498884302005742, 0.04789187969072823, 0.049737078855534265, 0.024672042876289983, 0.017114468537572262, -0.014505560310716805, 0.012588927854352377, 0.01165050307410882, -0.011413470661494469, -0.0412684949147263, -0.05172984319124563, -0.04351547491558008, -0.041351683207339916, -0.12792713686679527] %, RMSE: [0.5624976743216177, 0.6544883115800877, 0.6947486778289106, 0.7589013998647548, 0.8050132028502207, 0.8069530219336808, 0.7976366644944292, 0.7857892692915153, 0.8165626971352056, 0.8217149728066891, 0.8049333256521027, 0.8261388499700807, 0.8506660343909529, 0.8607079285370318, 0.8528006066084212, 0.8389889852133522, 0.8484875133320807, 0.8269616829901247, 0.829919595423782, 0.8496676975506972, 0.8575457138185688, 0.8503069200447428, 0.8371898569302197, 0.8099789550749699, 0.8052763724408107, 0.8145947254459696, 0.8136321461179852, 0.8171279895929118, 0.8199344429011055, 0.8327776554473536, 0.8185408023204537, 0.8045094279061632]
epoch 98   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 0.8207263724476683 , validation loss: 0.6427917256951332
tensor(58.1597, device='cuda:0')
MAE: [0.3053026802211846, 0.38611932265591453, 0.43150342145032183, 0.4758401878606336, 0.5135319623007372, 0.5257473774838078, 0.5319795974797195, 0.5314669250460706, 0.5681299180546103, 0.5879151262227714, 0.598250688148528, 0.6143331695444036, 0.621685797162354, 0.6255906250124279, 0.6226833267713484, 0.6057532357643406, 0.6210951540561528, 0.6221487313255514, 0.6310614575791298, 0.6362389701912083, 0.6380679447900927, 0.6420014333110494, 0.6356903483223209, 0.6132574699339025, 0.6170177356837336, 0.6255778812029467, 0.6264632922142129, 0.6259764413351251, 0.6179566683516521, 0.6200467021886221, 0.6087650564520323, 0.5906249968227498] , MAPE: [0.10746987828024149, 0.045934550096027336, 0.1266277293904493, 0.10014748206518749, 0.09994013462518102, 0.08819505871361188, 0.053607718398693716, 0.05380594717165896, 0.007864510081225368, 0.05881750056472098, 0.07789403741171141, 0.10354211250487799, 0.05895210929576802, 0.08654465360289137, 0.03571961795425129, 0.030092324091547946, 0.04091150073279968, 0.04832364747942529, 0.03740712918129332, 0.0299518400382643, 0.03225156599767362, 0.02559403449940836, 0.0077183701300791935, -0.04224989835507436, -0.004568159695127835, 1.108909369633562e-05, -0.03693343240874306, -0.07371297278874146, -0.09348495706204162, -0.0690443204071153, -0.07482413070807599, -0.1703811183309881] %, RMSE: [0.5703082743528594, 0.6630220935770899, 0.6959709183637645, 0.7463467616498378, 0.8014588602676644, 0.804498095600404, 0.8043417460083181, 0.7860005935116864, 0.8212406582663149, 0.8294941333764843, 0.8282773898659138, 0.8468417831546091, 0.8577759343913236, 0.85895125324039, 0.8513601793414619, 0.8240619485132327, 0.8365920204796337, 0.825701995857389, 0.8332990073628261, 0.8454120645921713, 0.8529264180342643, 0.8576017762017246, 0.8470357712249781, 0.8138446979098883, 0.8175129776221408, 0.8343321886776823, 0.8290685194913184, 0.8252070170872516, 0.8201685242605472, 0.8302870615557917, 0.8141474413854972, 0.7954507790824098]
epoch 99   lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6 , train loss: 0.8121737604047737 , validation loss: 0.6369406878948212
tensor(57.9727, device='cuda:0')
MAE: [0.3016545080290579, 0.3867693782495047, 0.4373246609720104, 0.4768118186343039, 0.5025015693712864, 0.5143241545869057, 0.5062195194525088, 0.5128413385700089, 0.5344533297465635, 0.5470916093716917, 0.5663731518901463, 0.5790644725111611, 0.5874647623978402, 0.6031165067233222, 0.5993318288009037, 0.594044471932287, 0.6088826247482302, 0.6196141184835704, 0.6295058996887091, 0.63148178242435, 0.6295521310144632, 0.6338357365761221, 0.6213243035826179, 0.5972831576759207, 0.6057406411523518, 0.6178066866309142, 0.6298297319753269, 0.6376630365211018, 0.6208937947202435, 0.6210634115858714, 0.6118154280916932, 0.5973327619876213] , MAPE: [0.11824001916559844, 0.05774394158394551, 0.13204875294984134, 0.12295842919877004, 0.10541817096057804, 0.10658361542640724, 0.05951899915872401, 0.08372672570810931, 0.023982839167379706, 0.07097535365667991, 0.08804642273494181, 0.10155494447553905, 0.06006994422727394, 0.10786937082200443, 0.06941493505942359, 0.05378853556407812, 0.06225858022956917, 0.06943326801544994, 0.04934564665271349, 0.023929714659431747, 0.01808518017727411, 0.004401732406134299, 0.005014810861064257, -0.03527050612839995, 0.00664279538851841, 0.015739306459970265, -0.01397453903122331, -0.03843911606772832, -0.06306396117384248, -0.05740066012373607, -0.05041151846763522, -0.1155061917201305] %, RMSE: [0.5645184900582011, 0.6666662486361307, 0.7094581820240267, 0.7505723584568099, 0.7863076073974676, 0.7891976235685545, 0.7691009973056276, 0.7672170167541685, 0.7808115460281007, 0.7790129348594445, 0.7961165068064143, 0.809412223505418, 0.8206482102987743, 0.8373891296230064, 0.8285472318127522, 0.8188088296922594, 0.8299803376192046, 0.8334183534306785, 0.8392340608326763, 0.8441738027883108, 0.8422175183079523, 0.8452482295221913, 0.8271022393230443, 0.7963450448371054, 0.80990200657068, 0.8340490006895988, 0.8445035014060726, 0.8472190055997122, 0.8233904811828359, 0.8264161621317238, 0.8139409868672763, 0.8018069114475725]
test loss: NIL 
MAE: [0.3016545080290579, 0.3867693782495047, 0.4373246609720104, 0.4768118186343039, 0.5025015693712864, 0.5143241545869057, 0.5062195194525088, 0.5128413385700089, 0.5344533297465635, 0.5470916093716917, 0.5663731518901463, 0.5790644725111611, 0.5874647623978402, 0.6031165067233222, 0.5993318288009037, 0.594044471932287, 0.6088826247482302, 0.6196141184835704, 0.6295058996887091, 0.63148178242435, 0.6295521310144632, 0.6338357365761221, 0.6213243035826179, 0.5972831576759207, 0.6057406411523518, 0.6178066866309142, 0.6298297319753269, 0.6376630365211018, 0.6208937947202435, 0.6210634115858714, 0.6118154280916932, 0.5973327619876213] , MAPE: [0.11824001916559844, 0.05774394158394551, 0.13204875294984134, 0.12295842919877004, 0.10541817096057804, 0.10658361542640724, 0.05951899915872401, 0.08372672570810931, 0.023982839167379706, 0.07097535365667991, 0.08804642273494181, 0.10155494447553905, 0.06006994422727394, 0.10786937082200443, 0.06941493505942359, 0.05378853556407812, 0.06225858022956917, 0.06943326801544994, 0.04934564665271349, 0.023929714659431747, 0.01808518017727411, 0.004401732406134299, 0.005014810861064257, -0.03527050612839995, 0.00664279538851841, 0.015739306459970265, -0.01397453903122331, -0.03843911606772832, -0.06306396117384248, -0.05740066012373607, -0.05041151846763522, -0.1155061917201305] %, RMSE: [0.5645184900582011, 0.6666662486361307, 0.7094581820240267, 0.7505723584568099, 0.7863076073974676, 0.7891976235685545, 0.7691009973056276, 0.7672170167541685, 0.7808115460281007, 0.7790129348594445, 0.7961165068064143, 0.809412223505418, 0.8206482102987743, 0.8373891296230064, 0.8285472318127522, 0.8188088296922594, 0.8299803376192046, 0.8334183534306785, 0.8392340608326763, 0.8441738027883108, 0.8422175183079523, 0.8452482295221913, 0.8271022393230443, 0.7963450448371054, 0.80990200657068, 0.8340490006895988, 0.8445035014060726, 0.8472190055997122, 0.8233904811828359, 0.8264161621317238, 0.8139409868672763, 0.8018069114475725]
====================
training elapsedd with 313.99 seconds for 100 iterations, the sec/iter = 3.14

MAE_mean: [0.30165451 0.38676938 0.43732466 0.47681182 0.50250157 0.51432415
 0.50621952 0.51284134 0.53445333 0.54709161 0.56637315 0.57906447
 0.58746476 0.60311651 0.59933183 0.59404447 0.60888262 0.61961412
 0.6295059  0.63148178 0.62955213 0.63383574 0.6213243  0.59728316
 0.60574064 0.61780669 0.62982973 0.63766304 0.62089379 0.62106341
 0.61181543 0.59733276] , MAPE_mean: [ 0.11824002  0.05774394  0.13204875  0.12295843  0.10541817  0.10658362
  0.059519    0.08372673  0.02398284  0.07097535  0.08804642  0.10155494
  0.06006994  0.10786937  0.06941494  0.05378854  0.06225858  0.06943327
  0.04934565  0.02392971  0.01808518  0.00440173  0.00501481 -0.03527051
  0.0066428   0.01573931 -0.01397454 -0.03843912 -0.06306396 -0.05740066
 -0.05041152 -0.11550619] , RMSE_mean: [0.56451849 0.66666625 0.70945818 0.75057236 0.78630761 0.78919762
 0.769101   0.76721702 0.78081155 0.77901293 0.79611651 0.80941222
 0.82064821 0.83738913 0.82854723 0.81880883 0.82998034 0.83341835
 0.83923406 0.8441738  0.84221752 0.84524823 0.82710224 0.79634504
 0.80990201 0.834049   0.8445035  0.84721901 0.82339048 0.82641616
 0.81394099 0.80180691]

MAE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , MAPE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , RMSE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
Finished training with: lr1e-4_bs64_nh64_ra1e-3_dp0.3_wd1e-5_ah2_ck1_kt6
user config:
seed 666
device 0
scaler StandardScaler()
day_slot 288
n_route 10
n_his 96
n_pred 96
n_train 34
n_val 5
n_test 5
mode 1
n_c 10
model STAGNN_stamp
TPG TPGNN
name lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2
log_path log/TPGNN_r05p02kt3outer_355
crash 355
new_name TPGNN_r05p02kt3outer_355
batch_size 64
lr 0.001
a 0.1
r 0.5
n_mask 1
adam {'use': True, 'weight_decay': 0.0001}
slr {'use': True, 'step_size': 400, 'gamma': 0.3}
resume False
start_epoch 0
epochs 100
n_layer 1
n_attr 64
n_hid 128
reg_A 0.0001
circle 288
drop_prob 0.3
CE {'use': True, 'kernel_size': 1, 'bias': False}
LE {'use': False, 'bias': False}
SE {'use': True, 'separate': True, 'no': False}
TE {'use': True, 'no': True}
attn {'head': 1, 'd_k': 32, 'd_v': 32, 'drop_prob': 0.2}
STstamp {'use': True, 'kt': 3, 'temperature': 1.0}
T4N {'use': True, 'step': 2, 'end_epoch': 10000, 'change_head': True, 'change_enc': True}
stamp_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/time_stamp_F_96.npy
data_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/V_France_processed_0.csv
adj_matrix_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/W_France_processed_0.csv
dis_mat tensor([[0.0000, 0.3661, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.6136, 0.0000,
         0.0000],
        [0.3661, 0.0000, 0.0000, 0.0000, 0.1098, 0.0000, 0.0000, 0.8975, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.3410, 0.8975, 0.0000, 0.0000, 0.0000, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.3410, 0.0000, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000,
         0.1494],
        [0.0000, 0.1098, 0.8975, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000, 0.6996,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000,
         0.2289],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000, 0.0000,
         0.5594],
        [0.6136, 0.8975, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.2117,
         0.0000],
        [0.0000, 0.4288, 0.4288, 0.0000, 0.6996, 0.0000, 0.0000, 0.2117, 0.0000,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.1494, 0.0000, 0.2289, 0.5594, 0.0000, 0.0000,
         0.0000]], device='cuda:0')
prefix log/lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2/
checkpoint_temp_path log/lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2//temp.pth
checkpoint_best_path log/lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2//best.pth
tensorboard_path log/lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2/
record_path log/lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2/record.txt
eps 0.1
parse <bound method DefaultConfig.parse of <config.DefaultConfig object at 0x7fa1bef14550>>
output <bound method DefaultConfig.output of <config.DefaultConfig object at 0x7fa1bef14550>>
train: True, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 9792
len(data): 9792, day_slot: 288, n_day: 34
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
10 10
epoch 0   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.9602224359325334 , validation loss: 1.0385258793830872
epoch 1   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.6195333997408549 , validation loss: 0.9371336549520493
epoch 2   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.5488141377766927 , validation loss: 0.9458501264452934
epoch 3   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.5034646695735407 , validation loss: 0.8883056491613388
epoch 4   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.4691527690373215 , validation loss: 0.825031615793705
epoch 5   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.44153566570842967 , validation loss: 0.8236852511763573
epoch 6   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.41522135512501585 , validation loss: 0.8155696988105774
epoch 7   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.38883232602886125 , validation loss: 0.7433237358927727
epoch 8   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.3664535979429881 , validation loss: 0.7142090648412704
epoch 9   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.3488076843467413 , validation loss: 0.7421755939722061
epoch 10   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.33619098628268523 , validation loss: 0.6891915574669838
epoch 11   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.3247392212643343 , validation loss: 0.7021497189998627
epoch 12   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.31593018594910116 , validation loss: 0.8109613731503487
epoch 13   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.30953653478154947 , validation loss: 0.6708581298589706
epoch 14   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.3004835499267952 , validation loss: 0.6999539583921432
epoch 15   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.2945752161390641 , validation loss: 0.6793560013175011
epoch 16   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.2887607573294172 , validation loss: 0.7008707374334335
epoch 17   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.28267766915115655 , validation loss: 0.6530388072133064
epoch 18   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.27849263654035683 , validation loss: 0.678286574780941
epoch 19   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.2751634506618275 , validation loss: 0.7400098815560341
epoch 20   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.27078285696459753 , validation loss: 0.6570087894797325
epoch 21   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.2650781910793454 , validation loss: 0.6740325838327408
epoch 22   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.2627643340942906 , validation loss: 0.6346925348043442
epoch 23   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.2596689272744983 , validation loss: 0.6691341623663902
epoch 24   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.2569275659088995 , validation loss: 0.6939934119582176
epoch 25   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.2540907082604427 , validation loss: 0.7269029840826988
epoch 26   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.2531977602664162 , validation loss: 0.6734006628394127
epoch 27   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.24880851922081967 , validation loss: 0.6682101860642433
epoch 28   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.24863624485100017 , validation loss: 0.7300852835178375
epoch 29   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.2465059392008127 , validation loss: 0.650013878941536
epoch 30   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.24378480981377995 , validation loss: 0.6496312171220779
epoch 31   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.2445646129986819 , validation loss: 0.6491323933005333
epoch 32   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.24145538403707392 , validation loss: 0.6659809425473213
epoch 33   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.24011499507754458 , validation loss: 0.6512374728918076
epoch 34   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.23809449900599086 , validation loss: 0.6276753842830658
epoch 35   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.2383378825935663 , validation loss: 0.6436507776379585
epoch 36   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.237097824028894 , validation loss: 0.631724625825882
epoch 37   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.23488756663659038 , validation loss: 0.6795665472745895
epoch 38   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.23435495092588313 , validation loss: 0.6328248009085655
epoch 39   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.23304342463904737 , validation loss: 0.696250818669796
epoch 40   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.23250540272862302 , validation loss: 0.6631786897778511
epoch 41   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.23328452542716382 , validation loss: 0.652705043554306
epoch 42   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.23090879473031736 , validation loss: 0.6933009773492813
epoch 43   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.23166892721372492 , validation loss: 0.6452274322509766
epoch 44   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.23026861425708323 , validation loss: 0.6330984383821487
epoch 45   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.22836739058588065 , validation loss: 0.6763551011681557
epoch 46   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.22849030617405386 , validation loss: 0.6978043839335442
epoch 47   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.2278545662468555 , validation loss: 0.6717621311545372
epoch 48   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.22687175811505786 , validation loss: 0.6241249516606331
epoch 49   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.22626508830809125 , validation loss: 0.6489512249827385
epoch 50   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.22591199126898073 , validation loss: 0.6665265262126923
epoch 51   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.2256153760587468 , validation loss: 0.6686588749289513
epoch 52   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.22636841997212054 , validation loss: 0.6684109941124916
epoch 53   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.2246138468092563 , validation loss: 0.6611129567027092
epoch 54   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.22528531796791973 , validation loss: 0.6358102560043335
epoch 55   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.22368383407592773 , validation loss: 0.6279445588588715
epoch 56   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.22402562902254217 , validation loss: 0.6617184579372406
epoch 57   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.2223598924922008 , validation loss: 0.6471530571579933
epoch 58   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.22303661587191562 , validation loss: 0.655297763645649
epoch 59   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.2222902681313309 , validation loss: 0.6534669250249863
epoch 60   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.2214502119550518 , validation loss: 0.6173932403326035
epoch 61   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.2223536901029886 , validation loss: 0.6319242790341377
epoch 62   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.2210630263183631 , validation loss: 0.6676320135593414
epoch 63   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.2209380681023878 , validation loss: 0.62305698543787
epoch 64   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.22009854515393576 , validation loss: 0.6541057229042053
epoch 65   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.21994747718175253 , validation loss: 0.6404055431485176
epoch 66   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.21975192953558528 , validation loss: 0.6617964208126068
epoch 67   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.21879258109074012 , validation loss: 0.6576045677065849
epoch 68   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.21937576053189298 , validation loss: 0.6503263711929321
epoch 69   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.21862646703626595 , validation loss: 0.6137439385056496
epoch 70   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.21948455040361367 , validation loss: 0.6239092350006104
epoch 71   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.2182355791914697 , validation loss: 0.6364696696400642
epoch 72   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.21774032302931243 , validation loss: 0.6664920523762703
epoch 73   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.21751948256118625 , validation loss: 0.6424973234534264
epoch 74   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.21780444097285176 , validation loss: 0.7036404460668564
epoch 75   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.21867658431623496 , validation loss: 0.6339728757739067
epoch 76   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.21637537432651893 , validation loss: 0.7115687057375908
epoch 77   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.21672327904140248 , validation loss: 0.6173747703433037
epoch 78   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.21614516161236108 , validation loss: 0.6471041366457939
epoch 79   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.21660247971029842 , validation loss: 0.6460296511650085
epoch 80   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.216023017670594 , validation loss: 0.6330855116248131
epoch 81   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.2171520640452703 , validation loss: 0.6470759138464928
epoch 82   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.21639596334859437 , validation loss: 0.6357419118285179
epoch 83   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.21534871178514817 , validation loss: 0.6788886487483978
epoch 84   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.21563228906369677 , validation loss: 0.6256928890943527
epoch 85   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.21429522803016737 , validation loss: 0.6187317445874214
epoch 86   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.21464442125722474 , validation loss: 0.6388273313641548
epoch 87   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.2145022247351852 , validation loss: 0.6567780897021294
epoch 88   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.2145080779697381 , validation loss: 0.6270266249775887
epoch 89   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.21361320392758237 , validation loss: 0.6211477294564247
epoch 90   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.21357424294247346 , validation loss: 0.6504469215869904
epoch 91   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.21467814842859903 , validation loss: 0.678277999162674
epoch 92   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.21332460700296887 , validation loss: 0.6668806821107864
epoch 93   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.21302373794948354 , validation loss: 0.6020872294902802
epoch 94   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.21343724809440912 , validation loss: 0.6851995810866356
epoch 95   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.212584112496937 , validation loss: 0.609757736325264
epoch 96   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.2125630197571773 , validation loss: 0.6808990761637688
tensor(13.9265, device='cuda:0')
MAE: [0.2775562413539929, 0.3620032792432791, 0.3943396141661389, 0.4275156649624564, 0.4634622283039864, 0.495586101229293, 0.5175119783951104, 0.5278380956377873, 0.5468325490804062, 0.5885294558641683, 0.601037492728072, 0.6174394376112206, 0.6373212015241164, 0.6544191746153514, 0.6639427851296039, 0.6718215768411756, 0.67097749822533, 0.6910450499211006, 0.6918958450116448, 0.6938170710396137, 0.6985245186987228, 0.7025960625719625, 0.7013573473202276, 0.6992358167427256, 0.7019138440670273, 0.7146654036122653, 0.7056537130713155, 0.6968167410537447, 0.6986001407305144, 0.692436931070478, 0.6804949612082126, 0.6819138477277971] , MAPE: [0.08026187235252606, 0.10964298583132386, 0.2120804873434701, 0.1671347169812393, 0.19377610862604042, 0.10969202564424384, 0.06786138265010298, 0.08651013346396137, 0.060627360004118884, 0.1582646739048865, 0.13353799245406073, 0.11204139587275273, 0.19035177069546932, 0.21255396023636308, 0.10288040587157983, 0.09793986768534504, 0.10795558478313584, 0.1373925791050325, 0.11046099226054683, 0.1604485414010256, 0.22792462198385674, 0.2038160246236042, 0.15175295076954462, 0.13267839004998527, 0.11555450528881846, 0.0442125354972896, 0.008231373433294926, -0.05543176676055511, -0.1312662730490568, -0.06358547100100004, -0.14429401423970234, -0.31080541880610535] %, RMSE: [0.46965226386778886, 0.5899717067216793, 0.6318168160793909, 0.6669446682919722, 0.7066716741293976, 0.7415445236862748, 0.7686454590210395, 0.7795416011859302, 0.7971849285593948, 0.8450993107452831, 0.863281419799344, 0.8777298931286149, 0.9035401906231643, 0.9162401325633608, 0.9276609884407132, 0.9348380211528609, 0.9346467316213819, 0.9537943685453043, 0.9562206176939804, 0.955586556953249, 0.960908695350255, 0.9664637909850935, 0.9670522675081433, 0.9657516244108663, 0.9680976010119053, 0.9810441561469815, 0.9733937673191649, 0.9618954842219427, 0.9632538545011758, 0.9576249806247356, 0.9464962987272428, 0.9530821288968314]
epoch 97   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.21277156764385746 , validation loss: 0.6119645237922668
tensor(13.7583, device='cuda:0')
MAE: [0.2686451579254485, 0.3436579006434101, 0.36944083147192586, 0.39139815898938585, 0.41856172609344583, 0.4399023377340402, 0.45917584477165313, 0.47187416518385494, 0.4899297938423865, 0.5137612955249155, 0.5267265861613926, 0.5308880526898909, 0.5382319087120369, 0.5451539991025995, 0.5509373943446223, 0.5506823647609844, 0.5514398617331976, 0.5567487317120138, 0.5521283679267334, 0.5468618553017563, 0.5528037854583607, 0.556273970794432, 0.557061244508962, 0.5663911101775071, 0.5646609261779825, 0.5588724265864945, 0.5551879321004158, 0.5471676490075655, 0.548035375745871, 0.553903004444329, 0.5600406739545851, 0.5715643131773266] , MAPE: [0.07320478807060475, 0.07768122077754071, 0.16949779005014767, 0.14961332603941366, 0.17841082934411537, 0.05819299619650919, 0.036777885555209874, 0.036834671708979326, 0.0027027367062774574, 0.0755804152026184, 0.03543770307271151, 0.05701064252408315, 0.04624539624874347, 0.07352245978954201, -0.022420535285281467, 0.028941201814450323, 0.018206167764332835, 0.060440397170891676, 0.03660599629107272, 0.023039631318937534, 0.06836089748018193, 0.10890894335323988, 0.012708506704996384, 0.0052909838407091585, 0.04085719211337867, 0.07744469481571961, 0.015139723156877416, 0.0014470252411043364, -0.009681958389411783, 0.038796849203911535, -0.02225554130876844, -0.10181498089718591] %, RMSE: [0.4611432215646695, 0.5666307417965311, 0.599126390913509, 0.6203837753438238, 0.6489107297548707, 0.6722869398855525, 0.6999175313966539, 0.7072010694373619, 0.7210598635754969, 0.7457950756725533, 0.7598396241424766, 0.7586103874866951, 0.7648061540383123, 0.7612524830686966, 0.7655311260632611, 0.7604761042478299, 0.7621750063725545, 0.7623621569876688, 0.752141718534374, 0.7465597161871974, 0.7522311641671428, 0.7487865168219612, 0.7508519075989775, 0.7567139543825567, 0.7506627310868164, 0.741939365025748, 0.7392181646534085, 0.7290748352563847, 0.7293841086699369, 0.7328760938017883, 0.7468418810613766, 0.7565454398026089]
epoch 98   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.21239299896885366 , validation loss: 0.6172229871153831
tensor(13.5667, device='cuda:0')
MAE: [0.26768597166870056, 0.353863148202798, 0.39259435747682897, 0.4231529389403415, 0.45907624558344023, 0.48408191807971324, 0.5114105118482767, 0.5158945755014369, 0.5419465484682316, 0.5581557675040106, 0.5736438214955564, 0.5828031745403237, 0.5983051790644597, 0.6028776159115404, 0.6160978395822122, 0.6093195592743565, 0.6153890412611907, 0.6132947378185069, 0.6035179402379646, 0.6014524814657406, 0.6073762668587613, 0.6146517089673692, 0.6135698530341969, 0.6052471911841908, 0.6129181257072721, 0.6075116369548763, 0.5963818170602635, 0.5876757517886185, 0.5865361751854112, 0.591435673746482, 0.5931693627562412, 0.5883423504098942] , MAPE: [0.04757145249516134, 0.07165941623710582, 0.18881170144579168, 0.14887416225526265, 0.1541166283917546, 0.06833990815655365, 0.03456274831743729, 0.017908475884541235, 0.0031784199117970914, 0.07261193378902575, 0.05704424013849798, 0.09085144815418465, 0.07360685215581847, 0.10340902718894493, -0.029799471105534114, -0.0009386867281279321, -0.03312618159117734, 0.01960493844072207, 0.002667322808993049, 0.0169218437022952, -0.007443726001146547, 0.02182469388014664, -0.10775528299331799, -0.11511372411251848, -0.12785855167196733, -0.09168524317670651, -0.13697761671454856, -0.20610957690465756, -0.18323434358457386, -0.14396367204927638, -0.20317626634434155, -0.28873765609038093] %, RMSE: [0.4699279009876033, 0.5818733455708228, 0.6313560190938535, 0.6637480822719137, 0.6981318412293537, 0.72465999522174, 0.7601594926459019, 0.7651325493823669, 0.7863057442984039, 0.8033398699092721, 0.8232121598991134, 0.8297800791151246, 0.8461209681649526, 0.8433257500785419, 0.85765907985794, 0.8422470770130809, 0.8474798731990514, 0.8391216264949765, 0.8259588307672003, 0.8234398560719486, 0.8228832184170165, 0.8279818742846513, 0.8295356066644407, 0.8145018730329124, 0.8151846885994488, 0.8047938605473549, 0.7968201363897027, 0.7828619803574339, 0.7753892182913006, 0.7749940963201312, 0.7786760933280148, 0.7708902252456228]
epoch 99   lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2 , train loss: 0.2128561413755604 , validation loss: 0.6784905791282654
tensor(13.4183, device='cuda:0')
MAE: [0.2814489775892232, 0.3688199342119018, 0.40157381849795504, 0.4447757356943198, 0.48058068077723237, 0.5051856940120613, 0.516758616179247, 0.5284492163315953, 0.5486145624061375, 0.5758764904333259, 0.5862811855347732, 0.6077136364102979, 0.6237551031265522, 0.627975505318339, 0.6328513720842828, 0.6389399464676138, 0.6395423253323191, 0.6506199849035936, 0.6511469518155166, 0.6639261798218814, 0.6678852333604675, 0.6712236444483098, 0.666836568127127, 0.6724255226953819, 0.6741048710624274, 0.6892200916506274, 0.6869749530635236, 0.6838359579612914, 0.685916700787151, 0.6888587337444277, 0.6835452748310857, 0.6788404388253375] , MAPE: [0.09966784304025234, 0.08754183224954891, 0.20451908360199575, 0.1785036160326479, 0.20842906190335064, 0.10901277260504394, 0.0786868359256856, 0.13309155698891156, 0.07812901750009521, 0.17702830417214932, 0.17479345909470964, 0.1665906195730492, 0.1980246819666924, 0.19013332496799626, 0.1440485488938872, 0.1618707842446777, 0.16810656377168362, 0.14901261502314003, 0.15492471886877862, 0.15959874419935022, 0.18467660043522122, 0.1722028664786239, 0.13519295297120668, 0.14980052718347447, 0.11445546345011158, 0.07759329561648705, 0.04368202842736602, -0.040374881204152564, -0.10378720123884443, -0.046635479518739247, -0.060384654110658284, -0.24928540908757024] %, RMSE: [0.49371850747950985, 0.607020238039408, 0.6514823710131886, 0.7018495495688599, 0.7443068716241465, 0.7763050776473339, 0.797464849255678, 0.8096790749488415, 0.8301829196552767, 0.8620689375449349, 0.8767043454925516, 0.896791251750255, 0.9203395607914441, 0.922046356734153, 0.9281010275175996, 0.9308841655460901, 0.9391841179736993, 0.9497123929582034, 0.9543414169371937, 0.9705590096092424, 0.9770323108194023, 0.9851382771434175, 0.9822319654577084, 0.9854726348027443, 0.9917868107760914, 1.0127356434635224, 1.0122123628131223, 1.0030059221999787, 1.0069528798979202, 1.0118177160881576, 1.0104190043442292, 1.0064413386538946]
test loss: NIL 
MAE: [0.2814489775892232, 0.3688199342119018, 0.40157381849795504, 0.4447757356943198, 0.48058068077723237, 0.5051856940120613, 0.516758616179247, 0.5284492163315953, 0.5486145624061375, 0.5758764904333259, 0.5862811855347732, 0.6077136364102979, 0.6237551031265522, 0.627975505318339, 0.6328513720842828, 0.6389399464676138, 0.6395423253323191, 0.6506199849035936, 0.6511469518155166, 0.6639261798218814, 0.6678852333604675, 0.6712236444483098, 0.666836568127127, 0.6724255226953819, 0.6741048710624274, 0.6892200916506274, 0.6869749530635236, 0.6838359579612914, 0.685916700787151, 0.6888587337444277, 0.6835452748310857, 0.6788404388253375] , MAPE: [0.09966784304025234, 0.08754183224954891, 0.20451908360199575, 0.1785036160326479, 0.20842906190335064, 0.10901277260504394, 0.0786868359256856, 0.13309155698891156, 0.07812901750009521, 0.17702830417214932, 0.17479345909470964, 0.1665906195730492, 0.1980246819666924, 0.19013332496799626, 0.1440485488938872, 0.1618707842446777, 0.16810656377168362, 0.14901261502314003, 0.15492471886877862, 0.15959874419935022, 0.18467660043522122, 0.1722028664786239, 0.13519295297120668, 0.14980052718347447, 0.11445546345011158, 0.07759329561648705, 0.04368202842736602, -0.040374881204152564, -0.10378720123884443, -0.046635479518739247, -0.060384654110658284, -0.24928540908757024] %, RMSE: [0.49371850747950985, 0.607020238039408, 0.6514823710131886, 0.7018495495688599, 0.7443068716241465, 0.7763050776473339, 0.797464849255678, 0.8096790749488415, 0.8301829196552767, 0.8620689375449349, 0.8767043454925516, 0.896791251750255, 0.9203395607914441, 0.922046356734153, 0.9281010275175996, 0.9308841655460901, 0.9391841179736993, 0.9497123929582034, 0.9543414169371937, 0.9705590096092424, 0.9770323108194023, 0.9851382771434175, 0.9822319654577084, 0.9854726348027443, 0.9917868107760914, 1.0127356434635224, 1.0122123628131223, 1.0030059221999787, 1.0069528798979202, 1.0118177160881576, 1.0104190043442292, 1.0064413386538946]
====================
training elapsedd with 319.27 seconds for 100 iterations, the sec/iter = 3.19

MAE_mean: [0.28144898 0.36881993 0.40157382 0.44477574 0.48058068 0.50518569
 0.51675862 0.52844922 0.54861456 0.57587649 0.58628119 0.60771364
 0.6237551  0.62797551 0.63285137 0.63893995 0.63954233 0.65061998
 0.65114695 0.66392618 0.66788523 0.67122364 0.66683657 0.67242552
 0.67410487 0.68922009 0.68697495 0.68383596 0.6859167  0.68885873
 0.68354527 0.67884044] , MAPE_mean: [ 0.09966784  0.08754183  0.20451908  0.17850362  0.20842906  0.10901277
  0.07868684  0.13309156  0.07812902  0.1770283   0.17479346  0.16659062
  0.19802468  0.19013332  0.14404855  0.16187078  0.16810656  0.14901262
  0.15492472  0.15959874  0.1846766   0.17220287  0.13519295  0.14980053
  0.11445546  0.0775933   0.04368203 -0.04037488 -0.1037872  -0.04663548
 -0.06038465 -0.24928541] , RMSE_mean: [0.49371851 0.60702024 0.65148237 0.70184955 0.74430687 0.77630508
 0.79746485 0.80967907 0.83018292 0.86206894 0.87670435 0.89679125
 0.92033956 0.92204636 0.92810103 0.93088417 0.93918412 0.94971239
 0.95434142 0.97055901 0.97703231 0.98513828 0.98223197 0.98547263
 0.99178681 1.01273564 1.01221236 1.00300592 1.00695288 1.01181772
 1.010419   1.00644134]

MAE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , MAPE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , RMSE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
Finished training with: lr1e-3_bs64_nh128_ra1e-4_dp0.3_wd1e-6_ah1_ck1_kt2
user config:
seed 666
device 0
scaler StandardScaler()
day_slot 288
n_route 10
n_his 96
n_pred 96
n_train 34
n_val 5
n_test 5
mode 1
n_c 10
model STAGNN_stamp
TPG TPGNN
name lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6
log_path log/TPGNN_r05p02kt3outer_356
crash 356
new_name TPGNN_r05p02kt3outer_356
batch_size 64
lr 0.001
a 0.1
r 0.5
n_mask 1
adam {'use': True, 'weight_decay': 0.0001}
slr {'use': True, 'step_size': 400, 'gamma': 0.3}
resume False
start_epoch 0
epochs 100
n_layer 1
n_attr 64
n_hid 128
reg_A 0.001
circle 288
drop_prob 0.1
CE {'use': True, 'kernel_size': 1, 'bias': False}
LE {'use': False, 'bias': False}
SE {'use': True, 'separate': True, 'no': False}
TE {'use': True, 'no': True}
attn {'head': 1, 'd_k': 32, 'd_v': 32, 'drop_prob': 0.2}
STstamp {'use': True, 'kt': 3, 'temperature': 1.0}
T4N {'use': True, 'step': 2, 'end_epoch': 10000, 'change_head': True, 'change_enc': True}
stamp_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/time_stamp_F_96.npy
data_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/V_France_processed_0.csv
adj_matrix_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/W_France_processed_0.csv
dis_mat tensor([[0.0000, 0.3661, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.6136, 0.0000,
         0.0000],
        [0.3661, 0.0000, 0.0000, 0.0000, 0.1098, 0.0000, 0.0000, 0.8975, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.3410, 0.8975, 0.0000, 0.0000, 0.0000, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.3410, 0.0000, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000,
         0.1494],
        [0.0000, 0.1098, 0.8975, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000, 0.6996,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000,
         0.2289],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000, 0.0000,
         0.5594],
        [0.6136, 0.8975, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.2117,
         0.0000],
        [0.0000, 0.4288, 0.4288, 0.0000, 0.6996, 0.0000, 0.0000, 0.2117, 0.0000,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.1494, 0.0000, 0.2289, 0.5594, 0.0000, 0.0000,
         0.0000]], device='cuda:0')
prefix log/lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6/
checkpoint_temp_path log/lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6//temp.pth
checkpoint_best_path log/lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6//best.pth
tensorboard_path log/lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6/
record_path log/lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6/record.txt
eps 0.1
parse <bound method DefaultConfig.parse of <config.DefaultConfig object at 0x7f7eaf72f550>>
output <bound method DefaultConfig.output of <config.DefaultConfig object at 0x7f7eaf72f550>>
train: True, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 9792
len(data): 9792, day_slot: 288, n_day: 34
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
10 10
epoch 0   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 2.915004248712577 , validation loss: 1.020600251853466
epoch 1   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 2.285228275785259 , validation loss: 0.8978246003389359
epoch 2   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 1.9831011716057272 , validation loss: 0.9044659361243248
epoch 3   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 1.7468064719555425 , validation loss: 0.8002697229385376
epoch 4   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 1.5515683375152887 , validation loss: 0.7907322496175766
epoch 5   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 1.387202594794479 , validation loss: 0.7655321285128593
epoch 6   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 1.2463966748293709 , validation loss: 0.7339800074696541
epoch 7   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 1.1232033780976838 , validation loss: 0.6970279142260551
epoch 8   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 1.0230420442188488 , validation loss: 0.6988593563437462
epoch 9   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.9377018669072319 , validation loss: 0.6774386316537857
epoch 10   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.8643863551756915 , validation loss: 0.6789549961686134
epoch 11   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.8003493839619207 , validation loss: 0.6788410097360611
epoch 12   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.7447574991805881 , validation loss: 0.6630159765481949
epoch 13   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.6964095912727655 , validation loss: 0.6699423268437386
epoch 14   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.6522298233181822 , validation loss: 0.6654767841100693
epoch 15   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.6126433470669914 , validation loss: 0.6633312180638313
epoch 16   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.578214963277181 , validation loss: 0.7323305904865265
epoch 17   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.5482894906810686 , validation loss: 0.6628071516752243
epoch 18   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.5205959671852636 , validation loss: 0.645048975944519
epoch 19   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.49546227268144194 , validation loss: 0.6484496518969536
epoch 20   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.4728638284346637 , validation loss: 0.6422316804528236
epoch 21   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.452906292443182 , validation loss: 0.6762045696377754
epoch 22   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.4346263402817296 , validation loss: 0.6565064266324043
epoch 23   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.41765677695180853 , validation loss: 0.6304779350757599
epoch 24   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.40179093386612685 , validation loss: 0.6361433640122414
epoch 25   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.3879130395019756 , validation loss: 0.6621071845293045
epoch 26   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.3754059952848098 , validation loss: 0.6329175606369972
epoch 27   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.36292945286806894 , validation loss: 0.6266026124358177
epoch 28   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.3527207918026868 , validation loss: 0.7069785669445992
epoch 29   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.3438238302866618 , validation loss: 0.7321646437048912
epoch 30   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.33434219804464604 , validation loss: 0.640461876988411
epoch 31   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.32573111033907126 , validation loss: 0.665034644305706
epoch 32   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.3180553685216343 , validation loss: 0.6488896608352661
epoch 33   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.3123750680801915 , validation loss: 0.6523177921772003
epoch 34   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.3045811863506542 , validation loss: 0.7601214647293091
epoch 35   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.2997857636096431 , validation loss: 0.6331438347697258
epoch 36   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.2916283268554538 , validation loss: 0.626961961388588
epoch 37   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.2872476373233047 , validation loss: 0.6279301717877388
epoch 38   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.28219277017256794 , validation loss: 0.6541133671998978
epoch 39   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.27790705888879064 , validation loss: 0.6784595400094986
epoch 40   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.2752143144607544 , validation loss: 0.6755472645163536
epoch 41   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.27020705564349307 , validation loss: 0.6445225402712822
epoch 42   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.26580629746119183 , validation loss: 0.6315595060586929
epoch 43   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.2641513566760456 , validation loss: 0.6122583523392677
epoch 44   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.25963689328408707 , validation loss: 0.6389193683862686
epoch 45   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.256312144445438 , validation loss: 0.6278489977121353
epoch 46   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.25391356150309247 , validation loss: 0.6507496312260628
epoch 47   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.25175929274044784 , validation loss: 0.6547942832112312
epoch 48   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.2491260279043048 , validation loss: 0.6173494160175323
epoch 49   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.24747547507286072 , validation loss: 0.6303650736808777
epoch 50   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.2453913884420021 , validation loss: 0.6196375116705894
epoch 51   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.24232064304398557 , validation loss: 0.8376617282629013
epoch 52   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.24227666533460804 , validation loss: 0.638216957449913
epoch 53   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.2388922250738331 , validation loss: 0.6302887424826622
epoch 54   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.23723802175007613 , validation loss: 0.6264262720942497
epoch 55   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.23562308444696314 , validation loss: 0.6411459967494011
epoch 56   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.23526967798962312 , validation loss: 0.6657996252179146
epoch 57   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.2326345367758882 , validation loss: 0.6249897330999374
epoch 58   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.2316038593942044 , validation loss: 0.6126562654972076
epoch 59   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.2305789329842025 , validation loss: 0.655777670443058
epoch 60   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.22995086773937823 , validation loss: 0.6407064720988274
epoch 61   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.2283573463266971 , validation loss: 0.6118437051773071
epoch 62   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.2276004640495076 , validation loss: 0.6461633890867233
epoch 63   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.22612974456712312 , validation loss: 0.6199684962630272
epoch 64   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.22479143212823308 , validation loss: 0.6187310367822647
epoch 65   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.22410330001045675 , validation loss: 0.6068605035543442
epoch 66   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.22390902480658362 , validation loss: 0.6556930691003799
epoch 67   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.22298583417546516 , validation loss: 0.6229587867856026
epoch 68   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.2214784099190843 , validation loss: 0.6626390814781189
epoch 69   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.22287047289165796 , validation loss: 0.6672419607639313
epoch 70   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.2208159676953858 , validation loss: 0.6303757056593895
epoch 71   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.21959225190620796 , validation loss: 0.6253070011734962
epoch 72   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.21929361598164426 , validation loss: 0.7241506949067116
epoch 73   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.21900042453232935 , validation loss: 0.6325298175215721
epoch 74   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.21800103170030258 , validation loss: 0.6116087511181831
epoch 75   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.217914796927396 , validation loss: 0.6760255470871925
epoch 76   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.21743396596581327 , validation loss: 0.6158754900097847
epoch 77   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.21664385059300592 , validation loss: 0.5980277806520462
epoch 78   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.21603103478749594 , validation loss: 0.6423680037260056
epoch 79   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.21639040667636722 , validation loss: 0.6345662176609039
epoch 80   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.21620698068656174 , validation loss: 0.6076504066586494
epoch 81   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.21543709144872777 , validation loss: 0.6033418625593185
epoch 82   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.21387912420665517 , validation loss: 0.6455438062548637
epoch 83   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.21394882307333105 , validation loss: 0.6068362519145012
epoch 84   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.2132151702455446 , validation loss: 0.6417939737439156
epoch 85   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.2145555440117331 , validation loss: 0.7205384522676468
epoch 86   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.21365097720249027 , validation loss: 0.6305068135261536
epoch 87   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.21188440626742794 , validation loss: 0.706447497010231
epoch 88   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.21200283134684844 , validation loss: 0.5936737656593323
epoch 89   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.21189137358291477 , validation loss: 0.6305535659193993
epoch 90   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.21187236963533887 , validation loss: 0.6105910688638687
epoch 91   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.2120769231342802 , validation loss: 0.6337715089321136
epoch 92   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.21119910537027844 , validation loss: 0.6023103073239326
epoch 93   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.211424343141855 , validation loss: 0.6910433396697044
epoch 94   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.2106480823428023 , validation loss: 0.6156551986932755
epoch 95   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.2119523549781126 , validation loss: 0.7448183670639992
epoch 96   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.2126921689977833 , validation loss: 0.6031055226922035
tensor(17.9820, device='cuda:0')
MAE: [0.2784535685463895, 0.3510110213372319, 0.367973472661886, 0.40774675619010764, 0.45177909888576756, 0.47388463543363146, 0.4703140829925992, 0.4805424080370474, 0.5013024878144725, 0.5093539981355834, 0.499092963373999, 0.5223474968051941, 0.5430689093996722, 0.5567050037125951, 0.553947776336242, 0.5573404754389116, 0.559303641707166, 0.5546785192832006, 0.5389181533684358, 0.5546909328054676, 0.5629416380427087, 0.5607085063750136, 0.5562401937499412, 0.5548391502110537, 0.5523781052746416, 0.5469882205800758, 0.523882087158356, 0.5310553703214205, 0.5389706595042317, 0.5330780547392583, 0.5202408790054549, 0.5219956355307673] , MAPE: [0.11491393476220484, 0.07931129946076064, 0.2040856943192467, 0.14836866234474, 0.1773026646023156, 0.11220846206470651, 0.03363349190735262, 0.10167920507471283, 0.04668612413145254, 0.1184469839539219, 0.0663465931146223, 0.11046080452473352, 0.1284530861501964, 0.15731742209525204, 0.09394285323087276, 0.10310243528065989, 0.12404977285433992, 0.12396475096616939, 0.05960776982236097, 0.09165742046473675, 0.12425127690905656, 0.18033927031203423, 0.17473631066511255, 0.166027912596392, 0.1479460161093178, 0.025161053596341836, -0.061718015384414175, -0.0600189074066623, -0.09612928054134809, -0.05416435247287679, -0.026462140151601976, -0.11105572258806355] %, RMSE: [0.49513759092382825, 0.5739403738313678, 0.5917271591307343, 0.6382021595769282, 0.6799227459015987, 0.7051711215102469, 0.7057229707831629, 0.717346508402337, 0.7369605801917608, 0.7400262318707146, 0.7210062827011887, 0.7450637800924667, 0.7614220004129462, 0.7784998488227906, 0.7734677231353024, 0.7808308297303362, 0.783584202105681, 0.7721478153396271, 0.7459662579221022, 0.7684873170793409, 0.7777622408077711, 0.7777614292050037, 0.7727124753562468, 0.7711321930827263, 0.7641589248115195, 0.7520675202122438, 0.7198541118191032, 0.7269477177036905, 0.7346773202477435, 0.730757098235912, 0.712629926062915, 0.7180737526717377]
epoch 97   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.20996792263844433 , validation loss: 0.6337497010827065
tensor(17.8670, device='cuda:0')
MAE: [0.28417887116062274, 0.35945927637341174, 0.3915367802762494, 0.41709303345684845, 0.4576953338222943, 0.48232609642251906, 0.5092020249368681, 0.528007314131048, 0.5457484128103428, 0.5713486192409986, 0.5920781570828529, 0.6023837955922042, 0.6194272215643264, 0.6369109100395257, 0.6446352069402479, 0.6464289689386629, 0.6361280261982502, 0.6345226915562814, 0.6359420859083994, 0.6325786255310606, 0.633979529805059, 0.6368830505289982, 0.6425366754547607, 0.634224728041895, 0.623662456961195, 0.623240784316026, 0.6172049643431512, 0.6028987744220139, 0.6023845603962227, 0.6036991279011534, 0.6063090996511434, 0.6018634742306372] , MAPE: [0.1426456374652113, 0.1367919834180268, 0.24862896941922372, 0.1431422139898203, 0.1369146961401836, 0.0177217119949757, -0.016352394968090857, 0.08561797743556228, 0.02736156022717418, 0.10154096164751124, 0.12933738286801394, 0.04804293820165523, 0.14358773993870985, 0.0788366435438163, 0.042819578356592475, 0.08504566375670244, 0.07336651864454549, 0.09225820486015249, -0.022585652877554933, -0.008026742108043801, 0.08110211997589074, 0.0662703285355259, 0.047922110683770766, 0.17091071650297646, 0.09011047304282985, -0.06938939502802989, -0.21601636603607535, -0.24563687999843506, -0.11969105485773923, -0.2020349622463592, -0.17552554165193157, -0.3752861551127664] %, RMSE: [0.49295836559092615, 0.5694939724067604, 0.5962568388383483, 0.6219755164152303, 0.6601790306135575, 0.6834045803565433, 0.7146668696168348, 0.7348288366757669, 0.7516242545713481, 0.7739770340433932, 0.7940432310135701, 0.8084339073077749, 0.8280013807395334, 0.850335478325149, 0.8566940587180528, 0.8664700355590385, 0.8555074867471474, 0.846908047163347, 0.8419265861558146, 0.8407028853409722, 0.837226427615822, 0.8369840816623076, 0.842671156674592, 0.8370590852411355, 0.8276173025411854, 0.8231492373321738, 0.8176117635855786, 0.8007248792971622, 0.7970566288375377, 0.8019064793339986, 0.808859314938238, 0.8101642601125535]
epoch 98   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.2096238016497855 , validation loss: 0.6712465509772301
tensor(17.7453, device='cuda:0')
MAE: [0.27870786554007265, 0.3557068719275142, 0.39309442160353447, 0.4333800641168869, 0.48390290713129736, 0.5284377993974527, 0.5417388435088328, 0.5724344539872764, 0.6092483405736226, 0.6291284503507399, 0.646739867705775, 0.6669690849701154, 0.6727637484047524, 0.6850585073747278, 0.6790071760912032, 0.6761011593763899, 0.6769038449129877, 0.6732045125419792, 0.680593101195607, 0.6828912803151443, 0.6669743052016482, 0.6722562613342072, 0.6654347359668463, 0.6551605992727749, 0.6583618712939859, 0.6581997267530328, 0.6543193453220055, 0.645752047750254, 0.6326612467245804, 0.6383307998696554, 0.6338953946534659, 0.6266906285425168] , MAPE: [0.12498579437762544, 0.13828030022171287, 0.26379904131561077, 0.13721148614259196, 0.15709891366186077, 0.057138848513904564, -0.027401580965559277, 0.06073897234854269, 0.022801925921576746, 0.12952831068096896, 0.1473860193223491, 0.1129510737907804, 0.22626027644311855, 0.14515290481515156, 0.06131981161612653, 0.0708843426015612, 0.05001767674791051, 0.15449892687277264, 0.018207344630000736, 0.10274579746596912, 0.2698302439948455, 0.1982856131529813, 0.18384433922799515, 0.17404557881351607, 0.09145187603928431, -0.015223804308881938, -0.15449242777413133, -0.047818750428292686, 0.10572578382326833, 0.018435144731213854, -0.0662532878064802, -0.2645406512186092] %, RMSE: [0.4785230759305473, 0.5611976869474717, 0.5978076406556924, 0.6393779071751853, 0.6865854226932399, 0.7331624168688593, 0.7493503064877837, 0.7878096224207392, 0.8275786041537045, 0.8435855150736965, 0.8601890654484061, 0.8826738135051656, 0.8905163463385138, 0.9103802193158423, 0.9042553028806032, 0.9083379046863176, 0.9075033262261264, 0.8951502024036644, 0.8939480164966895, 0.897711165881568, 0.8829370727335434, 0.88658091448709, 0.8796340070214153, 0.8760800261856239, 0.8794570620774386, 0.8733636389311609, 0.8667556069278888, 0.8593780042753396, 0.84750761739329, 0.8510654841492288, 0.8481878120517169, 0.8480002357720738]
epoch 99   lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6 , train loss: 0.2091540577364903 , validation loss: 0.685256265103817
tensor(17.6230, device='cuda:0')
MAE: [0.3367778276160513, 0.41047276721014303, 0.43000646456010333, 0.46566840436347984, 0.5191974514943654, 0.5440343746317301, 0.5485806748747211, 0.5696292455985988, 0.6133528503366583, 0.6209856260777211, 0.6150952487127836, 0.6309919153292155, 0.6631469306080919, 0.6696512303633865, 0.6748567174833998, 0.6786630493052995, 0.7014995387275271, 0.6994125731709923, 0.6825866803703542, 0.6855724346920002, 0.7103106770497392, 0.7138161672870676, 0.7082624862289306, 0.7110097207603544, 0.7260265412279548, 0.7268611989489074, 0.707966815418727, 0.7073593313725108, 0.7267047507955319, 0.7350050250112473, 0.734119246568646, 0.7370232410471618] , MAPE: [0.15641059653287123, 0.10492839695131666, 0.20980152548949077, 0.1332520511982621, 0.10594256312492455, 0.0263135039920621, 0.02241958288275595, 0.06966661501446501, 0.037491390046894016, 0.09314720972090879, 0.05621119676057694, 0.054429050031986406, 0.032481604652514096, 0.03560828201574623, 0.046597385633103464, 0.062488566949270026, 0.03439804108378948, -0.0015018089488448728, 0.037672957099689715, -0.04710244669445077, -0.06846316583555384, -0.009015222773852619, 0.0014768907726732125, -0.017716312282746095, -0.03273189992915147, -0.11249684346125391, -0.04998219847784719, -0.21595415665725481, -0.22705056701452572, -0.22700119963784843, -0.12321870146685919, -0.17319691160170908] %, RMSE: [0.5643034304984068, 0.6419144487340324, 0.6622033808815997, 0.7040803332796439, 0.7601271576779542, 0.7887920242552865, 0.7951407739922042, 0.8228234550638507, 0.8724980093623937, 0.8827993472397057, 0.8724639458215556, 0.8935539896293738, 0.9240481724284612, 0.930244632889387, 0.9353028444535096, 0.9406591065976024, 0.9684625062222462, 0.9705650510067545, 0.9483567784388842, 0.949534602691959, 0.9750356597343788, 0.9774337785630117, 0.9695607837706852, 0.9702084865793642, 0.982961179231138, 0.9824879993763743, 0.9612768355547466, 0.9556690220767796, 0.9702193643021477, 0.9800979426213441, 0.979861050624953, 0.9852612245148129]
test loss: NIL 
MAE: [0.3367778276160513, 0.41047276721014303, 0.43000646456010333, 0.46566840436347984, 0.5191974514943654, 0.5440343746317301, 0.5485806748747211, 0.5696292455985988, 0.6133528503366583, 0.6209856260777211, 0.6150952487127836, 0.6309919153292155, 0.6631469306080919, 0.6696512303633865, 0.6748567174833998, 0.6786630493052995, 0.7014995387275271, 0.6994125731709923, 0.6825866803703542, 0.6855724346920002, 0.7103106770497392, 0.7138161672870676, 0.7082624862289306, 0.7110097207603544, 0.7260265412279548, 0.7268611989489074, 0.707966815418727, 0.7073593313725108, 0.7267047507955319, 0.7350050250112473, 0.734119246568646, 0.7370232410471618] , MAPE: [0.15641059653287123, 0.10492839695131666, 0.20980152548949077, 0.1332520511982621, 0.10594256312492455, 0.0263135039920621, 0.02241958288275595, 0.06966661501446501, 0.037491390046894016, 0.09314720972090879, 0.05621119676057694, 0.054429050031986406, 0.032481604652514096, 0.03560828201574623, 0.046597385633103464, 0.062488566949270026, 0.03439804108378948, -0.0015018089488448728, 0.037672957099689715, -0.04710244669445077, -0.06846316583555384, -0.009015222773852619, 0.0014768907726732125, -0.017716312282746095, -0.03273189992915147, -0.11249684346125391, -0.04998219847784719, -0.21595415665725481, -0.22705056701452572, -0.22700119963784843, -0.12321870146685919, -0.17319691160170908] %, RMSE: [0.5643034304984068, 0.6419144487340324, 0.6622033808815997, 0.7040803332796439, 0.7601271576779542, 0.7887920242552865, 0.7951407739922042, 0.8228234550638507, 0.8724980093623937, 0.8827993472397057, 0.8724639458215556, 0.8935539896293738, 0.9240481724284612, 0.930244632889387, 0.9353028444535096, 0.9406591065976024, 0.9684625062222462, 0.9705650510067545, 0.9483567784388842, 0.949534602691959, 0.9750356597343788, 0.9774337785630117, 0.9695607837706852, 0.9702084865793642, 0.982961179231138, 0.9824879993763743, 0.9612768355547466, 0.9556690220767796, 0.9702193643021477, 0.9800979426213441, 0.979861050624953, 0.9852612245148129]
====================
training elapsedd with 319.15 seconds for 100 iterations, the sec/iter = 3.19

MAE_mean: [0.33677783 0.41047277 0.43000646 0.4656684  0.51919745 0.54403437
 0.54858067 0.56962925 0.61335285 0.62098563 0.61509525 0.63099192
 0.66314693 0.66965123 0.67485672 0.67866305 0.70149954 0.69941257
 0.68258668 0.68557243 0.71031068 0.71381617 0.70826249 0.71100972
 0.72602654 0.7268612  0.70796682 0.70735933 0.72670475 0.73500503
 0.73411925 0.73702324] , MAPE_mean: [ 0.1564106   0.1049284   0.20980153  0.13325205  0.10594256  0.0263135
  0.02241958  0.06966662  0.03749139  0.09314721  0.0562112   0.05442905
  0.0324816   0.03560828  0.04659739  0.06248857  0.03439804 -0.00150181
  0.03767296 -0.04710245 -0.06846317 -0.00901522  0.00147689 -0.01771631
 -0.0327319  -0.11249684 -0.0499822  -0.21595416 -0.22705057 -0.2270012
 -0.1232187  -0.17319691] , RMSE_mean: [0.56430343 0.64191445 0.66220338 0.70408033 0.76012716 0.78879202
 0.79514077 0.82282346 0.87249801 0.88279935 0.87246395 0.89355399
 0.92404817 0.93024463 0.93530284 0.94065911 0.96846251 0.97056505
 0.94835678 0.9495346  0.97503566 0.97743378 0.96956078 0.97020849
 0.98296118 0.982488   0.96127684 0.95566902 0.97021936 0.98009794
 0.97986105 0.98526122]

MAE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , MAPE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , RMSE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
Finished training with: lr1e-3_bs64_nh128_ra1e-3_dp0.1_wd1e-5_ah4_ck1_kt6
user config:
seed 666
device 0
scaler StandardScaler()
day_slot 288
n_route 10
n_his 96
n_pred 96
n_train 34
n_val 5
n_test 5
mode 1
n_c 10
model STAGNN_stamp
TPG TPGNN
name lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4
log_path log/TPGNN_r05p02kt3outer_357
crash 357
new_name TPGNN_r05p02kt3outer_357
batch_size 64
lr 0.0001
a 0.1
r 0.5
n_mask 1
adam {'use': True, 'weight_decay': 0.0001}
slr {'use': True, 'step_size': 400, 'gamma': 0.3}
resume False
start_epoch 0
epochs 100
n_layer 1
n_attr 64
n_hid 128
reg_A 1e-05
circle 288
drop_prob 0.2
CE {'use': True, 'kernel_size': 1, 'bias': False}
LE {'use': False, 'bias': False}
SE {'use': True, 'separate': True, 'no': False}
TE {'use': True, 'no': True}
attn {'head': 1, 'd_k': 32, 'd_v': 32, 'drop_prob': 0.2}
STstamp {'use': True, 'kt': 3, 'temperature': 1.0}
T4N {'use': True, 'step': 2, 'end_epoch': 10000, 'change_head': True, 'change_enc': True}
stamp_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/time_stamp_F_96.npy
data_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/V_France_processed_0.csv
adj_matrix_path /mnt/webscistorage/cc7738/ws_joella/EnergyTSF/TPGNN/datasets/W_France_processed_0.csv
dis_mat tensor([[0.0000, 0.3661, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.6136, 0.0000,
         0.0000],
        [0.3661, 0.0000, 0.0000, 0.0000, 0.1098, 0.0000, 0.0000, 0.8975, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.3410, 0.8975, 0.0000, 0.0000, 0.0000, 0.4288,
         0.0000],
        [0.0000, 0.0000, 0.3410, 0.0000, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000,
         0.1494],
        [0.0000, 0.1098, 0.8975, 0.1547, 0.0000, 0.0000, 0.0000, 0.0000, 0.6996,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000,
         0.2289],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8104, 0.0000, 0.0000, 0.0000,
         0.5594],
        [0.6136, 0.8975, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.2117,
         0.0000],
        [0.0000, 0.4288, 0.4288, 0.0000, 0.6996, 0.0000, 0.0000, 0.2117, 0.0000,
         0.0000],
        [0.0000, 0.0000, 0.0000, 0.1494, 0.0000, 0.2289, 0.5594, 0.0000, 0.0000,
         0.0000]], device='cuda:0')
prefix log/lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4/
checkpoint_temp_path log/lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4//temp.pth
checkpoint_best_path log/lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4//best.pth
tensorboard_path log/lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4/
record_path log/lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4/record.txt
eps 0.1
parse <bound method DefaultConfig.parse of <config.DefaultConfig object at 0x7f3bc57d6550>>
output <bound method DefaultConfig.output of <config.DefaultConfig object at 0x7f3bc57d6550>>
train: True, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 9792
len(data): 9792, day_slot: 288, n_day: 34
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
train: False, day_slot: 288, n_his: 96, n_pred: 96, T4N_step: 2
n_slot (calculated): 1440
len(data): 1440, day_slot: 288, n_day: 5
10 10
epoch 0   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 1.430191198984782 , validation loss: 0.998733401298523
epoch 1   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.8833939935646805 , validation loss: 1.0005281493067741
epoch 2   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.6639882559869804 , validation loss: 1.0391566529870033
epoch 3   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.5761554919037164 , validation loss: 1.0629280135035515
epoch 4   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.5314120247083551 , validation loss: 1.029329463839531
epoch 5   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.4992317341121973 , validation loss: 0.9915029779076576
epoch 6   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.4812091454571369 , validation loss: 0.9878880381584167
epoch 7   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.46733379130269964 , validation loss: 0.9763545840978622
epoch 8   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.45613057414690655 , validation loss: 0.9606357589364052
epoch 9   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.4462068852256326 , validation loss: 0.9499065652489662
epoch 10   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.43720057431389303 , validation loss: 0.9356869459152222
epoch 11   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.42919251381182205 , validation loss: 0.9289369583129883
epoch 12   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.42178503789153754 , validation loss: 0.918598122894764
epoch 13   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.41508787870407104 , validation loss: 0.9272954687476158
epoch 14   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.40866068063997757 , validation loss: 0.9259554073214531
epoch 15   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.40264294077368346 , validation loss: 0.9064239040017128
epoch 16   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.39709701958824606 , validation loss: 0.9151702746748924
epoch 17   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.39181019804056955 , validation loss: 0.8946099430322647
epoch 18   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.38699573687478606 , validation loss: 0.9018434584140778
epoch 19   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.38209692695561576 , validation loss: 0.8759396448731422
epoch 20   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.3775868877476337 , validation loss: 0.8633643612265587
epoch 21   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.37319828248491477 , validation loss: 0.874143935739994
epoch 22   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.3689328180808647 , validation loss: 0.8780062273144722
epoch 23   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.36476483356718925 , validation loss: 0.8497828990221024
epoch 24   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.36061926624354196 , validation loss: 0.8128827661275864
epoch 25   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.3565781391134449 , validation loss: 0.8155409917235374
epoch 26   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.35237953417441426 , validation loss: 0.7931739464402199
epoch 27   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.3481932130514407 , validation loss: 0.8201230317354202
epoch 28   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.3441660824943991 , validation loss: 0.7762223780155182
epoch 29   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.34001968538059907 , validation loss: 0.7831111401319504
epoch 30   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.3357308705647786 , validation loss: 0.7872875183820724
epoch 31   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.33180823513105806 , validation loss: 0.7380506992340088
epoch 32   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.32815834529259624 , validation loss: 0.7284961640834808
epoch 33   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.3247837395060296 , validation loss: 0.7285040616989136
epoch 34   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.3214969366204505 , validation loss: 0.7196387574076653
epoch 35   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.3187667166485506 , validation loss: 0.7294755578041077
epoch 36   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.3161015697554046 , validation loss: 0.7121858671307564
epoch 37   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.3134280992489235 , validation loss: 0.7071881368756294
epoch 38   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.31118209513963435 , validation loss: 0.7027965560555458
epoch 39   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.3093191589794907 , validation loss: 0.7067626789212227
epoch 40   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.307302292655496 , validation loss: 0.7067967876791954
epoch 41   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.30544762459455754 , validation loss: 0.6970255523920059
epoch 42   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.3033940482373331 , validation loss: 0.6932250559329987
epoch 43   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.30203133412435945 , validation loss: 0.6888105943799019
epoch 44   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.30053241171088874 , validation loss: 0.7019381895661354
epoch 45   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.2990415546239591 , validation loss: 0.682980015873909
epoch 46   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.2976246032060361 , validation loss: 0.6875664219260216
epoch 47   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.29625142906226365 , validation loss: 0.6899140924215317
epoch 48   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.295018276163176 , validation loss: 0.6857297047972679
epoch 49   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.29372750251900914 , validation loss: 0.6768503338098526
epoch 50   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.2923624129856334 , validation loss: 0.683394081890583
epoch 51   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.2911604935047673 , validation loss: 0.6785979866981506
epoch 52   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.2900623071427439 , validation loss: 0.6845106407999992
epoch 53   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.28898266892807156 , validation loss: 0.6821468397974968
epoch 54   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.28777967364180324 , validation loss: 0.6816112101078033
epoch 55   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.2867085115582335 , validation loss: 0.6775484532117844
epoch 56   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.2856785035600849 , validation loss: 0.6777151972055435
epoch 57   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.28493134940371795 , validation loss: 0.6792702600359917
epoch 58   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.2838934484650107 , validation loss: 0.6824145317077637
epoch 59   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.28284407538526196 , validation loss: 0.6788540184497833
epoch 60   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.2820083908006257 , validation loss: 0.684116818010807
epoch 61   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.28106775821423996 , validation loss: 0.6821863874793053
epoch 62   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.28016356159658995 , validation loss: 0.6783164143562317
epoch 63   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.27922676006952923 , validation loss: 0.685089036822319
epoch 64   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.27827400845639844 , validation loss: 0.6744647473096848
epoch 65   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.27756521631689635 , validation loss: 0.6670875772833824
epoch 66   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.2768392697268841 , validation loss: 0.6725299879908562
epoch 67   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.2759107719449436 , validation loss: 0.6729149743914604
epoch 68   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.2751796140390284 , validation loss: 0.6689639911055565
epoch 69   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.27422796277438893 , validation loss: 0.6692545413970947
epoch 70   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.2735159023135316 , validation loss: 0.6794585585594177
epoch 71   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.27269840883273705 , validation loss: 0.6772784814238548
epoch 72   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.27213549204901155 , validation loss: 0.670350581407547
epoch 73   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.2714395610725178 , validation loss: 0.6805698126554489
epoch 74   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.27062774230452147 , validation loss: 0.6643257588148117
epoch 75   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.269850715118296 , validation loss: 0.6637182161211967
epoch 76   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.26908085918894004 , validation loss: 0.6650882139801979
epoch 77   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.2686802031947117 , validation loss: 0.6610956192016602
epoch 78   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.26795485235896765 , validation loss: 0.665945753455162
epoch 79   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.26699023328575433 , validation loss: 0.6731697991490364
epoch 80   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.2664810600234013 , validation loss: 0.649258516728878
epoch 81   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.26585376116574977 , validation loss: 0.6587774232029915
epoch 82   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.2653418902088614 , validation loss: 0.6692515462636948
epoch 83   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.26471876221544605 , validation loss: 0.6709509417414665
epoch 84   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.26405861330967323 , validation loss: 0.6671432629227638
epoch 85   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.2635941534650092 , validation loss: 0.6633750051259995
epoch 86   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.2629423673246421 , validation loss: 0.6695912331342697
epoch 87   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.2623206315671696 , validation loss: 0.6534749120473862
epoch 88   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.2617409895448124 , validation loss: 0.6592753008008003
epoch 89   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.2611755246625227 , validation loss: 0.6504727154970169
epoch 90   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.26058944007929635 , validation loss: 0.6509358212351799
epoch 91   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.260098878659454 , validation loss: 0.6597394123673439
epoch 92   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.25953705141357347 , validation loss: 0.6500676870346069
epoch 93   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.259042170994422 , validation loss: 0.6679597124457359
epoch 94   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.25859733481033176 , validation loss: 0.6594968289136887
epoch 95   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.25777005798676433 , validation loss: 0.6611168086528778
epoch 96   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.2575005021165399 , validation loss: 0.6487556248903275
tensor(56.7708, device='cuda:0')
MAE: [0.3046304518317554, 0.39457965283145763, 0.43038319416670606, 0.46844542708910386, 0.5071926490020622, 0.5284505269058125, 0.5245101251798807, 0.527794896523209, 0.5583649763199933, 0.5834474388411096, 0.5833575681789019, 0.593007768955293, 0.6118055472279101, 0.6198357025379334, 0.6187997746482953, 0.6238811768842957, 0.6353207103397275, 0.6408696692523345, 0.6327643845234181, 0.6222855289106872, 0.6251180205390472, 0.6260082244688703, 0.6162417643387639, 0.6041195870845665, 0.6047178226778495, 0.6074338531728412, 0.5912191014521823, 0.5805814936219417, 0.5855261514451086, 0.5811055377287041, 0.5610038152340915, 0.5498222412320679] , MAPE: [0.12598122214905388, 0.1001830395851357, 0.14916440589062405, 0.18285320468949628, 0.14354879504484752, 0.10151711799400238, 0.05624496293416218, 0.0601408760403775, 0.03296610206810244, 0.09877330028188544, 0.0739008763588467, 0.0807121098149076, 0.08081665924660257, 0.12056844603696948, 0.06102343604140543, 0.02601936124723204, 0.03479906773226775, 0.05360080992306112, 0.04054676323356203, 0.03182280250887396, 0.09009093381120936, 0.058579418607867445, 0.03287879434831263, -0.012673166358673023, 0.006670574076940574, -0.01059413333098643, -0.011105686115903885, -0.07562430726745605, -0.09858342158063267, -0.06949991774383438, -0.07780422707476843, -0.1957875536424924] %, RMSE: [0.576231697714938, 0.6750452864772816, 0.7062327955666893, 0.7470474150343859, 0.8060175590248558, 0.8292062438867337, 0.809534626239442, 0.806132108465088, 0.8401690600831072, 0.8575405504067243, 0.8396316198165478, 0.8447293995340698, 0.8744700894437996, 0.8810971102719258, 0.87132298025367, 0.8815889959585828, 0.899420580749294, 0.8909144517135525, 0.8630313092709415, 0.8444239153084849, 0.8471904941498312, 0.8464741524622295, 0.8307216100516177, 0.8178288806195201, 0.8206633537748981, 0.8229403195259878, 0.79696370001673, 0.7818334172892811, 0.7917653492225284, 0.7927183831134199, 0.7646662523314028, 0.7591439988016826]
epoch 97   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.2569810917564467 , validation loss: 0.6458922252058983
tensor(56.5373, device='cuda:0')
MAE: [0.28859105629808046, 0.38734190785354866, 0.4238628254942212, 0.45315401691789786, 0.4934188589943362, 0.4971620413661003, 0.5037898448862366, 0.515026825632055, 0.5413517906870117, 0.5718138192033337, 0.5872817304399172, 0.5896606997342915, 0.6042646697263435, 0.5962789922672295, 0.5977894428026738, 0.5905712589091554, 0.6058132555988646, 0.6203931618570206, 0.628996183144063, 0.6203247710830081, 0.6188563966322882, 0.6134585749455872, 0.6027927847632889, 0.5910126028497963, 0.5910674864856392, 0.6010250213665446, 0.5918355329396184, 0.5812040139673297, 0.5791250755822228, 0.5667283292283717, 0.5550696321292636, 0.5364718853766771] , MAPE: [0.11912239178418442, 0.09115355888658237, 0.15657349565952508, 0.1804254755955428, 0.18229134878266084, 0.10972744750681646, 0.0880267168885122, 0.09794804296498433, 0.05417072945758376, 0.12316855338624609, 0.1086496412648595, 0.10124756344192759, 0.09642726258725197, 0.13525802591933656, 0.07901574463636636, 0.03937274589343417, 0.027826365268245862, 0.07098471700782519, 0.04690199658891982, 0.05656550306743869, 0.12036408585935017, 0.08616595455690144, 0.04894708817211141, 0.02295522847494888, 0.045104202083002934, 0.01430149330983863, -0.009688918525807633, -0.05910541633774104, -0.12867581186040794, -0.08502570020519773, -0.06044162974132857, -0.2861504231590403] %, RMSE: [0.5535096227877029, 0.6775027169178012, 0.7077798701787303, 0.7332686409138289, 0.7917624741651919, 0.7862986679104765, 0.7908140338304093, 0.80559814842249, 0.8324154026247158, 0.8580811460724762, 0.8662416654735793, 0.8576487408748271, 0.8756409617300728, 0.8564604500951276, 0.8544701571894965, 0.8472863251947176, 0.8740440342689404, 0.8795949153061914, 0.8769340255559871, 0.8594993223017764, 0.8531892833109788, 0.8412870177892752, 0.826218461400437, 0.8201856411126813, 0.8210811710428849, 0.8313539171969262, 0.8154682974950416, 0.8011167630501889, 0.7985231728801241, 0.7851689874549546, 0.7757622210136335, 0.7663085109113333]
epoch 98   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.2566828102457757 , validation loss: 0.6450029239058495
tensor(56.3162, device='cuda:0')
MAE: [0.2968516085036195, 0.3862320105069, 0.42464940922824457, 0.4687966310272243, 0.5058466196117788, 0.517795146711017, 0.5099632957168692, 0.52071476651154, 0.5488885489286682, 0.5620795686272232, 0.5684425590608807, 0.5905296842177812, 0.6089055133252836, 0.605339501144883, 0.6027382753267116, 0.6153104045887277, 0.6259225182012491, 0.6308845052887331, 0.6298108613974962, 0.629508035259955, 0.6267950315938629, 0.617146109311467, 0.59851174632529, 0.5910743489407349, 0.5883163486544004, 0.5906994186883274, 0.5782873014028462, 0.5682120843105901, 0.5646517110231918, 0.5561903950817806, 0.5389513116287663, 0.5314947888224395] , MAPE: [0.1306737252545686, 0.10445018792816273, 0.14388713554463356, 0.1791830058582322, 0.15504868414841375, 0.11455355184544273, 0.0755008066042786, 0.08847694260479104, 0.06340480172286259, 0.1284451483975173, 0.09533976874396459, 0.11280115653612212, 0.10651078329543395, 0.14581693719465078, 0.08477197192750328, 0.06776058035429287, 0.05651116525826342, 0.07857307338776287, 0.05710230999683527, 0.0584132767716411, 0.12353563553615328, 0.09296564040047875, 0.03839178099000248, 0.03489817914100527, 0.03840791274651827, 0.026415982051409263, 0.006947371765800761, -0.052681585278194165, -0.08969080102143295, -0.04927128324812619, -0.061397933190947725, -0.18797578221554243] %, RMSE: [0.5640837204680648, 0.6667292820494345, 0.7050886210634668, 0.7550020011980414, 0.8081419620376101, 0.8156901344522444, 0.7905507062764211, 0.8031215233172065, 0.8343800213583161, 0.8349321090614761, 0.8310581368776888, 0.8561765036677921, 0.8826826033812875, 0.8724866254384179, 0.8604936104552037, 0.883047323847369, 0.8983681812541898, 0.890922469971713, 0.8744107889424984, 0.8689773856546716, 0.8630204046021394, 0.8441356544469494, 0.8138128240250285, 0.8146856218668116, 0.812364359299336, 0.8141625794931335, 0.7954131359355532, 0.7821708960135461, 0.7794169693038722, 0.7743532996748036, 0.7526094176255855, 0.7559498666415086]
epoch 99   lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4 , train loss: 0.25609906660575493 , validation loss: 0.6471976041793823
tensor(56.0930, device='cuda:0')
MAE: [0.30903744677484957, 0.39281723735815627, 0.4272800002072352, 0.4794873051384714, 0.5168391816567668, 0.5377340067260582, 0.5375210671272782, 0.5471298729046488, 0.5816891714227722, 0.6058829806987004, 0.6076834600333355, 0.6171036266210997, 0.629687388347001, 0.6373731328785113, 0.6406402125808689, 0.6462834519835323, 0.6440888966391458, 0.6467153179111708, 0.6507373376340442, 0.6507350023819576, 0.6537467105682824, 0.6558688946870953, 0.6519145594062956, 0.6414856123411548, 0.6364234534992846, 0.6420214717101651, 0.6232267026941186, 0.6124335723220534, 0.6062401155125081, 0.6048250461258379, 0.5989081566012705, 0.5911397064373511] , MAPE: [0.13701533979312988, 0.09840112724626733, 0.1382486943752482, 0.16427517618291643, 0.15841138831960258, 0.09432411405143115, 0.05457642278644663, 0.05309257462614284, 0.028486586106865643, 0.09128096845774485, 0.05280422736780162, 0.05758997330142632, 0.046752666895278246, 0.07464810335904404, 0.027172285522407486, 0.006916163732257514, 0.009111894420330575, 0.011042962181045836, -0.00011030366304618566, 0.015512535706493696, 0.052088977099797144, 0.03440764555285118, -0.007189741198043399, -0.039491953788572426, -0.02000142318038774, -0.04040610708054542, -0.03955465320160207, -0.09436151266101622, -0.09366253868655307, -0.08481931621940883, -0.08666048307468653, -0.19561470321711447] %, RMSE: [0.5815977924163872, 0.669575292815493, 0.6975955020754423, 0.7583242619967567, 0.8084244780937515, 0.824909840609657, 0.8129904348981052, 0.8218366753470521, 0.8609391963550986, 0.8799178100421656, 0.8630206792642007, 0.8662089503131412, 0.8809232098758121, 0.884580978018619, 0.8814301932376881, 0.8947521749897379, 0.8938566460666411, 0.8839927845976, 0.8767131771163293, 0.87203360813954, 0.8705407910104324, 0.870430723694359, 0.8609410219699456, 0.8516924995583914, 0.8466666506053557, 0.8550293486917211, 0.8273731124716595, 0.8076644008488121, 0.7970136425330253, 0.7986979007348507, 0.7875811291760243, 0.7866479692221353]
test loss: NIL 
MAE: [0.30903744677484957, 0.39281723735815627, 0.4272800002072352, 0.4794873051384714, 0.5168391816567668, 0.5377340067260582, 0.5375210671272782, 0.5471298729046488, 0.5816891714227722, 0.6058829806987004, 0.6076834600333355, 0.6171036266210997, 0.629687388347001, 0.6373731328785113, 0.6406402125808689, 0.6462834519835323, 0.6440888966391458, 0.6467153179111708, 0.6507373376340442, 0.6507350023819576, 0.6537467105682824, 0.6558688946870953, 0.6519145594062956, 0.6414856123411548, 0.6364234534992846, 0.6420214717101651, 0.6232267026941186, 0.6124335723220534, 0.6062401155125081, 0.6048250461258379, 0.5989081566012705, 0.5911397064373511] , MAPE: [0.13701533979312988, 0.09840112724626733, 0.1382486943752482, 0.16427517618291643, 0.15841138831960258, 0.09432411405143115, 0.05457642278644663, 0.05309257462614284, 0.028486586106865643, 0.09128096845774485, 0.05280422736780162, 0.05758997330142632, 0.046752666895278246, 0.07464810335904404, 0.027172285522407486, 0.006916163732257514, 0.009111894420330575, 0.011042962181045836, -0.00011030366304618566, 0.015512535706493696, 0.052088977099797144, 0.03440764555285118, -0.007189741198043399, -0.039491953788572426, -0.02000142318038774, -0.04040610708054542, -0.03955465320160207, -0.09436151266101622, -0.09366253868655307, -0.08481931621940883, -0.08666048307468653, -0.19561470321711447] %, RMSE: [0.5815977924163872, 0.669575292815493, 0.6975955020754423, 0.7583242619967567, 0.8084244780937515, 0.824909840609657, 0.8129904348981052, 0.8218366753470521, 0.8609391963550986, 0.8799178100421656, 0.8630206792642007, 0.8662089503131412, 0.8809232098758121, 0.884580978018619, 0.8814301932376881, 0.8947521749897379, 0.8938566460666411, 0.8839927845976, 0.8767131771163293, 0.87203360813954, 0.8705407910104324, 0.870430723694359, 0.8609410219699456, 0.8516924995583914, 0.8466666506053557, 0.8550293486917211, 0.8273731124716595, 0.8076644008488121, 0.7970136425330253, 0.7986979007348507, 0.7875811291760243, 0.7866479692221353]
====================
training elapsedd with 320.12 seconds for 100 iterations, the sec/iter = 3.20

MAE_mean: [0.30903745 0.39281724 0.42728    0.47948731 0.51683918 0.53773401
 0.53752107 0.54712987 0.58168917 0.60588298 0.60768346 0.61710363
 0.62968739 0.63737313 0.64064021 0.64628345 0.6440889  0.64671532
 0.65073734 0.650735   0.65374671 0.65586889 0.65191456 0.64148561
 0.63642345 0.64202147 0.6232267  0.61243357 0.60624012 0.60482505
 0.59890816 0.59113971] , MAPE_mean: [ 1.37015340e-01  9.84011272e-02  1.38248694e-01  1.64275176e-01
  1.58411388e-01  9.43241141e-02  5.45764228e-02  5.30925746e-02
  2.84865861e-02  9.12809685e-02  5.28042274e-02  5.75899733e-02
  4.67526669e-02  7.46481034e-02  2.71722855e-02  6.91616373e-03
  9.11189442e-03  1.10429622e-02 -1.10303663e-04  1.55125357e-02
  5.20889771e-02  3.44076456e-02 -7.18974120e-03 -3.94919538e-02
 -2.00014232e-02 -4.04061071e-02 -3.95546532e-02 -9.43615127e-02
 -9.36625387e-02 -8.48193162e-02 -8.66604831e-02 -1.95614703e-01] , RMSE_mean: [0.58159779 0.66957529 0.6975955  0.75832426 0.80842448 0.82490984
 0.81299043 0.82183668 0.8609392  0.87991781 0.86302068 0.86620895
 0.88092321 0.88458098 0.88143019 0.89475217 0.89385665 0.88399278
 0.87671318 0.87203361 0.87054079 0.87043072 0.86094102 0.8516925
 0.84666665 0.85502935 0.82737311 0.8076644  0.79701364 0.7986979
 0.78758113 0.78664797]

MAE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , MAPE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan] , RMSE_std: [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
Finished training with: lr1e-4_bs64_nh128_ra1e-5_dp0.2_wd1e-5_ah2_ck5_kt4
Random search tuning completed. Results saved to tuning_results_G_96_R_1312.csv.
